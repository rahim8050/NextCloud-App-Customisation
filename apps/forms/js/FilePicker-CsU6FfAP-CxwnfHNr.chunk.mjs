/*! third party licenses: js/vendor.LICENSE.txt */
import{V as T,c as d,t as A,a as F,r as h,s as j,w as pe,o as $,n as Le,b as Pe,e as ze}from"./vendor-DyfrS5kh.chunk.mjs";import{d as q,e as $e,f as Oe,g as De,n as _,t as v,s as U,c as fe,_ as Z,p as M,a as Ee,b as he}from"./NcSettingsSection-CX5q924g-LnPhDy5H.chunk.mjs";import{c as Te,d as Ve,u as Ae,a as Me,E as Re,N as He,g as je,i as me,b as We,e as G,f as qe,h as Ue,s as Ze,F as L,C as ve,j as Ge,r as Y,k as ge,m as Ye,l as Ke,n as Je,o as Qe,p as Xe,q as et,t as tt,v as Q,w as it,x as rt}from"./Submit-C5uhIhQb.chunk.mjs";import{b as O,N as K,u as nt,s as st,e as at,g as ot,c as ye,d as B}from"./modulepreload-polyfill-DsqUG6ei.chunk.mjs";import{a as lt}from"./NcEmptyContent-4nhQl1Jo.chunk.mjs";var ct=Object.defineProperty,X=Object.getOwnPropertySymbols,ut=Object.prototype.hasOwnProperty,dt=Object.prototype.propertyIsEnumerable,ee=(e,t,i)=>t in e?ct(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,te=(e,t)=>{for(var i in t||(t={}))ut.call(t,i)&&ee(e,i,t[i]);if(X)for(var i of X(t))dt.call(t,i)&&ee(e,i,t[i]);return e};const pt={name:"ChevronRightIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var ft=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon chevron-right-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},ht=[],mt=O(pt,ft,ht,!1,null,null);const vt=mt.exports,gt={name:"NcBreadcrumb",components:{NcActions:q,ChevronRight:vt,NcButton:K},inheritAttrs:!1,props:{name:{type:String,required:!0},title:{type:String,default:null},to:{type:[String,Object],default:void 0},exact:{type:Boolean,default:!1},href:{type:String,default:void 0},icon:{type:String,default:""},forceIconText:{type:Boolean,default:!1},disableDrop:{type:Boolean,default:!1},forceMenu:{type:Boolean,default:!1},open:{type:Boolean,default:!1}},emits:["update:open","dropped"],setup(){const e=Te();return{actionsContainer:'.vue-crumb[data-crumb-id="'.concat(e,'"]'),crumbId:e}},data(){return{hovering:!1}},computed:{linkAttributes(){return this.to?te({to:this.to,exact:this.exact},this.$attrs):this.href?te({href:this.href},this.$attrs):this.$attrs}},methods:{onOpenChange(e){this.$emit("update:open",e)},dropped(e){return this.disableDrop||(this.$emit("dropped",e,this.to||this.href),this.$parent.$emit("dropped",e,this.to||this.href),this.hovering=!1),!1},dragEnter(){this.disableDrop||(this.hovering=!0)},dragLeave(e){this.disableDrop||e.target.contains(e.relatedTarget)||this.$refs.crumb.contains(e.relatedTarget)||(this.hovering=!1)}}};var yt=function(){var e=this,t=e._self._c;return t("li",{ref:"crumb",staticClass:"vue-crumb",class:{"vue-crumb--hovered":e.hovering},attrs:{"data-crumb-id":e.crumbId,draggable:"false"},on:{dragstart:function(i){return i.preventDefault(),(()=>{}).apply(null,arguments)},drop:function(i){return i.preventDefault(),e.dropped.apply(null,arguments)},dragover:function(i){return i.preventDefault(),(()=>{}).apply(null,arguments)},dragenter:e.dragEnter,dragleave:e.dragLeave}},[(e.name||e.icon||e.$slots.icon)&&!e.$slots.default?t("NcButton",e._g(e._b({attrs:{"aria-label":e.icon?e.name:void 0,title:e.title,variant:"tertiary"},scopedSlots:e._u([e.$slots.icon||e.icon?{key:"icon",fn:function(){return[e._t("icon",function(){return[t("span",{staticClass:"icon",class:e.icon})]})]},proxy:!0}:null,!(e.$slots.icon||e.icon)||e.forceIconText?{key:"default",fn:function(){return[e._v(" "+e._s(e.name)+" ")]},proxy:!0}:null],null,!0)},"NcButton",e.linkAttributes,!1),e.$listeners)):e._e(),e.$slots.default?t("NcActions",{ref:"actions",attrs:{"force-menu":e.forceMenu,open:e.open,"menu-name":e.name,title:e.title,"force-name":!0,container:e.actionsContainer,variant:"tertiary"},on:{"update:open":e.onOpenChange},scopedSlots:e._u([{key:"icon",fn:function(){return[e._t("menu-icon")]},proxy:!0}],null,!0)},[e._t("default")],2):e._e(),t("ChevronRight",{staticClass:"vue-crumb__separator",attrs:{size:20}})],1)},bt=[],_t=O(gt,yt,bt,!1,null,"bc2f0c21");const be=_t.exports;var R=Symbol(),P=Symbol(),ie=Symbol(),re=Symbol(),J=function(e){return"frag"in e},wt={get:function(){return this[P]||this.parentElement},configurable:!0},z=function(e,t){P in e||(e[P]=t,Object.defineProperty(e,"parentNode",wt))},Ct={get:function(){var e=this.parentNode.childNodes,t=e.indexOf(this);return t>-1&&e[t+1]||null}},V=function(e){ie in e||(e[ie]=!0,Object.defineProperty(e,"nextSibling",Ct))},kt=function(e,t){for(;e.parentNode!==t;){var i=e,r=i.parentNode;r&&(e=r)}return e},H,_e=function(e){if(!H){var t=Object.getOwnPropertyDescriptor(Node.prototype,"childNodes");H=t.get}var i=H.apply(e),r=Array.from(i).map(function(n){return kt(n,e)});return r.filter(function(n,s){return n!==r[s-1]})},St={get:function(){return this.frag||_e(this)}},Nt={get:function(){return this.childNodes[0]||null}};function xt(){return this.childNodes.length>0}var ne=function(e){re in e||(e[re]=!0,Object.defineProperties(e,{childNodes:St,firstChild:Nt}),e.hasChildNodes=xt)};function Ft(){var e;(e=this.frag[0]).before.apply(e,arguments)}function It(){var e=this.frag,t=e.splice(0,e.length);t.forEach(function(i){i.remove()})}var Bt=function e(t){var i;return(i=Array.prototype).concat.apply(i,t.map(function(r){return J(r)?e(r.frag):r}))},Lt=function(e,t){var i=e[R];t.before(i),z(i,e),e.frag.unshift(i)};function se(e){if(J(this)){var t=this.frag.indexOf(e);if(t>-1){var i=this.frag.splice(t,1),r=i[0];this.frag.length===0&&Lt(this,r),e.remove()}}else{var n=_e(this),s=n.indexOf(e);s>-1&&e.remove()}return e}function ae(e,t){var i=this,r=e.frag||[e];if(J(this)){if(e[P]===this&&e.parentElement)return e;var n=this.frag;if(t){var s=n.indexOf(t);s>-1&&(n.splice.apply(n,[s,0].concat(r)),t.before.apply(t,r))}else{var a=n[n.length-1];n.push.apply(n,r),a.after.apply(a,r)}we(this)}else t?this.childNodes.includes(t)&&t.before.apply(t,r):this.append.apply(this,r);r.forEach(function(c){z(c,i)});var o=r[r.length-1];return V(o),e}function Pt(e){if(e[P]===this&&e.parentElement)return e;var t=this.frag,i=t[t.length-1];return i.after(e),z(e,this),we(this),t.push(e),e}var we=function(e){var t=e[R];e.frag[0]===t&&(e.frag.shift(),t.remove())},zt={set:function(e){var t=this;if(this.frag[0]!==this[R]&&this.frag.slice().forEach(function(r){return t.removeChild(r)}),e){var i=document.createElement("div");i.innerHTML=e,Array.from(i.childNodes).forEach(function(r){t.appendChild(r)})}},get:function(){return""}},$t={inserted:function(e){var t=e.parentNode,i=e.nextSibling,r=e.previousSibling,n=Array.from(e.childNodes),s=document.createComment("");n.length===0&&n.push(s),e.frag=n,e[R]=s;var a=document.createDocumentFragment();a.append.apply(a,Bt(n)),e.replaceWith(a),n.forEach(function(o){z(o,e),V(o)}),ne(e),Object.assign(e,{remove:It,appendChild:Pt,insertBefore:ae,removeChild:se,before:Ft}),Object.defineProperty(e,"innerHTML",zt),t&&(Object.assign(t,{removeChild:se,insertBefore:ae}),z(e,t),ne(t)),i&&V(e),r&&V(r)},unbind:function(e){e.remove()}},Ce={name:"Fragment",directives:{frag:$t},render:function(e){return e("div",{directives:[{name:"frag"}]},this.$slots.default)}},Ot=Object.defineProperty,oe=Object.getOwnPropertySymbols,Dt=Object.prototype.hasOwnProperty,Et=Object.prototype.propertyIsEnumerable,le=(e,t,i)=>t in e?Ot(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Tt=(e,t)=>{for(var i in t||(t={}))Dt.call(t,i)&&le(e,i,t[i]);if(oe)for(var i of oe(t))Et.call(t,i)&&le(e,i,t[i]);return e};const Vt={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var At=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon folder-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Mt=[],Rt=O(Vt,At,Mt,!1,null,null);const Ht=Rt.exports;function ce(e,t,i){if(e!==void 0)for(let r=e.length-1;r>=0;r--){const n=e[r],s=!n.componentOptions&&n.tag&&t.indexOf(n.tag)===-1,a=!!n.componentOptions&&typeof n.componentOptions.tag=="string",o=a&&t.indexOf(n.componentOptions.tag)===-1;(s||!a||o)&&((s||o)&&T.util.warn("".concat(s?n.tag:n.componentOptions.tag," is not allowed inside the ").concat(i.$options.name," component"),i),e.splice(r,1))}}const b="vue-crumb",jt={name:"NcBreadcrumbs",components:{NcActions:q,NcActionButton:De,NcActionRouter:Oe,NcActionLink:$e,NcBreadcrumb:be,IconFolder:Ht},props:{rootIcon:{type:String,default:"icon-home"},ariaLabel:{type:String,default:null}},emits:["dropped"],data(){return{hiddenIndices:[],menuBreadcrumbProps:{name:"",forceMenu:!0,disableDrop:!0,open:!1},breadcrumbsRefs:{}}},beforeMount(){ce(this.$slots.default,["NcBreadcrumb"],this)},beforeUpdate(){ce(this.$slots.default,["NcBreadcrumb"],this)},created(){window.addEventListener("resize",Ve(()=>{this.handleWindowResize()},100)),st("navigation-toggled",this.delayedResize)},mounted(){this.handleWindowResize()},updated(){this.delayedResize(),this.$nextTick(()=>{this.hideCrumbs()})},beforeDestroy(){window.removeEventListener("resize",this.handleWindowResize),nt("navigation-toggled",this.delayedResize)},methods:{closeActions(e){this.$refs.actionsBreadcrumb.$el.contains(e.relatedTarget)||(this.menuBreadcrumbProps.open=!1)},async delayedResize(){await this.$nextTick(),this.handleWindowResize()},handleWindowResize(){var e;if(!this.$refs.container)return;const t=Object.values(this.breadcrumbsRefs),i=t.length,r=[],n=this.$refs.container.offsetWidth;let s=this.getTotalWidth(t);this.$refs.breadcrumb__actions&&(s+=this.$refs.breadcrumb__actions.offsetWidth);let a=s-n;a+=a>0?64:0;let o=0;const c=Math.floor(i/2);for(;a>0&&o<i-2;){const l=c+(o%2?o+1:o)/2*Math.pow(-1,o+i%2);a-=this.getWidth((e=t[l])==null?void 0:e.elm,l===t.length-1),r.push(l),o++}this.arraysEqual(this.hiddenIndices,r.sort((l,u)=>l-u))||(this.hiddenIndices=r)},arraysEqual(e,t){if(e.length!==t.length)return!1;if(e===t)return!0;if(e===null||t===null)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0},getTotalWidth(e){return e.reduce((t,i,r)=>t+this.getWidth(i?.elm,r===e.length-1),0)},getWidth(e,t){if(!e?.classList)return 0;const i=e.classList.contains("".concat(b,"--hidden"));e.style.minWidth="auto",t&&(e.style.maxWidth="210px"),e.classList.remove("".concat(b,"--hidden"));const r=e.offsetWidth;return i&&e.classList.add("".concat(b,"--hidden")),e.style.minWidth="",e.style.maxWidth="",r},preventDefault(e){return e.preventDefault&&e.preventDefault(),!1},dragStart(e){return this.preventDefault(e)},dropped(e,t,i){return i||this.$emit("dropped",e,t),this.menuBreadcrumbProps.open=!1,document.querySelectorAll(".".concat(b)).forEach(r=>{r.classList.remove("".concat(b,"--hovered"))}),this.preventDefault(e)},dragOver(e){return this.preventDefault(e)},dragEnter(e,t){if(!t&&e.target.closest){const i=e.target.closest(".".concat(b));i.classList&&i.classList.contains(b)&&(document.querySelectorAll(".".concat(b)).forEach(r=>{r.classList.remove("".concat(b,"--hovered"))}),i.classList.add("".concat(b,"--hovered")))}},dragLeave(e,t){if(!t&&!e.target.contains(e.relatedTarget)&&e.target.closest){const i=e.target.closest(".".concat(b));if(i.contains(e.relatedTarget))return;i.classList&&i.classList.contains(b)&&i.classList.remove("".concat(b,"--hovered"))}},hideCrumbs(){Object.values(this.breadcrumbsRefs).forEach((e,t)=>{var i;(i=e?.elm)!=null&&i.classList&&(this.hiddenIndices.includes(t)?e.elm.classList.add("".concat(b,"--hidden")):e.elm.classList.remove("".concat(b,"--hidden")))})},isBreadcrumb(e){var t;return(((t=e?.componentOptions)==null?void 0:t.tag)||e?.tag||"").includes("NcBreadcrumb")}},render(e){const t=[];if(this.$slots.default.forEach(s=>{var a,o;if(this.isBreadcrumb(s)){t.push(s);return}s?.type===Ce&&((o=(a=s?.children)==null?void 0:a.forEach)==null||o.call(a,c=>{this.isBreadcrumb(c)&&t.push(c)}))}),t.length===0)return;T.set(t[0].componentOptions.propsData,"icon",this.rootIcon),T.set(t[0].componentOptions.propsData,"ref","breadcrumbs");const i={};t.forEach((s,a)=>{T.set(s,"ref","crumb-".concat(a)),i[a]=s});let r=[];if(!this.hiddenIndices.length)r=t;else{r=t.slice(0,Math.round(t.length/2)),r.push(e("NcBreadcrumb",{class:"dropdown",props:this.menuBreadcrumbProps,attrs:{"aria-hidden":!0},ref:"actionsBreadcrumb",key:"actions-breadcrumb-1",nativeOn:{dragstart:this.dragStart,dragenter:()=>{this.menuBreadcrumbProps.open=!0},dragleave:this.closeActions},on:{"update:open":a=>{this.menuBreadcrumbProps.open=a}}},this.hiddenIndices.filter(a=>a<=t.length-1).map(a=>{const o=t[a],c=o.componentOptions.propsData.to,l=o.componentOptions.propsData.href,u=o.componentOptions.propsData.disableDrop,f=o.componentOptions.propsData.title,y=o.componentOptions.propsData.name;let w="NcActionButton",k="";l&&(w="NcActionLink",k=l),c&&(w="NcActionRouter",k=c);const S=e("IconFolder",{props:{size:20},slot:"icon"});return e(w,{class:b,props:{href:l||null,title:f,to:c||null},attrs:{draggable:!1},on:Tt({},o.componentOptions.listeners),nativeOn:{dragstart:this.dragStart,drop:C=>this.dropped(C,k,u),dragover:this.dragOver,dragenter:C=>this.dragEnter(C,u),dragleave:C=>this.dragLeave(C,u)}},[S,y])})));const s=t.slice(Math.round(t.length/2));r=r.concat(s)}const n=[e("nav",{attrs:{"aria-label":this.ariaLabel}},[e("ul",{class:"breadcrumb__crumbs"},[r])])];return this.$slots.actions&&n.push(e("div",{class:"breadcrumb__actions",ref:"breadcrumb__actions"},this.$slots.actions)),this.breadcrumbsRefs=i,e("div",{class:["breadcrumb",{"breadcrumb--collapsed":this.hiddenIndices.length===t.length-2}],ref:"container"},n)}},Wt=null,qt=null;var Ut=O(jt,Wt,qt,!1,null,"daf14f2f");const Zt=Ut.exports,Gt={name:"NcDateTime",props:{timestamp:{type:[Date,Number],required:!0},format:{type:Object,default:()=>({timeStyle:"medium",dateStyle:"short"})},relativeTime:{type:[Boolean,String],default:"long",validator:e=>e===!1||["long","short","narrow"].includes(e)},ignoreSeconds:{type:Boolean,default:!1}},setup(e){const t=d(()=>({format:e.format})),i=d(()=>({ignoreSeconds:e.ignoreSeconds,relativeTime:e.relativeTime||"long",update:e.relativeTime!==!1})),r=Ae(A(e,"timestamp"),t),n=Me(A(e,"timestamp"),i);return{formattedTime:d(()=>e.relativeTime?n.value:r.value),title:r}}};var Yt=function(){var e=this,t=e._self._c;return t("span",{staticClass:"nc-datetime",attrs:{dir:"auto","data-timestamp":e.timestamp,title:e.title},domProps:{textContent:e._s(e.formattedTime)}})},Kt=[],Jt=O(Gt,Yt,Kt,!1,null,null);const Qt=Jt.exports;function ke(e,t,i){const r=document.querySelector(`#initial-state-${e}-${t}`);if(r===null)return i;try{return JSON.parse(atob(r.value))}catch{throw new Error(`Could not parse initial state ${t} of ${e}`)}}var W=(e=>(e[e.User=0]="User",e[e.Group=1]="Group",e[e.Link=3]="Link",e[e.Email=4]="Email",e[e.Remote=6]="Remote",e[e.Team=7]="Team",e[e.Guest=8]="Guest",e[e.RemoteGroup=9]="RemoteGroup",e[e.Room=10]="Room",e[e.Deck=12]="Deck",e[e.FederatedGroup=14]="FederatedGroup",e[e.ScienceMesh=15]="ScienceMesh",e))(W||{});class Se extends Error{constructor(t){super(t),this.name="TimeoutError"}}class Xt extends Error{constructor(t){super(),this.name="AbortError",this.message=t}}const ue=e=>globalThis.DOMException===void 0?new Xt(e):new DOMException(e),de=e=>{const t=e.reason===void 0?ue("This operation was aborted."):e.reason;return t instanceof Error?t:ue(t)};function ei(e,t){const{milliseconds:i,fallback:r,message:n,customTimers:s={setTimeout,clearTimeout}}=t;let a,o;const c=new Promise((l,u)=>{if(typeof i!="number"||Math.sign(i)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${i}\``);if(t.signal){const{signal:y}=t;y.aborted&&u(de(y)),o=()=>{u(de(y))},y.addEventListener("abort",o,{once:!0})}if(i===Number.POSITIVE_INFINITY){e.then(l,u);return}const f=new Se;a=s.setTimeout.call(void 0,()=>{if(r){try{l(r())}catch(y){u(y)}return}typeof e.cancel=="function"&&e.cancel(),n===!1?l():n instanceof Error?u(n):(f.message=n??`Promise timed out after ${i} milliseconds`,u(f))},i),(async()=>{try{l(await e)}catch(y){u(y)}})()}).finally(()=>{c.clear(),o&&t.signal&&t.signal.removeEventListener("abort",o)});return c.clear=()=>{s.clearTimeout.call(void 0,a),a=void 0},c}function ti(e,t,i){let r=0,n=e.length;for(;n>0;){const s=Math.trunc(n/2);let a=r+s;i(e[a],t)<=0?(r=++a,n-=s+1):n=s}return r}class ii{#e=[];enqueue(t,i){i={priority:0,...i};const r={priority:i.priority,id:i.id,run:t};if(this.size===0||this.#e[this.size-1].priority>=i.priority){this.#e.push(r);return}const n=ti(this.#e,r,(s,a)=>a.priority-s.priority);this.#e.splice(n,0,r)}setPriority(t,i){const r=this.#e.findIndex(s=>s.id===t);if(r===-1)throw new ReferenceError(`No promise function with the id "${t}" exists in the queue.`);const[n]=this.#e.splice(r,1);this.enqueue(n.run,{priority:i,id:t})}dequeue(){return this.#e.shift()?.run}filter(t){return this.#e.filter(i=>i.priority===t.priority).map(i=>i.run)}get size(){return this.#e.length}}class ri extends Re{#e;#a;#s=0;#f;#o;#h=0;#i;#l;#t;#m;#r=0;#c;#n;#v;#b=1n;timeout;constructor(t){if(super(),t={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:ii,...t},!(typeof t.intervalCap=="number"&&t.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${t.intervalCap?.toString()??""}\` (${typeof t.intervalCap})`);if(t.interval===void 0||!(Number.isFinite(t.interval)&&t.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${t.interval?.toString()??""}\` (${typeof t.interval})`);this.#e=t.carryoverConcurrencyCount,this.#a=t.intervalCap===Number.POSITIVE_INFINITY||t.interval===0,this.#f=t.intervalCap,this.#o=t.interval,this.#t=new t.queueClass,this.#m=t.queueClass,this.concurrency=t.concurrency,this.timeout=t.timeout,this.#v=t.throwOnTimeout===!0,this.#n=t.autoStart===!1}get#_(){return this.#a||this.#s<this.#f}get#w(){return this.#r<this.#c}#C(){this.#r--,this.#u(),this.emit("next")}#k(){this.#y(),this.#g(),this.#l=void 0}get#S(){const t=Date.now();if(this.#i===void 0){const i=this.#h-t;if(i<0)this.#s=this.#e?this.#r:0;else return this.#l===void 0&&(this.#l=setTimeout(()=>{this.#k()},i)),!0}return!1}#u(){if(this.#t.size===0)return this.#i&&clearInterval(this.#i),this.#i=void 0,this.emit("empty"),this.#r===0&&this.emit("idle"),!1;if(!this.#n){const t=!this.#S;if(this.#_&&this.#w){const i=this.#t.dequeue();return i?(this.emit("active"),i(),t&&this.#g(),!0):!1}}return!1}#g(){this.#a||this.#i!==void 0||(this.#i=setInterval(()=>{this.#y()},this.#o),this.#h=Date.now()+this.#o)}#y(){this.#s===0&&this.#r===0&&this.#i&&(clearInterval(this.#i),this.#i=void 0),this.#s=this.#e?this.#r:0,this.#d()}#d(){for(;this.#u(););}get concurrency(){return this.#c}set concurrency(t){if(!(typeof t=="number"&&t>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${t}\` (${typeof t})`);this.#c=t,this.#d()}async#N(t){return new Promise((i,r)=>{t.addEventListener("abort",()=>{r(t.reason)},{once:!0})})}setPriority(t,i){this.#t.setPriority(t,i)}async add(t,i={}){return i.id??=(this.#b++).toString(),i={timeout:this.timeout,throwOnTimeout:this.#v,...i},new Promise((r,n)=>{this.#t.enqueue(async()=>{this.#r++;try{i.signal?.throwIfAborted(),this.#s++;let s=t({signal:i.signal});i.timeout&&(s=ei(Promise.resolve(s),{milliseconds:i.timeout})),i.signal&&(s=Promise.race([s,this.#N(i.signal)]));const a=await s;r(a),this.emit("completed",a)}catch(s){if(s instanceof Se&&!i.throwOnTimeout){r();return}n(s),this.emit("error",s)}finally{this.#C()}},i),this.emit("add"),this.#u()})}async addAll(t,i){return Promise.all(t.map(async r=>this.add(r,i)))}start(){return this.#n?(this.#n=!1,this.#d(),this):this}pause(){this.#n=!0}clear(){this.#t=new this.#m}async onEmpty(){this.#t.size!==0&&await this.#p("empty")}async onSizeLessThan(t){this.#t.size<t||await this.#p("next",()=>this.#t.size<t)}async onIdle(){this.#r===0&&this.#t.size===0||await this.#p("idle")}async#p(t,i){return new Promise(r=>{const n=()=>{i&&!i()||(this.off(t,n),r())};this.on(t,n)})}get size(){return this.#t.size}sizeBy(t){return this.#t.filter(t).length}get pending(){return this.#r}get isPaused(){return this.#n}}const ni={name:"FileIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var si=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon file-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},ai=[],oi=_(ni,si,ai,!1,null,null);const Ne=oi.exports,xe=()=>{const e=ke("files","config",null),t=h(e?.show_hidden??!0),i=h(e?.sort_favorites_first??!0),r=h(e?.crop_image_previews??!0);return $(async()=>{if(me())console.debug("Skip loading files settings - currently on public share");else try{const{data:n}=await fe.get(Z("/apps/files/api/v1/configs"));t.value=n?.data?.show_hidden??!1,i.value=n?.data?.sort_favorites_first??!0,r.value=n?.data?.crop_image_previews??!0}catch(n){console.error("Could not load files settings",n),U(v("Could not load files settings"))}}),{showHiddenFiles:t,sortFavoritesFirst:i,cropImagePreviews:r}},li=e=>{const t=l=>l==="asc"?"ascending":l==="desc"?"descending":"none",i=ke("files","viewConfigs",null),r=h({sortBy:i?.files?.sorting_mode??"basename",order:t(i?.files?.sorting_direction??"asc")}),n=h({sortBy:i?.recent?.sorting_mode??"basename",order:t(i?.recent?.sorting_direction??"asc")}),s=h({sortBy:i?.favorites?.sorting_mode??"basename",order:t(i?.favorites?.sorting_direction??"asc")});$(async()=>{if(me())console.debug("Skip loading files views - currently on public share");else try{const{data:l}=await fe.get(Z("/apps/files/api/v1/views"));r.value={sortBy:l?.data?.files?.sorting_mode??"basename",order:t(l?.data?.files?.sorting_direction)},s.value={sortBy:l?.data?.favorites?.sorting_mode??"basename",order:t(l?.data?.favorites?.sorting_direction)},n.value={sortBy:l?.data?.recent?.sorting_mode??"basename",order:t(l?.data?.recent?.sorting_direction)}}catch(l){console.error("Could not load files views",l),U(v("Could not load files views"))}});const a=d(()=>B(e||"files")==="files"?r.value:B(e)==="recent"?n.value:s.value),o=d(()=>a.value.sortBy),c=d(()=>a.value.order);return{filesViewConfig:r,favoritesViewConfig:s,recentViewConfig:n,currentConfig:a,sortBy:o,order:c}},ci={name:"MenuUpIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var ui=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon menu-up-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M7,15L12,10L17,15H7Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},di=[],pi=_(ci,ui,di,!1,null,null);const fi=pi.exports,hi={name:"MenuDownIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var mi=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon menu-down-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M7,10L12,15L17,10H7Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},vi=[],gi=_(hi,mi,vi,!1,null,null);const yi=gi.exports,Fe={"file-picker__file-icon":"_file-picker__file-icon_3v9zx_9","file-picker__file-icon--primary":"_file-picker__file-icon--primary_3v9zx_21","file-picker__file-icon-overlay":"_file-picker__file-icon-overlay_3v9zx_25"},bi=F({__name:"LoadingTableRow",props:{showCheckbox:{type:Boolean}},setup(e){return{__sfc:!0,fileListIconStyles:Fe}}});var _i=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("tr",{staticClass:"file-picker__row loading-row",attrs:{"aria-hidden":"true"}},[e.showCheckbox?t("td",{staticClass:"row-checkbox"},[t("span")]):e._e(),t("td",{staticClass:"row-name"},[t("div",{staticClass:"row-wrapper"},[t("span",{class:i.fileListIconStyles["file-picker__file-icon"]}),t("span")])]),e._m(0),e._m(1)])},wi=[function(){var e=this,t=e._self._c;return e._self._setupProxy,t("td",{staticClass:"row-size"},[t("span")])},function(){var e=this,t=e._self._c;return e._self._setupProxy,t("td",{staticClass:"row-modified"},[t("span")])}],Ci=_(bi,_i,wi,!1,null,"15187afc");const ki=Ci.exports,Si=new ri({concurrency:5});function Ni(e){const{resolve:t,promise:i}=Promise.withResolvers();return Si.add(()=>{const r=new Image;return r.onerror=()=>t(!1),r.onload=()=>t(!0),r.src=e,i}),i}function xi(e,t={}){t={size:32,cropPreview:!1,mimeFallback:!0,...t};try{const i=e.attributes?.previewUrl||Z("/core/preview?fileId={fileid}",{fileid:e.fileid});let r;try{r=new URL(i)}catch{r=new URL(i,window.location.origin)}return r.searchParams.set("x",`${t.size}`),r.searchParams.set("y",`${t.size}`),r.searchParams.set("mimeFallback",`${t.mimeFallback}`),r.searchParams.set("a",t.cropPreview===!0?"0":"1"),r.searchParams.set("c",`${e.attributes.etag}`),r}catch{return null}}const Fi=(e,t)=>{const i=h(null),r=h(!1);return ze(()=>{r.value=!1,i.value=xi(B(e),B(t||{})),i.value&&B(e).type===L.File&&Ni(i.value.href).then(n=>{r.value=n})}),{previewURL:i,previewLoaded:r}},Ii={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Bi=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon folder-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Li=[],Pi=_(Ii,Bi,Li,!1,null,null);const Ie=Pi.exports,zi={name:"FilePreview"},$i=F({...zi,props:{node:null,cropImagePreviews:{type:Boolean}},setup(e){const t=e,i=h(Fe),{previewURL:r,previewLoaded:n}=Fi(A(t,"node"),d(()=>({cropPreview:t.cropImagePreviews}))),s=d(()=>t.node.type===L.File),a=d(()=>{if(t.node.type!==L.Folder)return null;if(t.node.attributes?.["is-encrypted"]===1)return Xe;if(t.node.attributes?.["is-tag"])return et;const o=Object.values(t.node.attributes?.["share-types"]||{}).flat();if(o.some(c=>c===W.Link||c===W.Email))return tt;if(o.length>0)return Q;switch(t.node.attributes?.["mount-type"]){case"external":case"external-session":return rt;case"group":return it;case"shared":return Q}return null});return{__sfc:!0,fileListIconStyles:i,props:t,previewURL:r,previewLoaded:n,isFile:s,folderDecorationIcon:a,NcIconSvgWrapper:ye,IconFile:Ne,IconFolder:Ie}}});var Oi=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("div",{class:i.fileListIconStyles["file-picker__file-icon"],style:i.previewLoaded?{backgroundImage:`url(${i.previewURL})`}:void 0},[i.previewLoaded?e._e():[i.isFile?t(i.IconFile,{attrs:{size:32}}):[i.folderDecorationIcon?t(i.NcIconSvgWrapper,{class:i.fileListIconStyles["file-picker__file-icon-overlay"],attrs:{inline:"",path:i.folderDecorationIcon,size:16}}):e._e(),t(i.IconFolder,{class:i.fileListIconStyles["file-picker__file-icon--primary"],attrs:{size:32}})]]],2)},Di=[],Ei=_($i,Oi,Di,!1,null,null);const Ti=Ei.exports,Vi=F({__name:"FileListRow",props:{allowPickDirectory:{type:Boolean},selected:{type:Boolean},showCheckbox:{type:Boolean},canPick:{type:Boolean},node:null,cropImagePreviews:{type:Boolean}},emits:["update:selected","enter-directory"],setup(e,{emit:t}){const i=e,r=d(()=>i.node.attributes?.displayName||i.node.basename.slice(0,i.node.extension?-i.node.extension.length:void 0)),n=d(()=>i.node.extension),s=d(()=>i.node.type===L.Folder),a=d(()=>i.canPick&&(i.allowPickDirectory||!s.value));function o(){t("update:selected",!i.selected)}function c(){s.value?t("enter-directory",i.node):o()}function l(u){u.key==="Enter"&&c()}return{__sfc:!0,props:i,emit:t,displayName:r,fileExtension:n,isDirectory:s,isPickable:a,toggleSelected:o,handleClick:c,handleKeyDown:l,formatFileSize:Qe,NcCheckboxRadioSwitch:he,NcDateTime:Qt,t:v,FilePreview:Ti}}});var Ai=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("tr",e._g({class:["file-picker__row",{"file-picker__row--selected":e.selected&&!e.showCheckbox}],attrs:{tabindex:e.showCheckbox&&!i.isDirectory?void 0:0,"aria-selected":i.isPickable?e.selected:void 0,"data-filename":e.node.basename,"data-testid":"file-list-row"}},{click:i.handleClick,...!e.showCheckbox||i.isDirectory?{keydown:i.handleKeyDown}:{}}),[e.showCheckbox?t("td",{staticClass:"row-checkbox",on:{click:function(r){return r.stopPropagation(),(()=>{}).apply(null,arguments)}}},[t(i.NcCheckboxRadioSwitch,{attrs:{"aria-label":i.t("Select the row for {nodename}",{nodename:i.displayName}),disabled:!i.isPickable,"data-testid":"row-checkbox","model-value":e.selected},on:{"update:model-value":i.toggleSelected}})],1):e._e(),t("td",{staticClass:"row-name"},[t("div",{staticClass:"file-picker__name-container",attrs:{"data-testid":"row-name"}},[t(i.FilePreview,{attrs:{node:e.node,"crop-image-previews":e.cropImagePreviews}}),t("div",{staticClass:"file-picker__file-name",attrs:{title:i.displayName},domProps:{textContent:e._s(i.displayName)}}),t("div",{staticClass:"file-picker__file-extension",domProps:{textContent:e._s(i.fileExtension)}})],1)]),t("td",{staticClass:"row-size"},[e._v(" "+e._s(i.formatFileSize(e.node.size||0))+" ")]),t("td",{staticClass:"row-modified"},[t(i.NcDateTime,{attrs:{timestamp:e.node.mtime,"ignore-seconds":!0}})],1)])},Mi=[],Ri=_(Vi,Ai,Mi,!1,null,"4892c2a0");const Hi=Ri.exports,ji=F({__name:"FileList",props:{currentView:null,multiselect:{type:Boolean},allowPickDirectory:{type:Boolean},loading:{type:Boolean},files:null,selectedFiles:null,path:null},emits:["update:path","update:selectedFiles"],setup(e,{emit:t}){const i=e,r=h(),{currentConfig:n}=li(i.currentView),s=d(()=>r.value??n.value),a=d(()=>s.value.sortBy==="basename"?s.value.order==="none"?void 0:s.value.order:void 0),o=d(()=>s.value.sortBy==="size"?s.value.order==="none"?void 0:s.value.order:void 0),c=d(()=>s.value.sortBy==="mtime"?s.value.order==="none"?void 0:s.value.order:void 0),l=g=>{s.value.sortBy===g?s.value.order==="ascending"?r.value={sortBy:s.value.sortBy,order:"descending"}:r.value={sortBy:s.value.sortBy,order:"ascending"}:r.value={sortBy:g,order:"ascending"}},{sortFavoritesFirst:u,cropImagePreviews:f}=xe(),y=d(()=>Ze(i.files,{sortFoldersFirst:!0,sortFavoritesFirst:u.value,sortingOrder:s.value.order==="descending"?"desc":"asc",sortingMode:s.value.sortBy})),w=d(()=>i.files.filter(g=>i.allowPickDirectory||g.type!==L.Folder)),k=d(()=>!i.loading&&i.selectedFiles.length>0&&i.selectedFiles.length>=w.value.length);function S(){i.selectedFiles.length<w.value.length?t("update:selectedFiles",w.value):t("update:selectedFiles",[])}function C(g){i.selectedFiles.includes(g)?t("update:selectedFiles",i.selectedFiles.filter(x=>x.path!==g.path)):i.multiselect?t("update:selectedFiles",[...i.selectedFiles,g]):t("update:selectedFiles",[g])}function D(g){t("update:path",g.path)}const I=h(4),N=h();{const g=()=>Le(()=>{const x=N.value?.parentElement?.children||[];let E=N.value?.parentElement?.clientHeight||450;for(let p=0;p<x.length;p++)N.value?.isSameNode(x[p])||(E-=x[p].clientHeight);I.value=Math.max(1,Math.floor((E-50)/50))});$(()=>{window.addEventListener("resize",g),g()}),Pe(()=>{window.removeEventListener("resize",g)})}return{__sfc:!0,props:i,emit:t,customSortingConfig:r,filesAppSorting:n,sortingConfig:s,sortByName:a,sortBySize:o,sortByModified:c,toggleSorting:l,sortFavoritesFirst:u,cropImagePreviews:f,sortedFiles:y,selectableFiles:w,allSelected:k,onSelectAll:S,onNodeSelected:C,onChangeDirectory:D,skeletonNumber:I,fileContainer:N,NcButton:K,NcCheckboxRadioSwitch:he,t:v,IconSortAscending:fi,IconSortDescending:yi,LoadingTableRow:ki,FileListRow:Hi}}});var Wi=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("div",{ref:"fileContainer",staticClass:"file-picker__files"},[t("table",[t("thead",[t("tr",[e.multiselect?t("th",{staticClass:"row-checkbox"},[t("span",{staticClass:"hidden-visually"},[e._v(" "+e._s(i.t("Select entry"))+" ")]),e.multiselect?t(i.NcCheckboxRadioSwitch,{attrs:{"aria-label":i.t("Select all entries"),"data-testid":"select-all-checkbox","model-value":i.allSelected},on:{"update:model-value":i.onSelectAll}}):e._e()],1):e._e(),t("th",{staticClass:"row-name",attrs:{"aria-sort":i.sortByName}},[t("div",{staticClass:"header-wrapper"},[t("span",{staticClass:"file-picker__header-preview"}),t(i.NcButton,{attrs:{wide:!0,type:"tertiary","data-test":"file-picker_sort-name"},on:{click:function(r){return i.toggleSorting("basename")}},scopedSlots:e._u([{key:"icon",fn:function(){return[i.sortByName==="ascending"?t(i.IconSortAscending,{attrs:{size:20}}):i.sortByName==="descending"?t(i.IconSortDescending,{attrs:{size:20}}):t("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(i.t("Name"))+" ")])],1)]),t("th",{staticClass:"row-size",attrs:{"aria-sort":i.sortBySize}},[t(i.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(r){return i.toggleSorting("size")}},scopedSlots:e._u([{key:"icon",fn:function(){return[i.sortBySize==="ascending"?t(i.IconSortAscending,{attrs:{size:20}}):i.sortBySize==="descending"?t(i.IconSortDescending,{attrs:{size:20}}):t("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(i.t("Size"))+" ")])],1),t("th",{staticClass:"row-modified",attrs:{"aria-sort":i.sortByModified}},[t(i.NcButton,{attrs:{wide:!0,type:"tertiary"},on:{click:function(r){return i.toggleSorting("mtime")}},scopedSlots:e._u([{key:"icon",fn:function(){return[i.sortByModified==="ascending"?t(i.IconSortAscending,{attrs:{size:20}}):i.sortByModified==="descending"?t(i.IconSortDescending,{attrs:{size:20}}):t("span",{staticStyle:{width:"44px"}})]},proxy:!0}])},[e._v(" "+e._s(i.t("Modified"))+" ")])],1)])]),t("tbody",[e.loading?e._l(i.skeletonNumber,function(r){return t(i.LoadingTableRow,{key:r,attrs:{"show-checkbox":e.multiselect}})}):e._l(i.sortedFiles,function(r){return t(i.FileListRow,{key:r.fileid||r.path,attrs:{"allow-pick-directory":e.allowPickDirectory,"show-checkbox":e.multiselect,"can-pick":e.multiselect||e.selectedFiles.length===0||e.selectedFiles.includes(r),selected:e.selectedFiles.includes(r),node:r,"crop-image-previews":i.cropImagePreviews},on:{"update:selected":function(n){return i.onNodeSelected(r)},"enter-directory":i.onChangeDirectory}})})],2)])])},qi=[],Ui=_(ji,Wi,qi,!1,null,"4f5d2a56");const Zi=Ui.exports,Gi={name:"HomeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Yi=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon home-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Ki=[],Ji=_(Gi,Yi,Ki,!1,null,null);const Qi=Ji.exports,Xi={name:"PlusIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var er=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon plus-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},tr=[],ir=_(Xi,er,tr,!1,null,null);const rr=ir.exports,nr=F({__name:"FilePickerBreadcrumbs",props:{path:null,showMenu:{type:Boolean}},emits:["update:path","create-node"],setup(e,{emit:t}){const i=e,r=h(!1),n=h(""),s=h();function a(){const l=n.value.trim(),u=s.value?.$el?.querySelector("input");let f="";return l.length===0?f=v("Folder name cannot be empty."):l.includes("/")?f=v('"/" is not allowed inside a folder name.'):["..","."].includes(l)?f=v('"{name}" is an invalid folder name.',{name:l}):window.OC.config?.blacklist_files_regex&&l.match(window.OC.config?.blacklist_files_regex)&&(f=v('"{name}" is not an allowed folder name',{name:l})),u&&u.setCustomValidity(f),f===""}const o=function(){const l=n.value.trim();a()&&(r.value=!1,t("create-node",l),n.value="")},c=d(()=>i.path.split("/").filter(l=>l!=="").map((l,u,f)=>({name:l,path:"/"+f.slice(0,u+1).join("/")})));return{__sfc:!0,props:i,emit:t,actionsOpen:r,newNodeName:n,nameInput:s,validateInput:a,onSubmit:o,pathElements:c,IconFolder:Ie,IconHome:Qi,IconPlus:rr,NcActions:q,NcActionInput:Ue,NcBreadcrumbs:Zt,NcBreadcrumb:be,t:v}}});var sr=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t(i.NcBreadcrumbs,{staticClass:"file-picker__breadcrumbs",scopedSlots:e._u([{key:"default",fn:function(){return[t(i.NcBreadcrumb,{attrs:{name:i.t("All files"),title:i.t("Home")},on:{click:function(r){return i.emit("update:path","/")}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconHome,{attrs:{size:20}})]},proxy:!0}])}),e._l(i.pathElements,function(r){return t(i.NcBreadcrumb,{key:r.path,attrs:{name:r.name,title:r.path},on:{click:function(n){return i.emit("update:path",r.path)}}})})]},proxy:!0},e.showMenu?{key:"actions",fn:function(){return[t(i.NcActions,{attrs:{open:i.actionsOpen,"aria-label":i.t("Create directory"),"force-menu":!0,"force-name":!0,"menu-name":i.t("New"),type:"secondary"},on:{"update:open":function(r){i.actionsOpen=r},close:function(r){i.newNodeName=""}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconPlus,{attrs:{size:20}})]},proxy:!0}],null,!1,2971667417)},[t(i.NcActionInput,{ref:"nameInput",attrs:{value:i.newNodeName,label:i.t("New folder"),placeholder:i.t("New folder name")},on:{"update:value":function(r){i.newNodeName=r},submit:i.onSubmit,"update:model-value":i.validateInput},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconFolder,{attrs:{size:20}})]},proxy:!0}],null,!1,1614167509)})],1)]},proxy:!0}:null],null,!0)})},ar=[],or=_(nr,sr,ar,!1,null,"ec4d392b");const lr=or.exports,cr={name:"CloseIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var ur=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon close-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},dr=[],pr=_(cr,ur,dr,!1,null,null);const fr=pr.exports,hr={name:"MagnifyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var mr=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon magnify-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(i){return e.$emit("click",i)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},vr=[],gr=_(hr,mr,vr,!1,null,null);const yr=gr.exports,br=e=>{const t=[{id:"files",label:v("All files"),icon:Ye},{id:"recent",label:v("Recent"),icon:Ke},{id:"favorites",label:v("Favorites"),icon:Je}],i=e.value?t.filter(({id:r})=>r==="files"):t;return{allViews:t,availableViews:i}},_r=F({__name:"FilePickerNavigation",props:{currentView:null,filterString:null,isCollapsed:{type:Boolean},disabledNavigation:{type:Boolean}},emits:["update:currentView","update:filterString"],setup(e,{emit:t}){const i=e,{availableViews:r}=br(h(ot()===null)),n=d(()=>r.filter(s=>s.id===i.currentView)[0]??r[0]);return{__sfc:!0,props:i,emit:t,availableViews:r,currentViewObject:n,updateFilterValue:s=>t("update:filterString",s),IconClose:fr,IconMagnify:yr,NcButton:K,NcIconSvgWrapper:ye,NcSelect:Ee,NcTextField:qe,Fragment:Ce,t:v}}});var wr=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t(i.Fragment,[t(i.NcTextField,{staticClass:"file-picker__filter-input",attrs:{label:i.t("Filter file list"),"show-trailing-button":!!e.filterString,"model-value":e.filterString},on:{"update:model-value":i.updateFilterValue,"trailing-button-click":function(r){return i.updateFilterValue("")}},scopedSlots:e._u([{key:"trailing-button-icon",fn:function(){return[t(i.IconClose,{attrs:{size:16}})]},proxy:!0}])},[t(i.IconMagnify,{attrs:{size:16}})],1),i.availableViews.length>1&&!e.disabledNavigation?[e.isCollapsed?t(i.NcSelect,{attrs:{"aria-label":i.t("Current view selector"),clearable:!1,searchable:!1,options:i.availableViews,"model-value":i.currentViewObject},on:{"update:model-value":function(r){return i.emit("update:currentView",r.id)}}}):t("ul",{staticClass:"file-picker__side"},e._l(i.availableViews,function(r){return t("li",{key:r.id},[t(i.NcButton,{attrs:{type:e.currentView===r.id?"primary":"tertiary",wide:!0},on:{click:function(n){return e.$emit("update:currentView",r.id)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.NcIconSvgWrapper,{attrs:{path:r.icon,size:20}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(r.label)+" ")])],1)}),0)]:e._e()],2)},Cr=[],kr=_(_r,wr,Cr,!1,null,"f5975252");const Sr=kr.exports;function Nr(e){const t=new AbortController,i=Math.round(Date.now()/1e3)-60*60*24*14;return new ve(async(r,n,s)=>{s(()=>t.abort());try{const{data:a}=await e.search("/",{signal:t.signal,details:!0,data:Ge(i)}),o=a.results.map(c=>Y(c));r(o)}catch(a){n(a)}})}function xr(e,t){const i=new AbortController;return new ve(async(r,n,s)=>{s(()=>i.abort());try{const a=(await e.getDirectoryContents(M.join(G,t),{signal:i.signal,details:!0,includeSelf:!0,data:ge()})).data.map(o=>Y(o));r({contents:a.filter(({path:o})=>o!==t),folder:a.find(({path:o})=>o===t)})}catch(a){n(a)}})}async function Fr(e,t){const{data:i}=await e.stat(M.join(G,t),{details:!0,data:ge()});return Y(i)}const Ir=function(e,t){const i=je(),r=j([]),n=j(null),s=h(!0),a=h(null);async function o(l){const u=M.join(t.value,l);await i.createDirectory(M.join(G,u));const f=await Fr(i,u);return r.value=[...r.value,f],f}async function c(){a.value&&a.value.cancel(),s.value=!0,e.value==="favorites"?a.value=We(i,t.value):e.value==="recent"?a.value=Nr(i):a.value=xr(i,t.value);const l=await a.value;"folder"in l?(n.value=l.folder,r.value=l.contents):(n.value=null,r.value=l),a.value=null,s.value=!1}return pe([e,t],()=>c()),$(()=>c()),{isLoading:s,files:r,folder:n,loadFiles:c,createDirectory:o}},Br=function(e){const t=d(()=>e.value.map(i=>i.split("/")));return{isSupportedMimeType:i=>{const r=i.split("/");return t.value.some(([n,s])=>(r[0]===n||n==="*")&&(r[1]===s||s==="*"))}}},Lr={name:"FilePicker"},Pr=F({...Lr,props:{buttons:null,name:null,allowPickDirectory:{type:Boolean,default:!1},disabledNavigation:{type:Boolean,default:!1},container:{default:"body"},filterFn:{default:void 0},mimetypeFilter:{default:()=>[]},multiselect:{type:Boolean,default:!0},path:{default:void 0}},emits:["close"],setup(e,{emit:t}){const i=e,r=h(!0),n=d(()=>{const p=l.value.length===0&&i.allowPickDirectory&&C.value?[C.value]:l.value;return(typeof i.buttons=="function"?i.buttons(p,y.value,o.value):i.buttons).map(m=>({...m,disabled:m.disabled||D.value,callback:()=>{s=!0,a(m.callback,p)}}))});let s=!1;const a=async(p,m)=>{p(m),t("close",m),s=!1},o=h("files"),c=d(()=>o.value==="favorites"?v("Favorites"):o.value==="recent"?v("Recent"):""),l=j([]),u=h(window?.sessionStorage.getItem("NC.FilePicker.LastPath")||"/"),f=h("");pe([f],()=>{i.path===void 0&&f.value&&window.sessionStorage.setItem("NC.FilePicker.LastPath",f.value),l.value=[]});const y=d({get:()=>o.value==="files"?f.value||i.path||u.value:"/",set:p=>{f.value=p}}),w=h(""),{isSupportedMimeType:k}=Br(A(i,"mimetypeFilter")),{files:S,folder:C,isLoading:D,loadFiles:I,createDirectory:N}=Ir(o,y);$(()=>I());const{showHiddenFiles:g}=xe(),x=d(()=>{let p=S.value;return g.value||(p=p.filter(m=>!m.basename.startsWith("."))),i.mimetypeFilter.length>0&&(p=p.filter(m=>m.type==="folder"||m.mime&&k(m.mime))),w.value&&(p=p.filter(m=>m.basename.toLowerCase().includes(w.value.toLowerCase()))),i.filterFn&&(p=p.filter(m=>i.filterFn(m))),p}),E=d(()=>o.value==="files"?v("Upload some content or sync with your devices!"):o.value==="recent"?v("Files and folders you recently modified will show up here."):v("Files and folders you mark as favorite will show up here."));return{__sfc:!0,props:i,emit:t,isOpen:r,dialogButtons:n,isHandlingCallback:s,handleButtonClick:a,currentView:o,viewHeadline:c,selectedFiles:l,savedPath:u,navigatedPath:f,currentPath:y,filterString:w,isSupportedMimeType:k,files:S,currentFolder:C,isLoading:D,loadFiles:I,createDirectory:N,showHiddenFiles:g,filteredFiles:x,noFilesDescription:E,onCreateFolder:async p=>{try{const m=await N(p);f.value=m.path,at("files:node:created",S.value.filter(Be=>Be.basename===p)[0])}catch(m){console.warn("Could not create new folder",{name:p,error:m}),U(v("Could not create the new folder"))}},handleClose:p=>{!p&&!s&&t("close")},IconFile:Ne,FileList:Zi,FilePickerBreadcrumbs:lr,FilePickerNavigation:Sr,NcDialog:He,NcEmptyContent:lt,t:v}}});var zr=function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t(i.NcDialog,{attrs:{open:i.isOpen,container:e.container,buttons:i.dialogButtons,name:e.name,size:"large","content-classes":"file-picker__content","dialog-classes":"file-picker","navigation-classes":"file-picker__navigation"},on:{"update:open":[function(r){i.isOpen=r},i.handleClose]},scopedSlots:e._u([{key:"navigation",fn:function({isCollapsed:r}){return[t(i.FilePickerNavigation,{attrs:{"current-view":i.currentView,"filter-string":i.filterString,"is-collapsed":r,"disabled-navigation":e.disabledNavigation},on:{"update:currentView":function(n){i.currentView=n},"update:current-view":function(n){i.currentView=n},"update:filterString":function(n){i.filterString=n},"update:filter-string":function(n){i.filterString=n}}})]}}])},[t("div",{staticClass:"file-picker__main"},[i.currentView==="files"?t(i.FilePickerBreadcrumbs,{attrs:{path:i.currentPath,"show-menu":e.allowPickDirectory},on:{"update:path":function(r){i.currentPath=r},"create-node":i.onCreateFolder}}):t("div",{staticClass:"file-picker__view"},[t("h3",[e._v(e._s(i.viewHeadline))])]),i.isLoading||i.filteredFiles.length>0?t(i.FileList,{attrs:{path:i.currentPath,"selected-files":i.selectedFiles,"allow-pick-directory":e.allowPickDirectory,"current-view":i.currentView,files:i.filteredFiles,multiselect:e.multiselect,loading:i.isLoading,name:i.viewHeadline},on:{"update:path":[function(r){i.currentPath=r},function(r){i.currentView="files"}],"update:selectedFiles":function(r){i.selectedFiles=r},"update:selected-files":function(r){i.selectedFiles=r}}}):i.filterString?t(i.NcEmptyContent,{attrs:{name:i.t("No matching files"),description:i.t("No files matching your filter were found.")},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconFile)]},proxy:!0}])}):t(i.NcEmptyContent,{attrs:{name:i.t("No files in here"),description:i.noFilesDescription},scopedSlots:e._u([{key:"icon",fn:function(){return[t(i.IconFile)]},proxy:!0}])})],1)])},$r=[],Or=_(Pr,zr,$r,!1,null,"552cc2f5");const Mr=Or.exports;export{Mr as default};
//# sourceMappingURL=FilePicker-CsU6FfAP-CxwnfHNr.chunk.mjs.map
