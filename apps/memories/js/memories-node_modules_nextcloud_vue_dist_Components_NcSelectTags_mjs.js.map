{"version":3,"file":"memories-node_modules_nextcloud_vue_dist_Components_NcSelectTags_mjs.js?v=183cd374e053146bbbe0","mappings":"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","sources":["webpack:///memories/node_modules/@nextcloud/vue/dist/chunks/NcSelectTags-DYUCDZ_e.mjs"],"sourcesContent":["import { u as useModelMigration } from \"./useModelMigration-EhAWvqDD.mjs\";\nimport { r as register, k as t0, a as t } from \"./_l10n-BEfeU7gr.mjs\";\nimport { l as logger } from \"./logger-D3RVzcfQ.mjs\";\nimport NcEllipsisedOption from \"../Components/NcEllipsisedOption.mjs\";\nimport { N as NcSelect } from \"./NcSelect-PvjbF3jF.mjs\";\nimport axios from \"@nextcloud/axios\";\nimport { generateRemoteUrl } from \"@nextcloud/router\";\nimport { n as normalizeComponent } from \"./_plugin-vue2_normalizer-DU4iP6Vu.mjs\";\nregister(t0);\nfunction xmlToJson(xml) {\n  let obj = {};\n  if (xml.nodeType === 1) {\n    if (xml.attributes.length > 0) {\n      obj[\"@attributes\"] = {};\n      for (let j = 0; j < xml.attributes.length; j++) {\n        const attribute = xml.attributes.item(j);\n        obj[\"@attributes\"][attribute.nodeName] = attribute.nodeValue;\n      }\n    }\n  } else if (xml.nodeType === 3) {\n    obj = xml.nodeValue;\n  }\n  if (xml.hasChildNodes()) {\n    for (let i = 0; i < xml.childNodes.length; i++) {\n      const item = xml.childNodes.item(i);\n      const nodeName = item.nodeName;\n      if (typeof obj[nodeName] === \"undefined\") {\n        obj[nodeName] = xmlToJson(item);\n      } else {\n        if (typeof obj[nodeName].push === \"undefined\") {\n          const old = obj[nodeName];\n          obj[nodeName] = [];\n          obj[nodeName].push(old);\n        }\n        obj[nodeName].push(xmlToJson(item));\n      }\n    }\n  }\n  return obj;\n}\nfunction parseXml(xml) {\n  let dom = null;\n  try {\n    dom = new DOMParser().parseFromString(xml, \"text/xml\");\n  } catch (e) {\n    logger.error(\"Failed to parse xml document\", e);\n  }\n  return dom;\n}\nfunction xmlToTagList(xml) {\n  const json = xmlToJson(parseXml(xml));\n  const list = json[\"d:multistatus\"][\"d:response\"];\n  const result = [];\n  for (const index in list) {\n    const tag = list[index][\"d:propstat\"];\n    if (tag[\"d:status\"][\"#text\"] !== \"HTTP/1.1 200 OK\") {\n      continue;\n    }\n    result.push({\n      id: parseInt(tag[\"d:prop\"][\"oc:id\"][\"#text\"]),\n      displayName: tag[\"d:prop\"][\"oc:display-name\"][\"#text\"],\n      canAssign: tag[\"d:prop\"][\"oc:can-assign\"][\"#text\"] === \"true\",\n      userAssignable: tag[\"d:prop\"][\"oc:user-assignable\"][\"#text\"] === \"true\",\n      userVisible: tag[\"d:prop\"][\"oc:user-visible\"][\"#text\"] === \"true\"\n    });\n  }\n  return result;\n}\nasync function searchTags() {\n  if (window.NextcloudVueDocs) {\n    return Promise.resolve(xmlToTagList(window.NextcloudVueDocs.tags));\n  }\n  const result = await axios({\n    method: \"PROPFIND\",\n    url: generateRemoteUrl(\"dav\") + \"/systemtags/\",\n    data: `<?xml version=\"1.0\"?>\n\t\t\t\t\t<d:propfind  xmlns:d=\"DAV:\" xmlns:oc=\"http://owncloud.org/ns\">\n\t\t\t\t\t  <d:prop>\n\t\t\t\t\t\t<oc:id />\n\t\t\t\t\t\t<oc:display-name />\n\t\t\t\t\t\t<oc:user-visible />\n\t\t\t\t\t\t<oc:user-assignable />\n\t\t\t\t\t\t<oc:can-assign />\n\t\t\t\t\t  </d:prop>\n\t\t\t\t\t</d:propfind>`\n  });\n  return xmlToTagList(result.data);\n}\nconst _sfc_main = {\n  name: \"NcSelectTags\",\n  components: {\n    NcEllipsisedOption,\n    NcSelect\n  },\n  model: {\n    prop: \"modelValue\",\n    event: \"update:modelValue\"\n  },\n  props: {\n    // Add NcSelect prop defaults and populate $props\n    ...NcSelect.props,\n    /**\n     * Enable automatic fetching of tags\n     *\n     * If `false`, available tags must be passed using the `options` prop\n     */\n    fetchTags: {\n      type: Boolean,\n      // eslint-disable-next-line vue/no-boolean-default\n      default: true\n    },\n    /**\n     * Callback to generate the label text\n     *\n     * @see https://vue-select.org/api/props.html#getoptionlabel\n     */\n    getOptionLabel: {\n      type: Function,\n      default: (option) => {\n        const { displayName, userVisible, userAssignable } = option;\n        if (userVisible === false) {\n          return t(\"{tag} (invisible)\", { tag: displayName });\n        }\n        if (userAssignable === false) {\n          return t(\"{tag} (restricted)\", { tag: displayName });\n        }\n        return displayName;\n      }\n    },\n    /**\n     * Sets the maximum number of tags to display in the dropdown list\n     *\n     * Because of compatibility reasons only 5 tag entries are shown by\n     * default\n     */\n    limit: {\n      type: Number,\n      default: 5\n    },\n    /**\n     * Allow selection of multiple options\n     *\n     * This prop automatically sets the internal `closeOnSelect` prop to\n     * its boolean opposite\n     *\n     * @see https://vue-select.org/api/props.html#multiple\n     */\n    multiple: {\n      type: Boolean,\n      // eslint-disable-next-line vue/no-boolean-default\n      default: true\n    },\n    /**\n     * Callback to filter available options\n     */\n    optionsFilter: {\n      type: Function,\n      default: null\n    },\n    /**\n     * Enable passing of `value` prop and emitted `input` events as-is\n     * i.e. for usage with `v-model`\n     *\n     * If `true`, custom internal `value` and `input` handling is disabled\n     */\n    passthru: {\n      type: Boolean,\n      default: false\n    },\n    /**\n     * Placeholder text\n     *\n     * @see https://vue-select.org/api/props.html#placeholder\n     */\n    placeholder: {\n      type: String,\n      default: t(\"Select a tag\")\n    },\n    /**\n     * Removed in v9 - use `modelValue` (`v-model`) instead\n     *\n     * @deprecated\n     */\n    value: {\n      type: [Number, Array, Object],\n      default: void 0\n    },\n    /**\n     * Currently selected value\n     */\n    modelValue: {\n      type: [Number, Array, Object],\n      default: null\n    },\n    /**\n     * Any available prop\n     *\n     * @see https://vue-select.org/api/props.html\n     */\n    // Not an actual prop but needed to show in vue-styleguidist docs\n    // eslint-disable-next-line\n    \" \": {}\n  },\n  emits: [\n    /**\n     * Removed in v9 - use `update:modelValue` (`v-model`) instead\n     */\n    \"input\",\n    /**\n     * Emitted on input events of the multiselect field\n     *\n     * @type {number|number[]}\n     */\n    \"update:modelValue\",\n    /** Same as update:modelValue for Vue 2 compatibility */\n    \"update:model-value\",\n    /**\n     * All events from https://vue-select.org/api/events.html\n     */\n    // Not an actual event but needed to show in vue-styleguidist docs\n    \" \"\n  ],\n  setup() {\n    const model = useModelMigration(\"value\", \"input\");\n    const noop = () => {\n    };\n    return {\n      model,\n      noop\n    };\n  },\n  data() {\n    return {\n      search: \"\",\n      availableTags: []\n    };\n  },\n  computed: {\n    availableOptions() {\n      if (this.optionsFilter) {\n        return this.tags.filter(this.optionsFilter);\n      }\n      return this.tags;\n    },\n    localValue() {\n      if (this.tags.length === 0) {\n        return [];\n      }\n      if (this.multiple) {\n        return this.model.filter((tag) => tag !== \"\").map((id) => this.tags.find((tag2) => tag2.id === id));\n      } else {\n        return this.tags.find((tag) => tag.id === this.model);\n      }\n    },\n    propsToForward() {\n      const {\n        // Props handled by this component\n        fetchTags,\n        optionsFilter,\n        passthru,\n        // Props to forward\n        ...propsToForward\n      } = this.$props;\n      return propsToForward;\n    },\n    tags() {\n      if (!this.fetchTags) {\n        return this.options;\n      }\n      return this.availableTags;\n    }\n  },\n  async created() {\n    if (!this.fetchTags) {\n      return;\n    }\n    try {\n      const result = await searchTags();\n      this.availableTags = result;\n    } catch (error) {\n      logger.error(\"Loading systemtags failed\", error);\n    }\n  },\n  methods: {\n    handleInput(value) {\n      if (this.multiple) {\n        this.model = value.map((element) => element.id);\n      } else {\n        if (value === null) {\n          this.model = null;\n        } else {\n          this.model = value.id;\n        }\n      }\n    }\n  }\n};\nvar _sfc_render = function render() {\n  var _vm = this, _c = _vm._self._c;\n  return _c(\"NcSelect\", _vm._g(_vm._b({ attrs: { \"options\": _vm.availableOptions, \"close-on-select\": !_vm.multiple, \"value\": _vm.passthru ? _vm.model : _vm.localValue }, on: { \"search\": (searchString) => _vm.search = searchString }, scopedSlots: _vm._u([{ key: \"option\", fn: function(option) {\n    return [_c(\"NcEllipsisedOption\", { attrs: { \"name\": _vm.getOptionLabel(option), \"search\": _vm.search } })];\n  } }, { key: \"selected-option\", fn: function(selectedOption) {\n    return [_c(\"NcEllipsisedOption\", { attrs: { \"name\": _vm.getOptionLabel(selectedOption), \"search\": _vm.search } })];\n  } }, _vm._l(_vm.$scopedSlots, function(_, name) {\n    return { key: name, fn: function(data) {\n      return [_vm._t(name, null, null, data)];\n    } };\n  })], null, true) }, \"NcSelect\", _vm.propsToForward, false), {\n    ..._vm.$listeners,\n    input: _vm.passthru ? _vm.$listeners.input : _vm.noop,\n    \"update:modelValue\": _vm.passthru ? _vm.$listeners[\"update:modelValue\"] : _vm.handleInput,\n    \"update:model-value\": _vm.passthru ? _vm.$listeners[\"update:model-value\"] : _vm.noop\n  }));\n};\nvar _sfc_staticRenderFns = [];\nvar __component__ = /* @__PURE__ */ normalizeComponent(\n  _sfc_main,\n  _sfc_render,\n  _sfc_staticRenderFns,\n  false,\n  null,\n  null\n);\nconst NcSelectTags = __component__.exports;\nexport {\n  NcSelectTags as N\n};\n//# sourceMappingURL=NcSelectTags-DYUCDZ_e.mjs.map\n"],"names":["xmlToJson","xml","obj","nodeType","attributes","length","j","attribute","item","nodeName","nodeValue","hasChildNodes","i","childNodes","push","old","xmlToTagList","json","dom","DOMParser","parseFromString","e","l","error","parseXml","list","result","index","tag","id","parseInt","displayName","canAssign","userAssignable","userVisible","r","_sfc_main","name","components","NcEllipsisedOption","NcSelect","model","prop","event","props","N","fetchTags","type","Boolean","default","getOptionLabel","Function","option","limit","Number","multiple","optionsFilter","passthru","placeholder","String","value","Array","Object","modelValue","emits","setup","u","noop","data","search","availableTags","computed","availableOptions","this","tags","filter","localValue","map","find","tag2","propsToForward","$props","options","created","async","window","NextcloudVueDocs","Promise","resolve","method","url","searchTags","methods","handleInput","element","_sfc_render","_vm","_c","_self","_g","_b","attrs","on","searchString","scopedSlots","_u","key","fn","selectedOption","_l","$scopedSlots","_","_t","$listeners","input","_sfc_staticRenderFns","NcSelectTags","n","exports"],"sourceRoot":""}