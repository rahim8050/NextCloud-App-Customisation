"use strict";(()=>{(self.webpackChunktalk=self.webpackChunktalk||[]).push([["defaultVendors-node_modules_nextcloud_dialogs_dist_chunks_FilePicker-CtWlxGEm_mjs","node_modules_nextcloud_vue_dist_components_NcSelect_index_mjs"],{90255:(z,L,c)=>{c.d(L,{default:()=>ti});var e=c(20641),p=c(90033),n=c(50953),ne=c(53751),ae=c(61338),se=c(94434),O=c(59904),E=c(50240),y=c(35810),A=c(15446),Q=c(86296),oe=c(10997),R=c(9165);/*!
 * SPDX-FileCopyrightText: 2025 Nextcloud GmbH and Nextcloud contributors
 * SPDX-License-Identifier: GPL-3.0-or-later
 */var x;(function(i){i[i.User=0]="User",i[i.Group=1]="Group",i[i.Link=3]="Link",i[i.Email=4]="Email",i[i.Remote=6]="Remote",i[i.Team=7]="Team",i[i.Guest=8]="Guest",i[i.RemoteGroup=9]="RemoteGroup",i[i.Room=10]="Room",i[i.Deck=12]="Deck",i[i.FederatedGroup=14]="FederatedGroup",i[i.ScienceMesh=15]="ScienceMesh"})(x||(x={}));/*!
 * SPDX-FileCopyrightText: 2025 Nextcloud GmbH and Nextcloud contributors
 * SPDX-License-Identifier: GPL-3.0-or-later
 */var j=c(82510),re=c(88720),u=c(80837),Z=c(66802),G=c(81222),J=c(63814),Y=c(32505),T=c(39649),ce=c(5242),de=c(15797),q=c(82713),ue=c(68859),ve=c(21777),fe=c(3710),me=c(79455),V=c(71225),ee=c(36117);const ge={name:"FileIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},ke=["aria-hidden","aria-label"],he=["fill","width","height"],_e={d:"M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z"},pe={key:0};function ye(i,l,t,s,r,o){return(0,e.uX)(),(0,e.CE)("span",(0,e.v6)(i.$attrs,{"aria-hidden":t.title?null:"true","aria-label":t.title,class:"material-design-icon file-icon",role:"img",onClick:l[0]||(l[0]=a=>i.$emit("click",a))}),[((0,e.uX)(),(0,e.CE)("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[(0,e.Lk)("path",_e,[t.title?((0,e.uX)(),(0,e.CE)("title",pe,(0,p.v_)(t.title),1)):(0,e.Q3)("",!0)])],8,he))],16,ke)}const M=(0,E._)(ge,[["render",ye]]),Ce={name:"MenuDownIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},we=["aria-hidden","aria-label"],be=["fill","width","height"],Fe={d:"M7,10L12,15L17,10H7Z"},Ee={key:0};function Le(i,l,t,s,r,o){return(0,e.uX)(),(0,e.CE)("span",(0,e.v6)(i.$attrs,{"aria-hidden":t.title?null:"true","aria-label":t.title,class:"material-design-icon menu-down-icon",role:"img",onClick:l[0]||(l[0]=a=>i.$emit("click",a))}),[((0,e.uX)(),(0,e.CE)("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[(0,e.Lk)("path",Fe,[t.title?((0,e.uX)(),(0,e.CE)("title",Ee,(0,p.v_)(t.title),1)):(0,e.Q3)("",!0)])],8,be))],16,we)}const D=(0,E._)(Ce,[["render",Le]]),Re={name:"MenuUpIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},$e=["aria-hidden","aria-label"],Xe=["fill","width","height"],Be={d:"M7,15L12,10L17,15H7Z"},We={key:0};function Ne(i,l,t,s,r,o){return(0,e.uX)(),(0,e.CE)("span",(0,e.v6)(i.$attrs,{"aria-hidden":t.title?null:"true","aria-label":t.title,class:"material-design-icon menu-up-icon",role:"img",onClick:l[0]||(l[0]=a=>i.$emit("click",a))}),[((0,e.uX)(),(0,e.CE)("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[(0,e.Lk)("path",Be,[t.title?((0,e.uX)(),(0,e.CE)("title",We,(0,p.v_)(t.title),1)):(0,e.Q3)("",!0)])],8,Xe))],16,$e)}const S=(0,E._)(Re,[["render",Ne]]),ze={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Ie=["aria-hidden","aria-label"],Ae=["fill","width","height"],xe={d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"},Ve={key:0};function Pe(i,l,t,s,r,o){return(0,e.uX)(),(0,e.CE)("span",(0,e.v6)(i.$attrs,{"aria-hidden":t.title?null:"true","aria-label":t.title,class:"material-design-icon folder-icon",role:"img",onClick:l[0]||(l[0]=a=>i.$emit("click",a))}),[((0,e.uX)(),(0,e.CE)("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[(0,e.Lk)("path",xe,[t.title?((0,e.uX)(),(0,e.CE)("title",Ve,(0,p.v_)(t.title),1)):(0,e.Q3)("",!0)])],8,Ae))],16,Ie)}const te=(0,E._)(ze,[["render",Pe]]),ie={"file-picker__file-icon":"_file-picker__file-icon_3v9zx_9","file-picker__file-icon--primary":"_file-picker__file-icon--primary_3v9zx_21","file-picker__file-icon-overlay":"_file-picker__file-icon-overlay_3v9zx_25"},Me=(0,e.pM)({__name:"FilePreview",props:{node:{},cropImagePreviews:{type:Boolean}},setup(i){const l=i,t=(0,n.KR)(ie),{previewURL:s,previewLoaded:r}=(0,re.u)((0,n.lW)(l,"node"),(0,e.EW)(()=>({cropPreview:l.cropImagePreviews}))),o=(0,e.EW)(()=>l.node.type===y.pt.File),a=(0,e.EW)(()=>{if(l.node.type!==y.pt.Folder)return null;if(l.node.attributes?.["is-encrypted"]===1)return R.kHm;if(l.node.attributes?.["is-tag"])return R.HzW;const f=Object.values(l.node.attributes?.["share-types"]||{}).flat();if(f.some(v=>v===x.Link||v===x.Email))return R.Brj;if(f.length>0)return R.IyB;switch(l.node.attributes?.["mount-type"]){case"external":case"external-session":return R.jUz;case"group":return R.kOJ;case"shared":return R.IyB}return null});return(f,v)=>((0,e.uX)(),(0,e.CE)("div",{style:(0,p.Tr)((0,n.R1)(r)?{backgroundImage:`url(${(0,n.R1)(s)})`}:void 0),class:(0,p.C4)(t.value["file-picker__file-icon"])},[(0,n.R1)(r)?(0,e.Q3)("",!0):((0,e.uX)(),(0,e.CE)(e.FK,{key:0},[o.value?((0,e.uX)(),(0,e.Wv)(M,{key:0,size:32})):((0,e.uX)(),(0,e.CE)(e.FK,{key:1},[a.value?((0,e.uX)(),(0,e.Wv)((0,n.R1)(j.A),{key:0,class:(0,p.C4)(t.value["file-picker__file-icon-overlay"]),inline:"",path:a.value,size:16},null,8,["class","path"])):(0,e.Q3)("",!0),(0,e.bF)(te,{class:(0,p.C4)(t.value["file-picker__file-icon--primary"]),size:32},null,8,["class"])],64))],64))],6))}}),De=["tabindex","aria-selected","data-filename"],Se={class:"row-name"},He={class:"file-picker__name-container","data-testid":"row-name"},Ke=["title","textContent"],Ue=["textContent"],Oe={class:"row-size"},Qe={class:"row-modified"},je=(0,e.pM)({__name:"FileListRow",props:{allowPickDirectory:{type:Boolean},selected:{type:Boolean},showCheckbox:{type:Boolean},canPick:{type:Boolean},node:{},cropImagePreviews:{type:Boolean}},emits:["update:selected","enterDirectory"],setup(i,{emit:l}){const t=i,s=l,r=(0,e.EW)(()=>t.node.mtime??0),o=(0,e.EW)(()=>t.node.attributes?.displayName||t.node.basename.slice(0,t.node.extension?-t.node.extension.length:void 0)),a=(0,e.EW)(()=>t.node.extension),f=(0,e.EW)(()=>t.node.type===y.pt.Folder),v=(0,e.EW)(()=>t.canPick&&(t.allowPickDirectory||!f.value)),d=(0,e.EW)(()=>(t.node.permissions&y.aX.READ)===y.aX.READ);function g(){v.value&&s("update:selected",!t.selected)}function h(){f.value?d.value&&s("enterDirectory",t.node):g()}function k(X){X.key==="Enter"&&h()}return(X,W)=>((0,e.uX)(),(0,e.CE)("tr",(0,e.v6)({tabindex:i.showCheckbox&&!f.value?void 0:0,"aria-selected":v.value?i.selected:void 0,class:["file-picker__row",[{"file-picker__row--selected":i.selected&&!i.showCheckbox,"file-picker__row--not-navigatable":f.value&&!d.value,"file-picker__row--not-pickable":!v.value}]],"data-filename":i.node.basename,"data-testid":"file-list-row"},(0,e.Tb)({click:h,...!i.showCheckbox||f.value?{keydown:k}:{}},!0)),[i.showCheckbox?((0,e.uX)(),(0,e.CE)("td",{key:0,class:"row-checkbox",onClick:(0,ne.D$)(()=>{},["stop"])},[(0,e.bF)((0,n.R1)(Q.A),{"aria-label":(0,n.R1)(u.t)("Select the row for {nodename}",{nodename:o.value}),disabled:!v.value,"data-testid":"row-checkbox","model-value":i.selected,"onUpdate:modelValue":g},null,8,["aria-label","disabled","model-value"])])):(0,e.Q3)("",!0),(0,e.Lk)("td",Se,[(0,e.Lk)("div",He,[(0,e.bF)(Me,{node:i.node,"crop-image-previews":i.cropImagePreviews},null,8,["node","crop-image-previews"]),(0,e.Lk)("div",{class:"file-picker__file-name",title:o.value,textContent:(0,p.v_)(o.value)},null,8,Ke),(0,e.Lk)("div",{class:"file-picker__file-extension",textContent:(0,p.v_)(a.value)},null,8,Ue)])]),(0,e.Lk)("td",Oe,(0,p.v_)((0,n.R1)(y.v7)(i.node.size||0)),1),(0,e.Lk)("td",Qe,[(0,e.bF)((0,n.R1)(oe.A),{timestamp:r.value,"ignore-seconds":""},null,8,["timestamp"])])],16,De))}}),Ze=(0,E._)(je,[["__scopeId","data-v-a5daea8d"]]),Ge={"aria-hidden":"true",class:"file-picker__row loading-row"},Je={key:0,class:"row-checkbox"},Ye={class:"row-name"},Te={class:"row-wrapper"},qe=(0,e.pM)({__name:"LoadingTableRow",props:{showCheckbox:{type:Boolean}},setup(i){return(l,t)=>((0,e.uX)(),(0,e.CE)("tr",Ge,[i.showCheckbox?((0,e.uX)(),(0,e.CE)("td",Je,[...t[0]||(t[0]=[(0,e.Lk)("span",null,null,-1)])])):(0,e.Q3)("",!0),(0,e.Lk)("td",Ye,[(0,e.Lk)("div",Te,[(0,e.Lk)("span",{class:(0,p.C4)((0,n.R1)(ie)["file-picker__file-icon"])},null,2),t[1]||(t[1]=(0,e.Lk)("span",null,null,-1))])]),t[2]||(t[2]=(0,e.Lk)("td",{class:"row-size"},[(0,e.Lk)("span")],-1)),t[3]||(t[3]=(0,e.Lk)("td",{class:"row-modified"},[(0,e.Lk)("span")],-1))]))}}),et=(0,E._)(qe,[["__scopeId","data-v-1f96131b"]]);function le(){const i=(0,G.C)("files","config",null),l=(0,n.KR)(i?.show_hidden??!0),t=(0,n.KR)(i?.sort_favorites_first??!0),s=(0,n.KR)(i?.crop_image_previews??!0);return(0,e.sV)(async()=>{if((0,Y.f)())u.l.debug("Skip loading files settings - currently on public share");else try{const{data:r}=await Z.Ay.get((0,J.Jv)("/apps/files/api/v1/configs"));l.value=r?.data?.show_hidden??!1,t.value=r?.data?.sort_favorites_first??!0,s.value=r?.data?.crop_image_previews??!0}catch(r){u.l.error("Could not load files settings",r),(0,u.s)((0,u.t)("Could not load files settings"))}}),{showHiddenFiles:l,sortFavoritesFirst:t,cropImagePreviews:s}}function tt(i){const l=d=>d==="asc"?"ascending":d==="desc"?"descending":"none",t=(0,G.C)("files","viewConfigs",null),s=(0,n.KR)({sortBy:t?.files?.sorting_mode??"basename",order:l(t?.files?.sorting_direction??"asc")}),r=(0,n.KR)({sortBy:t?.recent?.sorting_mode??"basename",order:l(t?.recent?.sorting_direction??"asc")}),o=(0,n.KR)({sortBy:t?.favorites?.sorting_mode??"basename",order:l(t?.favorites?.sorting_direction??"asc")});(0,e.sV)(async()=>{if((0,Y.f)())u.l.debug("Skip loading files views - currently on public share");else try{const{data:d}=await Z.Ay.get((0,J.Jv)("/apps/files/api/v1/views"));s.value={sortBy:d?.data?.files?.sorting_mode??"basename",order:l(d?.data?.files?.sorting_direction)},o.value={sortBy:d?.data?.favorites?.sorting_mode??"basename",order:l(d?.data?.favorites?.sorting_direction)},r.value={sortBy:d?.data?.recent?.sorting_mode??"basename",order:l(d?.data?.recent?.sorting_direction)}}catch(d){u.l.error("Could not load files views",d),(0,u.s)((0,u.t)("Could not load files views"))}});const a=(0,e.EW)(()=>(0,T.BA)(i||"files")==="files"?s.value:(0,T.BA)(i)==="recent"?r.value:o.value),f=(0,e.EW)(()=>a.value.sortBy),v=(0,e.EW)(()=>a.value.order);return{filesViewConfig:s,favoritesViewConfig:o,recentViewConfig:r,currentConfig:a,sortBy:f,order:v}}const it={key:0,class:"row-checkbox"},lt={class:"hidden-visually"},nt=["aria-sort"],at={class:"header-wrapper"},st={key:2,style:{width:"44px"}},ot=["aria-sort"],rt={key:2,style:{width:"44px"}},ct=["aria-sort"],dt={key:2,style:{width:"44px"}},ut=(0,e.pM)({__name:"FileList",props:(0,e.zz)({currentView:{},multiselect:{type:Boolean},allowPickDirectory:{type:Boolean},loading:{type:Boolean},files:{},canPick:{type:Function}},{path:{required:!0},pathModifiers:{},selectedFiles:{required:!0},selectedFilesModifiers:{}}),emits:["update:path","update:selectedFiles"],setup(i){const l=(0,e.fn)(i,"path"),t=(0,e.fn)(i,"selectedFiles"),s=i,r=(0,n.KR)(),{currentConfig:o}=tt(s.currentView),a=(0,e.EW)(()=>r.value??o.value),f=(0,e.EW)(()=>a.value.sortBy==="basename"?a.value.order==="none"?void 0:a.value.order:void 0),v=(0,e.EW)(()=>a.value.sortBy==="size"?a.value.order==="none"?void 0:a.value.order:void 0),d=(0,e.EW)(()=>a.value.sortBy==="mtime"?a.value.order==="none"?void 0:a.value.order:void 0);function g(C){a.value.sortBy===C?a.value.order==="ascending"?r.value={sortBy:a.value.sortBy,order:"descending"}:r.value={sortBy:a.value.sortBy,order:"ascending"}:r.value={sortBy:C,order:"ascending"}}const{sortFavoritesFirst:h,cropImagePreviews:k}=le(),X=(0,e.EW)(()=>(0,y.ur)(s.files,{sortFoldersFirst:!0,sortFavoritesFirst:h.value,sortingOrder:a.value.order==="descending"?"desc":"asc",sortingMode:a.value.sortBy})),W=(0,e.EW)(()=>s.files.filter(C=>s.allowPickDirectory||C.type!==y.pt.Folder)),I=(0,e.EW)(()=>!s.loading&&t.value.length>0&&t.value.length>=W.value.length);function H(){t.value.length<W.value.length?t.value=[...W.value]:t.value=[]}function K(C){t.value.includes(C)?t.value=t.value.filter(w=>w.path!==C.path):s.multiselect?t.value=[...t.value,C]:t.value=[C]}function P(C){l.value=C.path}const $=(0,n.KR)(4),N=(0,n.KR)();{const C=()=>(0,e.dY)(()=>{const w=N.value?.parentElement?.children||[];let b=N.value?.parentElement?.clientHeight||450;for(let B=0;B<w.length;B++)N.value?.isSameNode(w[B])||(b-=w[B].clientHeight);$.value=Math.max(1,Math.floor((b-50)/50))});(0,e.sV)(()=>{window.addEventListener("resize",C),C()}),(0,e.hi)(()=>{window.removeEventListener("resize",C)})}return(C,w)=>((0,e.uX)(),(0,e.CE)("div",{ref_key:"fileContainer",ref:N,class:"file-picker__files"},[(0,e.Lk)("table",null,[(0,e.Lk)("thead",null,[(0,e.Lk)("tr",null,[i.multiselect?((0,e.uX)(),(0,e.CE)("th",it,[(0,e.Lk)("span",lt,(0,p.v_)((0,n.R1)(u.t)("Select entry")),1),i.multiselect?((0,e.uX)(),(0,e.Wv)((0,n.R1)(Q.A),{key:0,"aria-label":(0,n.R1)(u.t)("Select all entries"),"data-testid":"select-all-checkbox","model-value":I.value,"onUpdate:modelValue":H},null,8,["aria-label","model-value"])):(0,e.Q3)("",!0)])):(0,e.Q3)("",!0),(0,e.Lk)("th",{"aria-sort":f.value,class:"row-name"},[(0,e.Lk)("div",at,[w[3]||(w[3]=(0,e.Lk)("span",{class:"file-picker__header-preview"},null,-1)),(0,e.bF)((0,n.R1)(A.A),{"data-test":"file-picker_sort-name",variant:"tertiary",wide:"",onClick:w[0]||(w[0]=b=>g("basename"))},{icon:(0,e.k6)(()=>[f.value==="ascending"?((0,e.uX)(),(0,e.Wv)(S,{key:0,size:20})):f.value==="descending"?((0,e.uX)(),(0,e.Wv)(D,{key:1,size:20})):((0,e.uX)(),(0,e.CE)("span",st))]),default:(0,e.k6)(()=>[(0,e.eW)(" "+(0,p.v_)((0,n.R1)(u.t)("Name")),1)]),_:1})])],8,nt),(0,e.Lk)("th",{"aria-sort":v.value,class:"row-size"},[(0,e.bF)((0,n.R1)(A.A),{variant:"tertiary",wide:"",onClick:w[1]||(w[1]=b=>g("size"))},{icon:(0,e.k6)(()=>[v.value==="ascending"?((0,e.uX)(),(0,e.Wv)(S,{key:0,size:20})):v.value==="descending"?((0,e.uX)(),(0,e.Wv)(D,{key:1,size:20})):((0,e.uX)(),(0,e.CE)("span",rt))]),default:(0,e.k6)(()=>[(0,e.eW)(" "+(0,p.v_)((0,n.R1)(u.t)("Size")),1)]),_:1})],8,ot),(0,e.Lk)("th",{"aria-sort":d.value,class:"row-modified"},[(0,e.bF)((0,n.R1)(A.A),{variant:"tertiary",wide:"",onClick:w[2]||(w[2]=b=>g("mtime"))},{icon:(0,e.k6)(()=>[d.value==="ascending"?((0,e.uX)(),(0,e.Wv)(S,{key:0,size:20})):d.value==="descending"?((0,e.uX)(),(0,e.Wv)(D,{key:1,size:20})):((0,e.uX)(),(0,e.CE)("span",dt))]),default:(0,e.k6)(()=>[(0,e.eW)(" "+(0,p.v_)((0,n.R1)(u.t)("Modified")),1)]),_:1})],8,ct)])]),(0,e.Lk)("tbody",null,[i.loading?((0,e.uX)(!0),(0,e.CE)(e.FK,{key:0},(0,e.pI)($.value,b=>((0,e.uX)(),(0,e.Wv)(et,{key:b,"show-checkbox":i.multiselect},null,8,["show-checkbox"]))),128)):((0,e.uX)(!0),(0,e.CE)(e.FK,{key:1},(0,e.pI)(X.value,b=>((0,e.uX)(),(0,e.Wv)(Ze,{key:b.fileid||b.path,"allow-pick-directory":i.allowPickDirectory,"show-checkbox":i.multiselect,"can-pick":(i.multiselect||t.value.length===0||t.value.includes(b))&&(i.canPick===void 0||i.canPick(b)),selected:t.value.includes(b),node:b,"crop-image-previews":(0,n.R1)(k),"onUpdate:selected":B=>K(b),onEnterDirectory:P},null,8,["allow-pick-directory","show-checkbox","can-pick","selected","node","crop-image-previews","onUpdate:selected"]))),128))])])],512))}}),vt=(0,E._)(ut,[["__scopeId","data-v-38620705"]]),ft={name:"HomeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},mt=["aria-hidden","aria-label"],gt=["fill","width","height"],kt={d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"},ht={key:0};function _t(i,l,t,s,r,o){return(0,e.uX)(),(0,e.CE)("span",(0,e.v6)(i.$attrs,{"aria-hidden":t.title?null:"true","aria-label":t.title,class:"material-design-icon home-icon",role:"img",onClick:l[0]||(l[0]=a=>i.$emit("click",a))}),[((0,e.uX)(),(0,e.CE)("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[(0,e.Lk)("path",kt,[t.title?((0,e.uX)(),(0,e.CE)("title",ht,(0,p.v_)(t.title),1)):(0,e.Q3)("",!0)])],8,gt))],16,mt)}const pt=(0,E._)(ft,[["render",_t]]),yt={name:"PlusIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Ct=["aria-hidden","aria-label"],wt=["fill","width","height"],bt={d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"},Ft={key:0};function Et(i,l,t,s,r,o){return(0,e.uX)(),(0,e.CE)("span",(0,e.v6)(i.$attrs,{"aria-hidden":t.title?null:"true","aria-label":t.title,class:"material-design-icon plus-icon",role:"img",onClick:l[0]||(l[0]=a=>i.$emit("click",a))}),[((0,e.uX)(),(0,e.CE)("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[(0,e.Lk)("path",bt,[t.title?((0,e.uX)(),(0,e.CE)("title",Ft,(0,p.v_)(t.title),1)):(0,e.Q3)("",!0)])],8,wt))],16,Ct)}const Lt=(0,E._)(yt,[["render",Et]]),Rt=(0,e.pM)({__name:"FilePickerBreadcrumbs",props:{path:{},showMenu:{type:Boolean}},emits:["update:path","create-node"],setup(i,{emit:l}){const t=i,s=l,r=(0,n.KR)(!1),o=(0,n.KR)(""),a=(0,e.rk)("nameInput");function f(){const g=o.value.trim(),h=a.value?.$el?.querySelector("input");let k="";return g.length===0?k=(0,u.t)("Folder name cannot be empty."):g.includes("/")?k=(0,u.t)('"/" is not allowed inside a folder name.'):["..","."].includes(g)?k=(0,u.t)('"{name}" is an invalid folder name.',{name:g}):window.OC.config?.blacklist_files_regex&&g.match(window.OC.config?.blacklist_files_regex)&&(k=(0,u.t)('"{name}" is not an allowed folder name',{name:g})),h&&h.setCustomValidity(k),k===""}function v(){const g=o.value.trim();f()&&(r.value=!1,s("create-node",g),o.value="")}const d=(0,e.EW)(()=>t.path.split("/").filter(g=>g!=="").map((g,h,k)=>({name:g,path:"/"+k.slice(0,h+1).join("/")})));return(g,h)=>((0,e.uX)(),(0,e.Wv)((0,n.R1)(ue.N),{class:"file-picker__breadcrumbs"},(0,e.eX)({default:(0,e.k6)(()=>[(0,e.bF)((0,n.R1)(q.N),{name:(0,n.R1)(u.t)("All files"),title:(0,n.R1)(u.t)("Home"),onClick:h[0]||(h[0]=k=>s("update:path","/"))},{icon:(0,e.k6)(()=>[(0,e.bF)(pt,{size:20})]),_:1},8,["name","title"]),((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)(d.value,k=>((0,e.uX)(),(0,e.Wv)((0,n.R1)(q.N),{key:k.path,name:k.name,title:k.path,onClick:X=>s("update:path",k.path)},null,8,["name","title","onClick"]))),128))]),_:2},[i.showMenu?{name:"actions",fn:(0,e.k6)(()=>[(0,e.bF)((0,n.R1)(de.A),{open:r.value,"onUpdate:open":h[2]||(h[2]=k=>r.value=k),"aria-label":(0,n.R1)(u.t)("Create directory"),"force-menu":!0,"force-name":!0,"menu-name":(0,n.R1)(u.t)("New"),variant:"secondary",onClose:h[3]||(h[3]=k=>o.value="")},{icon:(0,e.k6)(()=>[(0,e.bF)(Lt,{size:20})]),default:(0,e.k6)(()=>[(0,e.bF)((0,n.R1)(ce.A),{ref_key:"nameInput",ref:a,modelValue:o.value,"onUpdate:modelValue":[h[1]||(h[1]=k=>o.value=k),f],label:(0,n.R1)(u.t)("New folder"),placeholder:(0,n.R1)(u.t)("New folder name"),onSubmit:v},{icon:(0,e.k6)(()=>[(0,e.bF)(te,{size:20})]),_:1},8,["modelValue","label","placeholder"])]),_:1},8,["open","aria-label","menu-name"])]),key:"0"}:void 0]),1024))}}),$t=(0,E._)(Rt,[["__scopeId","data-v-4e6fd4e4"]]),Xt={name:"CloseIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Bt=["aria-hidden","aria-label"],Wt=["fill","width","height"],Nt={d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"},zt={key:0};function It(i,l,t,s,r,o){return(0,e.uX)(),(0,e.CE)("span",(0,e.v6)(i.$attrs,{"aria-hidden":t.title?null:"true","aria-label":t.title,class:"material-design-icon close-icon",role:"img",onClick:l[0]||(l[0]=a=>i.$emit("click",a))}),[((0,e.uX)(),(0,e.CE)("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[(0,e.Lk)("path",Nt,[t.title?((0,e.uX)(),(0,e.CE)("title",zt,(0,p.v_)(t.title),1)):(0,e.Q3)("",!0)])],8,Wt))],16,Bt)}const At=(0,E._)(Xt,[["render",It]]),xt={name:"MagnifyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Vt=["aria-hidden","aria-label"],Pt=["fill","width","height"],Mt={d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"},Dt={key:0};function St(i,l,t,s,r,o){return(0,e.uX)(),(0,e.CE)("span",(0,e.v6)(i.$attrs,{"aria-hidden":t.title?null:"true","aria-label":t.title,class:"material-design-icon magnify-icon",role:"img",onClick:l[0]||(l[0]=a=>i.$emit("click",a))}),[((0,e.uX)(),(0,e.CE)("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[(0,e.Lk)("path",Mt,[t.title?((0,e.uX)(),(0,e.CE)("title",Dt,(0,p.v_)(t.title),1)):(0,e.Q3)("",!0)])],8,Pt))],16,Vt)}const Ht=(0,E._)(xt,[["render",St]]);function Kt(i){const l=[{id:"files",label:(0,u.t)("All files"),icon:R.fEr},{id:"recent",label:(0,u.t)("Recent"),icon:R.NZC},{id:"favorites",label:(0,u.t)("Favorites"),icon:R.ZL5}],t=i.value?l.filter(({id:s})=>s==="files"):l;return{allViews:l,availableViews:t}}const Ut={key:0,class:"file-picker__side"},Ot=(0,e.pM)({__name:"FilePickerNavigation",props:{currentView:{},filterString:{},isCollapsed:{type:Boolean},disabledNavigation:{type:Boolean}},emits:["update:currentView","update:filterString"],setup(i,{emit:l}){const t=i,s=l,{availableViews:r}=Kt((0,n.KR)((0,ve.HW)()===null)),o=(0,e.EW)(()=>r.filter(f=>f.id===t.currentView)[0]??r[0]),a=f=>s("update:filterString",f);return(f,v)=>((0,e.uX)(),(0,e.CE)(e.FK,null,[(0,e.bF)((0,n.R1)(me.A),{class:"file-picker__filter-input",label:(0,n.R1)(u.t)("Filter file list"),"show-trailing-button":!!i.filterString,"model-value":i.filterString,"onUpdate:modelValue":a,onTrailingButtonClick:v[0]||(v[0]=d=>a(""))},{"trailing-button-icon":(0,e.k6)(()=>[(0,e.bF)(At,{size:16})]),default:(0,e.k6)(()=>[(0,e.bF)(Ht,{size:16})]),_:1},8,["label","show-trailing-button","model-value"]),(0,n.R1)(r).length>1&&!i.disabledNavigation?((0,e.uX)(),(0,e.CE)(e.FK,{key:0},[i.isCollapsed?((0,e.uX)(),(0,e.Wv)((0,n.R1)(fe.default),{key:1,"aria-label":(0,n.R1)(u.t)("Current view selector"),clearable:!1,searchable:!1,options:(0,n.R1)(r),"model-value":o.value,"onUpdate:modelValue":v[1]||(v[1]=d=>s("update:currentView",d.id))},null,8,["aria-label","options","model-value"])):((0,e.uX)(),(0,e.CE)("ul",Ut,[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)((0,n.R1)(r),d=>((0,e.uX)(),(0,e.CE)("li",{key:d.id},[(0,e.bF)((0,n.R1)(A.A),{variant:i.currentView===d.id?"primary":"tertiary",wide:!0,onClick:g=>f.$emit("update:currentView",d.id)},{icon:(0,e.k6)(()=>[(0,e.bF)((0,n.R1)(j.A),{path:d.icon,size:20},null,8,["path"])]),default:(0,e.k6)(()=>[(0,e.eW)(" "+(0,p.v_)(d.label),1)]),_:2},1032,["variant","onClick"])]))),128))]))],64)):(0,e.Q3)("",!0)],64))}}),Qt=(0,E._)(Ot,[["__scopeId","data-v-86223490"]]);function jt(i){const l=new AbortController,t=Math.round(Date.now()/1e3)-60*60*24*14;return new ee.CancelablePromise(async(s,r,o)=>{o(()=>l.abort());try{const{data:a}=await i.search("/",{signal:l.signal,details:!0,data:(0,y.R3)(t)}),f=a.results.map(v=>(0,y.Al)(v));s(f)}catch(a){r(a)}})}function Zt(i,l){const t=new AbortController;return new ee.CancelablePromise(async(s,r,o)=>{o(()=>t.abort());try{const f=(await i.getDirectoryContents((0,V.HS)(y.lJ,l),{signal:t.signal,details:!0,includeSelf:!0,data:(0,y.VL)()})).data.map(v=>(0,y.Al)(v));s({contents:f.filter(({path:v})=>v!==l),folder:f.find(({path:v})=>v===l)})}catch(a){r(a)}})}async function Gt(i,l){const{data:t}=await i.stat((0,V.HS)(y.lJ,l),{details:!0,data:(0,y.VL)()});return(0,y.Al)(t)}function Jt(i,l){const t=(0,y.H4)(),s=(0,n.IJ)([]),r=(0,n.IJ)(null),o=(0,n.KR)(!0),a=(0,n.KR)(null);async function f(d){const g=(0,V.HS)(l.value,d);await t.createDirectory((0,V.HS)(y.lJ,g));const h=await Gt(t,g);return s.value=[...s.value,h],h}async function v(){a.value&&a.value.cancel(),o.value=!0,i.value==="favorites"?a.value=(0,y.Q$)(t,l.value):i.value==="recent"?a.value=jt(t):a.value=Zt(t,l.value);const d=await a.value;if(d)"folder"in d?(r.value=d.folder,s.value=d.contents):(r.value=null,s.value=d);else return;a.value=null,o.value=!1}return(0,e.wB)([i,l],()=>v()),(0,e.sV)(()=>v()),{isLoading:o,files:s,folder:r,loadFiles:v,createDirectory:f}}function Yt(i){const l=(0,e.EW)(()=>i.value.map(s=>s.split("/")));return{isSupportedMimeType:s=>{const r=s.split("/");return l.value.some(([o,a])=>(r[0]===o||o==="*")&&(r[1]===a||a==="*"))}}}const Tt={class:"file-picker__main"},qt={key:1,class:"file-picker__view"},ei=(0,e.pM)({__name:"FilePicker",props:{buttons:{},name:{},allowPickDirectory:{type:Boolean,default:!1},disabledNavigation:{type:Boolean,default:!1},filterFn:{type:Function,default:void 0},canPickFn:{type:Function,default:void 0},mimetypeFilter:{default:()=>[]},multiselect:{type:Boolean,default:!1},path:{default:void 0}},emits:["close"],setup(i,{emit:l}){const t=i,s=l,r=(0,n.KR)(!0),o=(0,n.KR)("files"),a=(0,n.KR)(window?.sessionStorage.getItem("NC.FilePicker.LastPath")||"/"),f=(0,n.KR)(""),v=(0,e.EW)({get:()=>o.value==="files"?f.value||t.path||a.value:"/",set:_=>{f.value=_}}),d=(0,n.IJ)([]),{files:g,folder:h,isLoading:k,loadFiles:X,createDirectory:W}=Jt(o,v);(0,e.wB)([f],()=>{t.path===void 0&&f.value&&window.sessionStorage.setItem("NC.FilePicker.LastPath",f.value),d.value=[]});let I=!1;const H=(0,e.EW)(()=>{const _=d.value.length===0&&t.allowPickDirectory&&h.value?[h.value]:d.value;return(typeof t.buttons=="function"?t.buttons(_,v.value,o.value):t.buttons).map(F=>({...F,disabled:F.disabled||k.value,callback:()=>{I=!0,K(F.callback,_)}}))});async function K(_,m){await _(m),s("close",m),I=!1}const P=(0,e.EW)(()=>o.value==="favorites"?(0,u.t)("Favorites"):o.value==="recent"?(0,u.t)("Recent"):""),$=(0,n.KR)(""),{isSupportedMimeType:N}=Yt((0,n.lW)(t,"mimetypeFilter"));(0,e.sV)(()=>X());const{showHiddenFiles:C}=le(),w=(0,e.EW)(()=>{let _=g.value;return C.value||(_=_.filter(m=>!m.basename.startsWith("."))),t.mimetypeFilter.length>0&&(_=_.filter(m=>m.type==="folder"||m.mime&&N(m.mime))),$.value&&(_=_.filter(m=>m.basename.toLowerCase().includes($.value.toLowerCase()))),t.filterFn&&(_=_.filter(m=>t.filterFn(m))),_}),b=(0,e.EW)(()=>o.value==="files"?(0,u.t)("Upload some content or sync with your devices!"):o.value==="recent"?(0,u.t)("Files and folders you recently modified will show up here."):(0,u.t)("Files and folders you mark as favorite will show up here."));async function B(_){try{const m=await W(_);f.value=m.path,(0,ae.Ic)("files:node:created",g.value.filter(F=>F.basename===_)[0])}catch(m){u.l.warn("Could not create new folder",{name:_,error:m}),(0,u.s)((0,u.t)("Could not create the new folder"))}}function ii(_){!_&&!I&&s("close")}return(_,m)=>((0,e.uX)(),(0,e.Wv)((0,n.R1)(se.A),{open:r.value,"onUpdate:open":[m[6]||(m[6]=F=>r.value=F),ii],buttons:H.value,name:i.name,size:"large","content-classes":"file-picker__content","dialog-classes":"file-picker","navigation-classes":"file-picker__navigation"},{navigation:(0,e.k6)(({isCollapsed:F})=>[(0,e.bF)(Qt,{"current-view":o.value,"onUpdate:currentView":m[0]||(m[0]=U=>o.value=U),"filter-string":$.value,"onUpdate:filterString":m[1]||(m[1]=U=>$.value=U),"is-collapsed":F,"disabled-navigation":i.disabledNavigation},null,8,["current-view","filter-string","is-collapsed","disabled-navigation"])]),default:(0,e.k6)(()=>[(0,e.Lk)("div",Tt,[o.value==="files"?((0,e.uX)(),(0,e.Wv)($t,{key:0,path:v.value,"onUpdate:path":m[2]||(m[2]=F=>v.value=F),"show-menu":i.allowPickDirectory,onCreateNode:B},null,8,["path","show-menu"])):((0,e.uX)(),(0,e.CE)("div",qt,[(0,e.Lk)("h3",null,(0,p.v_)(P.value),1)])),(0,n.R1)(k)||w.value.length>0?((0,e.uX)(),(0,e.Wv)(vt,{key:2,path:v.value,"onUpdate:path":[m[3]||(m[3]=F=>v.value=F),m[5]||(m[5]=F=>o.value="files")],"selected-files":d.value,"onUpdate:selectedFiles":m[4]||(m[4]=F=>d.value=F),"allow-pick-directory":i.allowPickDirectory,"current-view":o.value,files:w.value,multiselect:i.multiselect,loading:(0,n.R1)(k),name:P.value,"can-pick":i.canPickFn},null,8,["path","selected-files","allow-pick-directory","current-view","files","multiselect","loading","name","can-pick"])):$.value?((0,e.uX)(),(0,e.Wv)((0,n.R1)(O.A),{key:3,name:(0,n.R1)(u.t)("No matching files"),description:(0,n.R1)(u.t)("No files matching your filter were found.")},{icon:(0,e.k6)(()=>[(0,e.bF)(M)]),_:1},8,["name","description"])):((0,e.uX)(),(0,e.Wv)((0,n.R1)(O.A),{key:4,name:(0,n.R1)(u.t)("No files in here"),description:b.value},{icon:(0,e.k6)(()=>[(0,e.bF)(M)]),_:1},8,["name","description"]))])]),_:1},8,["open","buttons","name"]))}}),ti=(0,E._)(ei,[["__scopeId","data-v-5287035b"]])},5242:(z,L,c)=>{c.d(L,{A:()=>e.N});var e=c(25529)},15797:(z,L,c)=>{c.d(L,{A:()=>e.N});var e=c(38675)},59904:(z,L,c)=>{c.d(L,{A:()=>e.N});var e=c(30854)},3710:(z,L,c)=>{c.r(L),c.d(L,{default:()=>e.N});var e=c(29592)},79455:(z,L,c)=>{c.d(L,{A:()=>e._});var e=c(51868)}}]);})();

//# sourceMappingURL=talk-defaultVendors-node_modules_nextcloud_dialogs_dist_chunks_FilePicker-CtWlxGEm_mjs.js.map?v=c06e9e7135c3dba33352