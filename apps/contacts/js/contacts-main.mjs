import{a6 as gh,a7 as yh,a8 as vh,a9 as bh,aa as Ch,ab as wh,ac as kh,F as mt,ad as _h,ae as xh,af as Sh,ag as Mh,ah as Ah,ai as Nh,aj as Lh,ak as jl,al as ql,am as Dh,an as Ih,ao as Oh,ap as Th,aq as Eh,ar as Ph,as as $h,z as zh,at as Hh,C as Xt,e as _a,g as O,k as P,b as C,d as T,au as Bh,av as Rh,aw as Vh,ax as Uh,q as Xl,ay as Yh,j as K,i as M,az as Gh,aA as Fh,B as ze,aB as Wh,aC as jh,aD as qh,aE as Xh,aF as Zh,aG as Jh,aH as Kh,aI as Qh,aJ as tp,aK as ep,aL as np,aM as xa,aN as Zl,aO as ip,aP as op,aQ as Jl,A as rp,aR as ap,aS as sp,aT as lp,aU as cp,aV as dp,aW as up,aX as hp,aY as pp,aZ as mp,a_ as fp,a$ as gp,b0 as yp,b1 as vp,b2 as bp,b3 as Cp,b4 as wp,b5 as kp,b6 as Xo,b7 as _p,b8 as xp,N as Ii,n as pt,S as Kl,s as Kt,b9 as Ql,U as Zo,ba as Sp,bb as Mp,bc as Ap,bd as Np,be as Lp,bf as Dp,K as Jo,bg as Ip,bh as Op,bi as tc,bj as Tp,P as ec,bk as Ep,bl as Pp,o as p,bm as $p,bn as zp,bo as Hp,bp as Bp,bq as Rp,br as nc,bs as Vp,H as $e,bt as Up,bu as Yp,p as It,r as Tt,m as b,bv as Sa,bw as Pn,bx as Gp,by as Fp,bz as Wp,bA as jp,bB as qp,bC as Xp,bD as Zp,I as Jp,bE as Kp,bF as Qp,bG as t1,t as E,bH as e1,T as n1,bI as Ao,D as i1,bJ as o1,G as r1,bK as a1,bL as s1,E as Dn,bM as l1,bN as c1,bO as d1,bP as u1,bQ as h1,O as Ma,bR as p1,bS as m1,bT as f1,Q as g1,bU as y1,v as v1,bV as b1,bW as C1,bX as w1,bY as In,bZ as Oi,b_ as k1,b$ as ic,J as qe,V as _1,c0 as x1,c1 as S1,c2 as M1,h as _,c3 as A1,w as ue,c4 as Ko,c5 as N1,u as Wt,c6 as L1,_ as Q,a5 as D1,M as si,f as Ni,x as No,c as xe,c7 as Aa,c8 as I1,L as oc,a3 as ve,c9 as Na,a1 as O1,ca as rc,l as $n,Z as ac,R as sc,cb as lc,a as Qo}from"./LegacyGlobalMixin-fsGrxvTH.chunk.mjs";import{_ as Qe,d as Hn,t as T1,v as Bn,w as E1,p as P1,x as $1,q as Rn,R as z1,y as cc,m as Yi,N as ne,f as gn,z as La,b as fn,c as me,a as yn,i as dc,o as uc,A as Da,I as Ia,h as tr,B as H1,l as B1,C as Oa,n as Ta,D as R1,s as V1,E as U1,F as Y1,G as G1,H as F1,J as W1,K as j1,L as q1}from"./index-01gXY4hn.chunk.mjs";import{f as hc,d as vt,g as pc,j as X1,M as Z1,h as tn,P as J1,i as Gr,k as Fr,o as ie,p as K1,q as yi,D as Q1,w as tm,x as Wr,y as Vn,I as er,z as em,A as nm,B as mc,E as Ea,N as im,F as _r,G as om,H as Gi,J as rm,O as am,a as Pa,r as Ee,_ as sm,K as fc,L as lm,Q as cm,R as dm,C as gc,T as yc,U as um,V as hm,W as Ti,X as pm,m as $a,e as Vs,v as mm,Y as vc,Z as fm,c as co,$ as gm,u as bc,a0 as Cc,a1 as wc,a2 as xr,a3 as uo,a4 as ym,a5 as ho,a6 as Sr,a7 as jr,a8 as po,a9 as vm,b as bm,s as Cm}from"./style-B-IJY7WJ.chunk.mjs";const mh="contacts",fh="8.0.6",wm=()=>{},km=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:gh,BaseTransitionPropsValidators:yh,Comment:vh,DeprecationTypes:bh,EffectScope:Ch,ErrorCodes:wh,ErrorTypeStrings:kh,Fragment:mt,KeepAlive:_h,ReactiveEffect:xh,Static:Sh,Suspense:Mh,Teleport:Ah,Text:Nh,TrackOpTypes:Lh,Transition:jl,TransitionGroup:ql,TriggerOpTypes:Dh,VueElement:Ih,assertNumber:Oh,callWithAsyncErrorHandling:Th,callWithErrorHandling:Eh,camelize:Ph,capitalize:$h,cloneVNode:zh,compatUtils:Hh,compile:wm,computed:Xt,createApp:_a,createBlock:O,createCommentVNode:P,createElementBlock:C,createElementVNode:T,createHydrationRenderer:Bh,createPropsRestProxy:Rh,createRenderer:Vh,createSSRApp:Uh,createSlots:Xl,createStaticVNode:Yh,createTextVNode:K,createVNode:M,customRef:Gh,defineAsyncComponent:Fh,defineComponent:ze,defineCustomElement:Wh,defineEmits:jh,defineExpose:qh,defineModel:Xh,defineOptions:Zh,defineProps:Jh,defineSSRCustomElement:Kh,defineSlots:Qh,devtools:tp,effect:ep,effectScope:np,getCurrentInstance:xa,getCurrentScope:Zl,getCurrentWatcher:ip,getTransitionRawChildren:op,guardReactiveProps:Jl,h:rp,handleError:ap,hasInjectionContext:sp,hydrate:lp,hydrateOnIdle:cp,hydrateOnInteraction:dp,hydrateOnMediaQuery:up,hydrateOnVisible:hp,initCustomFormatter:pp,initDirectivesForSSR:mp,inject:fp,isMemoSame:gp,isProxy:yp,isReactive:vp,isReadonly:bp,isRef:Cp,isRuntimeOnly:wp,isShallow:kp,isVNode:Xo,markRaw:_p,mergeDefaults:xp,mergeModels:Ii,mergeProps:pt,nextTick:Kl,normalizeClass:Kt,normalizeProps:Ql,normalizeStyle:Zo,onActivated:Sp,onBeforeMount:Mp,onBeforeUnmount:Ap,onBeforeUpdate:Np,onDeactivated:Lp,onErrorCaptured:Dp,onMounted:Jo,onRenderTracked:Ip,onRenderTriggered:Op,onScopeDispose:tc,onServerPrefetch:Tp,onUnmounted:ec,onUpdated:Ep,onWatcherCleanup:Pp,openBlock:p,popScopeId:$p,provide:zp,proxyRefs:Hp,pushScopeId:Bp,queuePostFlushCb:Rp,reactive:nc,readonly:Vp,ref:$e,registerRuntimeCompiler:Up,render:Yp,renderList:It,renderSlot:Tt,resolveComponent:b,resolveDirective:Sa,resolveDynamicComponent:Pn,resolveFilter:Gp,resolveTransitionHooks:Fp,setBlockTracking:Wp,setDevtoolsHook:jp,setTransitionHooks:qp,shallowReactive:Xp,shallowReadonly:Zp,shallowRef:Jp,ssrContextKey:Kp,ssrUtils:Qp,stop:t1,toDisplayString:E,toHandlerKey:e1,toHandlers:n1,toRaw:Ao,toRef:i1,toRefs:o1,toValue:r1,transformVNodeArgs:a1,triggerRef:s1,unref:Dn,useAttrs:l1,useCssModule:c1,useCssVars:d1,useHost:u1,useId:h1,useModel:Ma,useSSRContext:p1,useShadowRoot:m1,useSlots:f1,useTemplateRef:g1,useTransitionState:y1,vModelCheckbox:v1,vModelDynamic:b1,vModelRadio:C1,vModelSelect:w1,vModelText:In,vShow:Oi,version:k1,warn:ic,watch:qe,watchEffect:_1,watchPostEffect:x1,watchSyncEffect:S1,withAsyncContext:M1,withCtx:_,withDefaults:A1,withDirectives:ue,withKeys:Ko,withMemo:N1,withModifiers:Wt,withScopeId:L1},Symbol.toStringTag,{value:"Module"})),_m={name:"ContactsRoot"};function xm(e,i,o,r,a,s){const l=b("RouterView");return p(),O(l)}const Sm=Q(_m,[["render",xm]]),Mm={name:"NcActionSeparator"},Am={class:"action action-separator action--disabled",role:"separator"};function Nm(e,i,o,r,a,s){return p(),C("li",Am)}const Lm=Qe(Mm,[["render",Nm],["__scopeId","data-v-3e2324b7"]]),Dm={class:"app-content-details"},Im=ze({__name:"NcAppContentDetails",setup(e){return(i,o)=>(p(),C("div",Dm,[Tt(i.$slots,"default")]))}}),Om={name:"NcAppContentList",props:{selection:{type:Boolean,default:!1},showDetails:{type:Boolean,default:!1}}};function Tm(e,i,o,r,a,s){return p(),C("div",{class:Kt(["app-content-list",{selection:o.selection,showdetails:o.showDetails}])},[Tt(e.$slots,"default")],2)}const Em=Qe(Om,[["render",Tm]]),Pm={name:"NcAppSettingsSection",inject:["registerSection","unregisterSection"],props:{name:{type:String,required:!0},id:{type:String,required:!0,validator(e){return/^[a-z0-9\-_]+$/.test(e)}}},computed:{htmlId(){return"settings-section_"+this.id}},watch:{id(e,i){this.unregisterSection(i),this.registerSection(e,this.name,this.$slots?.icon?.())},name(e){this.unregisterSection(this.id),this.registerSection(this.id,e,this.$slots?.icon?.())}},mounted(){this.registerSection(this.id,this.name,this.$slots?.icon?.())},beforeUnmount(){this.unregisterSection(this.id)}},$m=["id","aria-labelledby"],zm=["id"];function Hm(e,i,o,r,a,s){return p(),C("section",{id:s.htmlId,"aria-labelledby":`${s.htmlId}--label`,class:"app-settings-section"},[T("h3",{id:`${s.htmlId}--label`,class:"app-settings-section__name"},E(o.name),9,zm),Tt(e.$slots,"default",{},void 0,!0),P("",!0)],8,$m)}const Bm=Qe(Pm,[["render",Hm],["__scopeId","data-v-ce8fac13"]]),Rm=["title"],Vm=ze({__name:"NcCounterBubble",props:{count:{},active:{type:Boolean},type:{default:""},raw:{type:Boolean}},setup(e){const i=e,o=Xt(()=>i.raw?i.count.toString():new Intl.NumberFormat(D1(),{notation:"compact",compactDisplay:"short"}).format(i.count)),r=Xt(()=>{if(i.raw)return;const a=i.count.toString();if(a!==o.value)return a});return(a,s)=>(p(),C("div",{class:Kt(["counter-bubble__counter",{active:a.active,"counter-bubble__counter--highlighted":a.type==="highlighted","counter-bubble__counter--outlined":a.type==="outlined"}]),title:r.value},E(o.value),11,Rm))}}),nr=Qe(Vm,[["__scopeId","data-v-5481b656"]]),Um={name:"NcListItem",components:{NcActions:Hn,NcCounterBubble:nr,NcVNodes:T1},inheritAttrs:!1,props:{details:{type:String,default:""},name:{type:String,default:void 0},to:{type:[String,Object],default:null},href:{type:String,default:"#"},target:{type:String,default:""},anchorId:{type:String,default:""},bold:{type:Boolean,default:!1},compact:{type:Boolean,default:!1},active:{type:Boolean,default:void 0},linkAriaLabel:{type:String,default:""},actionsAriaLabel:{type:String,default:void 0},counterNumber:{type:[Number,String],default:0},counterType:{type:String,default:"",validator(e){return["highlighted","outlined",""].indexOf(e)!==-1}},forceDisplayActions:{type:Boolean,default:!1},forceMenu:{type:Boolean,default:!1},oneLine:{type:Boolean,default:!1}},emits:["click","update:menuOpen"],data(){return{hovered:!1,hasActions:!1,hasSubname:!1,displayActionsOnHoverFocus:!1,menuOpen:!1,hasIndicator:!1,hasDetails:!1}},computed:{showAdditionalElements(){return!this.displayActionsOnHoverFocus||this.forceDisplayActions},showDetails(){return(this.details!==""||this.hasDetails)&&(!this.displayActionsOnHoverFocus||this.forceDisplayActions)}},watch:{menuOpen(e){!e&&!this.hovered&&(this.displayActionsOnHoverFocus=!1)}},mounted(){this.checkSlots()},updated(){this.checkSlots()},methods:{onClick(e,i,o){this.$emit("click",e),!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&o&&(i?.(e),e.preventDefault())},showActions(){this.hasActions&&(this.displayActionsOnHoverFocus=!0),this.hovered=!1},hideActions(){this.displayActionsOnHoverFocus=!1},handleBlur(e){this.menuOpen||this.$refs["list-item"]?.contains(e.relatedTarget)||this.hideActions()},handleMouseleave(){this.menuOpen||(this.displayActionsOnHoverFocus=!1),this.hovered=!1},handleMouseover(){this.showActions(),this.hovered=!0},handleActionsUpdateOpen(e){this.menuOpen=e,this.$emit("update:menuOpen",e)},checkSlots(){this.hasActions!==!!this.$slots.actions&&(this.hasActions=!!this.$slots.actions),this.hasSubname!==!!this.$slots.subname&&(this.hasSubname=!!this.$slots.subname),this.hasIndicator!==!!this.$slots.indicator&&(this.hasIndicator=!!this.$slots.indicator),this.hasDetails!==!!this.$slots.details&&(this.hasDetails=!!this.$slots.details)}}},Ym=["id","aria-label","href","target","rel","onClick"],Gm={class:"list-item-content"},Fm={class:"list-item-content__main"},Wm={class:"list-item-content__name"},jm={class:"list-item-content__details"},qm={key:0,class:"list-item-details__details"},Xm={key:1,class:"list-item-details__extra"},Zm={key:1,class:"list-item-details__indicator"},Jm={key:0,class:"list-item-content__extra-actions"},Km={key:1,class:"list-item__extra"};function Qm(e,i,o,r,a,s){const l=b("NcCounterBubble"),c=b("NcActions");return p(),O(Pn(o.to?"router-link":"NcVNodes"),Ql(Jl({...o.to&&{custom:!0,to:o.to}})),{default:_(({href:d,navigate:u,isActive:m})=>[T("li",pt({class:["list-item__wrapper",{"list-item__wrapper--active":o.active??m}]},e.$attrs),[T("div",{ref:"list-item",class:Kt(["list-item",{"list-item--compact":o.compact,"list-item--one-line":o.oneLine}]),onMouseover:i[4]||(i[4]=(...y)=>s.handleMouseover&&s.handleMouseover(...y)),onMouseleave:i[5]||(i[5]=(...y)=>s.handleMouseleave&&s.handleMouseleave(...y))},[T("a",{id:o.anchorId||void 0,"aria-label":o.linkAriaLabel,class:"list-item__anchor",href:d||o.href,target:o.target||(o.href==="#"?void 0:"_blank"),rel:o.href==="#"?void 0:"noopener noreferrer",onFocus:i[0]||(i[0]=(...y)=>s.showActions&&s.showActions(...y)),onFocusout:i[1]||(i[1]=(...y)=>s.handleBlur&&s.handleBlur(...y)),onClick:y=>s.onClick(y,u,d),onKeydown:i[2]||(i[2]=Ko((...y)=>s.hideActions&&s.hideActions(...y),["esc"]))},[Tt(e.$slots,"icon",{},void 0,!0),T("div",Gm,[T("div",Fm,[T("div",Wm,[Tt(e.$slots,"name",{},()=>[K(E(o.name),1)],!0)]),a.hasSubname?(p(),C("div",{key:0,class:Kt(["list-item-content__subname",{"list-item-content__subname--bold":o.bold}])},[Tt(e.$slots,"subname",{},void 0,!0)],2)):P("",!0)]),T("div",jm,[s.showDetails?(p(),C("div",qm,[Tt(e.$slots,"details",{},()=>[K(E(o.details),1)],!0)])):P("",!0),o.counterNumber!==0||a.hasIndicator?ue((p(),C("div",Xm,[o.counterNumber!==0?(p(),O(l,{key:0,count:o.counterNumber,active:o.active??m,class:"list-item-details__counter",type:o.counterType},null,8,["count","active","type"])):P("",!0),a.hasIndicator?(p(),C("span",Zm,[Tt(e.$slots,"indicator",{},void 0,!0)])):P("",!0)],512)),[[Oi,s.showAdditionalElements]]):P("",!0)])])],40,Ym),e.$slots["extra-actions"]?(p(),C("div",Jm,[Tt(e.$slots,"extra-actions",{},void 0,!0)])):P("",!0),ue(T("div",{class:"list-item-content__actions",onFocusout:i[3]||(i[3]=(...y)=>s.handleBlur&&s.handleBlur(...y))},[M(c,{ref:"actions",primary:o.active??m,"force-menu":o.forceMenu,"aria-label":o.actionsAriaLabel,"onUpdate:open":s.handleActionsUpdateOpen},Xl({default:_(()=>[Tt(e.$slots,"actions",{},void 0,!0)]),_:2},[e.$slots["actions-icon"]?{name:"icon",fn:_(()=>[Tt(e.$slots,"actions-icon",{},void 0,!0)]),key:"0"}:void 0]),1032,["primary","force-menu","aria-label","onUpdate:open"])],544),[[Oi,o.forceDisplayActions||a.displayActionsOnHoverFocus]]),e.$slots.extra?(p(),C("div",Km,[Tt(e.$slots,"extra",{},void 0,!0)])):P("",!0)],34)],16)]),_:3},16)}const kc=Qe(Um,[["render",Qm],["__scopeId","data-v-4c860755"]]),tf=8,Us=32,ef={name:"NcListItemIcon",components:{NcAvatar:Bn,NcHighlight:E1,NcIconSvgWrapper:P1},mixins:[$1],props:{name:{type:String,required:!0},subname:{type:String,default:""},icon:{type:String,default:""},iconSvg:{type:String,default:""},iconName:{type:String,default:""},search:{type:String,default:""},avatarSize:{type:Number,default:Us},noMargin:{type:Boolean,default:!1},displayName:{type:String,default:null},isNoUser:{type:Boolean,default:!1},id:{type:String,default:null}},setup(){return{margin:tf,defaultSize:Us}},computed:{hasIcon(){return this.icon!==""},hasIconSvg(){return this.iconSvg!==""},isValidSubname(){return this.subname?.trim?.()!==""},isSizeBigEnough(){return this.avatarSize>=26},cssVars(){const e=this.noMargin?0:this.margin;return{"--height":this.avatarSize+2*e+"px","--margin":this.margin+"px"}},searchParts(){const e=/^([^<]*)<([^>]+)>?$/,i=this.search.match(e);return this.isNoUser||!i?[this.search,this.search]:[i[1].trim(),i[2]]}},beforeMount(){!this.isNoUser&&!this.subname&&this.fetchUserStatus(this.user)}},nf=["id"],of={class:"option__details"},rf={key:1},af=["aria-label"];function sf(e,i,o,r,a,s){const l=b("NcAvatar"),c=b("NcHighlight"),d=b("NcIconSvgWrapper");return p(),C("span",{id:o.id,class:Kt(["option",{"option--compact":o.avatarSize<r.defaultSize}]),style:Zo(s.cssVars)},[M(l,pt(e.$attrs,{"disable-menu":!0,"disable-tooltip":!0,"display-name":o.displayName||o.name,"is-no-user":o.isNoUser,size:o.avatarSize,class:"option__avatar"}),null,16,["display-name","is-no-user","size"]),T("div",of,[M(c,{class:"option__lineone",text:o.name,search:s.searchParts[0]},null,8,["text","search"]),s.isValidSubname&&s.isSizeBigEnough?(p(),O(c,{key:0,class:"option__linetwo",text:o.subname,search:s.searchParts[1]},null,8,["text","search"])):e.hasStatus?(p(),C("span",rf,[T("span",null,E(e.userStatus.icon),1),T("span",null,E(e.userStatus.message),1)])):P("",!0)]),Tt(e.$slots,"default",{},()=>[s.hasIconSvg?(p(),O(d,{key:0,class:"option__icon",svg:o.iconSvg,name:o.iconName},null,8,["svg","name"])):s.hasIcon?(p(),C("span",{key:1,class:Kt(["icon option__icon",o.icon]),"aria-label":o.iconName},null,10,af)):P("",!0)],!0)],14,nf)}const Ys=Qe(ef,[["render",sf],["__scopeId","data-v-f5135913"]]),lf=ze({__name:"NcSelectUsers",props:Ii({ariaLabelClearSelected:{},ariaLabelListbox:{},ariaLabelDeselectOption:{type:Function},disabled:{type:Boolean},inputId:{},inputLabel:{},labelOutside:{type:Boolean},keepOpen:{type:Boolean},loading:{type:Boolean},multiple:{type:Boolean},noWrap:{type:Boolean},options:{},placeholder:{},required:{type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:Ii(["search"],["update:modelValue"]),setup(e,{emit:i}){const o=Ma(e,"modelValue"),r=i,a=$e("");qe(a,()=>r("search",a.value));const s=Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--default-clickable-area")),l=Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--default-grid-baseline")),c=s-2*l;function d(u,m,y){const v=/[^<]*<([^>]+)/,w=y.match(v),D=u.subname?.toLocaleLowerCase()??"";return w&&D.indexOf(w[1].toLocaleLowerCase())>-1||`${m} ${u.subname}`.toLocaleLowerCase().indexOf(y.toLocaleLowerCase())>-1}return(u,m)=>(p(),O(Dn(Rn),pt({modelValue:o.value,"onUpdate:modelValue":m[0]||(m[0]=y=>o.value=y),class:"nc-select-users"},u.$props,{"filter-by":d,label:"displayName",onSearch:m[1]||(m[1]=y=>a.value=y)}),{option:_(y=>[M(Dn(Ys),pt(y,{"avatar-size":32,name:y.displayName,search:a.value}),null,16,["name","search"])]),"selected-option":_(y=>[M(Dn(Ys),pt(y,{"avatar-size":c,name:y.displayName,"no-margin":"",search:a.value}),null,16,["name","search"])]),_:1},16,["modelValue"]))}}),cf=Qe(lf,[["__scopeId","data-v-085bfabd"]]),df={};function uf(e,i){return p(),C("div",null,[Tt(e.$slots,"trigger")])}const hf=Qe(df,[["render",uf]]),pf={class:"user-bubble__name"},mf={key:0,class:"user-bubble__secondary"},ff=ze({__name:"NcUserBubble",props:Ii({avatarImage:{default:void 0},user:{default:void 0},displayName:{default:void 0},showUserStatus:{type:Boolean},url:{default:void 0},to:{default:void 0},primary:{type:Boolean},size:{default:20},margin:{default:2}},{open:{type:Boolean},openModifiers:{}}),emits:Ii(["click"],["update:open"]),setup(e,{emit:i}){const o=e,r=i,a=Ma(e,"open"),s=Xt(()=>{if(!o.avatarImage)return!1;try{return!!new URL(o.avatarImage)}catch{return!1}}),l=Xt(()=>!!o.avatarImage),c=Xt(()=>({marginInlineStart:`${o.margin}px`})),d=Xt(()=>{if(!o.url||o.url.trim()==="")return!1;try{return!!new URL(o.url,o.url?.startsWith?.("/")?window.location.href:void 0)}catch{return ic("[NcUserBubble] Invalid URL passed",{url:o.url}),!1}}),u=Xt(()=>d.value?o.url:void 0),m=Xt(()=>d.value?"a":o.to?z1:"div"),y=Xt(()=>({height:`${o.size}px`,lineHeight:`${o.size}px`,borderRadius:`${o.size/2}px`}));return qe([()=>o.displayName,()=>o.user],()=>{!o.displayName&&o.user}),(v,w)=>(p(),O(Pn(v.$slots.default?Dn(cc):hf),{shown:a.value,"onUpdate:shown":w[1]||(w[1]=D=>a.value=D),class:"user-bubble__wrapper",trigger:"hover focus"},{trigger:_(({attrs:D})=>[(p(),O(Pn(m.value),pt({class:["user-bubble__content",{"user-bubble__content--primary":v.primary}],style:y.value,to:v.to,href:u.value},D,{onClick:w[0]||(w[0]=S=>r("click",S))}),{default:_(()=>[M(Dn(Bn),{url:l.value&&s.value?v.avatarImage:void 0,"icon-class":l.value&&!s.value?v.avatarImage:void 0,user:v.user,"display-name":v.displayName,size:v.size-v.margin*2,style:Zo(c.value),"disable-tooltip":!0,"disable-menu":!0,"hide-status":!v.showUserStatus,class:"user-bubble__avatar"},null,8,["url","icon-class","user","display-name","size","style","hide-status"]),T("span",pf,E(v.displayName||v.user),1),v.$slots.name?(p(),C("span",mf,[Tt(v.$slots,"name",{},void 0,!0)])):P("",!0)]),_:2},1040,["class","style","to","href"]))]),default:_(()=>[Tt(v.$slots,"default",{},void 0,!0)]),_:3},40,["shown"]))}}),za=Qe(ff,[["__scopeId","data-v-a7e3a34c"]]),gf={name:"AccountGroupOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},yf=["aria-hidden","aria-label"],vf=["fill","width","height"],bf={d:"M12,5A3.5,3.5 0 0,0 8.5,8.5A3.5,3.5 0 0,0 12,12A3.5,3.5 0 0,0 15.5,8.5A3.5,3.5 0 0,0 12,5M12,7A1.5,1.5 0 0,1 13.5,8.5A1.5,1.5 0 0,1 12,10A1.5,1.5 0 0,1 10.5,8.5A1.5,1.5 0 0,1 12,7M5.5,8A2.5,2.5 0 0,0 3,10.5C3,11.44 3.53,12.25 4.29,12.68C4.65,12.88 5.06,13 5.5,13C5.94,13 6.35,12.88 6.71,12.68C7.08,12.47 7.39,12.17 7.62,11.81C6.89,10.86 6.5,9.7 6.5,8.5C6.5,8.41 6.5,8.31 6.5,8.22C6.2,8.08 5.86,8 5.5,8M18.5,8C18.14,8 17.8,8.08 17.5,8.22C17.5,8.31 17.5,8.41 17.5,8.5C17.5,9.7 17.11,10.86 16.38,11.81C16.5,12 16.63,12.15 16.78,12.3C16.94,12.45 17.1,12.58 17.29,12.68C17.65,12.88 18.06,13 18.5,13C18.94,13 19.35,12.88 19.71,12.68C20.47,12.25 21,11.44 21,10.5A2.5,2.5 0 0,0 18.5,8M12,14C9.66,14 5,15.17 5,17.5V19H19V17.5C19,15.17 14.34,14 12,14M4.71,14.55C2.78,14.78 0,15.76 0,17.5V19H3V17.07C3,16.06 3.69,15.22 4.71,14.55M19.29,14.55C20.31,15.22 21,16.06 21,17.07V19H24V17.5C24,15.76 21.22,14.78 19.29,14.55M12,16C13.53,16 15.24,16.5 16.23,17H7.77C8.76,16.5 10.47,16 12,16Z"},Cf={key:0};function wf(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon account-group-outline-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",bf,[o.title?(p(),C("title",Cf,E(o.title),1)):P("",!0)])],8,vf))],16,yf)}const ir=Q(gf,[["render",wf]]);function kf(e){return Zl()?(tc(e),!0):!1}function _c(e){return typeof e=="function"?e():Dn(e)}const _f=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;function xf(e){return xa()}function Sf(e,i=!0,o){xf()?Jo(e,o):i?e():Kl(e)}const xc=_f?window:void 0;function Kn(e){var i;const o=_c(e);return(i=o?.$el)!=null?i:o}function Mf(){const e=$e(!1),i=xa();return i&&Jo(()=>{e.value=!0},i),e}function Af(e){const i=Mf();return Xt(()=>(i.value,!!e()))}function Nf(e,i,o={}){const{window:r=xc,...a}=o;let s;const l=Af(()=>r&&"ResizeObserver"in r),c=()=>{s&&(s.disconnect(),s=void 0)},d=Xt(()=>{const y=_c(e);return Array.isArray(y)?y.map(v=>Kn(v)):[Kn(y)]}),u=qe(d,y=>{if(c(),l.value&&r){s=new ResizeObserver(i);for(const v of y)v&&s.observe(v,a)}},{immediate:!0,flush:"post"}),m=()=>{c(),u()};return kf(m),{isSupported:l,stop:m}}function Lf(e,i={width:0,height:0},o={}){const{window:r=xc,box:a="content-box"}=o,s=Xt(()=>{var y,v;return(v=(y=Kn(e))==null?void 0:y.namespaceURI)==null?void 0:v.includes("svg")}),l=$e(i.width),c=$e(i.height),{stop:d}=Nf(e,([y])=>{const v=a==="border-box"?y.borderBoxSize:a==="content-box"?y.contentBoxSize:y.devicePixelContentBoxSize;if(r&&s.value){const w=Kn(e);if(w){const D=w.getBoundingClientRect();l.value=D.width,c.value=D.height}}else if(v){const w=Array.isArray(v)?v:[v];l.value=w.reduce((D,{inlineSize:S})=>D+S,0),c.value=w.reduce((D,{blockSize:S})=>D+S,0)}else l.value=y.contentRect.width,c.value=y.contentRect.height},o);Sf(()=>{const y=Kn(e);y&&(l.value="offsetWidth"in y?y.offsetWidth:i.width,c.value="offsetHeight"in y?y.offsetHeight:i.height)});const u=qe(()=>Kn(e),y=>{l.value=y?i.width:0,c.value=y?i.height:0});function m(){d(),u()}return{width:l,height:c,stop:m}}const Df={name:"CogOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},If=["aria-hidden","aria-label"],Of=["fill","width","height"],Tf={d:"M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8M12,10A2,2 0 0,0 10,12A2,2 0 0,0 12,14A2,2 0 0,0 14,12A2,2 0 0,0 12,10M10,22C9.75,22 9.54,21.82 9.5,21.58L9.13,18.93C8.5,18.68 7.96,18.34 7.44,17.94L4.95,18.95C4.73,19.03 4.46,18.95 4.34,18.73L2.34,15.27C2.21,15.05 2.27,14.78 2.46,14.63L4.57,12.97L4.5,12L4.57,11L2.46,9.37C2.27,9.22 2.21,8.95 2.34,8.73L4.34,5.27C4.46,5.05 4.73,4.96 4.95,5.05L7.44,6.05C7.96,5.66 8.5,5.32 9.13,5.07L9.5,2.42C9.54,2.18 9.75,2 10,2H14C14.25,2 14.46,2.18 14.5,2.42L14.87,5.07C15.5,5.32 16.04,5.66 16.56,6.05L19.05,5.05C19.27,4.96 19.54,5.05 19.66,5.27L21.66,8.73C21.79,8.95 21.73,9.22 21.54,9.37L19.43,11L19.5,12L19.43,13L21.54,14.63C21.73,14.78 21.79,15.05 21.66,15.27L19.66,18.73C19.54,18.95 19.27,19.04 19.05,18.95L16.56,17.95C16.04,18.34 15.5,18.68 14.87,18.93L14.5,21.58C14.46,21.82 14.25,22 14,22H10M11.25,4L10.88,6.61C9.68,6.86 8.62,7.5 7.85,8.39L5.44,7.35L4.69,8.65L6.8,10.2C6.4,11.37 6.4,12.64 6.8,13.8L4.68,15.36L5.43,16.66L7.86,15.62C8.63,16.5 9.68,17.14 10.87,17.38L11.24,20H12.76L13.13,17.39C14.32,17.14 15.37,16.5 16.14,15.62L18.57,16.66L19.32,15.36L17.2,13.81C17.6,12.64 17.6,11.37 17.2,10.2L19.31,8.65L18.56,7.35L16.15,8.39C15.38,7.5 14.32,6.86 13.12,6.62L12.75,4H11.25Z"},Ef={key:0};function Pf(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon cog-outline-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",Tf,[o.title?(p(),C("title",Ef,E(o.title),1)):P("",!0)])],8,Of))],16,If)}const Ha=Q(Df,[["render",Pf]]),$f={name:"LoginIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},zf=["aria-hidden","aria-label"],Hf=["fill","width","height"],Bf={d:"M11 7L9.6 8.4L12.2 11H2V13H12.2L9.6 15.6L11 17L16 12L11 7M20 19H12V21H20C21.1 21 22 20.1 22 19V5C22 3.9 21.1 3 20 3H12V5H20V19Z"},Rf={key:0};function Vf(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon login-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",Bf,[o.title?(p(),C("title",Rf,E(o.title),1)):P("",!0)])],8,Hf))],16,zf)}const Uf=Q($f,[["render",Vf]]),Yf={name:"LogoutIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Gf=["aria-hidden","aria-label"],Ff=["fill","width","height"],Wf={d:"M17 7L15.59 8.41L18.17 11H8V13H18.17L15.59 15.58L17 17L22 12M4 5H12V3H4C2.9 3 2 3.9 2 5V19C2 20.1 2.9 21 4 21H12V19H4V5Z"},jf={key:0};function qf(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon logout-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",Wf,[o.title?(p(),C("title",jf,E(o.title),1)):P("",!0)])],8,Ff))],16,Gf)}const Sc=Q(Yf,[["render",qf]]),Xf={name:"AccountPlusOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Zf=["aria-hidden","aria-label"],Jf=["fill","width","height"],Kf={d:"M15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4M15,5.9C16.16,5.9 17.1,6.84 17.1,8C17.1,9.16 16.16,10.1 15,10.1A2.1,2.1 0 0,1 12.9,8A2.1,2.1 0 0,1 15,5.9M4,7V10H1V12H4V15H6V12H9V10H6V7H4M15,13C12.33,13 7,14.33 7,17V20H23V17C23,14.33 17.67,13 15,13M15,14.9C17.97,14.9 21.1,16.36 21.1,17V18.1H8.9V17C8.9,16.36 12,14.9 15,14.9Z"},Qf={key:0};function t0(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon account-plus-outline-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",Kf,[o.title?(p(),C("title",Qf,E(o.title),1)):P("",!0)])],8,Jf))],16,Zf)}const Mc=Q(Xf,[["render",t0]]),e0={name:"FileDocumentOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},n0=["aria-hidden","aria-label"],i0=["fill","width","height"],o0={d:"M6,2A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6M6,4H13V9H18V20H6V4M8,12V14H16V12H8M8,16V18H13V16H8Z"},r0={key:0};function a0(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon file-document-outline-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",o0,[o.title?(p(),C("title",r0,E(o.title),1)):P("",!0)])],8,i0))],16,n0)}const s0=Q(e0,[["render",a0]]),Ac={data(){return{copied:!1,copyLoading:!1,copySuccess:!1}},computed:{copyLinkIcon(){return this.copySuccess?"icon-checkmark":this.copyLoading?"icon-loading-small":"icon-public"}},methods:{async copyToClipboard(e){this.copyLoading=!0;try{await navigator.clipboard.writeText(e),this.copySuccess=!0,this.copied=!0,hc(t("contacts","Link copied to the clipboard"))}catch{this.copySuccess=!1,this.copied=!0,vt(t("contacts","Could not copy link to the clipboard."))}finally{this.copyLoading=!1,setTimeout(()=>{this.copied=!1,this.copySuccess=!1},2e3)}}}},Nc={props:{circle:{type:pc,required:!0}},mixins:[Ac],data(){return{loadingAction:!1,loadingJoin:!1}},computed:{copyButtonText(){return this.copied?this.copySuccess?t("contacts","Copied"):t("contacts","Could not copy"):t("contacts","Copy link")},circleUrl(){const e=this.$router.resolve(this.circle.router);return window.location.origin+e.href},joinButtonTitle(){return this.circle.requireJoinAccept?t("contacts","Request to join"):t("contacts","Join team")}},methods:{confirmLeaveCircle(){window.OC.dialogs.confirmDestructive(t("contacts",`You are about to leave {circle}.
Are you sure?`,{circle:this.circle.displayName}),t("contacts","Please confirm team leave"),window.OC.dialogs.YES_NO_BUTTONS,this.leaveCircle,!0)},async leaveCircle(e){if(!e){this.logger.debug("Circle leave cancelled");return}this.loadingAction=!0;const i=this.circle.initiator;try{await this.$store.dispatch("deleteMemberFromCircle",{member:i,leave:!0}),this.circle.initiator=null}catch(o){console.error("Could not leave the circle",i,o),vt(t("contacts","Could not leave the team {displayName}",this.circle))}finally{this.loadingAction=!1}},async joinCircle(){this.loadingJoin=!0;try{const e=await X1(this.circle.id),i=new Z1(e,this.circle);this.circle.initiator=i,i.circle.addMember(i)}catch(e){vt(t("contacts","Unable to join the team")),console.error("Unable to join the circle",e)}finally{this.loadingJoin=!1}},confirmDeleteCircle(){window.OC.dialogs.confirmDestructive(t("contacts",`You are about to delete {circle}.
Are you sure?`,{circle:this.circle.displayName}),t("contacts","Please confirm team deletion"),window.OC.dialogs.YES_NO_BUTTONS,this.deleteCircle,!0)},async deleteCircle(e){if(!e){this.logger.debug("Circle deletion cancelled");return}this.loadingAction=!0;try{this.$store.dispatch("deleteCircle",this.circle.id)}catch{vt(t("contacts","Unable to delete the team"))}finally{this.loadingAction=!1}},async addMemberToCircle(){try{await this.$router.push(this.circle.router)}catch{}si("contacts:circles:append",this.circle.id)}}},vi="enforce_password",bi="password_single_enabled",Ji="password_single",l0={name:"CirclePasswordSettings",components:{CheckboxRadioSwitch:Yi,Button:ne},props:{circle:{type:Object,required:!0}},data(){return{ENFORCE_PASSWORD_PROTECTION:vi,USE_UNIQUE_PASSWORD:bi,UNIQUE_PASSWORD:Ji,loading:[],uniquePassword:"",uniquePasswordError:!1,showUniquePasswordInput:!1}},computed:{circleId(){return this.circle._data.id},enforcePasswordProtection(){const e=this.circle._data.settings[vi];return e==="1"||e==="true"},useUniquePassword(){const e=this.circle._data.settings[bi];return e==="1"||e==="true"}},methods:{async changePasswordProtection(){this.loading.push(vi);try{const e=!this.enforcePasswordProtection;!e&&this.useUniquePassword&&await this.saveUseUniquePassword(!1),!e&&this.showUniquePasswordInput&&(this.showUniquePasswordInput=!1),await this.$store.dispatch("editCircleSetting",{circleId:this.circleId,setting:{setting:vi,value:e.toString()}})}finally{this.loading=this.loading.filter(e=>e!==vi)}},async changeUseUniquePassword(){if(!this.useUniquePassword){this.showUniquePasswordInput=!this.showUniquePasswordInput;return}await this.saveUseUniquePassword(!this.useUniquePassword)},async saveUseUniquePassword(e){this.loading.push(bi);try{await this.$store.dispatch("editCircleSetting",{circleId:this.circleId,setting:{setting:bi,value:e.toString()}}),e||(this.uniquePassword="",this.showUniquePasswordInput=!1)}finally{this.loading=this.loading.filter(i=>i!==bi)}},async saveUniquePassword(){if(this.uniquePassword.length!==0){this.loading.push(Ji),this.uniquePasswordError=!1;try{this.useUniquePassword||await this.saveUseUniquePassword(!0),await this.$store.dispatch("editCircleSetting",{circleId:this.circleId,setting:{setting:Ji,value:this.uniquePassword}}),this.showUniquePasswordInput=!1,this.uniquePassword=""}catch{this.uniquePasswordError=!0}finally{this.loading=this.loading.filter(e=>e!==Ji)}}},onClickChangePassword(){this.showUniquePasswordInput=!0}}},c0={class:"circle-config"},d0={class:"circle-config__list"},u0={class:"unique-password"},h0=["disabled","placeholder"],p0={key:2,class:"unique-password-error"};function m0(e,i,o,r,a,s){const l=b("CheckboxRadioSwitch"),c=b("Button");return p(),C("ul",null,[T("li",c0,[T("ul",d0,[M(l,{"model-value":s.enforcePasswordProtection,loading:a.loading.includes(a.ENFORCE_PASSWORD_PROTECTION),disabled:a.loading.length>0,"wrapper-element":"li","onUpdate:modelValue":s.changePasswordProtection},{default:_(()=>[K(E(e.t("contacts","Enforce password protection on files shared to this team")),1)]),_:1},8,["model-value","loading","disabled","onUpdate:modelValue"]),s.enforcePasswordProtection?(p(),O(l,{key:0,"model-value":s.useUniquePassword||a.showUniquePasswordInput,loading:a.loading.includes(a.USE_UNIQUE_PASSWORD),disabled:a.loading.length>0,"wrapper-element":"li","onUpdate:modelValue":s.changeUseUniquePassword},{default:_(()=>[K(E(e.t("contacts","Use a unique password for all shares to this team")),1)]),_:1},8,["model-value","loading","disabled","onUpdate:modelValue"])):P("",!0),T("li",u0,[a.showUniquePasswordInput?(p(),C(mt,{key:0},[ue(T("input",{"onUpdate:modelValue":i[0]||(i[0]=d=>a.uniquePassword=d),disabled:a.loading.length>0,placeholder:e.t("contacts","Unique password …"),type:"text",onKeyup:i[1]||(i[1]=Ko((...d)=>s.saveUniquePassword&&s.saveUniquePassword(...d),["enter"]))},null,40,h0),[[In,a.uniquePassword]]),M(c,{variant:"tertiary-no-background",disabled:a.loading.length>0||a.uniquePassword.length===0,onClick:s.saveUniquePassword},{default:_(()=>[K(E(e.t("contacts","Save")),1)]),_:1},8,["disabled","onClick"])],64)):s.useUniquePassword?(p(),O(c,{key:1,class:"change-unique-password",onClick:s.onClickChangePassword},{default:_(()=>[K(E(e.t("contacts","Change unique password")),1)]),_:1},8,["onClick"])):P("",!0),a.uniquePasswordError?(p(),C("div",p0,E(e.t("contacts","Failed to save password. Please try again later.")),1)):P("",!0)])])])])}const f0=Q(l0,[["render",m0],["__scopeId","data-v-66930476"]]),g0={name:"ContentHeading",props:{loading:{type:Boolean,default:!1}}},y0={class:"app-content-heading"},v0={key:0,class:"app-content-heading__loader icon-loading-small"};function b0(e,i,o,r,a,s){return p(),C("h3",y0,[Tt(e.$slots,"default",{},void 0,!0),o.loading?(p(),C("div",v0)):P("",!0)])}const Lc=Q(g0,[["render",b0],["__scopeId","data-v-614dccab"]]),C0=ze({name:"CircleSettings",components:{ContentHeading:Lc,CirclePasswordSettings:f0,IconDelete:tn,IconLogout:Sc,NcButton:ne,NcCheckboxRadioSwitch:Yi},props:{circle:{type:Object,required:!0}},emits:["leave","delete"],setup(){return{t:Ni}},data(){return{PUBLIC_CIRCLE_CONFIG:J1,loading:!1}},methods:{isChecked(e){return(this.circle.config&e)!==0},async onChange(e,i){this.logger.debug(`Circle config ${e} is set to ${i}`),this.loading=e;const o=this.circle.config;i?e=o|e:e=o&~e;try{const r=await Gr(this.circle.id,Fr.Config,e);this.circle.config=r.config}catch(r){this.logger.error("Unable to edit circle config",{prevConfig:o,config:e,error:r}),vt(Ni("contacts","An error happened during the config change"))}finally{this.loading=!1}}}}),w0={class:"circle-settings"},k0={class:"circle-config__list"};function _0(e,i,o,r,a,s){const l=b("ContentHeading"),c=b("NcCheckboxRadioSwitch"),d=b("CirclePasswordSettings"),u=b("IconLogout"),m=b("NcButton"),y=b("IconDelete");return p(),C("div",w0,[T("ul",null,[(p(!0),C(mt,null,It(e.PUBLIC_CIRCLE_CONFIG,(v,w)=>(p(),C("li",{key:w,class:"circle-config"},[M(l,{class:"circle-config__title"},{default:_(()=>[K(E(w),1)]),_:2},1024),T("ul",k0,[(p(!0),C(mt,null,It(v,(D,S)=>(p(),O(c,{key:"circle-config"+S,checked:e.isChecked(S),loading:e.loading===S,disabled:e.loading!==!1,"wrapper-element":"li","onUpdate:checked":R=>e.onChange(S,R)},{default:_(()=>[K(E(D),1)]),_:2},1032,["checked","loading","disabled","onUpdate:checked"]))),128))])]))),128))]),M(d,{circle:e.circle},null,8,["circle"]),e.circle.canLeave?(p(),O(m,{key:0,type:"warning",onClick:i[0]||(i[0]=v=>e.$emit("leave"))},{icon:_(()=>[M(u,{size:16})]),default:_(()=>[K(" "+E(e.t("contacts","Leave team")),1)]),_:1})):P("",!0),e.circle.canDelete?(p(),O(m,{key:1,type:"error",href:"#",onClick:i[1]||(i[1]=Wt(v=>e.$emit("delete"),["prevent","stop"]))},{icon:_(()=>[M(y,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Delete team")),1)]),_:1})):P("",!0)])}const x0=Q(C0,[["render",_0],["__scopeId","data-v-48dd71ac"]]),S0={name:"CheckOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},M0=["aria-hidden","aria-label"],A0=["fill","width","height"],N0={d:"M19.78,2.2L24,6.42L8.44,22L0,13.55L4.22,9.33L8.44,13.55L19.78,2.2M19.78,5L8.44,16.36L4.22,12.19L2.81,13.55L8.44,19.17L21.19,6.42L19.78,5Z"},L0={key:0};function D0(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon check-outline-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",N0,[o.title?(p(),C("title",L0,E(o.title),1)):P("",!0)])],8,A0))],16,M0)}const I0=Q(S0,[["render",D0]]),O0={name:"CloseOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},T0=["aria-hidden","aria-label"],E0=["fill","width","height"],P0={d:"M3,16.74L7.76,12L3,7.26L7.26,3L12,7.76L16.74,3L21,7.26L16.24,12L21,16.74L16.74,21L12,16.24L7.26,21L3,16.74M12,13.41L16.74,18.16L18.16,16.74L13.41,12L18.16,7.26L16.74,5.84L12,10.59L7.26,5.84L5.84,7.26L10.59,12L5.84,16.74L7.26,18.16L12,13.41Z"},$0={key:0};function z0(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon close-outline-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",P0,[o.title?(p(),C("title",$0,E(o.title),1)):P("",!0)])],8,E0))],16,T0)}const H0=Q(O0,[["render",z0]]),B0={name:"ExitToAppIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},R0=["aria-hidden","aria-label"],V0=["fill","width","height"],U0={d:"M19,3H5C3.89,3 3,3.89 3,5V9H5V5H19V19H5V15H3V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M10.08,15.58L11.5,17L16.5,12L11.5,7L10.08,8.41L12.67,11H3V13H12.67L10.08,15.58Z"},Y0={key:0};function G0(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon exit-to-app-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",U0,[o.title?(p(),C("title",Y0,E(o.title),1)):P("",!0)])],8,V0))],16,R0)}const Dc=Q(B0,[["render",G0]]),F0={name:"ShieldCheckOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},W0=["aria-hidden","aria-label"],j0=["fill","width","height"],q0={d:"M21,11C21,16.55 17.16,21.74 12,23C6.84,21.74 3,16.55 3,11V5L12,1L21,5V11M12,21C15.75,20 19,15.54 19,11.22V6.3L12,3.18L5,6.3V11.22C5,15.54 8.25,20 12,21M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9"},X0={key:0};function Z0(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon shield-check-outline-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",q0,[o.title?(p(),C("title",X0,E(o.title),1)):P("",!0)])],8,j0))],16,W0)}const J0=Q(F0,[["render",Z0]]),vn={computed:{selectedContact(){return this.$route.params.selectedContact},selectedGroup(){return this.$route.params.selectedGroup},selectedCircle(){return this.$route.params.selectedCircle},selectedChart(){return this.$route.params.selectedChart}}},K0={name:"MemberGridItem",components:{NcAvatar:Bn,IconAccountGroupOutline:ir,NcActions:Hn,NcActionButton:gn,NcActionSeparator:Lm,NcActionText:La,IconDeleteOutline:tn,IconExitToApp:Dc,IconShieldCheckOutline:J0,IconCheckOutline:I0,IconCloseOutline:H0,NcButton:ne},mixins:[vn],props:{member:{type:Object,required:!0},isTeam:{type:Boolean,default:!1}},data(){return{loading:!1}},computed:{circle(){return this.$store.getters.getCircle(this.selectedCircle)},currentUserLevel(){return this.circle?.initiator?.level||ie.MEMBER},currentUserId(){return this.circle?.initiator?.singleId},availableLevelsChange(){const e=[];return this.member.level===ie.OWNER||this.isCurrentUser||(this.currentUserLevel>=ie.MODERATOR&&this.member.level!==ie.ADMIN&&e.push(ie.ADMIN),this.currentUserLevel>=ie.ADMIN&&(this.member.level!==ie.MODERATOR&&e.push(ie.MODERATOR),this.member.level!==ie.MEMBER&&e.push(ie.MEMBER)),this.circle.isOwner&&e.push(ie.OWNER)),e},isCurrentUser(){return this.member.id===this.currentUserId},isPendingApproval(){return this.member.level===ie.NONE&&this.member.status===K1.PENDING},canChangeLevel(){return this.circle.canManageMembers&&this.availableLevelsChange.length>0&&!this.isCurrentUser},canDelete(){return this.circle.canManageMembers&&this.member.level<=this.currentUserLevel&&!this.isCurrentUser},memberRole(){return!this.member.level||this.member.level===ie.NONE?null:yi[this.member.level]||null}},methods:{levelChangeLabel(e){return e===ie.OWNER?t("contacts","Promote as sole owner"):this.member.level<e?t("contacts","Promote to {level}",{level:yi[e]}):t("contacts","Demote to {level}",{level:yi[e]})},async deleteMember(){if(!this.isCurrentUser){await this.doDeleteMember();return}try{await new Q1().setName(t("contacts","Leave team")).setText(t("contacts","Are you sure you want to leave this team? This action cannot be undone.")).setButtons([{label:t("contacts","Cancel"),type:"secondary",callback:()=>{}},{label:t("contacts","Leave team"),type:"error",callback:async()=>{try{await this.doDeleteMember()}catch(e){this.logger.error("Error in delete member callback",{e}),vt(t("contacts","Leave team failed."))}}}]).build().show()}catch{}},async doDeleteMember(){this.loading=!0;try{await this.$store.dispatch("deleteMemberFromCircle",{member:this.member,leave:this.isCurrentUser})}catch(e){if(e?.response?.status===404){this.logger.debug("Member is not in circle");return}this.logger.error("Could not delete the member",{member:this.member,error:e}),vt(t("contacts","Could not delete the member {displayName}",this.member))}finally{this.loading=!1}},async changeLevel(e){this.loading=!0;try{if(await tm(this.circle.id,this.member.id,e),this.showLevelMenu=!1,e===ie.OWNER){await this.$store.dispatch("getCircle",this.circle.id),await this.$store.dispatch("getCircleMembers",this.circle.id);return}this.member.level=e}catch(i){this.logger.error("Could not change the member level",{level:yi[e],error:i}),vt(t("contacts","Could not change the member level to {level}",{level:yi[e]}))}finally{this.loading=!1}},async acceptMember(){this.loading=!0;try{await await this.$store.dispatch("acceptCircleMember",{circleId:this.circle.id,memberId:this.member.id})}catch(e){this.logger.error("Could not accept membership request",{member:this.member,error:e}),vt(t("contacts","Could not accept membership request"))}finally{this.loading=!1}}}},Q0={class:"member-grid-item"},tg={class:"member-info"},eg={class:"member-name"},ng={key:0,class:"member-role"},ig={key:2,class:"member-grid-item__actions"};function og(e,i,o,r,a,s){const l=b("IconAccountGroupOutline"),c=b("NcAvatar"),d=b("IconCheckOutline"),u=b("NcButton"),m=b("IconCloseOutline"),y=b("NcActionText"),v=b("IconShieldCheckOutline"),w=b("NcActionButton"),D=b("NcActionSeparator"),S=b("IconExitToApp"),R=b("IconDeleteOutline"),A=b("NcActions");return p(),C("div",Q0,[o.isTeam?(p(),O(c,{key:0,"display-name":o.member.displayName,"is-no-user":!0,size:32},{icon:_(()=>[M(l,{size:20})]),_:1},8,["display-name"])):(p(),O(c,{key:1,user:o.member.userId,"display-name":o.member.displayName,size:32},null,8,["user","display-name"])),T("div",tg,[T("span",eg,E(o.member.displayName),1),s.memberRole?(p(),C("span",ng,E(s.memberRole),1)):P("",!0)]),!a.loading&&s.isPendingApproval&&s.circle.canManageMembers?(p(),C("div",ig,[M(u,{"aria-label":e.t("contacts","Accept membership request"),onClick:s.acceptMember},{icon:_(()=>[M(d,{size:20})]),_:1},8,["aria-label","onClick"]),M(u,{"aria-label":e.t("contacts","Reject membership request"),onClick:s.deleteMember},{icon:_(()=>[M(m,{size:20})]),_:1},8,["aria-label","onClick"])])):(p(),O(A,{key:3},{default:_(()=>[a.loading?(p(),O(y,{key:0,icon:"icon-loading-small"},{default:_(()=>[K(E(e.t("contacts","Loading …")),1)]),_:1})):(p(),C(mt,{key:1},[s.canChangeLevel?(p(),C(mt,{key:0},[M(y,null,{icon:_(()=>[M(v,{size:16})]),default:_(()=>[K(E(e.t("contacts","Manage level"))+" ",1)]),_:1}),(p(!0),C(mt,null,It(s.availableLevelsChange,V=>(p(),O(w,{key:V,icon:"",onClick:W=>s.changeLevel(V)},{default:_(()=>[K(E(s.levelChangeLabel(V)),1)]),_:2},1032,["onClick"]))),128)),M(D)],64)):P("",!0),s.isCurrentUser&&!s.circle.isOwner?(p(),O(w,{key:1,onClick:s.deleteMember},{icon:_(()=>[M(S,{size:16})]),default:_(()=>[K(E(e.t("contacts","Leave team"))+" ",1)]),_:1},8,["onClick"])):s.canDelete?(p(),O(w,{key:2,onClick:s.deleteMember},{icon:_(()=>[M(R,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Remove member")),1)]),_:1},8,["onClick"])):P("",!0)],64))]),_:1}))])}const rg=Q(K0,[["render",og],["__scopeId","data-v-8a5fcb1e"]]),ei=null,{min:An,max:Ie,abs:Gs,floor:ag}=Math,Ic=(e,i,o)=>An(o,Ie(i,e)),Oc=e=>[...e].sort((i,o)=>i-o),Fs=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)},Ba=e=>{let i;return()=>(e&&(i=e(),e=void 0),i)},On=-1,Lo=(e,i,o)=>{const r=o?"unshift":"push";for(let a=0;a<i;a++)e[r](On);return e},Do=(e,i)=>{const o=e.t[i];return o===On?e.o:o},sg=(e,i,o)=>{const r=e.t[i]===On;return e.t[i]=o,e.i=An(i,e.i),r},mo=(e,i)=>{if(!e.l)return 0;if(e.i>=i)return e.u[i];e.i<0&&(e.u[0]=0,e.i=0);let o=e.i,r=e.u[o];for(;o<i;)r+=Do(e,o),e.u[++o]=r;return e.i=i,r},_n=(e,i,o=0,r=e.l-1)=>{for(;o<=r;){const a=ag((o+r)/2),s=mo(e,a);if(s<=i){if(s+Do(e,a)>i)return a;o=a+1}else r=a-1}return Ic(o,0,e.l-1)},Ws=(e,i,o)=>{const r=i-e.l;return e.i=o?-1:An(i-1,e.i),e.l=i,r>0?(Lo(e.u,r),Lo(e.t,r,o),e.o*r):(e.u.splice(r),(o?e.t.splice(0,-r):e.t.splice(r)).reduce((a,s)=>a-(s===On?e.o:s),0))},lg=typeof window<"u",Tc=()=>document.documentElement,cg=e=>e.ownerDocument,dg=e=>e.defaultView,Ec=Ba(()=>!!lg&&getComputedStyle(Tc()).direction==="rtl"),Pc=Ba(()=>/iP(hone|od|ad)/.test(navigator.userAgent)),ug=Ba(()=>"scrollBehavior"in Tc().style),hg=e=>!!e.p(),pg=(e,i=40,o=4,r=0,a,s=!1)=>{let l=!!r,c=1,d=0,u=0,m=0,y=0,v=0,w=0,D=0,S=0,R=l?[0,Ie(r-1,0)]:ei,A=[0,0],V=0;const W=((G,j)=>({o:j,t:Lo([],G),l:G,i:-1,u:Lo([],G)}))(e,i),it=new Set,et=()=>m-u,st=()=>et()+v+y,lt=G=>((j,I,Z,z)=>{if(z=An(z,j.l-1),mo(j,z)<=I){const tt=_n(j,I+Z,z);return[_n(j,I,z,tt),tt]}{const tt=_n(j,I,void 0,z);return[tt,_n(j,I+Z,tt)]}})(W,G,d,A[0]),ht=()=>(G=>G.l?mo(G,G.l-1)+Do(G,G.l-1):0)(W),rt=G=>mo(W,G)-v,dt=G=>Do(W,G),L=G=>{G&&(Pc()&&D!==0?v+=G:y+=G)};return{h:()=>c,m:()=>(G=>[G.t.slice(),G.o])(W),v:()=>{let G,j;return w?[G,j]=A:([G,j]=A=lt(Ie(0,st())),R&&(G=An(G,R[0]),j=Ie(j,R[1]))),D!==1&&(G-=Ie(0,o)),D!==2&&(j+=Ie(0,o)),[Ie(G,0),An(j,W.l-1)]},S:()=>_n(W,st()),I:()=>_n(W,st()+d),k:G=>W.t[G]===On,O:()=>!!R&&W.t.slice(Ie(0,R[0]-1),An(W.l-1,R[1]+1)+1).includes(On),j:rt,T:dt,B:()=>W.l,q:()=>m,P:()=>D!==0,p:()=>d,R:()=>u,M:ht,N:()=>(w=y,y=0,[w,S===2||et()+d>=ht()]),A:(G,j)=>{const I=[G,j];return it.add(I),()=>{it.delete(I)}},H:(G,j)=>{let I,Z,z=0;switch(G){case 1:{const tt=w;w=0;const at=j-m,ct=Gs(at);tt&&ct<Gs(tt)+1||S!==0||(D=at<0?2:1),l&&(R=ei,l=!1),m=j,z=4;const Y=et();Y>=-d&&Y<=ht()&&(z+=1,Z=ct>d);break}case 2:z=8,D!==0&&(I=!0,z+=1),D=0,S=0,R=ei;break;case 3:{const tt=j.filter(([at,ct])=>W.t[at]!==ct);if(!tt.length)break;L(tt.reduce((at,[ct,Y])=>((S===2||(R?!l&&ct<R[0]:rt(ct)+(D===0&&S===0?dt(ct):0)<et()))&&(at+=Y-dt(ct)),at),0));for(const[at,ct]of tt){const Y=dt(at),gt=sg(W,at,ct);s&&(V+=gt?ct:ct-Y)}s&&d&&V>d&&(L(((at,ct)=>{let Y=0;const gt=[];at.t.forEach((jt,oe)=>{jt!==On&&(gt.push(jt),oe<ct&&Y++)}),at.i=-1;const St=Oc(gt),Ht=St.length,Ot=Ht/2|0,Gt=Ht%2==0?(St[Ot-1]+St[Ot])/2:St[Ot],Qt=at.o;return((at.o=Gt)-Qt)*Ie(ct-Y,0)})(W,_n(W,st()))),s=!1),z=3,Z=!0;break}case 4:d!==j&&(d=j,z=3);break;case 5:j[1]?(L(Ws(W,j[0],!0)),S=2,z=1):(Ws(W,j[0]),z=1);break;case 6:u=j;break;case 7:S=1;break;case 8:R=lt(j),z=1}z&&(c=1+(2147483647&c),I&&v&&(y+=v,v=0),it.forEach(([tt,at])=>{z&tt&&at(Z)}))}}},qr=setTimeout,fo=(e,i)=>i&&Ec()?-e:e,mg=(e,i,o,r,a,s)=>{const l=Date.now;let c=0,d=!1,u=!1,m=!1,y=!1;const v=(()=>{let A;const V=()=>{A!=ei&&clearTimeout(A)},W=()=>{V(),A=qr(()=>{A=ei,(()=>{if(d||u)return d=!1,void v();m=!1,e.H(2)})()},150)};return W.V=V,W})(),w=()=>{c=l(),m&&(y=!0),e.H(1,r()),v()},D=A=>{if(d||!e.P()||A.ctrlKey)return;const V=l()-c;150>V&&50<V&&(o?A.deltaX:A.deltaY)&&(d=!0)},S=()=>{u=!0,m=y=!1},R=()=>{u=!1,Pc()&&(m=!0)};return i.addEventListener("scroll",w),i.addEventListener("wheel",D,{passive:!0}),i.addEventListener("touchstart",S,{passive:!0}),i.addEventListener("touchend",R,{passive:!0}),{C:()=>{i.removeEventListener("scroll",w),i.removeEventListener("wheel",D),i.removeEventListener("touchstart",S),i.removeEventListener("touchend",R),v.V()},F:()=>{const[A,V]=e.N();A&&(a(fo(A,o),V,y),y=!1,V&&e.p()>e.M()&&e.H(1,r()))}}},fg=e=>{let i;return{J(o){(i||(i=new(dg(cg(o))).ResizeObserver(e))).observe(o)},L(o){i.unobserve(o)},C(){i&&i.disconnect()}}},gg=ze({props:{W:{type:Object,required:!0},X:{type:Object,required:!0},Y:{type:Object,required:!0},U:{type:Function,required:!0},D:{type:Number,required:!0},G:{type:Boolean},K:{type:Boolean},Z:{type:String,required:!0},ee:Object},setup(e){const i=$e(),o=Xt(()=>e.W.value&&e.X.j(e.D)),r=Xt(()=>e.W.value&&e.X.k(e.D));return qe(()=>i.value&&e.D,(a,s,l)=>{l(e.U(i.value,e.D))},{flush:"post"}),()=>{var a;const{Y:s,G:l,K:c,Z:d}=e,u=r.value,{style:m,...y}=(a=e.ee)!==null&&a!==void 0?a:{},v={position:u&&c?void 0:"absolute",[l?"height":"width"]:"100%",[l?"top":"left"]:"0px",[l?Ec()?"right":"left":"top"]:o.value+"px",visibility:!u||c?"visible":"hidden",...m};return l&&(v.display="flex"),M(d,pt({ref:i,style:v},y),typeof(w=s)=="function"||Object.prototype.toString.call(w)==="[object Object]"&&!Xo(w)?s:{default:()=>[s],_:2},16,["style"]);var w}}}),yg=(e,i)=>e.key??"_"+i,vg=(e,i)=>e[0]===i[0]&&e[1]===i[1],bg=ze({props:{data:{type:Array,required:!0},overscan:Number,itemSize:Number,shift:Boolean,horizontal:Boolean,startMargin:{type:Number,default:0},ssrCount:Number,scrollRef:Object,as:{type:String,default:"div"},item:{type:String,default:"div"},itemProps:Function,keepMounted:Array},emits:["scroll","scrollEnd"],setup(e,{emit:i,expose:o,slots:r}){let a=!!e.ssrCount;const s=e.horizontal,l=$e(),c=pg(e.data.length,e.itemSize,e.overscan,e.ssrCount,0,!e.itemSize),d=((A,V)=>{let W;const it=V?"width":"height",et=new WeakMap,st=fg(lt=>{const ht=[];for(const{target:rt,contentRect:dt}of lt)if(rt.offsetParent)if(rt===W)A.H(4,dt[it]);else{const L=et.get(rt);L!=ei&&ht.push([L,dt[it]])}ht.length&&A.H(3,ht)});return{te(lt){st.J(W=lt)},re:(lt,ht)=>(et.set(lt,ht),st.J(lt),()=>{et.delete(lt),st.L(lt)}),oe:st.C}})(c,s),u=((A,V)=>{let W,it,et;const st=V?"scrollLeft":"scrollTop",lt=V?"overflowX":"overflowY",ht=async(rt,dt)=>{if(!W)return void Fs(()=>ht(rt,dt));et&&et();const L=()=>{let G;return[new Promise((j,I)=>{G=j,et=I,hg(A)&&qr(I,150)}),A.A(2,()=>{G&&G()})]};if(dt&&ug()){for(;A.H(8,rt()),A.O();){const[G,j]=L();try{await G}catch{return}finally{j()}}W.scrollTo({[V?"left":"top"]:fo(rt(),V),behavior:"smooth"})}else for(;;){const[G,j]=L();try{W[st]=fo(rt(),V),A.H(7),await G}catch{return}finally{j()}}};return{ne(rt){W=rt,it=mg(A,rt,V,()=>fo(rt[st],V),(dt,L,G)=>{if(G){const j=rt.style,I=j[lt];j[lt]="hidden",qr(()=>{j[lt]=I})}L?(rt[st]=A.q()+dt,et&&et()):rt[st]+=dt})},oe(){it&&it.C()},se(rt){ht(()=>rt)},ie(rt){rt+=A.q(),ht(()=>rt)},le(rt,{align:dt,smooth:L,offset:G=0}={}){if(rt=Ic(rt,0,A.B()-1),dt==="nearest"){const j=A.j(rt),I=A.q();if(j<I)dt="start";else{if(!(j+A.T(rt)>I+A.p()))return;dt="end"}}ht(()=>G+A.R()+A.j(rt)+(dt==="end"?A.T(rt)-A.p():dt==="center"?(A.T(rt)-A.p())/2:0),L)},ce:()=>{it&&it.F()}}})(c,s),m=$e(c.h()),y=c.A(1,()=>{m.value=c.h()}),v=c.A(4,()=>{i("scroll",c.q())}),w=c.A(8,()=>{i("scrollEnd")}),D=Xt(A=>{m.value;const V=c.v();return A&&vg(A,V)?A:V}),S=Xt(()=>m.value&&c.P()),R=Xt(()=>m.value&&c.M());return Jo(()=>{a=!1,Fs(()=>{const A=V=>{d.te(V),u.ne(V)};e.scrollRef?A(e.scrollRef):A(l.value.parentElement)})}),ec(()=>{y(),v(),w(),d.oe(),u.oe()}),qe(()=>e.data.length,A=>{c.H(5,[A,e.shift])}),qe(()=>e.startMargin,A=>{c.H(6,A)},{immediate:!0}),qe([m],()=>{u.ce()},{flush:"post"}),o({get scrollOffset(){return c.q()},get scrollSize(){return(A=>Ie(A.M(),A.p()))(c)},get viewportSize(){return c.p()},findStartIndex:c.S,findEndIndex:c.I,getItemOffset:c.j,getItemSize:c.T,scrollToIndex:u.le,scrollTo:u.se,scrollBy:u.ie}),()=>{const A=e.as,V=e.item,[W,it]=D.value,et=R.value,st=[];function lt(rt){var dt;const L=r.default({item:e.data[rt],index:rt})[0];return M(gg,{key:yg(L,rt),W:m,X:c,U:d.re,D:rt,Y:L,G:s,K:a,Z:V,ee:(dt=e.itemProps)===null||dt===void 0?void 0:dt.call(e,{item:e.data[rt],index:rt})},null,8,["W","X","U","D","Y","G","K","Z","ee"])}for(let rt=W,dt=it;rt<=dt;rt++)st.push(lt(rt));if(e.keepMounted){const rt=[],dt=[];Oc(e.keepMounted).forEach(L=>{L<W&&rt.push(lt(L)),L>it&&dt.push(lt(L))}),st.unshift(...rt),st.push(...dt)}return M(A,{ref:l,style:{overflowAnchor:"none",flex:"none",position:"relative",visibility:"hidden",width:s?et+"px":"100%",height:s?"100%":et+"px",pointerEvents:S.value?"none":void 0}},typeof(ht=st)=="function"||Object.prototype.toString.call(ht)==="[object Object]"&&!Xo(ht)?st:{default:()=>[st],_:2},8,["style"]);var ht}}}),$c=ze({props:{data:{type:Array,required:!0},overscan:Number,itemSize:Number,shift:Boolean,horizontal:Boolean,ssrCount:Number,itemProps:Function,keepMounted:Array},emits:["scroll","scrollEnd"],setup(e,{emit:i,expose:o,slots:r}){const a=e.horizontal,s=d=>{i("scroll",d)},l=()=>{i("scrollEnd")},c=$e();return o({get scrollOffset(){return c.value.scrollOffset},get scrollSize(){return c.value.scrollSize},get viewportSize(){return c.value.viewportSize},findStartIndex:(...d)=>c.value.findStartIndex(...d),findEndIndex:(...d)=>c.value.findEndIndex(...d),getItemOffset:(...d)=>c.value.getItemOffset(...d),getItemSize:(...d)=>c.value.getItemSize(...d),scrollToIndex:(...d)=>c.value.scrollToIndex(...d),scrollTo:(...d)=>c.value.scrollTo(...d),scrollBy:(...d)=>c.value.scrollBy(...d)}),()=>{return M("div",{style:{display:a?"inline-block":"block",[a?"overflowX":"overflowY"]:"auto",contain:"strict",width:"100%",height:"100%"}},[M(bg,{ref:c,data:e.data,overscan:e.overscan,itemSize:e.itemSize,itemProps:e.itemProps,shift:e.shift,ssrCount:e.ssrCount,horizontal:a,keepMounted:e.keepMounted,onScroll:s,onScrollEnd:l},(d=r,typeof d=="function"||Object.prototype.toString.call(d)==="[object Object]"&&!Xo(d)?r:{default:()=>[r],_:2}),8,["data","overscan","itemSize","itemProps","shift","ssrCount","horizontal","keepMounted","onScroll","onScrollEnd"])],4);var d}}}),Cg={name:"MagnifyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},wg=["aria-hidden","aria-label"],kg=["fill","width","height"],_g={d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"},xg={key:0};function Sg(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon magnify-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",_g,[o.title?(p(),C("title",xg,E(o.title),1)):P("",!0)])],8,kg))],16,wg)}const Mg=Q(Cg,[["render",Sg]]),Ag={name:"EntityBubble",components:{UserBubble:za},props:{id:{type:String,required:!0},label:{type:String,required:!0},type:{type:String,required:!0}},methods:{onDelete(){this.$emit("delete",{id:this.id,type:this.type})}}},Ng=["title"];function Lg(e,i,o,r,a,s){const l=b("UserBubble");return p(),O(l,{class:"entity-picker__bubble",margin:0,size:22,"display-name":o.label},{name:_(()=>[T("a",{href:"#",title:e.t("contacts","Remove {type}",{type:o.type}),class:"entity-picker__bubble-delete icon-close",onClick:i[0]||(i[0]=(...c)=>s.onDelete&&s.onDelete(...c))},null,8,Ng)]),_:1},8,["display-name"])}const Dg=Q(Ag,[["render",Lg],["__scopeId","data-v-5c279f5d"]]),Ig={name:"EntitySearchResult",components:{UserBubble:za},props:{source:{type:Object,default(){return{}}},onClick:{type:Function,default(){}},selection:{type:Object,default:()=>({})}},computed:{isSelected(){return this.source.id in this.selection}}};function Og(e,i,o,r,a,s){const l=b("UserBubble");return o.source.heading?(p(),C("h4",{key:o.source.id,class:"entity-picker__option-caption"},E(e.t("contacts","Add {type}",{type:o.source.label.toLowerCase()})),1)):(p(),O(l,{key:1,class:Kt(["entity-picker__bubble",{"entity-picker__bubble--selected":s.isSelected}]),"display-name":o.source.label,user:o.source.user,margin:6,size:44,url:"#",onClick:i[0]||(i[0]=Wt(c=>o.onClick(o.source),["stop","prevent"]))},{title:_(()=>i[1]||(i[1]=[T("span",{class:"entity-picker__bubble-checkmark icon-checkmark"},null,-1)])),_:1},8,["class","display-name","user"]))}const Tg=Q(Ig,[["render",Og],["__scopeId","data-v-bc6ac935"]]),Eg={name:"EntityPicker",components:{Button:ne,EmptyContent:fn,EntityBubble:Dg,IconAccountPlusOutline:Mc,IconSearch:Mg,IconLoading:me,Modal:yn,VList:$c,EntitySearchResult:Tg},props:{loading:{type:Boolean,default:!1},dataTypes:{type:Array,required:!0,validator:e=>{const i=e.filter(o=>!o.id&&!o.label);return i.length>0?(console.error("The following types MUST have a proper id and label key",i),!1):!0}},dataSet:{type:Array,required:!0,validator:e=>(e.forEach(i=>{(!i.id||!i.label)&&console.error("The following source MUST have a proper id and label key",i)}),!0)},sort:{type:String,default:"label"},confirmLabel:{type:String,default:t("contacts","Add to group")},internalSearch:{type:Boolean,default:!0},selection:{type:Object,default:null},emptyDataSetDescription:{type:String,default:""}},data(){return{canInviteGuests:!!window?.OCA?.Guests?.openGuestDialog,searchQuery:"",localSelection:{}}},computed:{selectionSet:{get(){return this.selection!==null?this.selection:this.localSelection},set(e){this.selection!==null&&this.$emit("update:selection",e),this.localSelection=e}},isSingleType(){return!(this.dataTypes.length>1)},isEmptySelection(){return Object.keys(this.selectionSet).length===0},searchPlaceholderTypes(){return`${this.dataTypes.map(e=>e.label).join(", ")}…`},searchSet(){return this.internalSearch&&this.searchQuery&&this.searchQuery.trim!==""?this.dataSet.filter(e=>e.label.toLowerCase().indexOf(this.searchQuery.toLowerCase())>-1):this.dataSet},availableEntities(){return this.isSingleType?this.searchSet:this.dataTypes.map(e=>{const i=this.searchSet.filter(r=>r.type===e.id),o=[{id:e.id,label:e.label,heading:!0},...i];return i.length===0?[]:o}).flat()}},mounted(){this.$nextTick(()=>{this.$refs.input.focus(),this.$refs.input.select()}),this.canInviteGuests&&No("guests:user:created",this.addGuest)},methods:{onCancel(){this.$emit("close")},onSubmit(){this.$emit("submit",Object.values(this.selectionSet))},onSearch:dc(function(){this.$emit("search",this.searchQuery)},200),onDelete(e){delete this.selectionSet[e.id],console.debug("Removing entity from selection",e)},onClick(e){if(e.id in this.selectionSet){delete this.selectionSet[e.id],console.debug("Removed entity to selection",e);return}this.selectionSet[e.id]=e,console.debug("Added entity to selection",e)},onToggle(e){e.id in this.selectionSet?this.onDelete(e):this.onPick(e)},onGuestButtonClick(){this.canInviteGuests&&window?.OCA?.Guests?.openGuestDialog("contacts")}}},Pg={class:"entity-picker"},$g={class:"entity-picker__heading"},zg={class:"entity-picker__title"},Hg={class:"entity-picker__search-container"},Bg={class:"entity-picker__search"},Rg=["placeholder"],Vg={class:"entity-picker__navigation"},Ug=["disabled"],Yg=["disabled"];function Gg(e,i,o,r,a,s){const l=b("IconAccountPlusOutline"),c=b("Button"),d=b("IconLoading"),u=b("EmptyContent"),m=b("EntityBubble"),y=b("IconSearch"),v=b("EntitySearchResult"),w=b("VList"),D=b("Modal");return p(),O(D,{size:"normal",onClose:s.onCancel},{default:_(()=>[T("div",Pg,[T("div",$g,[T("h2",zg,E(e.t("contacts","Invite members to team")),1)]),T("div",Hg,[T("div",Bg,[i[4]||(i[4]=T("div",{class:"entity-picker__search-icon icon-search"},null,-1)),ue(T("input",{ref:"input","onUpdate:modelValue":i[0]||(i[0]=S=>a.searchQuery=S),placeholder:e.t("contacts","Search {types}",{types:s.searchPlaceholderTypes}),class:"entity-picker__search-input",type:"search",onInput:i[1]||(i[1]=(...S)=>s.onSearch&&s.onSearch(...S))},null,40,Rg),[[In,a.searchQuery]])]),a.canInviteGuests?(p(),O(c,{key:0,type:"button",variant:"tertiary-no-background",title:e.t("contacts","Add guest"),"aria-label":e.t("contacts","Add guest"),onClick:s.onGuestButtonClick},{default:_(()=>[M(l,{size:20})]),_:1},8,["title","aria-label","onClick"])):P("",!0)]),o.loading?(p(),O(u,{key:0,name:e.t("contacts","Loading …")},{icon:_(()=>[M(d,{size:20})]),_:1},8,["name"])):(p(),C(mt,{key:1},[Object.keys(s.selectionSet).length>0?(p(),O(ql,{key:0,name:"zoom",tag:"ul",class:"entity-picker__selection"},{default:_(()=>[(p(!0),C(mt,null,It(s.selectionSet,S=>(p(),O(m,pt({key:S.key||`entity-${S.type}-${S.id}`},{ref_for:!0},S,{onDelete:R=>s.onDelete(S)}),null,16,["onDelete"]))),128))]),_:1})):P("",!0),o.dataSet.length===0?(p(),O(u,{key:1,name:e.t("contacts","Search for people to add"),description:o.emptyDataSetDescription},{icon:_(()=>[M(y,{size:20})]),_:1},8,["name","description"])):s.searchSet.length>0&&s.availableEntities.length>0?(p(),O(w,{key:2,class:"entity-picker__options",data:s.availableEntities},{default:_(({item:S})=>[(p(),O(v,{key:S.id,source:S,selection:s.selectionSet,"on-click":s.onClick},null,8,["source","selection","on-click"]))]),_:1},8,["data"])):a.searchQuery?(p(),O(u,{key:3,name:e.t("contacts","No results")},{icon:_(()=>[M(y,{size:20})]),_:1},8,["name"])):P("",!0),T("div",Vg,[T("button",{disabled:o.loading,class:"navigation__button-left",onClick:i[2]||(i[2]=(...S)=>s.onCancel&&s.onCancel(...S))},E(e.t("contacts","Cancel")),9,Ug),T("button",{disabled:s.isEmptySelection||o.loading,class:"navigation__button-right primary",onClick:i[3]||(i[3]=(...S)=>s.onSubmit&&s.onSubmit(...S))},E(o.confirmLabel),9,Yg)])],64))])]),_:1},8,["onClose"])}const zc=Q(Eg,[["render",Gg],["__scopeId","data-v-f631529b"]]),Hc=Object.keys(Wr),Fg=parseInt(window.OC.config["sharing.maxAutocompleteResults"],10)||25,js=async function(e){const i=await xe.get(Aa("apps/files_sharing/api/v1/sharees"),{params:{format:"json",itemType:"contacts",search:e,perPage:Fg,shareType:Hc,lookup:!1}}),o=i.data.ocs.data,r=i.data.ocs.data.exact;o.exact=[];const a=Object.values(r).reduce((y,v)=>y.concat(v),[]),s=Object.values(o).reduce((y,v)=>y.concat(v),[]),l=a.filter(y=>typeof y=="object").map(y=>Xr(y)).sort((y,v)=>y.shareType-v.shareType),c=s.filter(y=>typeof y=="object").map(y=>Xr(y)).sort((y,v)=>y.shareType-v.shareType),d=l.concat(c),u=d.reduce((y,v)=>(v.displayName&&(y[v.displayName]||(y[v.displayName]=0),y[v.displayName]++),y),{}),m=d.map(y=>u[y.displayName]>1&&!y.desc?{...y,desc:y.shareWithDisplayNameUnique}:y);return console.info("suggestions",m),m},Wg=async function(){const e=(await xe.get(Aa("apps/files_sharing/api/v1/sharees_recommended"),{params:{format:"json",itemType:"contacts",shareType:Hc}})).data.ocs.data.exact,i=Object.values(e).reduce((o,r)=>o.concat(r),[]).map(o=>Xr(o));return console.info("recommendations",i),i},Xr=function(e){const i=`picker-${e.value.shareType}`;return{label:e.label,id:`${i}-${e.value.shareWith}`,user:[window.OC.Share.SHARE_TYPE_USER,window.OC.Share.SHARE_TYPE_REMOTE].indexOf(e.value.shareType)>-1?e.value.shareWith:null,type:i,...e.value}},jg=ze({name:"MemberList",components:{EntityPicker:zc,IconContact:Vn,MemberGridItem:rg,NcEmptyContent:fn},mixins:[er,vn],props:{list:{type:Array,required:!0},loading:{type:Boolean,default:!1}},data(){return{pickerLoading:!1,showPicker:!1,showPickerIntro:!0,recommendations:[],pickerCircle:null,pickerData:[],pickerSelection:{},pickerTypes:em}},computed:{circle(){return this.$store.getters.getCircle(this.selectedCircle)},filteredPickerData(){return this.pickerData.filter(e=>{const i=Wr[e.shareType],o=this.list.filter(({userType:r})=>r===i);return o?o.find(r=>r.userId===e.shareWith)===void 0:!0})},flatList(){const e=this.list.filter(o=>!o.isUser),i=this.list.filter(o=>o.isUser);return[...e,...i]},hasMembers(){return this.flatList.length>0}},mounted(){No("contacts:circles:append",this.onShowPicker),No("guests:user:created",this.onGuestCreated)},methods:{async onShowPicker(e){this.showPicker=!0,this.pickerLoading=!0,this.pickerCircle=e;try{const i=await Wg();this.recommendations=i,this.pickerData=i}catch(i){console.error("Unable to get the recommendations list",i)}finally{this.pickerLoading=!1}},async onSearch(e){if(e.trim()===""){this.pickerData=this.recommendations;return}this.pickerLoading=!0;try{const i=await js(e);this.pickerData=i}catch(i){console.error("Unable to get the results",i),vt(Ni("contacts","Unable to get the results"))}finally{this.pickerLoading=!1}},async onPickerPick(e){this.logger.info("Adding selection to circle",{selection:e,pickerCircle:this.pickerCircle}),this.pickerLoading=!0,e=e.map(i=>({id:i.shareWith,type:Wr[i.shareType]}));try{if((await this.$store.dispatch("addMembersToCircle",{circleId:this.pickerCircle,selection:e})).length<e.length){nm(Ni("contacts","Some members could not be added")),this.pickerSelection={};return}this.resetPicker()}catch(i){vt(Ni("contacts","There was an issue adding members to the team")),console.error("There was an issue adding members to the circle",this.pickerCircle,i)}finally{this.pickerLoading=!1}},resetPicker(){this.showPicker=!1,this.pickerCircle=null,this.pickerData=[],this.pickerSelection={}},async onGuestCreated(e){const i=await js(e.username);this.$refs.entityPicker.onClick(i[0])}}}),qg={class:"member-list"},Xg={key:3,class:"member-grid"};function Zg(e,i,o,r,a,s){const l=b("IconLoading"),c=b("NcEmptyContent"),d=b("IconContact"),u=b("MemberGridItem"),m=b("EntityPicker");return p(),C("section",qg,[e.loading?(p(),O(c,{key:0,class:"empty-content",name:e.t("contacts","Loading members list …")},{icon:_(()=>[M(l,{size:20})]),_:1},8,["name"])):e.circle.isMember?e.hasMembers?(p(),C("div",Xg,[(p(!0),C(mt,null,It(e.flatList,y=>(p(),O(u,{key:`member-grid-item-${y.id}`,member:y,"is-team":!y.isUser},null,8,["member","is-team"]))),128))])):(p(),O(c,{key:2,class:"empty-content",name:e.t("contacts","You currently have no access to the member list")},{icon:_(()=>[M(d,{size:20})]),_:1},8,["name"])):(p(),O(c,{key:1,class:"empty-content",name:e.t("contacts","The list of members is only visible to members of this team")},{icon:_(()=>[M(d,{size:20})]),_:1},8,["name"])),e.showPicker?(p(),O(m,{key:4,ref:"entityPicker",selection:e.pickerSelection,"onUpdate:selection":i[0]||(i[0]=y=>e.pickerSelection=y),"confirm-label":e.t("contacts","Add to {circle}",{circle:e.circle.displayName}),"data-types":e.pickerTypes,"data-set":e.filteredPickerData,"internal-search":!1,loading:e.pickerLoading,onClose:e.resetPicker,onSearch:e.onSearch,onSubmit:e.onPickerPick},null,8,["selection","confirm-label","data-types","data-set","loading","onClose","onSearch","onSubmit"])):P("",!0)])}const Jg=Q(jg,[["render",Zg],["__scopeId","data-v-89dd26db"]]),Kg={name:"CircleDetails",components:{AccountPlusIcon:Mc,Avatar:Bn,Button:ne,ContentHeading:Lc,ListItem:kc,CogIcon:Ha,CopyIcon:mc,IconAccountGroup:ir,FileDocumentOutline:s0,LoginIcon:Uf,LogoutIcon:Sc,MemberList:Jg,CircleSettings:x0,NcEmptyContent:fn,NcLoadingIcon:me,NcPopover:cc,PencilIcon:Ea,UserBubble:za,NcTextField:uc,NcTextArea:im},mixins:[Nc],setup(){const e=$e(),{width:i}=Lf(e);return{avatarList:e,width:i}},data(){return{active:!1,isEditing:!1,showMembersModal:!1,loading:!1,loadingJoin:!1,loadingLeave:!1,loadingName:!1,loadingDescription:!1,isSettingsPopoverShown:!1,resources:[],originalDisplayName:"",originalDescription:""}},computed:{descriptionPlaceholder(){return this.circle.description.trim()===""?t("contacts","There is no description for this team"):t("contacts","Enter a description for the team")},isEmptyDescription(){return this.circle.description.trim()===""},showDescription(){return this.circle.isOwner?!0:!this.isEmptyDescription},members(){return Object.values(this.$store.getters.getCircle(this.circle.id)?.members||[])},circleUrl(){return window.location.href},canManageTeam(){return(this.circle.isOwner||this.circle.isAdmin)&&!this.circle.isPersonal},maxMembers(){const e=parseInt(window.getComputedStyle(document.body).getPropertyValue("--default-clickable-area"))+12,i=Math.floor(this.width/e);return this.members.length>i?i-1:i},memberLimit(){return Math.min(this.members.length,this.maxMembers)},membersLimited(){return this.members.slice(0,this.memberLimit)},hasExtraMembers(){return this.members.length>this.maxMembers},groupedResources(){return this.resources.reduce((e,i)=>{const o=i.provider.id;return e[o]||(e[o]={name:i.provider.name,resources:[]}),e[o].resources.push(i),e},{})},resourcesForProvider(){return e=>this.resources?.filter(i=>i.provider.id===e)??[]}},watch:{"circle.id":{handler(){this.fetchTeamResources()},immediate:!0}},methods:{addMembers(){this.$refs.memberList.onShowPicker(this.circle.id)},onLeave(){this.isSettingsPopoverShown=!1,this.confirmLeaveCircle()},onDelete(){this.isSettingsPopoverShown=!1,this.confirmDeleteCircle()},startEditing(){this.originalDisplayName=this.circle.displayName,this.originalDescription=this.circle.description,this.isEditing=!0},cancelEditing(){this.circle.displayName=this.originalDisplayName,this.circle.description=this.originalDescription,this.isEditing=!1},async fetchTeamResources(){const e=await xe.get(Aa(`/teams/${this.circle.id}/resources`));this.resources=e.data.ocs.data.resources,console.debug("Team resources",this.resources)},onAutocomplete(e,i){i([])},async saveChanges(){const e=[];if(this.circle.displayName!==this.originalDisplayName){this.loadingName=!0;try{await Gr(this.circle.id,Fr.Name,this.circle.displayName),this.originalDisplayName=this.circle.displayName}catch(i){console.error("Unable to edit name",this.circle.displayName,i),e.push("name"),this.circle.displayName=this.originalDisplayName}finally{this.loadingName=!1}}if(this.circle.description!==this.originalDescription){this.loadingDescription=!0;try{await Gr(this.circle.id,Fr.Description,this.circle.description),this.originalDescription=this.circle.description}catch(i){console.error("Unable to edit team description",this.circle.description,i),e.push("description"),this.circle.description=this.originalDescription}finally{this.loadingDescription=!1}}if(e.length>0){const i=e.join(" and ");vt(t("contacts","An error happened while saving {fields}",{fields:i}));return}this.isEditing=!1}}},Qg={class:"circle-details-container"},ty={class:"circle-details__header-wrapper"},ey={class:"circle-details-grid__avatar"},ny={class:"circle-details__header"},iy={class:"circle-name-wrapper"},oy={key:0,class:"circle-name"},ry=["title"],ay={key:0,class:"subtitle"},sy={key:1,class:"circle-description-wrapper"},ly={key:0,class:"circle-description"},cy={class:"actions"},dy={class:"circle-details__main-content"},uy={key:1},hy={class:"section-header"},py={class:"item-list"},my=["innerHTML"],fy=["src"],gy={class:"circle-details-section"},yy={class:"member-section-layout"},vy={class:"section-header"};function by(e,i,o,r,a,s){const l=b("Avatar"),c=b("NcLoading"),d=b("NcTextField"),u=b("UserBubble"),m=b("NcTextArea"),y=b("PencilIcon"),v=b("Button"),w=b("CopyIcon"),D=b("CogIcon"),S=b("CircleSettings"),R=b("NcPopover"),A=b("LoginIcon"),V=b("LogoutIcon"),W=b("NcLoadingIcon"),it=b("NcEmptyContent"),et=b("IconAccountGroup"),st=b("ContentHeading"),lt=b("FileDocumentOutline"),ht=b("ListItem"),rt=b("AccountPlusIcon"),dt=b("MemberList");return p(),C("div",Qg,[T("div",{class:Kt(["circle-details-grid",{"is-editing":a.isEditing}])},[T("div",ty,[T("div",ey,[M(l,{"disable-tooltip":!0,"display-name":e.circle.displayName,"is-no-user":!0,size:75},null,8,["display-name"])]),T("div",ny,[T("div",iy,[a.isEditing?(p(),O(d,{key:1,modelValue:e.circle.displayName,"onUpdate:modelValue":i[0]||(i[0]=L=>e.circle.displayName=L),placeholder:e.t("contacts","Team name"),label:"Team name"},null,8,["modelValue","placeholder"])):(p(),C("h2",oy,[T("span",{title:e.circle.displayName},E(e.circle.displayName),9,ry),a.loadingName?(p(),O(c,{key:0,size:24})):P("",!0)]))]),a.isEditing?P("",!0):(p(),C("div",ay,[T("span",null,E(e.t("files","Team owner")),1),i[5]||(i[5]=K()),M(u,{user:e.circle.owner.userId,"display-name":e.circle.isOwner?"you":e.circle.owner.displayName},null,8,["user","display-name"])])),s.showDescription?(p(),C("div",sy,[a.isEditing?(p(),O(m,{key:1,modelValue:e.circle.description,"onUpdate:modelValue":i[1]||(i[1]=L=>e.circle.description=L),placeholder:s.descriptionPlaceholder,label:"Description",maxlength:1024},null,8,["modelValue","placeholder"])):(p(),C("div",ly,E(e.circle.description),1))])):P("",!0),T("div",cy,[a.isEditing?(p(),C(mt,{key:1},[M(v,{variant:"secondary",onClick:s.cancelEditing},{default:_(()=>[K(E(e.t("contacts","Cancel")),1)]),_:1},8,["onClick"]),M(v,{variant:"primary",onClick:s.saveChanges},{default:_(()=>[K(E(e.t("contacts","Save")),1)]),_:1},8,["onClick"])],64)):(p(),C(mt,{key:0},[s.canManageTeam?(p(),O(v,{key:0,variant:"primary",onClick:s.startEditing},{icon:_(()=>[M(y,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Edit")),1)]),_:1},8,["onClick"])):P("",!0),M(v,{variant:"secondary",href:s.circleUrl,onClick:i[2]||(i[2]=Wt(L=>e.copyToClipboard(s.circleUrl),["stop","prevent"]))},{icon:_(()=>[M(w,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Copy link")),1)]),_:1},8,["href"]),s.canManageTeam?(p(),O(R,{key:1,shown:a.isSettingsPopoverShown,"popup-role":"dialog","onUpdate:shown":i[4]||(i[4]=L=>a.isSettingsPopoverShown=L)},{trigger:_(()=>[M(v,{onClick:i[3]||(i[3]=L=>a.isSettingsPopoverShown=!0)},{icon:_(()=>[M(D,{size:20})]),_:1})]),default:_(()=>[M(S,{circle:e.circle,onLeave:s.onLeave,onDelete:s.onDelete},null,8,["circle","onLeave","onDelete"])]),_:1},8,["shown"])):P("",!0)],64)),!e.circle.isPendingMember&&!e.circle.isMember&&e.circle.canJoin?(p(),O(v,{key:2,disabled:a.loadingJoin,class:"primary",onClick:e.joinCircle},{icon:_(()=>[M(A,{size:16})]),default:_(()=>[K(" "+E(e.t("contacts","Request to join")),1)]),_:1},8,["disabled","onClick"])):P("",!0),e.circle.isMember&&e.circle.canLeave?(p(),O(v,{key:3,disabled:a.loadingLeave,variant:"warning",onClick:e.confirmLeaveCircle},{icon:_(()=>[M(V,{size:16})]),default:_(()=>[K(" "+E(e.t("contacts","Leave team")),1)]),_:1},8,["disabled","onClick"])):P("",!0)])])]),T("div",dy,[e.circle.isMember?(p(),C("section",uy,[(p(!0),C(mt,null,It(s.groupedResources,(L,G)=>(p(),C("div",{key:G,class:"circle-details-section"},[T("div",hy,[M(st,null,{default:_(()=>[K(E(L.name),1)]),_:2},1024)]),T("ul",py,[(p(!0),C(mt,null,It(L.resources,j=>(p(),O(ht,{key:j.id,href:j.url,name:j.label},{icon:_(()=>[j.iconSvg?(p(),C("div",{key:0,class:"resource__icon",innerHTML:j.iconSvg},null,8,my)):j.iconURL?(p(),C("img",{key:1,src:j.iconURL,class:"resource__icon"},null,8,fy)):(p(),O(lt,{key:2,size:20}))]),_:2},1032,["href","name"]))),128))])]))),128)),T("div",gy,[T("div",yy,[T("div",vy,[M(st,null,{default:_(()=>[K(E(e.t("contacts","Members")),1)]),_:1}),e.circle.canManageMembers?(p(),O(v,{key:0,variant:"tertiary",onClick:s.addMembers},{icon:_(()=>[M(rt,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Add")),1)]),_:1},8,["onClick"])):P("",!0)]),M(dt,{ref:"memberList",list:s.members},null,8,["list"])])])])):(p(),C(mt,{key:0},[e.circle.isPendingMember?(p(),O(it,{key:0,name:e.t("contacts","Your request to join this team is pending approval")},{icon:_(()=>[M(W,{size:20})]),_:1},8,["name"])):(p(),O(it,{key:1,name:e.t("contacts","You are not a member of {circle}",{circle:e.circle.displayName})},{icon:_(()=>[M(et,{size:20})]),_:1},8,["name"]))],64))])],2)])}const Cy=Q(Kg,[["render",by],["__scopeId","data-v-dabc17e0"]]),wy={name:"CircleContent",components:{AppContent:Da,CircleDetails:Cy,EmptyContent:fn,AccountGroup:ir,IconLoading:me},mixins:[er,vn],props:{loading:{type:Boolean,default:!0}},data(){return{loadingList:!1}},computed:{circles(){return this.$store.getters.getCircles},circle(){return this.$store.getters.getCircle(this.selectedCircle)},members(){return Object.values(this.circle?.members||[])},isEmptyCircle(){return this.members.length===0}},watch:{circle(e){e?.id&&this.fetchCircleMembers(e.id)}},beforeMount(){this.circle?.id&&this.fetchCircleMembers(this.circle.id)},methods:{async fetchCircleMembers(e){this.loadingList=!0,this.logger.debug("Fetching members for",{circleId:e});try{await this.$store.dispatch("getCircleMembers",e)}catch(i){console.error(i),vt(t("contacts","There was an error fetching the member list"))}finally{this.loadingList=!1}}}};function ky(e,i,o,r,a,s){const l=b("AccountGroup"),c=b("EmptyContent"),d=b("IconLoading"),u=b("CircleDetails"),m=b("AppContent");return p(),O(m,null,{default:_(()=>[s.circle?o.loading?(p(),O(c,{key:1,class:"empty-content",name:e.t("contacts","Loading team…")},{icon:_(()=>[M(d,{size:20})]),_:1},8,["name"])):(p(),O(u,{key:2,circle:s.circle},null,8,["circle"])):(p(),O(c,{key:0,name:e.t("contacts","Please select a team")},{icon:_(()=>[M(l,{size:20})]),_:1},8,["name"]))]),_:1})}const _y=Q(wy,[["render",ky],["__scopeId","data-v-3a922225"]]);function xy(e,i){var o=0,r=0;return Float64Array.from(e,i===void 0?a=>o+=+a||0:a=>o+=+i(a,r++,e)||0)}function Sy(e,i){let o;if(i===void 0)for(const r of e)r!=null&&(o<r||o===void 0&&r>=r)&&(o=r);else{let r=-1;for(let a of e)(a=i(a,++r,e))!=null&&(o<a||o===void 0&&a>=a)&&(o=a)}return o}function My(e,i){let o;if(i===void 0)for(const r of e)r!=null&&(o>r||o===void 0&&r>=r)&&(o=r);else{let r=-1;for(let a of e)(a=i(a,++r,e))!=null&&(o>a||o===void 0&&a>=a)&&(o=a)}return o}function Ay(e,i){let o=0;if(i===void 0)for(let r of e)(r=+r)&&(o+=r);else{let r=-1;for(let a of e)(a=+i(a,++r,e))&&(o+=a)}return o}var Ny={value:()=>{}};function Ra(){for(var e=0,i=arguments.length,o={},r;e<i;++e){if(!(r=arguments[e]+"")||r in o||/[\s.]/.test(r))throw new Error("illegal type: "+r);o[r]=[]}return new go(o)}function go(e){this._=e}function Ly(e,i){return e.trim().split(/^|\s+/).map(function(o){var r="",a=o.indexOf(".");if(a>=0&&(r=o.slice(a+1),o=o.slice(0,a)),o&&!i.hasOwnProperty(o))throw new Error("unknown type: "+o);return{type:o,name:r}})}go.prototype=Ra.prototype={constructor:go,on:function(e,i){var o=this._,r=Ly(e+"",o),a,s=-1,l=r.length;if(arguments.length<2){for(;++s<l;)if((a=(e=r[s]).type)&&(a=Dy(o[a],e.name)))return a;return}if(i!=null&&typeof i!="function")throw new Error("invalid callback: "+i);for(;++s<l;)if(a=(e=r[s]).type)o[a]=qs(o[a],e.name,i);else if(i==null)for(a in o)o[a]=qs(o[a],e.name,null);return this},copy:function(){var e={},i=this._;for(var o in i)e[o]=i[o].slice();return new go(e)},call:function(e,i){if((a=arguments.length-2)>0)for(var o=new Array(a),r=0,a,s;r<a;++r)o[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,a=s.length;r<a;++r)s[r].value.apply(i,o)},apply:function(e,i,o){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],a=0,s=r.length;a<s;++a)r[a].value.apply(i,o)}};function Dy(e,i){for(var o=0,r=e.length,a;o<r;++o)if((a=e[o]).name===i)return a.value}function qs(e,i,o){for(var r=0,a=e.length;r<a;++r)if(e[r].name===i){e[r]=Ny,e=e.slice(0,r).concat(e.slice(r+1));break}return o!=null&&e.push({name:i,value:o}),e}var Zr="http://www.w3.org/1999/xhtml";const Xs={svg:"http://www.w3.org/2000/svg",xhtml:Zr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function or(e){var i=e+="",o=i.indexOf(":");return o>=0&&(i=e.slice(0,o))!=="xmlns"&&(e=e.slice(o+1)),Xs.hasOwnProperty(i)?{space:Xs[i],local:e}:e}function Iy(e){return function(){var i=this.ownerDocument,o=this.namespaceURI;return o===Zr&&i.documentElement.namespaceURI===Zr?i.createElement(e):i.createElementNS(o,e)}}function Oy(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Bc(e){var i=or(e);return(i.local?Oy:Iy)(i)}function Ty(){}function Va(e){return e==null?Ty:function(){return this.querySelector(e)}}function Ey(e){typeof e!="function"&&(e=Va(e));for(var i=this._groups,o=i.length,r=new Array(o),a=0;a<o;++a)for(var s=i[a],l=s.length,c=r[a]=new Array(l),d,u,m=0;m<l;++m)(d=s[m])&&(u=e.call(d,d.__data__,m,s))&&("__data__"in d&&(u.__data__=d.__data__),c[m]=u);return new pe(r,this._parents)}function Py(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function $y(){return[]}function Rc(e){return e==null?$y:function(){return this.querySelectorAll(e)}}function zy(e){return function(){return Py(e.apply(this,arguments))}}function Hy(e){typeof e=="function"?e=zy(e):e=Rc(e);for(var i=this._groups,o=i.length,r=[],a=[],s=0;s<o;++s)for(var l=i[s],c=l.length,d,u=0;u<c;++u)(d=l[u])&&(r.push(e.call(d,d.__data__,u,l)),a.push(d));return new pe(r,a)}function Vc(e){return function(){return this.matches(e)}}function Uc(e){return function(i){return i.matches(e)}}var By=Array.prototype.find;function Ry(e){return function(){return By.call(this.children,e)}}function Vy(){return this.firstElementChild}function Uy(e){return this.select(e==null?Vy:Ry(typeof e=="function"?e:Uc(e)))}var Yy=Array.prototype.filter;function Gy(){return Array.from(this.children)}function Fy(e){return function(){return Yy.call(this.children,e)}}function Wy(e){return this.selectAll(e==null?Gy:Fy(typeof e=="function"?e:Uc(e)))}function jy(e){typeof e!="function"&&(e=Vc(e));for(var i=this._groups,o=i.length,r=new Array(o),a=0;a<o;++a)for(var s=i[a],l=s.length,c=r[a]=[],d,u=0;u<l;++u)(d=s[u])&&e.call(d,d.__data__,u,s)&&c.push(d);return new pe(r,this._parents)}function Yc(e){return new Array(e.length)}function qy(){return new pe(this._enter||this._groups.map(Yc),this._parents)}function Io(e,i){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=i}Io.prototype={constructor:Io,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,i){return this._parent.insertBefore(e,i)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Xy(e){return function(){return e}}function Zy(e,i,o,r,a,s){for(var l=0,c,d=i.length,u=s.length;l<u;++l)(c=i[l])?(c.__data__=s[l],r[l]=c):o[l]=new Io(e,s[l]);for(;l<d;++l)(c=i[l])&&(a[l]=c)}function Jy(e,i,o,r,a,s,l){var c,d,u=new Map,m=i.length,y=s.length,v=new Array(m),w;for(c=0;c<m;++c)(d=i[c])&&(v[c]=w=l.call(d,d.__data__,c,i)+"",u.has(w)?a[c]=d:u.set(w,d));for(c=0;c<y;++c)w=l.call(e,s[c],c,s)+"",(d=u.get(w))?(r[c]=d,d.__data__=s[c],u.delete(w)):o[c]=new Io(e,s[c]);for(c=0;c<m;++c)(d=i[c])&&u.get(v[c])===d&&(a[c]=d)}function Ky(e){return e.__data__}function Qy(e,i){if(!arguments.length)return Array.from(this,Ky);var o=i?Jy:Zy,r=this._parents,a=this._groups;typeof e!="function"&&(e=Xy(e));for(var s=a.length,l=new Array(s),c=new Array(s),d=new Array(s),u=0;u<s;++u){var m=r[u],y=a[u],v=y.length,w=t2(e.call(m,m&&m.__data__,u,r)),D=w.length,S=c[u]=new Array(D),R=l[u]=new Array(D),A=d[u]=new Array(v);o(m,y,S,R,A,w,i);for(var V=0,W=0,it,et;V<D;++V)if(it=S[V]){for(V>=W&&(W=V+1);!(et=R[W])&&++W<D;);it._next=et||null}}return l=new pe(l,r),l._enter=c,l._exit=d,l}function t2(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function e2(){return new pe(this._exit||this._groups.map(Yc),this._parents)}function n2(e,i,o){var r=this.enter(),a=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),i!=null&&(a=i(a),a&&(a=a.selection())),o==null?s.remove():o(s),r&&a?r.merge(a).order():a}function i2(e){for(var i=e.selection?e.selection():e,o=this._groups,r=i._groups,a=o.length,s=r.length,l=Math.min(a,s),c=new Array(a),d=0;d<l;++d)for(var u=o[d],m=r[d],y=u.length,v=c[d]=new Array(y),w,D=0;D<y;++D)(w=u[D]||m[D])&&(v[D]=w);for(;d<a;++d)c[d]=o[d];return new pe(c,this._parents)}function o2(){for(var e=this._groups,i=-1,o=e.length;++i<o;)for(var r=e[i],a=r.length-1,s=r[a],l;--a>=0;)(l=r[a])&&(s&&l.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(l,s),s=l);return this}function r2(e){e||(e=a2);function i(y,v){return y&&v?e(y.__data__,v.__data__):!y-!v}for(var o=this._groups,r=o.length,a=new Array(r),s=0;s<r;++s){for(var l=o[s],c=l.length,d=a[s]=new Array(c),u,m=0;m<c;++m)(u=l[m])&&(d[m]=u);d.sort(i)}return new pe(a,this._parents).order()}function a2(e,i){return e<i?-1:e>i?1:e>=i?0:NaN}function s2(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function l2(){return Array.from(this)}function c2(){for(var e=this._groups,i=0,o=e.length;i<o;++i)for(var r=e[i],a=0,s=r.length;a<s;++a){var l=r[a];if(l)return l}return null}function d2(){let e=0;for(const i of this)++e;return e}function u2(){return!this.node()}function h2(e){for(var i=this._groups,o=0,r=i.length;o<r;++o)for(var a=i[o],s=0,l=a.length,c;s<l;++s)(c=a[s])&&e.call(c,c.__data__,s,a);return this}function p2(e){return function(){this.removeAttribute(e)}}function m2(e){return function(){this.removeAttributeNS(e.space,e.local)}}function f2(e,i){return function(){this.setAttribute(e,i)}}function g2(e,i){return function(){this.setAttributeNS(e.space,e.local,i)}}function y2(e,i){return function(){var o=i.apply(this,arguments);o==null?this.removeAttribute(e):this.setAttribute(e,o)}}function v2(e,i){return function(){var o=i.apply(this,arguments);o==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,o)}}function b2(e,i){var o=or(e);if(arguments.length<2){var r=this.node();return o.local?r.getAttributeNS(o.space,o.local):r.getAttribute(o)}return this.each((i==null?o.local?m2:p2:typeof i=="function"?o.local?v2:y2:o.local?g2:f2)(o,i))}function Gc(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function C2(e){return function(){this.style.removeProperty(e)}}function w2(e,i,o){return function(){this.style.setProperty(e,i,o)}}function k2(e,i,o){return function(){var r=i.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,o)}}function _2(e,i,o){return arguments.length>1?this.each((i==null?C2:typeof i=="function"?k2:w2)(e,i,o??"")):li(this.node(),e)}function li(e,i){return e.style.getPropertyValue(i)||Gc(e).getComputedStyle(e,null).getPropertyValue(i)}function x2(e){return function(){delete this[e]}}function S2(e,i){return function(){this[e]=i}}function M2(e,i){return function(){var o=i.apply(this,arguments);o==null?delete this[e]:this[e]=o}}function A2(e,i){return arguments.length>1?this.each((i==null?x2:typeof i=="function"?M2:S2)(e,i)):this.node()[e]}function Fc(e){return e.trim().split(/^|\s+/)}function Ua(e){return e.classList||new Wc(e)}function Wc(e){this._node=e,this._names=Fc(e.getAttribute("class")||"")}Wc.prototype={add:function(e){var i=this._names.indexOf(e);i<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var i=this._names.indexOf(e);i>=0&&(this._names.splice(i,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function jc(e,i){for(var o=Ua(e),r=-1,a=i.length;++r<a;)o.add(i[r])}function qc(e,i){for(var o=Ua(e),r=-1,a=i.length;++r<a;)o.remove(i[r])}function N2(e){return function(){jc(this,e)}}function L2(e){return function(){qc(this,e)}}function D2(e,i){return function(){(i.apply(this,arguments)?jc:qc)(this,e)}}function I2(e,i){var o=Fc(e+"");if(arguments.length<2){for(var r=Ua(this.node()),a=-1,s=o.length;++a<s;)if(!r.contains(o[a]))return!1;return!0}return this.each((typeof i=="function"?D2:i?N2:L2)(o,i))}function O2(){this.textContent=""}function T2(e){return function(){this.textContent=e}}function E2(e){return function(){var i=e.apply(this,arguments);this.textContent=i??""}}function P2(e){return arguments.length?this.each(e==null?O2:(typeof e=="function"?E2:T2)(e)):this.node().textContent}function $2(){this.innerHTML=""}function z2(e){return function(){this.innerHTML=e}}function H2(e){return function(){var i=e.apply(this,arguments);this.innerHTML=i??""}}function B2(e){return arguments.length?this.each(e==null?$2:(typeof e=="function"?H2:z2)(e)):this.node().innerHTML}function R2(){this.nextSibling&&this.parentNode.appendChild(this)}function V2(){return this.each(R2)}function U2(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Y2(){return this.each(U2)}function G2(e){var i=typeof e=="function"?e:Bc(e);return this.select(function(){return this.appendChild(i.apply(this,arguments))})}function F2(){return null}function W2(e,i){var o=typeof e=="function"?e:Bc(e),r=i==null?F2:typeof i=="function"?i:Va(i);return this.select(function(){return this.insertBefore(o.apply(this,arguments),r.apply(this,arguments)||null)})}function j2(){var e=this.parentNode;e&&e.removeChild(this)}function q2(){return this.each(j2)}function X2(){var e=this.cloneNode(!1),i=this.parentNode;return i?i.insertBefore(e,this.nextSibling):e}function Z2(){var e=this.cloneNode(!0),i=this.parentNode;return i?i.insertBefore(e,this.nextSibling):e}function J2(e){return this.select(e?Z2:X2)}function K2(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Q2(e){return function(i){e.call(this,i,this.__data__)}}function tv(e){return e.trim().split(/^|\s+/).map(function(i){var o="",r=i.indexOf(".");return r>=0&&(o=i.slice(r+1),i=i.slice(0,r)),{type:i,name:o}})}function ev(e){return function(){var i=this.__on;if(i){for(var o=0,r=-1,a=i.length,s;o<a;++o)s=i[o],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):i[++r]=s;++r?i.length=r:delete this.__on}}}function nv(e,i,o){return function(){var r=this.__on,a,s=Q2(i);if(r){for(var l=0,c=r.length;l<c;++l)if((a=r[l]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=s,a.options=o),a.value=i;return}}this.addEventListener(e.type,s,o),a={type:e.type,name:e.name,value:i,listener:s,options:o},r?r.push(a):this.__on=[a]}}function iv(e,i,o){var r=tv(e+""),a,s=r.length,l;if(arguments.length<2){var c=this.node().__on;if(c){for(var d=0,u=c.length,m;d<u;++d)for(a=0,m=c[d];a<s;++a)if((l=r[a]).type===m.type&&l.name===m.name)return m.value}return}for(c=i?nv:ev,a=0;a<s;++a)this.each(c(r[a],i,o));return this}function Xc(e,i,o){var r=Gc(e),a=r.CustomEvent;typeof a=="function"?a=new a(i,o):(a=r.document.createEvent("Event"),o?(a.initEvent(i,o.bubbles,o.cancelable),a.detail=o.detail):a.initEvent(i,!1,!1)),e.dispatchEvent(a)}function ov(e,i){return function(){return Xc(this,e,i)}}function rv(e,i){return function(){return Xc(this,e,i.apply(this,arguments))}}function av(e,i){return this.each((typeof i=="function"?rv:ov)(e,i))}function*sv(){for(var e=this._groups,i=0,o=e.length;i<o;++i)for(var r=e[i],a=0,s=r.length,l;a<s;++a)(l=r[a])&&(yield l)}var Zc=[null];function pe(e,i){this._groups=e,this._parents=i}function ci(){return new pe([[document.documentElement]],Zc)}function lv(){return this}pe.prototype=ci.prototype={constructor:pe,select:Ey,selectAll:Hy,selectChild:Uy,selectChildren:Wy,filter:jy,data:Qy,enter:qy,exit:e2,join:n2,merge:i2,selection:lv,order:o2,sort:r2,call:s2,nodes:l2,node:c2,size:d2,empty:u2,each:h2,attr:b2,style:_2,property:A2,classed:I2,text:P2,html:B2,raise:V2,lower:Y2,append:G2,insert:W2,remove:q2,clone:J2,datum:K2,on:iv,dispatch:av,[Symbol.iterator]:sv};function le(e){return typeof e=="string"?new pe([[document.querySelector(e)]],[document.documentElement]):new pe([[e]],Zc)}function cv(e){let i;for(;i=e.sourceEvent;)e=i;return e}function xn(e,i){if(e=cv(e),i===void 0&&(i=e.currentTarget),i){var o=i.ownerSVGElement||i;if(o.createSVGPoint){var r=o.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(i.getScreenCTM().inverse()),[r.x,r.y]}if(i.getBoundingClientRect){var a=i.getBoundingClientRect();return[e.clientX-a.left-i.clientLeft,e.clientY-a.top-i.clientTop]}}return[e.pageX,e.pageY]}const Jr={capture:!0,passive:!1};function Kr(e){e.preventDefault(),e.stopImmediatePropagation()}function dv(e){var i=e.document.documentElement,o=le(e).on("dragstart.drag",Kr,Jr);"onselectstart"in i?o.on("selectstart.drag",Kr,Jr):(i.__noselect=i.style.MozUserSelect,i.style.MozUserSelect="none")}function uv(e,i){var o=e.document.documentElement,r=le(e).on("dragstart.drag",null);i&&(r.on("click.drag",Kr,Jr),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in o?r.on("selectstart.drag",null):(o.style.MozUserSelect=o.__noselect,delete o.__noselect)}function Ya(e,i,o){e.prototype=i.prototype=o,o.constructor=e}function Jc(e,i){var o=Object.create(e.prototype);for(var r in i)o[r]=i[r];return o}function Fi(){}var Ei=.7,Oo=1/Ei,ni="\\s*([+-]?\\d+)\\s*",Pi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Pe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",hv=/^#([0-9a-f]{3,8})$/,pv=new RegExp(`^rgb\\(${ni},${ni},${ni}\\)$`),mv=new RegExp(`^rgb\\(${Pe},${Pe},${Pe}\\)$`),fv=new RegExp(`^rgba\\(${ni},${ni},${ni},${Pi}\\)$`),gv=new RegExp(`^rgba\\(${Pe},${Pe},${Pe},${Pi}\\)$`),yv=new RegExp(`^hsl\\(${Pi},${Pe},${Pe}\\)$`),vv=new RegExp(`^hsla\\(${Pi},${Pe},${Pe},${Pi}\\)$`),Zs={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ya(Fi,$i,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Js,formatHex:Js,formatHex8:bv,formatHsl:Cv,formatRgb:Ks,toString:Ks});function Js(){return this.rgb().formatHex()}function bv(){return this.rgb().formatHex8()}function Cv(){return Kc(this).formatHsl()}function Ks(){return this.rgb().formatRgb()}function $i(e){var i,o;return e=(e+"").trim().toLowerCase(),(i=hv.exec(e))?(o=i[1].length,i=parseInt(i[1],16),o===6?Qs(i):o===3?new ce(i>>8&15|i>>4&240,i>>4&15|i&240,(i&15)<<4|i&15,1):o===8?Ki(i>>24&255,i>>16&255,i>>8&255,(i&255)/255):o===4?Ki(i>>12&15|i>>8&240,i>>8&15|i>>4&240,i>>4&15|i&240,((i&15)<<4|i&15)/255):null):(i=pv.exec(e))?new ce(i[1],i[2],i[3],1):(i=mv.exec(e))?new ce(i[1]*255/100,i[2]*255/100,i[3]*255/100,1):(i=fv.exec(e))?Ki(i[1],i[2],i[3],i[4]):(i=gv.exec(e))?Ki(i[1]*255/100,i[2]*255/100,i[3]*255/100,i[4]):(i=yv.exec(e))?nl(i[1],i[2]/100,i[3]/100,1):(i=vv.exec(e))?nl(i[1],i[2]/100,i[3]/100,i[4]):Zs.hasOwnProperty(e)?Qs(Zs[e]):e==="transparent"?new ce(NaN,NaN,NaN,0):null}function Qs(e){return new ce(e>>16&255,e>>8&255,e&255,1)}function Ki(e,i,o,r){return r<=0&&(e=i=o=NaN),new ce(e,i,o,r)}function wv(e){return e instanceof Fi||(e=$i(e)),e?(e=e.rgb(),new ce(e.r,e.g,e.b,e.opacity)):new ce}function Qr(e,i,o,r){return arguments.length===1?wv(e):new ce(e,i,o,r??1)}function ce(e,i,o,r){this.r=+e,this.g=+i,this.b=+o,this.opacity=+r}Ya(ce,Qr,Jc(Fi,{brighter(e){return e=e==null?Oo:Math.pow(Oo,e),new ce(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ei:Math.pow(Ei,e),new ce(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ce(Tn(this.r),Tn(this.g),Tn(this.b),To(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:tl,formatHex:tl,formatHex8:kv,formatRgb:el,toString:el}));function tl(){return`#${Nn(this.r)}${Nn(this.g)}${Nn(this.b)}`}function kv(){return`#${Nn(this.r)}${Nn(this.g)}${Nn(this.b)}${Nn((isNaN(this.opacity)?1:this.opacity)*255)}`}function el(){const e=To(this.opacity);return`${e===1?"rgb(":"rgba("}${Tn(this.r)}, ${Tn(this.g)}, ${Tn(this.b)}${e===1?")":`, ${e})`}`}function To(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Tn(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Nn(e){return e=Tn(e),(e<16?"0":"")+e.toString(16)}function nl(e,i,o,r){return r<=0?e=i=o=NaN:o<=0||o>=1?e=i=NaN:i<=0&&(e=NaN),new we(e,i,o,r)}function Kc(e){if(e instanceof we)return new we(e.h,e.s,e.l,e.opacity);if(e instanceof Fi||(e=$i(e)),!e)return new we;if(e instanceof we)return e;e=e.rgb();var i=e.r/255,o=e.g/255,r=e.b/255,a=Math.min(i,o,r),s=Math.max(i,o,r),l=NaN,c=s-a,d=(s+a)/2;return c?(i===s?l=(o-r)/c+(o<r)*6:o===s?l=(r-i)/c+2:l=(i-o)/c+4,c/=d<.5?s+a:2-s-a,l*=60):c=d>0&&d<1?0:l,new we(l,c,d,e.opacity)}function _v(e,i,o,r){return arguments.length===1?Kc(e):new we(e,i,o,r??1)}function we(e,i,o,r){this.h=+e,this.s=+i,this.l=+o,this.opacity=+r}Ya(we,_v,Jc(Fi,{brighter(e){return e=e==null?Oo:Math.pow(Oo,e),new we(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ei:Math.pow(Ei,e),new we(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,i=isNaN(e)||isNaN(this.s)?0:this.s,o=this.l,r=o+(o<.5?o:1-o)*i,a=2*o-r;return new ce(Mr(e>=240?e-240:e+120,a,r),Mr(e,a,r),Mr(e<120?e+240:e-120,a,r),this.opacity)},clamp(){return new we(il(this.h),Qi(this.s),Qi(this.l),To(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=To(this.opacity);return`${e===1?"hsl(":"hsla("}${il(this.h)}, ${Qi(this.s)*100}%, ${Qi(this.l)*100}%${e===1?")":`, ${e})`}`}}));function il(e){return e=(e||0)%360,e<0?e+360:e}function Qi(e){return Math.max(0,Math.min(1,e||0))}function Mr(e,i,o){return(e<60?i+(o-i)*e/60:e<180?o:e<240?i+(o-i)*(240-e)/60:i)*255}const Qc=e=>()=>e;function xv(e,i){return function(o){return e+o*i}}function Sv(e,i,o){return e=Math.pow(e,o),i=Math.pow(i,o)-e,o=1/o,function(r){return Math.pow(e+r*i,o)}}function Mv(e){return(e=+e)==1?td:function(i,o){return o-i?Sv(i,o,e):Qc(isNaN(i)?o:i)}}function td(e,i){var o=i-e;return o?xv(e,o):Qc(isNaN(e)?i:e)}const ol=function e(i){var o=Mv(i);function r(a,s){var l=o((a=Qr(a)).r,(s=Qr(s)).r),c=o(a.g,s.g),d=o(a.b,s.b),u=td(a.opacity,s.opacity);return function(m){return a.r=l(m),a.g=c(m),a.b=d(m),a.opacity=u(m),a+""}}return r.gamma=e,r}(1);function dn(e,i){return e=+e,i=+i,function(o){return e*(1-o)+i*o}}var ta=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ar=new RegExp(ta.source,"g");function Av(e){return function(){return e}}function Nv(e){return function(i){return e(i)+""}}function Lv(e,i){var o=ta.lastIndex=Ar.lastIndex=0,r,a,s,l=-1,c=[],d=[];for(e=e+"",i=i+"";(r=ta.exec(e))&&(a=Ar.exec(i));)(s=a.index)>o&&(s=i.slice(o,s),c[l]?c[l]+=s:c[++l]=s),(r=r[0])===(a=a[0])?c[l]?c[l]+=a:c[++l]=a:(c[++l]=null,d.push({i:l,x:dn(r,a)})),o=Ar.lastIndex;return o<i.length&&(s=i.slice(o),c[l]?c[l]+=s:c[++l]=s),c.length<2?d[0]?Nv(d[0].x):Av(i):(i=d.length,function(u){for(var m=0,y;m<i;++m)c[(y=d[m]).i]=y.x(u);return c.join("")})}var rl=180/Math.PI,ed={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function nd(e,i,o,r,a,s){var l,c,d;return(l=Math.sqrt(e*e+i*i))&&(e/=l,i/=l),(d=e*o+i*r)&&(o-=e*d,r-=i*d),(c=Math.sqrt(o*o+r*r))&&(o/=c,r/=c,d/=c),e*r<i*o&&(e=-e,i=-i,d=-d,l=-l),{translateX:a,translateY:s,rotate:Math.atan2(i,e)*rl,skewX:Math.atan(d)*rl,scaleX:l,scaleY:c}}var to;function Dv(e){const i=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return i.isIdentity?ed:nd(i.a,i.b,i.c,i.d,i.e,i.f)}function Iv(e){return e==null||(to||(to=document.createElementNS("http://www.w3.org/2000/svg","g")),to.setAttribute("transform",e),!(e=to.transform.baseVal.consolidate()))?ed:(e=e.matrix,nd(e.a,e.b,e.c,e.d,e.e,e.f))}function id(e,i,o,r){function a(u){return u.length?u.pop()+" ":""}function s(u,m,y,v,w,D){if(u!==y||m!==v){var S=w.push("translate(",null,i,null,o);D.push({i:S-4,x:dn(u,y)},{i:S-2,x:dn(m,v)})}else(y||v)&&w.push("translate("+y+i+v+o)}function l(u,m,y,v){u!==m?(u-m>180?m+=360:m-u>180&&(u+=360),v.push({i:y.push(a(y)+"rotate(",null,r)-2,x:dn(u,m)})):m&&y.push(a(y)+"rotate("+m+r)}function c(u,m,y,v){u!==m?v.push({i:y.push(a(y)+"skewX(",null,r)-2,x:dn(u,m)}):m&&y.push(a(y)+"skewX("+m+r)}function d(u,m,y,v,w,D){if(u!==y||m!==v){var S=w.push(a(w)+"scale(",null,",",null,")");D.push({i:S-4,x:dn(u,y)},{i:S-2,x:dn(m,v)})}else(y!==1||v!==1)&&w.push(a(w)+"scale("+y+","+v+")")}return function(u,m){var y=[],v=[];return u=e(u),m=e(m),s(u.translateX,u.translateY,m.translateX,m.translateY,y,v),l(u.rotate,m.rotate,y,v),c(u.skewX,m.skewX,y,v),d(u.scaleX,u.scaleY,m.scaleX,m.scaleY,y,v),u=m=null,function(w){for(var D=-1,S=v.length,R;++D<S;)y[(R=v[D]).i]=R.x(w);return y.join("")}}}var Ov=id(Dv,"px, ","px)","deg)"),Tv=id(Iv,", ",")",")"),Ev=1e-12;function al(e){return((e=Math.exp(e))+1/e)/2}function Pv(e){return((e=Math.exp(e))-1/e)/2}function $v(e){return((e=Math.exp(2*e))-1)/(e+1)}const zv=function e(i,o,r){function a(s,l){var c=s[0],d=s[1],u=s[2],m=l[0],y=l[1],v=l[2],w=m-c,D=y-d,S=w*w+D*D,R,A;if(S<Ev)A=Math.log(v/u)/i,R=function(lt){return[c+lt*w,d+lt*D,u*Math.exp(i*lt*A)]};else{var V=Math.sqrt(S),W=(v*v-u*u+r*S)/(2*u*o*V),it=(v*v-u*u-r*S)/(2*v*o*V),et=Math.log(Math.sqrt(W*W+1)-W),st=Math.log(Math.sqrt(it*it+1)-it);A=(st-et)/i,R=function(lt){var ht=lt*A,rt=al(et),dt=u/(o*V)*(rt*$v(i*ht+et)-Pv(et));return[c+dt*w,d+dt*D,u*rt/al(i*ht+et)]}}return R.duration=A*1e3*i/Math.SQRT2,R}return a.rho=function(s){var l=Math.max(.001,+s),c=l*l,d=c*c;return e(l,c,d)},a}(Math.SQRT2,2,4);var di=0,Si=0,Ci=0,od=1e3,Eo,Mi,Po=0,zn=0,rr=0,zi=typeof performance=="object"&&performance.now?performance:Date,rd=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Ga(){return zn||(rd(Hv),zn=zi.now()+rr)}function Hv(){zn=0}function $o(){this._call=this._time=this._next=null}$o.prototype=ad.prototype={constructor:$o,restart:function(e,i,o){if(typeof e!="function")throw new TypeError("callback is not a function");o=(o==null?Ga():+o)+(i==null?0:+i),!this._next&&Mi!==this&&(Mi?Mi._next=this:Eo=this,Mi=this),this._call=e,this._time=o,ea()},stop:function(){this._call&&(this._call=null,this._time=1/0,ea())}};function ad(e,i,o){var r=new $o;return r.restart(e,i,o),r}function Bv(){Ga(),++di;for(var e=Eo,i;e;)(i=zn-e._time)>=0&&e._call.call(void 0,i),e=e._next;--di}function sl(){zn=(Po=zi.now())+rr,di=Si=0;try{Bv()}finally{di=0,Vv(),zn=0}}function Rv(){var e=zi.now(),i=e-Po;i>od&&(rr-=i,Po=e)}function Vv(){for(var e,i=Eo,o,r=1/0;i;)i._call?(r>i._time&&(r=i._time),e=i,i=i._next):(o=i._next,i._next=null,i=e?e._next=o:Eo=o);Mi=e,ea(r)}function ea(e){if(!di){Si&&(Si=clearTimeout(Si));var i=e-zn;i>24?(e<1/0&&(Si=setTimeout(sl,e-zi.now()-rr)),Ci&&(Ci=clearInterval(Ci))):(Ci||(Po=zi.now(),Ci=setInterval(Rv,od)),di=1,rd(sl))}}function ll(e,i,o){var r=new $o;return i=i==null?0:+i,r.restart(a=>{r.stop(),e(a+i)},i,o),r}var Uv=Ra("start","end","cancel","interrupt"),Yv=[],sd=0,cl=1,na=2,yo=3,dl=4,ia=5,vo=6;function ar(e,i,o,r,a,s){var l=e.__transition;if(!l)e.__transition={};else if(o in l)return;Gv(e,o,{name:i,index:r,group:a,on:Uv,tween:Yv,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:sd})}function Fa(e,i){var o=Ne(e,i);if(o.state>sd)throw new Error("too late; already scheduled");return o}function He(e,i){var o=Ne(e,i);if(o.state>yo)throw new Error("too late; already running");return o}function Ne(e,i){var o=e.__transition;if(!o||!(o=o[i]))throw new Error("transition not found");return o}function Gv(e,i,o){var r=e.__transition,a;r[i]=o,o.timer=ad(s,0,o.time);function s(u){o.state=cl,o.timer.restart(l,o.delay,o.time),o.delay<=u&&l(u-o.delay)}function l(u){var m,y,v,w;if(o.state!==cl)return d();for(m in r)if(w=r[m],w.name===o.name){if(w.state===yo)return ll(l);w.state===dl?(w.state=vo,w.timer.stop(),w.on.call("interrupt",e,e.__data__,w.index,w.group),delete r[m]):+m<i&&(w.state=vo,w.timer.stop(),w.on.call("cancel",e,e.__data__,w.index,w.group),delete r[m])}if(ll(function(){o.state===yo&&(o.state=dl,o.timer.restart(c,o.delay,o.time),c(u))}),o.state=na,o.on.call("start",e,e.__data__,o.index,o.group),o.state===na){for(o.state=yo,a=new Array(v=o.tween.length),m=0,y=-1;m<v;++m)(w=o.tween[m].value.call(e,e.__data__,o.index,o.group))&&(a[++y]=w);a.length=y+1}}function c(u){for(var m=u<o.duration?o.ease.call(null,u/o.duration):(o.timer.restart(d),o.state=ia,1),y=-1,v=a.length;++y<v;)a[y].call(e,m);o.state===ia&&(o.on.call("end",e,e.__data__,o.index,o.group),d())}function d(){o.state=vo,o.timer.stop(),delete r[i];for(var u in r)return;delete e.__transition}}function bo(e,i){var o=e.__transition,r,a,s=!0,l;if(o){i=i==null?null:i+"";for(l in o){if((r=o[l]).name!==i){s=!1;continue}a=r.state>na&&r.state<ia,r.state=vo,r.timer.stop(),r.on.call(a?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete o[l]}s&&delete e.__transition}}function Fv(e){return this.each(function(){bo(this,e)})}function Wv(e,i){var o,r;return function(){var a=He(this,e),s=a.tween;if(s!==o){r=o=s;for(var l=0,c=r.length;l<c;++l)if(r[l].name===i){r=r.slice(),r.splice(l,1);break}}a.tween=r}}function jv(e,i,o){var r,a;if(typeof o!="function")throw new Error;return function(){var s=He(this,e),l=s.tween;if(l!==r){a=(r=l).slice();for(var c={name:i,value:o},d=0,u=a.length;d<u;++d)if(a[d].name===i){a[d]=c;break}d===u&&a.push(c)}s.tween=a}}function qv(e,i){var o=this._id;if(e+="",arguments.length<2){for(var r=Ne(this.node(),o).tween,a=0,s=r.length,l;a<s;++a)if((l=r[a]).name===e)return l.value;return null}return this.each((i==null?Wv:jv)(o,e,i))}function Wa(e,i,o){var r=e._id;return e.each(function(){var a=He(this,r);(a.value||(a.value={}))[i]=o.apply(this,arguments)}),function(a){return Ne(a,r).value[i]}}function ld(e,i){var o;return(typeof i=="number"?dn:i instanceof $i?ol:(o=$i(i))?(i=o,ol):Lv)(e,i)}function Xv(e){return function(){this.removeAttribute(e)}}function Zv(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Jv(e,i,o){var r,a=o+"",s;return function(){var l=this.getAttribute(e);return l===a?null:l===r?s:s=i(r=l,o)}}function Kv(e,i,o){var r,a=o+"",s;return function(){var l=this.getAttributeNS(e.space,e.local);return l===a?null:l===r?s:s=i(r=l,o)}}function Qv(e,i,o){var r,a,s;return function(){var l,c=o(this),d;return c==null?void this.removeAttribute(e):(l=this.getAttribute(e),d=c+"",l===d?null:l===r&&d===a?s:(a=d,s=i(r=l,c)))}}function tb(e,i,o){var r,a,s;return function(){var l,c=o(this),d;return c==null?void this.removeAttributeNS(e.space,e.local):(l=this.getAttributeNS(e.space,e.local),d=c+"",l===d?null:l===r&&d===a?s:(a=d,s=i(r=l,c)))}}function eb(e,i){var o=or(e),r=o==="transform"?Tv:ld;return this.attrTween(e,typeof i=="function"?(o.local?tb:Qv)(o,r,Wa(this,"attr."+e,i)):i==null?(o.local?Zv:Xv)(o):(o.local?Kv:Jv)(o,r,i))}function nb(e,i){return function(o){this.setAttribute(e,i.call(this,o))}}function ib(e,i){return function(o){this.setAttributeNS(e.space,e.local,i.call(this,o))}}function ob(e,i){var o,r;function a(){var s=i.apply(this,arguments);return s!==r&&(o=(r=s)&&ib(e,s)),o}return a._value=i,a}function rb(e,i){var o,r;function a(){var s=i.apply(this,arguments);return s!==r&&(o=(r=s)&&nb(e,s)),o}return a._value=i,a}function ab(e,i){var o="attr."+e;if(arguments.length<2)return(o=this.tween(o))&&o._value;if(i==null)return this.tween(o,null);if(typeof i!="function")throw new Error;var r=or(e);return this.tween(o,(r.local?ob:rb)(r,i))}function sb(e,i){return function(){Fa(this,e).delay=+i.apply(this,arguments)}}function lb(e,i){return i=+i,function(){Fa(this,e).delay=i}}function cb(e){var i=this._id;return arguments.length?this.each((typeof e=="function"?sb:lb)(i,e)):Ne(this.node(),i).delay}function db(e,i){return function(){He(this,e).duration=+i.apply(this,arguments)}}function ub(e,i){return i=+i,function(){He(this,e).duration=i}}function hb(e){var i=this._id;return arguments.length?this.each((typeof e=="function"?db:ub)(i,e)):Ne(this.node(),i).duration}function pb(e,i){if(typeof i!="function")throw new Error;return function(){He(this,e).ease=i}}function mb(e){var i=this._id;return arguments.length?this.each(pb(i,e)):Ne(this.node(),i).ease}function fb(e,i){return function(){var o=i.apply(this,arguments);if(typeof o!="function")throw new Error;He(this,e).ease=o}}function gb(e){if(typeof e!="function")throw new Error;return this.each(fb(this._id,e))}function yb(e){typeof e!="function"&&(e=Vc(e));for(var i=this._groups,o=i.length,r=new Array(o),a=0;a<o;++a)for(var s=i[a],l=s.length,c=r[a]=[],d,u=0;u<l;++u)(d=s[u])&&e.call(d,d.__data__,u,s)&&c.push(d);return new Je(r,this._parents,this._name,this._id)}function vb(e){if(e._id!==this._id)throw new Error;for(var i=this._groups,o=e._groups,r=i.length,a=o.length,s=Math.min(r,a),l=new Array(r),c=0;c<s;++c)for(var d=i[c],u=o[c],m=d.length,y=l[c]=new Array(m),v,w=0;w<m;++w)(v=d[w]||u[w])&&(y[w]=v);for(;c<r;++c)l[c]=i[c];return new Je(l,this._parents,this._name,this._id)}function bb(e){return(e+"").trim().split(/^|\s+/).every(function(i){var o=i.indexOf(".");return o>=0&&(i=i.slice(0,o)),!i||i==="start"})}function Cb(e,i,o){var r,a,s=bb(i)?Fa:He;return function(){var l=s(this,e),c=l.on;c!==r&&(a=(r=c).copy()).on(i,o),l.on=a}}function wb(e,i){var o=this._id;return arguments.length<2?Ne(this.node(),o).on.on(e):this.each(Cb(o,e,i))}function kb(e){return function(){var i=this.parentNode;for(var o in this.__transition)if(+o!==e)return;i&&i.removeChild(this)}}function _b(){return this.on("end.remove",kb(this._id))}function xb(e){var i=this._name,o=this._id;typeof e!="function"&&(e=Va(e));for(var r=this._groups,a=r.length,s=new Array(a),l=0;l<a;++l)for(var c=r[l],d=c.length,u=s[l]=new Array(d),m,y,v=0;v<d;++v)(m=c[v])&&(y=e.call(m,m.__data__,v,c))&&("__data__"in m&&(y.__data__=m.__data__),u[v]=y,ar(u[v],i,o,v,u,Ne(m,o)));return new Je(s,this._parents,i,o)}function Sb(e){var i=this._name,o=this._id;typeof e!="function"&&(e=Rc(e));for(var r=this._groups,a=r.length,s=[],l=[],c=0;c<a;++c)for(var d=r[c],u=d.length,m,y=0;y<u;++y)if(m=d[y]){for(var v=e.call(m,m.__data__,y,d),w,D=Ne(m,o),S=0,R=v.length;S<R;++S)(w=v[S])&&ar(w,i,o,S,v,D);s.push(v),l.push(m)}return new Je(s,l,i,o)}var Mb=ci.prototype.constructor;function Ab(){return new Mb(this._groups,this._parents)}function Nb(e,i){var o,r,a;return function(){var s=li(this,e),l=(this.style.removeProperty(e),li(this,e));return s===l?null:s===o&&l===r?a:a=i(o=s,r=l)}}function cd(e){return function(){this.style.removeProperty(e)}}function Lb(e,i,o){var r,a=o+"",s;return function(){var l=li(this,e);return l===a?null:l===r?s:s=i(r=l,o)}}function Db(e,i,o){var r,a,s;return function(){var l=li(this,e),c=o(this),d=c+"";return c==null&&(d=c=(this.style.removeProperty(e),li(this,e))),l===d?null:l===r&&d===a?s:(a=d,s=i(r=l,c))}}function Ib(e,i){var o,r,a,s="style."+i,l="end."+s,c;return function(){var d=He(this,e),u=d.on,m=d.value[s]==null?c||(c=cd(i)):void 0;(u!==o||a!==m)&&(r=(o=u).copy()).on(l,a=m),d.on=r}}function Ob(e,i,o){var r=(e+="")=="transform"?Ov:ld;return i==null?this.styleTween(e,Nb(e,r)).on("end.style."+e,cd(e)):typeof i=="function"?this.styleTween(e,Db(e,r,Wa(this,"style."+e,i))).each(Ib(this._id,e)):this.styleTween(e,Lb(e,r,i),o).on("end.style."+e,null)}function Tb(e,i,o){return function(r){this.style.setProperty(e,i.call(this,r),o)}}function Eb(e,i,o){var r,a;function s(){var l=i.apply(this,arguments);return l!==a&&(r=(a=l)&&Tb(e,l,o)),r}return s._value=i,s}function Pb(e,i,o){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(i==null)return this.tween(r,null);if(typeof i!="function")throw new Error;return this.tween(r,Eb(e,i,o??""))}function $b(e){return function(){this.textContent=e}}function zb(e){return function(){var i=e(this);this.textContent=i??""}}function Hb(e){return this.tween("text",typeof e=="function"?zb(Wa(this,"text",e)):$b(e==null?"":e+""))}function Bb(e){return function(i){this.textContent=e.call(this,i)}}function Rb(e){var i,o;function r(){var a=e.apply(this,arguments);return a!==o&&(i=(o=a)&&Bb(a)),i}return r._value=e,r}function Vb(e){var i="text";if(arguments.length<1)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,Rb(e))}function Ub(){for(var e=this._name,i=this._id,o=dd(),r=this._groups,a=r.length,s=0;s<a;++s)for(var l=r[s],c=l.length,d,u=0;u<c;++u)if(d=l[u]){var m=Ne(d,i);ar(d,e,o,u,l,{time:m.time+m.delay+m.duration,delay:0,duration:m.duration,ease:m.ease})}return new Je(r,this._parents,e,o)}function Yb(){var e,i,o=this,r=o._id,a=o.size();return new Promise(function(s,l){var c={value:l},d={value:function(){--a===0&&s()}};o.each(function(){var u=He(this,r),m=u.on;m!==e&&(i=(e=m).copy(),i._.cancel.push(c),i._.interrupt.push(c),i._.end.push(d)),u.on=i}),a===0&&s()})}var Gb=0;function Je(e,i,o,r){this._groups=e,this._parents=i,this._name=o,this._id=r}function dd(){return++Gb}var Ue=ci.prototype;Je.prototype={constructor:Je,select:xb,selectAll:Sb,selectChild:Ue.selectChild,selectChildren:Ue.selectChildren,filter:yb,merge:vb,selection:Ab,transition:Ub,call:Ue.call,nodes:Ue.nodes,node:Ue.node,size:Ue.size,empty:Ue.empty,each:Ue.each,on:wb,attr:eb,attrTween:ab,style:Ob,styleTween:Pb,text:Hb,textTween:Vb,remove:_b,tween:qv,delay:cb,duration:hb,ease:mb,easeVarying:gb,end:Yb,[Symbol.iterator]:Ue[Symbol.iterator]};function Fb(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Wb={time:null,delay:0,duration:250,ease:Fb};function jb(e,i){for(var o;!(o=e.__transition)||!(o=o[i]);)if(!(e=e.parentNode))throw new Error(`transition ${i} not found`);return o}function qb(e){var i,o;e instanceof Je?(i=e._id,e=e._name):(i=dd(),(o=Wb).time=Ga(),e=e==null?null:e+"");for(var r=this._groups,a=r.length,s=0;s<a;++s)for(var l=r[s],c=l.length,d,u=0;u<c;++u)(d=l[u])&&ar(d,e,i,u,l,o||jb(d,i));return new Je(r,this._parents,e,i)}ci.prototype.interrupt=Fv,ci.prototype.transition=qb;const oa=Math.PI,ra=2*oa,Mn=1e-6,Xb=ra-Mn;function aa(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ud(){return new aa}aa.prototype=ud.prototype={constructor:aa,moveTo:function(e,i){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+i)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,i){this._+="L"+(this._x1=+e)+","+(this._y1=+i)},quadraticCurveTo:function(e,i,o,r){this._+="Q"+ +e+","+ +i+","+(this._x1=+o)+","+(this._y1=+r)},bezierCurveTo:function(e,i,o,r,a,s){this._+="C"+ +e+","+ +i+","+ +o+","+ +r+","+(this._x1=+a)+","+(this._y1=+s)},arcTo:function(e,i,o,r,a){e=+e,i=+i,o=+o,r=+r,a=+a;var s=this._x1,l=this._y1,c=o-e,d=r-i,u=s-e,m=l-i,y=u*u+m*m;if(a<0)throw new Error("negative radius: "+a);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=i);else if(y>Mn)if(!(Math.abs(m*c-d*u)>Mn)||!a)this._+="L"+(this._x1=e)+","+(this._y1=i);else{var v=o-s,w=r-l,D=c*c+d*d,S=v*v+w*w,R=Math.sqrt(D),A=Math.sqrt(y),V=a*Math.tan((oa-Math.acos((D+y-S)/(2*R*A)))/2),W=V/A,it=V/R;Math.abs(W-1)>Mn&&(this._+="L"+(e+W*u)+","+(i+W*m)),this._+="A"+a+","+a+",0,0,"+ +(m*v>u*w)+","+(this._x1=e+it*c)+","+(this._y1=i+it*d)}},arc:function(e,i,o,r,a,s){e=+e,i=+i,o=+o,s=!!s;var l=o*Math.cos(r),c=o*Math.sin(r),d=e+l,u=i+c,m=1^s,y=s?r-a:a-r;if(o<0)throw new Error("negative radius: "+o);this._x1===null?this._+="M"+d+","+u:(Math.abs(this._x1-d)>Mn||Math.abs(this._y1-u)>Mn)&&(this._+="L"+d+","+u),o&&(y<0&&(y=y%ra+ra),y>Xb?this._+="A"+o+","+o+",0,1,"+m+","+(e-l)+","+(i-c)+"A"+o+","+o+",0,1,"+m+","+(this._x1=d)+","+(this._y1=u):y>Mn&&(this._+="A"+o+","+o+",0,"+ +(y>=oa)+","+m+","+(this._x1=e+o*Math.cos(a))+","+(this._y1=i+o*Math.sin(a))))},rect:function(e,i,o,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+i)+"h"+ +o+"v"+ +r+"h"+-o+"Z"},toString:function(){return this._}};function Zb(e){var i=0,o=e.children,r=o&&o.length;if(!r)i=1;else for(;--r>=0;)i+=o[r].value;e.value=i}function Jb(){return this.eachAfter(Zb)}function Kb(e,i){let o=-1;for(const r of this)e.call(i,r,++o,this);return this}function Qb(e,i){for(var o=this,r=[o],a,s,l=-1;o=r.pop();)if(e.call(i,o,++l,this),a=o.children)for(s=a.length-1;s>=0;--s)r.push(a[s]);return this}function tC(e,i){for(var o=this,r=[o],a=[],s,l,c,d=-1;o=r.pop();)if(a.push(o),s=o.children)for(l=0,c=s.length;l<c;++l)r.push(s[l]);for(;o=a.pop();)e.call(i,o,++d,this);return this}function eC(e,i){let o=-1;for(const r of this)if(e.call(i,r,++o,this))return r}function nC(e){return this.eachAfter(function(i){for(var o=+e(i.data)||0,r=i.children,a=r&&r.length;--a>=0;)o+=r[a].value;i.value=o})}function iC(e){return this.eachBefore(function(i){i.children&&i.children.sort(e)})}function oC(e){for(var i=this,o=rC(i,e),r=[i];i!==o;)i=i.parent,r.push(i);for(var a=r.length;e!==o;)r.splice(a,0,e),e=e.parent;return r}function rC(e,i){if(e===i)return e;var o=e.ancestors(),r=i.ancestors(),a=null;for(e=o.pop(),i=r.pop();e===i;)a=e,e=o.pop(),i=r.pop();return a}function aC(){for(var e=this,i=[e];e=e.parent;)i.push(e);return i}function sC(){return Array.from(this)}function lC(){var e=[];return this.eachBefore(function(i){i.children||e.push(i)}),e}function cC(){var e=this,i=[];return e.each(function(o){o!==e&&i.push({source:o.parent,target:o})}),i}function*dC(){var e=this,i,o=[e],r,a,s;do for(i=o.reverse(),o=[];e=i.pop();)if(yield e,r=e.children)for(a=0,s=r.length;a<s;++a)o.push(r[a]);while(o.length)}function hd(e,i){e instanceof Map?(e=[void 0,e],i===void 0&&(i=pC)):i===void 0&&(i=hC);for(var o=new ui(e),r,a=[o],s,l,c,d;r=a.pop();)if((l=i(r.data))&&(d=(l=Array.from(l)).length))for(r.children=l,c=d-1;c>=0;--c)a.push(s=l[c]=new ui(l[c])),s.parent=r,s.depth=r.depth+1;return o.eachBefore(pd)}function uC(){return hd(this).eachBefore(mC)}function hC(e){return e.children}function pC(e){return Array.isArray(e)?e[1]:null}function mC(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function pd(e){var i=0;do e.height=i;while((e=e.parent)&&e.height<++i)}function ui(e){this.data=e,this.depth=this.height=0,this.parent=null}ui.prototype=hd.prototype={constructor:ui,count:Jb,each:Kb,eachAfter:tC,eachBefore:Qb,find:eC,sum:nC,sort:iC,path:oC,ancestors:aC,descendants:sC,leaves:lC,links:cC,copy:uC,[Symbol.iterator]:dC};function Nr(e){return e==null?null:fC(e)}function fC(e){if(typeof e!="function")throw new Error;return e}var gC={depth:-1},ul={},Lr={};function yC(e){return e.id}function vC(e){return e.parentId}function bC(){var e=yC,i=vC,o;function r(a){var s=Array.from(a),l=e,c=i,d,u,m,y,v,w,D,S,R=new Map;if(o!=null){const A=s.map((it,et)=>CC(o(it,et,a))),V=A.map(hl),W=new Set(A).add("");for(const it of V)W.has(it)||(W.add(it),A.push(it),V.push(hl(it)),s.push(Lr));l=(it,et)=>A[et],c=(it,et)=>V[et]}for(m=0,d=s.length;m<d;++m)u=s[m],w=s[m]=new ui(u),(D=l(u,m,a))!=null&&(D+="")&&(S=w.id=D,R.set(S,R.has(S)?ul:w)),(D=c(u,m,a))!=null&&(D+="")&&(w.parent=D);for(m=0;m<d;++m)if(w=s[m],D=w.parent){if(v=R.get(D),!v)throw new Error("missing: "+D);if(v===ul)throw new Error("ambiguous: "+D);v.children?v.children.push(w):v.children=[w],w.parent=v}else{if(y)throw new Error("multiple roots");y=w}if(!y)throw new Error("no root");if(o!=null){for(;y.data===Lr&&y.children.length===1;)y=y.children[0],--d;for(let A=s.length-1;A>=0&&(w=s[A],w.data===Lr);--A)w.data=null}if(y.parent=gC,y.eachBefore(function(A){A.depth=A.parent.depth+1,--d}).eachBefore(pd),y.parent=null,d>0)throw new Error("cycle");return y}return r.id=function(a){return arguments.length?(e=Nr(a),r):e},r.parentId=function(a){return arguments.length?(i=Nr(a),r):i},r.path=function(a){return arguments.length?(o=Nr(a),r):o},r}function CC(e){e=`${e}`;let i=e.length;return sa(e,i-1)&&!sa(e,i-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function hl(e){let i=e.length;if(i<2)return"";for(;--i>1&&!sa(e,i););return e.slice(0,i)}function sa(e,i){if(e[i]==="/"){let o=0;for(;i>0&&e[--i]==="\\";)++o;if(!(o&1))return!0}return!1}function wC(e,i){return e.parent===i.parent?1:2}function Dr(e){var i=e.children;return i?i[0]:e.t}function Ir(e){var i=e.children;return i?i[i.length-1]:e.t}function kC(e,i,o){var r=o/(i.i-e.i);i.c-=r,i.s+=o,e.c+=r,i.z+=o,i.m+=o}function _C(e){for(var i=0,o=0,r=e.children,a=r.length,s;--a>=0;)s=r[a],s.z+=i,s.m+=i,i+=s.s+(o+=s.c)}function xC(e,i,o){return e.a.parent===i.parent?e.a:o}function Co(e,i){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=i}Co.prototype=Object.create(ui.prototype);function SC(e){for(var i=new Co(e,0),o,r=[i],a,s,l,c;o=r.pop();)if(s=o._.children)for(o.children=new Array(c=s.length),l=c-1;l>=0;--l)r.push(a=o.children[l]=new Co(s[l],l)),a.parent=o;return(i.parent=new Co(null,0)).children=[i],i}function MC(){var e=wC,i=1,o=1,r=null;function a(u){var m=SC(u);if(m.eachAfter(s),m.parent.m=-m.z,m.eachBefore(l),r)u.eachBefore(d);else{var y=u,v=u,w=u;u.eachBefore(function(V){V.x<y.x&&(y=V),V.x>v.x&&(v=V),V.depth>w.depth&&(w=V)});var D=y===v?1:e(y,v)/2,S=D-y.x,R=i/(v.x+D+S),A=o/(w.depth||1);u.eachBefore(function(V){V.x=(V.x+S)*R,V.y=V.depth*A})}return u}function s(u){var m=u.children,y=u.parent.children,v=u.i?y[u.i-1]:null;if(m){_C(u);var w=(m[0].z+m[m.length-1].z)/2;v?(u.z=v.z+e(u._,v._),u.m=u.z-w):u.z=w}else v&&(u.z=v.z+e(u._,v._));u.parent.A=c(u,v,u.parent.A||y[0])}function l(u){u._.x=u.z+u.parent.m,u.m+=u.parent.m}function c(u,m,y){if(m){for(var v=u,w=u,D=m,S=v.parent.children[0],R=v.m,A=w.m,V=D.m,W=S.m,it;D=Ir(D),v=Dr(v),D&&v;)S=Dr(S),w=Ir(w),w.a=u,it=D.z+V-v.z-R+e(D._,v._),it>0&&(kC(xC(D,u,y),u,it),R+=it,A+=it),V+=D.m,R+=v.m,W+=S.m,A+=w.m;D&&!Ir(w)&&(w.t=D,w.m+=V-A),v&&!Dr(S)&&(S.t=v,S.m+=R-W,y=u)}return y}function d(u){u.x*=i,u.y=u.depth*o}return a.separation=function(u){return arguments.length?(e=u,a):e},a.size=function(u){return arguments.length?(r=!1,i=+u[0],o=+u[1],a):r?null:[i,o]},a.nodeSize=function(u){return arguments.length?(r=!0,i=+u[0],o=+u[1],a):r?[i,o]:null},a}function pl(e){return function(){return e}}var AC=Array.prototype.slice;function NC(e){return e[0]}function LC(e){return e[1]}class DC{constructor(i,o){this._context=i,this._x=o}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(i,o){switch(i=+i,o=+o,this._point){case 0:{this._point=1,this._line?this._context.lineTo(i,o):this._context.moveTo(i,o);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+i)/2,this._y0,this._x0,o,i,o):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+o)/2,i,this._y0,i,o);break}}this._x0=i,this._y0=o}}function IC(e){return new DC(e,!0)}function OC(e){return e.source}function TC(e){return e.target}function EC(e){let i=OC,o=TC,r=NC,a=LC,s=null,l=null;function c(){let d;const u=AC.call(arguments),m=i.apply(this,u),y=o.apply(this,u);if(s==null&&(l=e(d=ud())),l.lineStart(),u[0]=m,l.point(+r.apply(this,u),+a.apply(this,u)),u[0]=y,l.point(+r.apply(this,u),+a.apply(this,u)),l.lineEnd(),d)return l=null,d+""||null}return c.source=function(d){return arguments.length?(i=d,c):i},c.target=function(d){return arguments.length?(o=d,c):o},c.x=function(d){return arguments.length?(r=typeof d=="function"?d:pl(+d),c):r},c.y=function(d){return arguments.length?(a=typeof d=="function"?d:pl(+d),c):a},c.context=function(d){return arguments.length?(d==null?s=l=null:l=e(s=d),c):s},c}function PC(){return EC(IC)}const eo=e=>()=>e;function $C(e,{sourceEvent:i,target:o,transform:r,dispatch:a}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:i,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:a}})}function Fe(e,i,o){this.k=e,this.x=i,this.y=o}Fe.prototype={constructor:Fe,scale:function(e){return e===1?this:new Fe(this.k*e,this.x,this.y)},translate:function(e,i){return e===0&i===0?this:new Fe(this.k,this.x+this.k*e,this.y+this.k*i)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ja=new Fe(1,0,0);Fe.prototype;function Or(e){e.stopImmediatePropagation()}function wi(e){e.preventDefault(),e.stopImmediatePropagation()}function zC(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function HC(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function ml(){return this.__zoom||ja}function BC(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function RC(){return navigator.maxTouchPoints||"ontouchstart"in this}function VC(e,i,o){var r=e.invertX(i[0][0])-o[0][0],a=e.invertX(i[1][0])-o[1][0],s=e.invertY(i[0][1])-o[0][1],l=e.invertY(i[1][1])-o[1][1];return e.translate(a>r?(r+a)/2:Math.min(0,r)||Math.max(0,a),l>s?(s+l)/2:Math.min(0,s)||Math.max(0,l))}function UC(){var e=zC,i=HC,o=VC,r=BC,a=RC,s=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],c=250,d=zv,u=Ra("start","zoom","end"),m,y,v,w=500,D=150,S=0,R=10;function A(I){I.property("__zoom",ml).on("wheel.zoom",ht,{passive:!1}).on("mousedown.zoom",rt).on("dblclick.zoom",dt).filter(a).on("touchstart.zoom",L).on("touchmove.zoom",G).on("touchend.zoom touchcancel.zoom",j).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}A.transform=function(I,Z,z,tt){var at=I.selection?I.selection():I;at.property("__zoom",ml),I!==at?et(I,Z,z,tt):at.interrupt().each(function(){st(this,arguments).event(tt).start().zoom(null,typeof Z=="function"?Z.apply(this,arguments):Z).end()})},A.scaleBy=function(I,Z,z,tt){A.scaleTo(I,function(){var at=this.__zoom.k,ct=typeof Z=="function"?Z.apply(this,arguments):Z;return at*ct},z,tt)},A.scaleTo=function(I,Z,z,tt){A.transform(I,function(){var at=i.apply(this,arguments),ct=this.__zoom,Y=z==null?it(at):typeof z=="function"?z.apply(this,arguments):z,gt=ct.invert(Y),St=typeof Z=="function"?Z.apply(this,arguments):Z;return o(W(V(ct,St),Y,gt),at,l)},z,tt)},A.translateBy=function(I,Z,z,tt){A.transform(I,function(){return o(this.__zoom.translate(typeof Z=="function"?Z.apply(this,arguments):Z,typeof z=="function"?z.apply(this,arguments):z),i.apply(this,arguments),l)},null,tt)},A.translateTo=function(I,Z,z,tt,at){A.transform(I,function(){var ct=i.apply(this,arguments),Y=this.__zoom,gt=tt==null?it(ct):typeof tt=="function"?tt.apply(this,arguments):tt;return o(ja.translate(gt[0],gt[1]).scale(Y.k).translate(typeof Z=="function"?-Z.apply(this,arguments):-Z,typeof z=="function"?-z.apply(this,arguments):-z),ct,l)},tt,at)};function V(I,Z){return Z=Math.max(s[0],Math.min(s[1],Z)),Z===I.k?I:new Fe(Z,I.x,I.y)}function W(I,Z,z){var tt=Z[0]-z[0]*I.k,at=Z[1]-z[1]*I.k;return tt===I.x&&at===I.y?I:new Fe(I.k,tt,at)}function it(I){return[(+I[0][0]+ +I[1][0])/2,(+I[0][1]+ +I[1][1])/2]}function et(I,Z,z,tt){I.on("start.zoom",function(){st(this,arguments).event(tt).start()}).on("interrupt.zoom end.zoom",function(){st(this,arguments).event(tt).end()}).tween("zoom",function(){var at=this,ct=arguments,Y=st(at,ct).event(tt),gt=i.apply(at,ct),St=z==null?it(gt):typeof z=="function"?z.apply(at,ct):z,Ht=Math.max(gt[1][0]-gt[0][0],gt[1][1]-gt[0][1]),Ot=at.__zoom,Gt=typeof Z=="function"?Z.apply(at,ct):Z,Qt=d(Ot.invert(St).concat(Ht/Ot.k),Gt.invert(St).concat(Ht/Gt.k));return function(jt){if(jt===1)jt=Gt;else{var oe=Qt(jt),Yn=Ht/oe[2];jt=new Fe(Yn,St[0]-oe[0]*Yn,St[1]-oe[1]*Yn)}Y.zoom(null,jt)}})}function st(I,Z,z){return!z&&I.__zooming||new lt(I,Z)}function lt(I,Z){this.that=I,this.args=Z,this.active=0,this.sourceEvent=null,this.extent=i.apply(I,Z),this.taps=0}lt.prototype={event:function(I){return I&&(this.sourceEvent=I),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(I,Z){return this.mouse&&I!=="mouse"&&(this.mouse[1]=Z.invert(this.mouse[0])),this.touch0&&I!=="touch"&&(this.touch0[1]=Z.invert(this.touch0[0])),this.touch1&&I!=="touch"&&(this.touch1[1]=Z.invert(this.touch1[0])),this.that.__zoom=Z,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(I){var Z=le(this.that).datum();u.call(I,this.that,new $C(I,{sourceEvent:this.sourceEvent,target:A,type:I,transform:this.that.__zoom,dispatch:u}),Z)}};function ht(I,...Z){if(!e.apply(this,arguments))return;var z=st(this,Z).event(I),tt=this.__zoom,at=Math.max(s[0],Math.min(s[1],tt.k*Math.pow(2,r.apply(this,arguments)))),ct=xn(I);if(z.wheel)(z.mouse[0][0]!==ct[0]||z.mouse[0][1]!==ct[1])&&(z.mouse[1]=tt.invert(z.mouse[0]=ct)),clearTimeout(z.wheel);else{if(tt.k===at)return;z.mouse=[ct,tt.invert(ct)],bo(this),z.start()}wi(I),z.wheel=setTimeout(Y,D),z.zoom("mouse",o(W(V(tt,at),z.mouse[0],z.mouse[1]),z.extent,l));function Y(){z.wheel=null,z.end()}}function rt(I,...Z){if(v||!e.apply(this,arguments))return;var z=I.currentTarget,tt=st(this,Z,!0).event(I),at=le(I.view).on("mousemove.zoom",St,!0).on("mouseup.zoom",Ht,!0),ct=xn(I,z),Y=I.clientX,gt=I.clientY;dv(I.view),Or(I),tt.mouse=[ct,this.__zoom.invert(ct)],bo(this),tt.start();function St(Ot){if(wi(Ot),!tt.moved){var Gt=Ot.clientX-Y,Qt=Ot.clientY-gt;tt.moved=Gt*Gt+Qt*Qt>S}tt.event(Ot).zoom("mouse",o(W(tt.that.__zoom,tt.mouse[0]=xn(Ot,z),tt.mouse[1]),tt.extent,l))}function Ht(Ot){at.on("mousemove.zoom mouseup.zoom",null),uv(Ot.view,tt.moved),wi(Ot),tt.event(Ot).end()}}function dt(I,...Z){if(e.apply(this,arguments)){var z=this.__zoom,tt=xn(I.changedTouches?I.changedTouches[0]:I,this),at=z.invert(tt),ct=z.k*(I.shiftKey?.5:2),Y=o(W(V(z,ct),tt,at),i.apply(this,Z),l);wi(I),c>0?le(this).transition().duration(c).call(et,Y,tt,I):le(this).call(A.transform,Y,tt,I)}}function L(I,...Z){if(e.apply(this,arguments)){var z=I.touches,tt=z.length,at=st(this,Z,I.changedTouches.length===tt).event(I),ct,Y,gt,St;for(Or(I),Y=0;Y<tt;++Y)gt=z[Y],St=xn(gt,this),St=[St,this.__zoom.invert(St),gt.identifier],at.touch0?!at.touch1&&at.touch0[2]!==St[2]&&(at.touch1=St,at.taps=0):(at.touch0=St,ct=!0,at.taps=1+!!m);m&&(m=clearTimeout(m)),ct&&(at.taps<2&&(y=St[0],m=setTimeout(function(){m=null},w)),bo(this),at.start())}}function G(I,...Z){if(this.__zooming){var z=st(this,Z).event(I),tt=I.changedTouches,at=tt.length,ct,Y,gt,St;for(wi(I),ct=0;ct<at;++ct)Y=tt[ct],gt=xn(Y,this),z.touch0&&z.touch0[2]===Y.identifier?z.touch0[0]=gt:z.touch1&&z.touch1[2]===Y.identifier&&(z.touch1[0]=gt);if(Y=z.that.__zoom,z.touch1){var Ht=z.touch0[0],Ot=z.touch0[1],Gt=z.touch1[0],Qt=z.touch1[1],jt=(jt=Gt[0]-Ht[0])*jt+(jt=Gt[1]-Ht[1])*jt,oe=(oe=Qt[0]-Ot[0])*oe+(oe=Qt[1]-Ot[1])*oe;Y=V(Y,Math.sqrt(jt/oe)),gt=[(Ht[0]+Gt[0])/2,(Ht[1]+Gt[1])/2],St=[(Ot[0]+Qt[0])/2,(Ot[1]+Qt[1])/2]}else if(z.touch0)gt=z.touch0[0],St=z.touch0[1];else return;z.zoom("touch",o(W(Y,gt,St),z.extent,l))}}function j(I,...Z){if(this.__zooming){var z=st(this,Z).event(I),tt=I.changedTouches,at=tt.length,ct,Y;for(Or(I),v&&clearTimeout(v),v=setTimeout(function(){v=null},w),ct=0;ct<at;++ct)Y=tt[ct],z.touch0&&z.touch0[2]===Y.identifier?delete z.touch0:z.touch1&&z.touch1[2]===Y.identifier&&delete z.touch1;if(z.touch1&&!z.touch0&&(z.touch0=z.touch1,delete z.touch1),z.touch0)z.touch0[1]=this.__zoom.invert(z.touch0[0]);else if(z.end(),z.taps===2&&(Y=xn(Y,this),Math.hypot(y[0]-Y[0],y[1]-Y[1])<R)){var gt=le(this).on("dblclick.zoom");gt&&gt.apply(this,arguments)}}}return A.wheelDelta=function(I){return arguments.length?(r=typeof I=="function"?I:eo(+I),A):r},A.filter=function(I){return arguments.length?(e=typeof I=="function"?I:eo(!!I),A):e},A.touchable=function(I){return arguments.length?(a=typeof I=="function"?I:eo(!!I),A):a},A.extent=function(I){return arguments.length?(i=typeof I=="function"?I:eo([[+I[0][0],+I[0][1]],[+I[1][0],+I[1][1]]]),A):i},A.scaleExtent=function(I){return arguments.length?(s[0]=+I[0],s[1]=+I[1],A):[s[0],s[1]]},A.translateExtent=function(I){return arguments.length?(l[0][0]=+I[0][0],l[1][0]=+I[1][0],l[0][1]=+I[0][1],l[1][1]=+I[1][1],A):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},A.constrain=function(I){return arguments.length?(o=I,A):o},A.duration=function(I){return arguments.length?(c=+I,A):c},A.interpolate=function(I){return arguments.length?(d=I,A):d},A.on=function(){var I=u.on.apply(u,arguments);return I===u?A:I},A.clickDistance=function(I){return arguments.length?(S=(I=+I)*I,A):Math.sqrt(S)},A.tapDistance=function(I){return arguments.length?(R=+I,A):R},A}const YC={name:"ChartTemplate",components:{Avatar:Bn},props:{chartData:{type:Object,default:()=>{}},onAvatarClick:{type:Function,default:()=>{}}},computed:{selectedChart(){return this.$route.params.selectedChart}}},GC={class:"org-chart-node"},FC={class:"inner-box"},WC={class:"main-container"},jC={class:"fullName"},qC={class:"title"},XC={class:"description"},ZC={key:0},JC={key:1};function KC(e,i,o,r,a,s){const l=b("Avatar"),c=b("router-link");return p(),C("div",GC,[T("div",FC,[M(c,{to:{name:"contact",params:{selectedGroup:s.selectedChart,selectedContact:o.chartData.key}}},{default:_(()=>[M(l,{"disable-tooltip":!0,"display-name":o.chartData.fullName,"is-no-user":!0,size:60,url:o.chartData.photoUrl,class:"org-chart-node__avatar"},null,8,["display-name","url"])]),_:1},8,["to"]),i[0]||(i[0]=T("div",{class:"panel"},null,-1)),T("div",WC,[T("h3",jC,E(o.chartData.fullName),1),T("h4",qC,E(o.chartData.title),1)]),T("div",XC,[o.chartData._directSubordinates?(p(),C("p",ZC,E(e.t("contacts","Manages"))+": "+E(o.chartData._directSubordinates),1)):P("",!0),o.chartData._totalSubordinates?(p(),C("p",JC,E(e.t("contacts","Oversees"))+": "+E(o.chartData._totalSubordinates),1)):P("",!0)])])])}const QC=Q(YC,[["render",KC],["__scopeId","data-v-b43f264a"]]);function tw(e){var i=0,o=e.children,r=o&&o.length;if(!r)i=1;else for(;--r>=0;)i+=o[r].value;e.value=i}function ew(){return this.eachAfter(tw)}function nw(e){var i=this,o,r=[i],a,s,l;do for(o=r.reverse(),r=[];i=o.pop();)if(e(i),a=i.children,a)for(s=0,l=a.length;s<l;++s)r.push(a[s]);while(r.length);return this}function iw(e){for(var i=this,o=[i],r,a;i=o.pop();)if(e(i),r=i.children,r)for(a=r.length-1;a>=0;--a)o.push(r[a]);return this}function ow(e){for(var i=this,o=[i],r=[],a,s,l;i=o.pop();)if(r.push(i),a=i.children,a)for(s=0,l=a.length;s<l;++s)o.push(a[s]);for(;i=r.pop();)e(i);return this}function rw(e){return this.eachAfter(function(i){for(var o=+e(i.data)||0,r=i.children,a=r&&r.length;--a>=0;)o+=r[a].value;i.value=o})}function aw(e){return this.eachBefore(function(i){i.children&&i.children.sort(e)})}function sw(e){for(var i=this,o=lw(i,e),r=[i];i!==o;)i=i.parent,r.push(i);for(var a=r.length;e!==o;)r.splice(a,0,e),e=e.parent;return r}function lw(e,i){if(e===i)return e;var o=e.ancestors(),r=i.ancestors(),a=null;for(e=o.pop(),i=r.pop();e===i;)a=e,e=o.pop(),i=r.pop();return a}function cw(){for(var e=this,i=[e];e=e.parent;)i.push(e);return i}function dw(){var e=[];return this.each(function(i){e.push(i)}),e}function uw(){var e=[];return this.eachBefore(function(i){i.children||e.push(i)}),e}function hw(){var e=this,i=[];return e.each(function(o){o!==e&&i.push({source:o.parent,target:o})}),i}function qa(e,i){var o=new zo(e),r=+e.value&&(o.value=e.value),a,s=[o],l,c,d,u;for(i==null&&(i=mw);a=s.pop();)if(r&&(a.value=+a.data.value),(c=i(a.data))&&(u=c.length))for(a.children=new Array(u),d=u-1;d>=0;--d)s.push(l=a.children[d]=new zo(c[d])),l.parent=a,l.depth=a.depth+1;return o.eachBefore(gw)}function pw(){return qa(this).eachBefore(fw)}function mw(e){return e.children}function fw(e){e.data=e.data.data}function gw(e){var i=0;do e.height=i;while((e=e.parent)&&e.height<++i)}function zo(e){this.data=e,this.depth=this.height=0,this.parent=null}zo.prototype=qa.prototype={constructor:zo,count:ew,each:nw,eachAfter:ow,eachBefore:iw,sum:rw,sort:aw,path:sw,ancestors:cw,descendants:dw,leaves:uw,links:hw,copy:pw};const yw="d3-flextree",vw="2.1.2",bw="build/d3-flextree.js",Cw="index",ww={name:"Chris Maloney",url:"http://chrismaloney.org"},kw="Flexible tree layout algorithm that allows for variable node sizes.",_w=["d3","d3-module","layout","tree","hierarchy","d3-hierarchy","plugin","d3-plugin","infovis","visualization","2d"],xw="https://github.com/klortho/d3-flextree",Sw="WTFPL",Mw={type:"git",url:"https://github.com/klortho/d3-flextree.git"},Aw={clean:"rm -rf build demo test","build:demo":"rollup -c --environment BUILD:demo","build:dev":"rollup -c --environment BUILD:dev","build:prod":"rollup -c --environment BUILD:prod","build:test":"rollup -c --environment BUILD:test",build:"rollup -c",lint:"eslint index.js src","test:main":"node test/bundle.js","test:browser":"node test/browser-tests.js",test:"npm-run-all test:*",prepare:"npm-run-all clean build lint test"},Nw={"d3-hierarchy":"^1.1.5"},Lw={"babel-plugin-external-helpers":"^6.22.0","babel-preset-es2015-rollup":"^3.0.0",d3:"^4.13.0","d3-selection-multi":"^1.0.1",eslint:"^4.19.1",jsdom:"^11.6.2","npm-run-all":"^4.1.2",rollup:"^0.55.3","rollup-plugin-babel":"^2.7.1","rollup-plugin-commonjs":"^8.0.2","rollup-plugin-copy":"^0.2.3","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"^3.0.2","rollup-plugin-uglify":"^3.0.0","uglify-es":"^3.3.9"},Dw={name:yw,version:vw,main:bw,module:Cw,"jsnext:main":"index",author:ww,description:kw,keywords:_w,homepage:xw,license:Sw,repository:Mw,scripts:Aw,dependencies:Nw,devDependencies:Lw},{version:Iw}=Dw,Ow=Object.freeze({children:e=>e.children,nodeSize:e=>e.data.size,spacing:0});function Xa(e){const i=Object.assign({},Ow,e);function o(c){const d=i[c];return typeof d=="function"?d:()=>d}function r(c){const d=l(s(),c,u=>u.children);return d.update(),d.data}function a(){const c=o("nodeSize"),d=o("spacing");return class md extends qa.prototype.constructor{constructor(m){super(m)}copy(){const m=l(this.constructor,this,y=>y.children);return m.each(y=>y.data=y.data.data),m}get size(){return c(this)}spacing(m){return d(this,m)}get nodes(){return this.descendants()}get xSize(){return this.size[0]}get ySize(){return this.size[1]}get top(){return this.y}get bottom(){return this.y+this.ySize}get left(){return this.x-this.xSize/2}get right(){return this.x+this.xSize/2}get root(){const m=this.ancestors();return m[m.length-1]}get numChildren(){return this.hasChildren?this.children.length:0}get hasChildren(){return!this.noChildren}get noChildren(){return this.children===null}get firstChild(){return this.hasChildren?this.children[0]:null}get lastChild(){return this.hasChildren?this.children[this.numChildren-1]:null}get extents(){return(this.children||[]).reduce((m,y)=>md.maxExtents(m,y.extents),this.nodeExtents)}get nodeExtents(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}static maxExtents(m,y){return{top:Math.min(m.top,y.top),bottom:Math.max(m.bottom,y.bottom),left:Math.min(m.left,y.left),right:Math.max(m.right,y.right)}}}}function s(){const c=a(),d=o("nodeSize"),u=o("spacing");return class extends c{constructor(m){super(m),Object.assign(this,{x:0,y:0,relX:0,prelim:0,shift:0,change:0,lExt:this,lExtRelX:0,lThr:null,rExt:this,rExtRelX:0,rThr:null})}get size(){return d(this.data)}spacing(m){return u(this.data,m.data)}get x(){return this.data.x}set x(m){this.data.x=m}get y(){return this.data.y}set y(m){this.data.y=m}update(){return fd(this),gd(this),this}}}function l(c,d,u){const m=(y,v)=>{const w=new c(y);Object.assign(w,{parent:v,depth:v===null?0:v.depth+1,height:0,length:1});const D=u(y)||[];return w.children=D.length===0?null:D.map(S=>m(S,w)),w.children&&Object.assign(w,w.children.reduce((S,R)=>({height:Math.max(S.height,R.height+1),length:S.length+R.length}),w)),w};return m(d,null)}return Object.assign(r,{nodeSize(c){return arguments.length?(i.nodeSize=c,r):i.nodeSize},spacing(c){return arguments.length?(i.spacing=c,r):i.spacing},children(c){return arguments.length?(i.children=c,r):i.children},hierarchy(c,d){const u=typeof d>"u"?i.children:d;return l(a(),c,u)},dump(c){const d=o("nodeSize"),u=m=>y=>{const v=m+"  ",w=m+"    ",{x:D,y:S}=y,R=d(y),A=y.children||[],V=A.length===0?" ":`,${v}children: [${w}${A.map(u(w)).join(w)}${v}],${m}`;return`{ size: [${R.join(", ")}],${v}x: ${D}, y: ${S}${V}},`};return u(`
`)(c)}}),r}Xa.version=Iw;const fd=(e,i=0)=>(e.y=i,(e.children||[]).reduce((o,r)=>{const[a,s]=o;fd(r,e.y+e.ySize);const l=(a===0?r.lExt:r.rExt).bottom;a!==0&&Ew(e,a,s);const c=Uw(l,a,s);return[a+1,c]},[0,null]),Tw(e),Vw(e),e),gd=(e,i,o)=>{typeof i>"u"&&(i=-e.relX-e.prelim,o=0);const r=i+e.relX;return e.relX=r+e.prelim-o,e.prelim=0,e.x=o+e.relX,(e.children||[]).forEach(a=>gd(a,r,e.x)),e},Tw=e=>{(e.children||[]).reduce((i,o)=>{const[r,a]=i,s=r+o.shift,l=a+s+o.change;return o.relX+=l,[s,l]},[0,0])},Ew=(e,i,o)=>{const r=e.children[i-1],a=e.children[i];let s=r,l=r.relX,c=a,d=a.relX,u=!0;for(;s&&c;){s.bottom>o.lowY&&(o=o.next);const m=l+s.prelim-(d+c.prelim)+s.xSize/2+c.xSize/2+s.spacing(c);(m>0||m<0&&u)&&(d+=m,Pw(a,m),$w(e,i,o.index,m)),u=!1;const y=s.bottom,v=c.bottom;y<=v&&(s=Hw(s),s&&(l+=s.relX)),y>=v&&(c=zw(c),c&&(d+=c.relX))}!s&&c?Bw(e,i,c,d):s&&!c&&Rw(e,i,s,l)},Pw=(e,i)=>{e.relX+=i,e.lExtRelX+=i,e.rExtRelX+=i},$w=(e,i,o,r)=>{const a=e.children[i],s=i-o;if(s>1){const l=r/s;e.children[o+1].shift+=l,a.shift-=l,a.change-=r-l}},zw=e=>e.hasChildren?e.firstChild:e.lThr,Hw=e=>e.hasChildren?e.lastChild:e.rThr,Bw=(e,i,o,r)=>{const a=e.firstChild,s=a.lExt,l=e.children[i];s.lThr=o;const c=r-o.relX-a.lExtRelX;s.relX+=c,s.prelim-=c,a.lExt=l.lExt,a.lExtRelX=l.lExtRelX},Rw=(e,i,o,r)=>{const a=e.children[i],s=a.rExt,l=e.children[i-1];s.rThr=o;const c=r-o.relX-a.rExtRelX;s.relX+=c,s.prelim-=c,a.rExt=l.rExt,a.rExtRelX=l.rExtRelX},Vw=e=>{if(e.hasChildren){const i=e.firstChild,o=e.lastChild,r=(i.prelim+i.relX-i.xSize/2+o.relX+o.prelim+o.xSize/2)/2;Object.assign(e,{prelim:r,lExt:i.lExt,lExtRelX:i.lExtRelX,rExt:o.rExt,rExtRelX:o.rExtRelX})}},Uw=(e,i,o)=>{for(;o!==null&&e>=o.lowY;)o=o.next;return{lowY:e,index:i,next:o}},Dt={selection:ci,select:le,max:Sy,min:My,sum:Ay,cumsum:xy,tree:MC,stratify:bC,zoom:UC,zoomIdentity:ja,linkHorizontal:PC,flextree:Xa};let Yw=class{constructor(){const e={id:`ID${Math.floor(Math.random()*1e6)}`,firstDraw:!0,ctx:document.createElement("canvas").getContext("2d"),initialExpandLevel:1,nodeDefaultBackground:"none",lastTransform:{x:0,y:0,k:1},allowedNodesCount:{},zoomBehavior:null,generateRoot:null,svgWidth:800,svgHeight:window.innerHeight-100,container:"body",data:null,connections:[],defaultFont:"Helvetica",nodeId:i=>i.nodeId||i.id,parentNodeId:i=>i.parentNodeId||i.parentId,rootMargin:40,nodeWidth:i=>250,nodeHeight:i=>150,neighbourMargin:(i,o)=>80,siblingsMargin:i=>20,childrenMargin:i=>60,compactMarginPair:i=>100,compactMarginBetween:i=>20,nodeButtonWidth:i=>40,nodeButtonHeight:i=>40,nodeButtonX:i=>-20,nodeButtonY:i=>-20,linkYOffset:30,pagingStep:i=>5,minPagingVisibleNodes:i=>2e3,scaleExtent:[.001,20],duration:400,imageName:"Chart",setActiveNodeCentered:!0,layout:"top",compact:!0,createZoom:i=>Dt.zoom(),onZoomStart:i=>{},onZoom:i=>{},onZoomEnd:i=>{},onNodeClick:i=>i,onExpandOrCollapse:i=>i,nodeContent:i=>`<div style="padding:5px;font-size:10px;">Sample Node(id=${i.id}), override using <br/> 
            <code>chart.nodeContent({data}=>{ <br/>
             &nbsp;&nbsp;&nbsp;&nbsp;return '' // Custom HTML <br/>
             })</code>
             <br/> 
             Or check different <a href="https://github.com/bumbeishvili/org-chart#jump-to-examples" target="_blank">layout examples</a>
             </div>`,buttonContent:({node:i,state:o})=>`<div style="border:1px solid #E4E2E9;border-radius:3px;padding:3px;font-size:9px;margin:auto auto;background-color:white"> ${{left:r=>r?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M14.283 3.50094L6.51 11.4749C6.37348 11.615 6.29707 11.8029 6.29707 11.9984C6.29707 12.194 6.37348 12.3819 6.51 12.5219L14.283 20.4989C14.3466 20.5643 14.4226 20.6162 14.5066 20.6516C14.5906 20.6871 14.6808 20.7053 14.772 20.7053C14.8632 20.7053 14.9534 20.6871 15.0374 20.6516C15.1214 20.6162 15.1974 20.5643 15.261 20.4989C15.3918 20.365 15.4651 20.1852 15.4651 19.9979C15.4651 19.8107 15.3918 19.6309 15.261 19.4969L7.9515 11.9984L15.261 4.50144C15.3914 4.36756 15.4643 4.18807 15.4643 4.00119C15.4643 3.81431 15.3914 3.63482 15.261 3.50094C15.1974 3.43563 15.1214 3.38371 15.0374 3.34827C14.9534 3.31282 14.8632 3.29456 14.772 3.29456C14.6808 3.29456 14.5906 3.31282 14.5066 3.34827C14.4226 3.38371 14.3466 3.43563 14.283 3.50094V3.50094Z" fill="#716E7B" stroke="#716E7B"/>
                      </svg></span><span style="color:#716E7B">${i.data._directSubordinatesPaging} </span></div>`:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M7.989 3.49944C7.85817 3.63339 7.78492 3.8132 7.78492 4.00044C7.78492 4.18768 7.85817 4.36749 7.989 4.50144L15.2985 11.9999L7.989 19.4969C7.85817 19.6309 7.78492 19.8107 7.78492 19.9979C7.78492 20.1852 7.85817 20.365 7.989 20.4989C8.05259 20.5643 8.12863 20.6162 8.21261 20.6516C8.2966 20.6871 8.38684 20.7053 8.478 20.7053C8.56916 20.7053 8.6594 20.6871 8.74338 20.6516C8.82737 20.6162 8.90341 20.5643 8.967 20.4989L16.74 12.5234C16.8765 12.3834 16.9529 12.1955 16.9529 11.9999C16.9529 11.8044 16.8765 11.6165 16.74 11.4764L8.967 3.50094C8.90341 3.43563 8.82737 3.38371 8.74338 3.34827C8.6594 3.31282 8.56916 3.29456 8.478 3.29456C8.38684 3.29456 8.2966 3.31282 8.21261 3.34827C8.12863 3.38371 8.05259 3.43563 7.989 3.50094V3.49944Z" fill="#716E7B" stroke="#716E7B"/>
                          </svg></span><span style="color:#716E7B">${i.data._directSubordinatesPaging} </span></div>`,bottom:r=>r?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M19.497 7.98903L12 15.297L4.503 7.98903C4.36905 7.85819 4.18924 7.78495 4.002 7.78495C3.81476 7.78495 3.63495 7.85819 3.501 7.98903C3.43614 8.05257 3.38462 8.12842 3.34944 8.21213C3.31427 8.29584 3.29615 8.38573 3.29615 8.47653C3.29615 8.56733 3.31427 8.65721 3.34944 8.74092C3.38462 8.82463 3.43614 8.90048 3.501 8.96403L11.4765 16.74C11.6166 16.8765 11.8044 16.953 12 16.953C12.1956 16.953 12.3834 16.8765 12.5235 16.74L20.499 8.96553C20.5643 8.90193 20.6162 8.8259 20.6517 8.74191C20.6871 8.65792 20.7054 8.56769 20.7054 8.47653C20.7054 8.38537 20.6871 8.29513 20.6517 8.21114C20.6162 8.12715 20.5643 8.05112 20.499 7.98753C20.3651 7.85669 20.1852 7.78345 19.998 7.78345C19.8108 7.78345 19.6309 7.85669 19.497 7.98753V7.98903Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="margin-left:1px;color:#716E7B" >${i.data._directSubordinatesPaging} </span></div>
                       `:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M11.457 8.07005L3.49199 16.4296C3.35903 16.569 3.28485 16.7543 3.28485 16.9471C3.28485 17.1398 3.35903 17.3251 3.49199 17.4646L3.50099 17.4736C3.56545 17.5414 3.64304 17.5954 3.72904 17.6324C3.81504 17.6693 3.90765 17.6883 4.00124 17.6883C4.09483 17.6883 4.18745 17.6693 4.27344 17.6324C4.35944 17.5954 4.43703 17.5414 4.50149 17.4736L12.0015 9.60155L19.4985 17.4736C19.563 17.5414 19.6405 17.5954 19.7265 17.6324C19.8125 17.6693 19.9052 17.6883 19.9987 17.6883C20.0923 17.6883 20.1849 17.6693 20.2709 17.6324C20.3569 17.5954 20.4345 17.5414 20.499 17.4736L20.508 17.4646C20.641 17.3251 20.7151 17.1398 20.7151 16.9471C20.7151 16.7543 20.641 16.569 20.508 16.4296L12.543 8.07005C12.4729 7.99653 12.3887 7.93801 12.2954 7.89801C12.202 7.85802 12.1015 7.8374 12 7.8374C11.8984 7.8374 11.798 7.85802 11.7046 7.89801C11.6113 7.93801 11.527 7.99653 11.457 8.07005Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="margin-left:1px;color:#716E7B" >${i.data._directSubordinatesPaging} </span></div>
                    `,right:r=>r?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M7.989 3.49944C7.85817 3.63339 7.78492 3.8132 7.78492 4.00044C7.78492 4.18768 7.85817 4.36749 7.989 4.50144L15.2985 11.9999L7.989 19.4969C7.85817 19.6309 7.78492 19.8107 7.78492 19.9979C7.78492 20.1852 7.85817 20.365 7.989 20.4989C8.05259 20.5643 8.12863 20.6162 8.21261 20.6516C8.2966 20.6871 8.38684 20.7053 8.478 20.7053C8.56916 20.7053 8.6594 20.6871 8.74338 20.6516C8.82737 20.6162 8.90341 20.5643 8.967 20.4989L16.74 12.5234C16.8765 12.3834 16.9529 12.1955 16.9529 11.9999C16.9529 11.8044 16.8765 11.6165 16.74 11.4764L8.967 3.50094C8.90341 3.43563 8.82737 3.38371 8.74338 3.34827C8.6594 3.31282 8.56916 3.29456 8.478 3.29456C8.38684 3.29456 8.2966 3.31282 8.21261 3.34827C8.12863 3.38371 8.05259 3.43563 7.989 3.50094V3.49944Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="color:#716E7B">${i.data._directSubordinatesPaging} </span></div>`:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M14.283 3.50094L6.51 11.4749C6.37348 11.615 6.29707 11.8029 6.29707 11.9984C6.29707 12.194 6.37348 12.3819 6.51 12.5219L14.283 20.4989C14.3466 20.5643 14.4226 20.6162 14.5066 20.6516C14.5906 20.6871 14.6808 20.7053 14.772 20.7053C14.8632 20.7053 14.9534 20.6871 15.0374 20.6516C15.1214 20.6162 15.1974 20.5643 15.261 20.4989C15.3918 20.365 15.4651 20.1852 15.4651 19.9979C15.4651 19.8107 15.3918 19.6309 15.261 19.4969L7.9515 11.9984L15.261 4.50144C15.3914 4.36756 15.4643 4.18807 15.4643 4.00119C15.4643 3.81431 15.3914 3.63482 15.261 3.50094C15.1974 3.43563 15.1214 3.38371 15.0374 3.34827C14.9534 3.31282 14.8632 3.29456 14.772 3.29456C14.6808 3.29456 14.5906 3.31282 14.5066 3.34827C14.4226 3.38371 14.3466 3.43563 14.283 3.50094V3.50094Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="color:#716E7B">${i.data._directSubordinatesPaging} </span></div>`,top:r=>r?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.457 8.07005L3.49199 16.4296C3.35903 16.569 3.28485 16.7543 3.28485 16.9471C3.28485 17.1398 3.35903 17.3251 3.49199 17.4646L3.50099 17.4736C3.56545 17.5414 3.64304 17.5954 3.72904 17.6324C3.81504 17.6693 3.90765 17.6883 4.00124 17.6883C4.09483 17.6883 4.18745 17.6693 4.27344 17.6324C4.35944 17.5954 4.43703 17.5414 4.50149 17.4736L12.0015 9.60155L19.4985 17.4736C19.563 17.5414 19.6405 17.5954 19.7265 17.6324C19.8125 17.6693 19.9052 17.6883 19.9987 17.6883C20.0923 17.6883 20.1849 17.6693 20.2709 17.6324C20.3569 17.5954 20.4345 17.5414 20.499 17.4736L20.508 17.4646C20.641 17.3251 20.7151 17.1398 20.7151 16.9471C20.7151 16.7543 20.641 16.569 20.508 16.4296L12.543 8.07005C12.4729 7.99653 12.3887 7.93801 12.2954 7.89801C12.202 7.85802 12.1015 7.8374 12 7.8374C11.8984 7.8374 11.798 7.85802 11.7046 7.89801C11.6113 7.93801 11.527 7.99653 11.457 8.07005Z" fill="#716E7B" stroke="#716E7B"/>
                        </svg></span><span style="margin-left:1px;color:#716E7B">${i.data._directSubordinatesPaging} </span></div>
                        `:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19.497 7.98903L12 15.297L4.503 7.98903C4.36905 7.85819 4.18924 7.78495 4.002 7.78495C3.81476 7.78495 3.63495 7.85819 3.501 7.98903C3.43614 8.05257 3.38462 8.12842 3.34944 8.21213C3.31427 8.29584 3.29615 8.38573 3.29615 8.47653C3.29615 8.56733 3.31427 8.65721 3.34944 8.74092C3.38462 8.82463 3.43614 8.90048 3.501 8.96403L11.4765 16.74C11.6166 16.8765 11.8044 16.953 12 16.953C12.1956 16.953 12.3834 16.8765 12.5235 16.74L20.499 8.96553C20.5643 8.90193 20.6162 8.8259 20.6517 8.74191C20.6871 8.65792 20.7054 8.56769 20.7054 8.47653C20.7054 8.38537 20.6871 8.29513 20.6517 8.21114C20.6162 8.12715 20.5643 8.05112 20.499 7.98753C20.3651 7.85669 20.1852 7.78345 19.998 7.78345C19.8108 7.78345 19.6309 7.85669 19.497 7.98753V7.98903Z" fill="#716E7B" stroke="#716E7B"/>
                        </svg></span><span style="margin-left:1px;color:#716E7B">${i.data._directSubordinatesPaging} </span></div>
                    `}[o.layout](i.children)}  </div>`,pagingButton:(i,o,r,a)=>{const s=a.pagingStep(i.parent),l=i.parent.data._pagingStep,c=i.parent.data._directSubordinatesPaging-l;return`
                   <div style="margin-top:90px;">
                      <div style="display:flex;width:170px;border-radius:20px;padding:5px 15px; padding-bottom:4px;;background-color:#E5E9F2">
                      <div><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M5.59 7.41L10.18 12L5.59 16.59L7 18L13 12L7 6L5.59 7.41ZM16 6H18V18H16V6Z" fill="#716E7B" stroke="#716E7B"/>
                      </svg>
                      </div><div style="line-height:2"> Show next ${Math.min(c,s)}  nodes </div></div>
                   </div>
                `},nodeUpdate:function(i,o,r){Dt.select(this).select(".node-rect").attr("stroke",a=>a.data._highlighted||a.data._upToTheRootHighlighted?"#E27396":"none").attr("stroke-width",i.data._highlighted||i.data._upToTheRootHighlighted?10:1)},nodeEnter:i=>i,nodeExit:i=>i,linkUpdate:function(i,o,r){Dt.select(this).attr("stroke",a=>a.data._upToTheRootHighlighted?"#E27396":"#E4E2E9").attr("stroke-width",a=>a.data._upToTheRootHighlighted?5:1),i.data._upToTheRootHighlighted&&Dt.select(this).raise()},hdiagonal:function(i,o,r){const a=i.x,s=i.y,l=o.x,c=o.y;let d=r&&r.x!=null?r.x:a,u=r&&r.y!=null?r.y:s,m=l-a<0?-1:1,y=c-s<0?-1:1,v=35,w=Math.abs(l-a)/2<v?Math.abs(l-a)/2:v;w=Math.abs(c-s)/2<w?Math.abs(c-s)/2:w;let D=Math.abs(l-a)/2-w;return`
                          M ${d} ${u}
                          L ${d} ${s}
                          L ${a} ${s}
                          L ${a+D*m} ${s}
                          C ${a+D*m+w*m} ${s} 
                            ${a+D*m+w*m} ${s} 
                            ${a+D*m+w*m} ${s+w*y}
                          L ${a+D*m+w*m} ${c-w*y} 
                          C ${a+D*m+w*m}  ${c} 
                            ${a+D*m+w*m}  ${c} 
                            ${l-D*m}  ${c}
                          L ${l} ${c}
               `},diagonal:function(i,o,r,a={sy:0}){const s=i.x;let l=i.y;const c=o.x,d=o.y;let u=r&&r.x!=null?r.x:s,m=r&&r.y!=null?r.y:l,y=c-s<0?-1:1,v=d-l<0?-1:1;l+=a.sy;let w=35,D=Math.abs(c-s)/2<w?Math.abs(c-s)/2:w;D=Math.abs(d-l)/2<D?Math.abs(d-l)/2:D;let S=Math.abs(d-l)/2-D,R=Math.abs(c-s)-D*2;return`
                          M ${u} ${m}
                          L ${s} ${m}
                          L ${s} ${l}
                          L ${s} ${l+S*v}
                          C  ${s} ${l+S*v+D*v} ${s} ${l+S*v+D*v} ${s+D*y} ${l+S*v+D*v}
                          L ${s+R*y+D*y} ${l+S*v+D*v}
                          C  ${c}  ${l+S*v+D*v} ${c}  ${l+S*v+D*v} ${c} ${d-S*v}
                          L ${c} ${d}
               `},defs:function(i,o){return`<defs>
                    ${o.map(r=>{const a=this.getTextWidth(r.label,{ctx:i.ctx,fontSize:2,defaultFont:i.defaultFont});return`
                       <marker id="${r.from+"_"+r.to}" refX="${r._source.x<r._target.x?-7:7}" refY="5" markerWidth="500"  markerHeight="500"  orient="${r._source.x<r._target.x?"auto":"auto-start-reverse"}" >
                       <rect rx=0.5 width=${r.label?a+3:0} height=3 y=1  fill="#E27396"></rect>
                       <text font-size="2px" x=1 fill="white" y=3>${r.label||""}</text>
                       </marker>

                       <marker id="arrow-${r.from+"_"+r.to}"  markerWidth="500"  markerHeight="500"  refY="2"  refX="1" orient="${r._source.x<r._target.x?"auto":"auto-start-reverse"}" >
                       <path transform="translate(0)" d='M0,0 V4 L2,2 Z' fill='#E27396' />
                       </marker>
                    `}).join("")}
                    </defs>
                    `},connectionsUpdate:function(i,o,r){Dt.select(this).attr("stroke",a=>"#E27396").attr("stroke-linecap","round").attr("stroke-width",a=>"5").attr("pointer-events","none").attr("marker-start",a=>`url(#${a.from+"_"+a.to})`).attr("marker-end",a=>`url(#arrow-${a.from+"_"+a.to})`)},linkGroupArc:Dt.linkHorizontal().x(i=>i.x).y(i=>i.y),layoutBindings:{left:{nodeLeftX:i=>0,nodeRightX:i=>i.width,nodeTopY:i=>-i.height/2,nodeBottomY:i=>i.height/2,nodeJoinX:i=>i.x+i.width,nodeJoinY:i=>i.y-i.height/2,linkJoinX:i=>i.x+i.width,linkJoinY:i=>i.y,linkX:i=>i.x,linkY:i=>i.y,linkCompactXStart:i=>i.x+i.width/2,linkCompactYStart:i=>i.y+(i.compactEven?i.height/2:-i.height/2),compactLinkMidX:(i,o)=>i.firstCompactNode.x,compactLinkMidY:(i,o)=>i.firstCompactNode.y+i.firstCompactNode.flexCompactDim[0]/4+o.compactMarginPair(i)/4,linkParentX:i=>i.parent.x+i.parent.width,linkParentY:i=>i.parent.y,buttonX:i=>i.width,buttonY:i=>i.height/2,centerTransform:({root:i,rootMargin:o,centerY:r,scale:a,centerX:s})=>`translate(${o},${r}) scale(${a})`,compactDimension:{sizeColumn:i=>i.height,sizeRow:i=>i.width,reverse:i=>i.slice().reverse()},nodeFlexSize:({height:i,width:o,siblingsMargin:r,childrenMargin:a,state:s,node:l})=>s.compact&&l.flexCompactDim?[l.flexCompactDim[0],l.flexCompactDim[1]]:[i+r,o+a],zoomTransform:({centerY:i,scale:o})=>`translate(0,${i}) scale(${o})`,diagonal:this.hdiagonal.bind(this),swap:i=>{const o=i.x;i.x=i.y,i.y=o},nodeUpdateTransform:({x:i,y:o,width:r,height:a})=>`translate(${i},${o-a/2})`},top:{nodeLeftX:i=>-i.width/2,nodeRightX:i=>i.width/2,nodeTopY:i=>0,nodeBottomY:i=>i.height,nodeJoinX:i=>i.x-i.width/2,nodeJoinY:i=>i.y+i.height,linkJoinX:i=>i.x,linkJoinY:i=>i.y+i.height,linkCompactXStart:i=>i.x+(i.compactEven?i.width/2:-i.width/2),linkCompactYStart:i=>i.y+i.height/2,compactLinkMidX:(i,o)=>i.firstCompactNode.x+i.firstCompactNode.flexCompactDim[0]/4+o.compactMarginPair(i)/4,compactLinkMidY:i=>i.firstCompactNode.y,compactDimension:{sizeColumn:i=>i.width,sizeRow:i=>i.height,reverse:i=>i},linkX:i=>i.x,linkY:i=>i.y,linkParentX:i=>i.parent.x,linkParentY:i=>i.parent.y+i.parent.height,buttonX:i=>i.width/2,buttonY:i=>i.height,centerTransform:({root:i,rootMargin:o,centerY:r,scale:a,centerX:s})=>`translate(${s},${o}) scale(${a})`,nodeFlexSize:({height:i,width:o,siblingsMargin:r,childrenMargin:a,state:s,node:l,compactViewIndex:c})=>s.compact&&l.flexCompactDim?[l.flexCompactDim[0],l.flexCompactDim[1]]:[o+r,i+a],zoomTransform:({centerX:i,scale:o})=>`translate(${i},0}) scale(${o})`,diagonal:this.diagonal.bind(this),swap:i=>{},nodeUpdateTransform:({x:i,y:o,width:r,height:a})=>`translate(${i-r/2},${o})`},bottom:{nodeLeftX:i=>-i.width/2,nodeRightX:i=>i.width/2,nodeTopY:i=>-i.height,nodeBottomY:i=>0,nodeJoinX:i=>i.x-i.width/2,nodeJoinY:i=>i.y-i.height-i.height,linkJoinX:i=>i.x,linkJoinY:i=>i.y-i.height,linkCompactXStart:i=>i.x+(i.compactEven?i.width/2:-i.width/2),linkCompactYStart:i=>i.y-i.height/2,compactLinkMidX:(i,o)=>i.firstCompactNode.x+i.firstCompactNode.flexCompactDim[0]/4+o.compactMarginPair(i)/4,compactLinkMidY:i=>i.firstCompactNode.y,linkX:i=>i.x,linkY:i=>i.y,compactDimension:{sizeColumn:i=>i.width,sizeRow:i=>i.height,reverse:i=>i},linkParentX:i=>i.parent.x,linkParentY:i=>i.parent.y-i.parent.height,buttonX:i=>i.width/2,buttonY:i=>0,centerTransform:({root:i,rootMargin:o,centerY:r,scale:a,centerX:s,chartHeight:l})=>`translate(${s},${l-o}) scale(${a})`,nodeFlexSize:({height:i,width:o,siblingsMargin:r,childrenMargin:a,state:s,node:l})=>s.compact&&l.flexCompactDim?[l.flexCompactDim[0],l.flexCompactDim[1]]:[o+r,i+a],zoomTransform:({centerX:i,scale:o})=>`translate(${i},0}) scale(${o})`,diagonal:this.diagonal.bind(this),swap:i=>{i.y=-i.y},nodeUpdateTransform:({x:i,y:o,width:r,height:a})=>`translate(${i-r/2},${o-a})`},right:{nodeLeftX:i=>-i.width,nodeRightX:i=>0,nodeTopY:i=>-i.height/2,nodeBottomY:i=>i.height/2,nodeJoinX:i=>i.x-i.width-i.width,nodeJoinY:i=>i.y-i.height/2,linkJoinX:i=>i.x-i.width,linkJoinY:i=>i.y,linkX:i=>i.x,linkY:i=>i.y,linkParentX:i=>i.parent.x-i.parent.width,linkParentY:i=>i.parent.y,buttonX:i=>0,buttonY:i=>i.height/2,linkCompactXStart:i=>i.x-i.width/2,linkCompactYStart:i=>i.y+(i.compactEven?i.height/2:-i.height/2),compactLinkMidX:(i,o)=>i.firstCompactNode.x,compactLinkMidY:(i,o)=>i.firstCompactNode.y+i.firstCompactNode.flexCompactDim[0]/4+o.compactMarginPair(i)/4,centerTransform:({root:i,rootMargin:o,centerY:r,scale:a,centerX:s,chartWidth:l})=>`translate(${l-o},${r}) scale(${a})`,nodeFlexSize:({height:i,width:o,siblingsMargin:r,childrenMargin:a,state:s,node:l})=>s.compact&&l.flexCompactDim?[l.flexCompactDim[0],l.flexCompactDim[1]]:[i+r,o+a],compactDimension:{sizeColumn:i=>i.height,sizeRow:i=>i.width,reverse:i=>i.slice().reverse()},zoomTransform:({centerY:i,scale:o})=>`translate(0,${i}) scale(${o})`,diagonal:this.hdiagonal.bind(this),swap:i=>{const o=i.x;i.x=-i.y,i.y=o},nodeUpdateTransform:({x:i,y:o,width:r,height:a})=>`translate(${i-r},${o-a/2})`}}};this.getChartState=()=>e,Object.keys(e).forEach(i=>{this[i]=function(o){if(arguments.length)e[i]=o;else return e[i];return this}}),this.initializeEnterExitUpdatePattern()}initializeEnterExitUpdatePattern(){Dt.selection.prototype.patternify=function(e){var i=this,o=e.selector,r=e.tag,a=e.data||[o],s=i.selectAll("."+o).data(a,(l,c)=>typeof l=="object"&&l.id?l.id:c);return s.exit().remove(),s=s.enter().append(r).merge(s),s.attr("class",o),s}}getNodeChildren({data:e,children:i,_children:o},r){return r.push(e),i&&i.forEach(a=>{this.getNodeChildren(a,r)}),o&&o.forEach(a=>{this.getNodeChildren(a,r)}),r}initialZoom(e){const i=this.getChartState();return i.lastTransform.k=e,this}render(){const e=this.getChartState();if(!e.data||e.data.length==0)return console.log("ORG CHART - Data is empty"),e.container&&(le(e.container).select(".nodes-wrapper").remove(),le(e.container).select(".links-wrapper").remove(),le(e.container).select(".connections-wrapper").remove()),this;const i=Dt.select(e.container),o=i.node().getBoundingClientRect();o.width>0&&(e.svgWidth=o.width);const r={id:`ID${Math.floor(Math.random()*1e6)}`,chartWidth:e.svgWidth,chartHeight:e.svgHeight};if(e.calc=r,r.centerX=r.chartWidth/2,r.centerY=r.chartHeight/2,e.firstDraw){const l={zoom:null};l.zoom=e.createZoom().clickDistance(10).on("start",(c,d)=>e.onZoomStart(c)).on("end",(c,d)=>e.onZoomEnd(c)).on("zoom",(c,d)=>{e.onZoom(c),this.zoomed(c,d)}).scaleExtent(e.scaleExtent),e.zoomBehavior=l.zoom}e.flexTreeLayout=Xa({nodeSize:l=>{const c=e.nodeWidth(l),d=e.nodeHeight(l),u=e.siblingsMargin(l),m=e.childrenMargin(l);return e.layoutBindings[e.layout].nodeFlexSize({state:e,node:l,width:c,height:d,siblingsMargin:u,childrenMargin:m})}}).spacing((l,c)=>l.parent==c.parent?0:e.neighbourMargin(l,c)),this.setLayouts({expandNodesFirst:!1});const a=i.patternify({tag:"svg",selector:"svg-chart-container"}).attr("width",e.svgWidth).attr("height",e.svgHeight).attr("font-family",e.defaultFont);e.firstDraw&&a.call(e.zoomBehavior).on("dblclick.zoom",null).attr("cursor","move"),e.svg=a;const s=a.patternify({tag:"g",selector:"chart"});return e.centerG=s.patternify({tag:"g",selector:"center-group"}),e.linksWrapper=e.centerG.patternify({tag:"g",selector:"links-wrapper"}),e.nodesWrapper=e.centerG.patternify({tag:"g",selector:"nodes-wrapper"}),e.connectionsWrapper=e.centerG.patternify({tag:"g",selector:"connections-wrapper"}),e.defsWrapper=a.patternify({tag:"g",selector:"defs-wrapper"}),e.firstDraw&&e.centerG.attr("transform",()=>e.layoutBindings[e.layout].centerTransform({centerX:r.centerX,centerY:r.centerY,scale:e.lastTransform.k,rootMargin:e.rootMargin,root:e.root,chartHeight:r.chartHeight,chartWidth:r.chartWidth})),e.chart=s,this.update(e.root),Dt.select(window).on(`resize.${e.id}`,()=>{const l=Dt.select(e.container).node().getBoundingClientRect();e.svg.attr("width",l.width)}),e.firstDraw&&(e.firstDraw=!1),this}addNode(e){const i=this.getChartState();if(e&&(i.parentNodeId(e)==null||i.parentNodeId(e)==i.nodeId(e))&&i.data.length==0)return i.data.push(e),this.render(),this;const o=i.generateRoot(i.data).descendants(),r=o.filter(({data:a})=>i.nodeId(a).toString()===i.nodeId(e).toString())[0];return o.filter(({data:a})=>i.nodeId(a).toString()===i.parentNodeId(e).toString())[0],r?(console.log(`ORG CHART - ADD - Node with id "${i.nodeId(e)}" already exists in tree`),this):(e._centered&&!e._expanded&&(e._expanded=!0),i.data.push(e),this.updateNodesState(),this)}removeNode(e){const i=this.getChartState(),o=i.generateRoot(i.data).descendants().filter(({data:r})=>i.nodeId(r)==e)[0];return o?(o.descendants().forEach(r=>r.data._filteredOut=!0),i.data=i.data.filter(r=>!r._filteredOut),i.data.length==0?this.render():this.updateNodesState.bind(this)(),this):(console.log(`ORG CHART - REMOVE - Node with id "${e}" not found in the tree`),this)}groupBy(e,i,o){const r={};return e.forEach(a=>{const s=i(a);r[s]||(r[s]=[]),r[s].push(a)}),Object.keys(r).forEach(a=>{r[a]=o(r[a])}),Object.entries(r)}calculateCompactFlexDimensions(e){const i=this.getChartState();e.eachBefore(o=>{o.firstCompact=null,o.compactEven=null,o.flexCompactDim=null,o.firstCompactNode=null}),e.eachBefore(o=>{if(o.children&&o.children.length>1){const r=o.children.filter(u=>!u.children);if(r.length<2)return;r.forEach((u,m)=>{m||(u.firstCompact=!0),m%2?u.compactEven=!1:u.compactEven=!0,u.row=Math.floor(m/2)});const a=Dt.max(r.filter(u=>u.compactEven),i.layoutBindings[i.layout].compactDimension.sizeColumn),s=Dt.max(r.filter(u=>!u.compactEven),i.layoutBindings[i.layout].compactDimension.sizeColumn),l=Math.max(a,s)*2,c=this.groupBy(r,u=>u.row,u=>Dt.max(u,m=>i.layoutBindings[i.layout].compactDimension.sizeRow(m)+i.compactMarginBetween(m))),d=Dt.sum(c.map(u=>u[1]));r.forEach(u=>{u.firstCompactNode=r[0],u.firstCompact?u.flexCompactDim=[l+i.compactMarginPair(u),d-i.compactMarginBetween(u)]:u.flexCompactDim=[0,0]}),o.flexCompactDim=null}})}calculateCompactFlexPositions(e){const i=this.getChartState();e.eachBefore(o=>{if(o.children){const r=o.children.filter(u=>u.flexCompactDim),a=r[0];if(!a)return;r.forEach((u,m,y)=>{m==0&&(a.x-=a.flexCompactDim[0]/2),m&m%2-1?u.x=a.x+a.flexCompactDim[0]*.25-i.compactMarginPair(u)/4:m&&(u.x=a.x+a.flexCompactDim[0]*.75+i.compactMarginPair(u)/4)});const s=a.x+a.flexCompactDim[0]*.5;a.x=a.x+a.flexCompactDim[0]*.25-i.compactMarginPair(a)/4;const l=o.x-s;Math.abs(l)<10&&r.forEach(u=>u.x+=l);const c=this.groupBy(r,u=>u.row,u=>Dt.max(u,m=>i.layoutBindings[i.layout].compactDimension.sizeRow(m))),d=Dt.cumsum(c.map(u=>u[1]+i.compactMarginBetween(u)));r.forEach((u,m)=>{u.row?u.y=a.y+d[u.row-1]:u.y=a.y})}})}update({x0:e,y0:i,x:o=0,y:r=0,width:a,height:s}){const l=this.getChartState();l.calc,l.compact&&this.calculateCompactFlexDimensions(l.root);const c=l.flexTreeLayout(l.root);l.compact&&this.calculateCompactFlexPositions(l.root);const d=c.descendants(),u=c.descendants().slice(1);d.forEach(l.layoutBindings[l.layout].swap);const m=l.connections,y={};l.allNodes.forEach(L=>y[l.nodeId(L.data)]=L);const v={};d.forEach(L=>v[l.nodeId(L.data)]=L),m.forEach(L=>{const G=y[L.from],j=y[L.to];L._source=G,L._target=j});const w=m.filter(L=>v[L.from]&&v[L.to]),D=l.defs.bind(this)(l,w),S=l.defsWrapper.html();D!==S&&l.defsWrapper.html(D);const R=l.linksWrapper.selectAll("path.link").data(u,L=>l.nodeId(L.data)),A=R.enter().insert("path","g").attr("class","link").attr("d",L=>{const G=l.layoutBindings[l.layout].linkJoinX({x:e,y:i,width:a,height:s}),j=l.layoutBindings[l.layout].linkJoinY({x:e,y:i,width:a,height:s}),I={x:G,y:j};return l.layoutBindings[l.layout].diagonal(I,I,I)}).merge(R);A.attr("fill","none"),this.isEdge()?A.style("display",L=>L.data._pagingButton?"none":"auto"):A.attr("display",L=>L.data._pagingButton?"none":"auto"),A.each(l.linkUpdate),A.transition().duration(l.duration).attr("d",L=>{const G=l.compact&&L.flexCompactDim?{x:l.layoutBindings[l.layout].compactLinkMidX(L,l),y:l.layoutBindings[l.layout].compactLinkMidY(L,l)}:{x:l.layoutBindings[l.layout].linkX(L),y:l.layoutBindings[l.layout].linkY(L)},j={x:l.layoutBindings[l.layout].linkParentX(L),y:l.layoutBindings[l.layout].linkParentY(L)},I=l.compact&&L.flexCompactDim?{x:l.layoutBindings[l.layout].linkCompactXStart(L),y:l.layoutBindings[l.layout].linkCompactYStart(L)}:G;return l.layoutBindings[l.layout].diagonal(G,j,I,{sy:l.linkYOffset})}),R.exit().transition().duration(l.duration).attr("d",L=>{const G=l.layoutBindings[l.layout].linkJoinX({x:o,y:r,width:a,height:s}),j=l.layoutBindings[l.layout].linkJoinY({x:o,y:r,width:a,height:s}),I={x:G,y:j};return l.layoutBindings[l.layout].diagonal(I,I,null,{sy:l.linkYOffset})}).remove();const V=l.connectionsWrapper.selectAll("path.connection").data(w),W=V.enter().insert("path","g").attr("class","connection").attr("d",L=>{const G=l.layoutBindings[l.layout].linkJoinX({x:e,y:i,width:a,height:s}),j=l.layoutBindings[l.layout].linkJoinY({x:e,y:i,width:a,height:s}),I={x:G,y:j};return l.layoutBindings[l.layout].diagonal(I,I,null,{sy:l.linkYOffset})}).merge(V);W.attr("fill","none"),W.transition().duration(l.duration).attr("d",L=>{const G=l.layoutBindings[l.layout].linkX({x:L._source.x,y:L._source.y,width:L._source.width,height:L._source.height}),j=l.layoutBindings[l.layout].linkY({x:L._source.x,y:L._source.y,width:L._source.width,height:L._source.height}),I=l.layoutBindings[l.layout].linkJoinX({x:L._target.x,y:L._target.y,width:L._target.width,height:L._target.height}),Z=l.layoutBindings[l.layout].linkJoinY({x:L._target.x,y:L._target.y,width:L._target.width,height:L._target.height});return l.linkGroupArc({source:{x:G,y:j},target:{x:I,y:Z}})}),W.each(l.connectionsUpdate),V.exit().transition().duration(l.duration).attr("opacity",0).remove();const it=l.nodesWrapper.selectAll("g.node").data(d,({data:L})=>l.nodeId(L)),et=it.enter().append("g").attr("class","node").attr("transform",L=>{if(L==l.root)return`translate(${e},${i})`;const G=l.layoutBindings[l.layout].nodeJoinX({x:e,y:i,width:a,height:s}),j=l.layoutBindings[l.layout].nodeJoinY({x:e,y:i,width:a,height:s});return`translate(${G},${j})`}).attr("cursor","pointer").on("click.node",(L,G)=>{const{data:j}=G;if(![...L.srcElement.classList].includes("node-button-foreign-object")){if([...L.srcElement.classList].includes("paging-button-wrapper")){this.loadPagingNodes(G);return}if(!j._pagingButton){l.onNodeClick(G);return}console.log("event fired, no handlers")}}).on("keydown.node",(L,G)=>{if(L.key==="Enter"||L.key===" "||L.key==="Spacebar"){if([...L.srcElement.classList].includes("node-button-foreign-object"))return;if([...L.srcElement.classList].includes("paging-button-wrapper")){this.loadPagingNodes(G);return}(L.key==="Enter"||L.key===" "||L.key==="Spacebar")&&this.onButtonClick(L,G)}});et.each(l.nodeEnter),et.patternify({tag:"rect",selector:"node-rect",data:L=>[L]});const st=et.merge(it).style("font","12px sans-serif");st.patternify({tag:"foreignObject",selector:"node-foreign-object",data:L=>[L]}).style("overflow","visible").patternify({tag:"xhtml:div",selector:"node-foreign-object-div",data:L=>[L]}),this.restyleForeignObjectElements();const lt=et.patternify({tag:"g",selector:"node-button-g",data:L=>[L]}).on("click",(L,G)=>this.onButtonClick(L,G)).on("keydown",(L,G)=>{(L.key==="Enter"||L.key===" "||L.key==="Spacebar")&&this.onButtonClick(L,G)});lt.patternify({tag:"rect",selector:"node-button-rect",data:L=>[L]}).attr("opacity",0).attr("pointer-events","all").attr("width",L=>l.nodeButtonWidth(L)).attr("height",L=>l.nodeButtonHeight(L)).attr("x",L=>l.nodeButtonX(L)).attr("y",L=>l.nodeButtonY(L)),lt.patternify({tag:"foreignObject",selector:"node-button-foreign-object",data:L=>[L]}).attr("width",L=>l.nodeButtonWidth(L)).attr("height",L=>l.nodeButtonHeight(L)).attr("x",L=>l.nodeButtonX(L)).attr("y",L=>l.nodeButtonY(L)).style("overflow","visible").patternify({tag:"xhtml:div",selector:"node-button-div",data:L=>[L]}).style("pointer-events","none").style("display","flex").style("width","100%").style("height","100%"),st.transition().attr("opacity",0).duration(l.duration).attr("transform",({x:L,y:G,width:j,height:I})=>l.layoutBindings[l.layout].nodeUpdateTransform({x:L,y:G,width:j,height:I})).attr("opacity",1),st.select(".node-rect").attr("width",({width:L})=>L).attr("height",({height:L})=>L).attr("x",({width:L})=>0).attr("y",({height:L})=>0).attr("cursor","pointer").attr("rx",3).attr("fill",l.nodeDefaultBackground),st.select(".node-button-g").attr("transform",({data:L,width:G,height:j})=>{const I=l.layoutBindings[l.layout].buttonX({width:G,height:j}),Z=l.layoutBindings[l.layout].buttonY({width:G,height:j});return`translate(${I},${Z})`}).attr("display",({data:L})=>L._directSubordinates>0?null:"none").attr("opacity",({data:L,children:G,_children:j})=>L._pagingButton?0:G||j?1:0),st.select(".node-button-foreign-object .node-button-div").html(L=>l.buttonContent({node:L,state:l})),st.select(".node-button-text").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-size",({children:L})=>L?40:26).text(({children:L})=>L?"-":"+").attr("y",this.isEdge()?10:0),st.each(l.nodeUpdate);const ht=it.exit();ht.each(l.nodeExit);const rt=ht.data().reduce((L,G)=>L.depth<G.depth?L:G,{depth:1/0});ht.attr("opacity",1).transition().duration(l.duration).attr("transform",L=>{let{x:G,y:j,width:I,height:Z}=rt.parent||{};const z=l.layoutBindings[l.layout].nodeJoinX({x:G,y:j,width:I,height:Z}),tt=l.layoutBindings[l.layout].nodeJoinY({x:G,y:j,width:I,height:Z});return`translate(${z},${tt})`}).on("end",function(){Dt.select(this).remove()}).attr("opacity",0),d.forEach(L=>{L.x0=L.x,L.y0=L.y});const dt=l.allNodes.filter(L=>L.data._centered)[0];if(dt){let L=[dt];dt.data._centeredWithDescendants&&(l.compact?L=dt.descendants().filter((G,j)=>j<7):L=dt.descendants().filter((G,j,I)=>{const Z=Math.round(I.length/2),z=2;return I.length%2?j>Z-z&&j<Z+z-1:j>Z-z&&j<Z+z})),dt.data._centeredWithDescendants=null,dt.data._centered=null,this.fit({animate:!0,scale:!1,nodes:L})}}isEdge(){return window.navigator.userAgent.includes("Edge")}hdiagonal(e,i,o,r){return this.getChartState().hdiagonal(e,i,o,r)}diagonal(e,i,o,r){return this.getChartState().diagonal(e,i,o,r)}restyleForeignObjectElements(){const e=this.getChartState();e.svg.selectAll(".node-foreign-object").attr("width",({width:i})=>i).attr("height",({height:i})=>i).attr("x",({width:i})=>0).attr("y",({height:i})=>0),e.svg.selectAll(".node-foreign-object-div").style("width",({width:i})=>`${i}px`).style("height",({height:i})=>`${i}px`).html(function(i,o,r){return i.data._pagingButton?`<div class="paging-button-wrapper"><div style="pointer-events:none">${e.pagingButton(i,o,r,e)}</div></div>`:e.nodeContent.bind(this)(i,o,r,e)})}onButtonClick(e,i){const o=this.getChartState();i.data._pagingButton||(o.setActiveNodeCentered&&(i.data._centered=!0,i.data._centeredWithDescendants=!0),i.children?(i._children=i.children,i.children=null,this.setExpansionFlagToChildren(i,!1)):(i.children=i._children,i._children=null,i.children&&i.children.forEach(({data:r})=>r._expanded=!0)),this.update(i),e.stopPropagation(),o.onExpandOrCollapse(i))}setExpansionFlagToChildren({data:e,children:i,_children:o},r){e._expanded=r,i&&i.forEach(a=>{this.setExpansionFlagToChildren(a,r)}),o&&o.forEach(a=>{this.setExpansionFlagToChildren(a,r)})}expandSomeNodes(e){if(e.data._expanded){let i=e.parent;for(;i&&i._children;)i.children=i._children,i._children=null,i=i.parent}e._children&&e._children.forEach(i=>this.expandSomeNodes(i)),e.children&&e.children.forEach(i=>this.expandSomeNodes(i))}updateNodesState(){const e=this.getChartState();this.setLayouts({expandNodesFirst:!0}),this.update(e.root)}setLayouts({expandNodesFirst:e=!0}){const i=this.getChartState();i.generateRoot=Dt.stratify().id(a=>i.nodeId(a)).parentId(a=>i.parentNodeId(a)),i.root=i.generateRoot(i.data);const o=i.root.descendants();i.initialExpandLevel>1&&o.length>0&&(o.forEach(a=>{a.depth<=i.initialExpandLevel&&(a.data._expanded=!0)}),i.initialExpandLevel=1);const r={};i.root.descendants().filter(a=>a.children).filter(a=>!a.data._pagingStep).forEach(a=>{a.data._pagingStep=i.minPagingVisibleNodes(a)}),i.root.eachBefore((a,s)=>{a.data._directSubordinatesPaging=a.children?a.children.length:0,a.children&&a.children.forEach((l,c)=>{if(l.data._pagingButton=!1,c>a.data._pagingStep&&(r[l.id]=!0),c===a.data._pagingStep&&a.children.length-1>a.data._pagingStep&&(l.data._pagingButton=!0),r[l.parent.id]&&(r[l.id]=!0),l.data._expanded||l.data._centered||l.data._highlighted||l.data._upToTheRootHighlighted){let d=l;for(;d&&(r[d.id]||d.data._pagingButton);)r[d.id]=!1,d.data._pagingButton&&(d.data._pagingButton=!1,d.parent.children.forEach(u=>{u.data._expanded=!0,r[u.id]=!1})),d=d.parent}})}),i.root=Dt.stratify().id(a=>i.nodeId(a)).parentId(a=>i.parentNodeId(a))(i.data.filter(a=>r[a.id]!==!0)),i.root.each((a,s,l)=>{let c=a._hierarchyHeight||a.height,d=i.nodeWidth(a),u=i.nodeHeight(a);Object.assign(a,{width:d,height:u,_hierarchyHeight:c})}),i.root.x0=0,i.root.y0=0,i.allNodes=i.root.descendants(),i.allNodes.forEach(a=>{Object.assign(a.data,{_directSubordinates:a.children?a.children.length:0,_totalSubordinates:a.descendants().length-1})}),i.root.children&&(e&&i.root.children.forEach(this.expand),i.root.children.forEach(a=>this.collapse(a)),i.initialExpandLevel==0&&(i.root._children=i.root.children,i.root.children=null),[i.root].forEach(a=>this.expandSomeNodes(a)))}collapse(e){e.children&&(e._children=e.children,e._children.forEach(i=>this.collapse(i)),e.children=null)}expand(e){e._children&&(e.children=e._children,e.children.forEach(i=>this.expand(i)),e._children=null)}zoomed(e,i){const o=this.getChartState(),r=o.chart,a=e.transform;o.lastTransform=a,r.attr("transform",a),this.isEdge()&&this.restyleForeignObjectElements()}zoomTreeBounds({x0:e,x1:i,y0:o,y1:r,params:a={animate:!0,scale:!0,onCompleted:()=>{}}}){const{centerG:s,svgWidth:l,svgHeight:c,svg:d,zoomBehavior:u,duration:m,lastTransform:y}=this.getChartState();let v=Math.min(8,.9/Math.max((i-e)/l,(r-o)/c)),w=Dt.zoomIdentity.translate(l/2,c/2);w=w.scale(a.scale?v:y.k),w=w.translate(-(e+i)/2,-(o+r)/2),d.transition().duration(a.animate?m:0).call(u.transform,w),s.transition().duration(a.animate?m:0).attr("transform","translate(0,0)").on("end",function(){a.onCompleted&&a.onCompleted()})}fit({animate:e=!0,nodes:i,scale:o=!0,onCompleted:r=()=>{}}={}){const a=this.getChartState(),{root:s}=a;let l=i||s.descendants();const c=Dt.min(l,y=>y.x+a.layoutBindings[a.layout].nodeLeftX(y)),d=Dt.max(l,y=>y.x+a.layoutBindings[a.layout].nodeRightX(y)),u=Dt.min(l,y=>y.y+a.layoutBindings[a.layout].nodeTopY(y)),m=Dt.max(l,y=>y.y+a.layoutBindings[a.layout].nodeBottomY(y));return this.zoomTreeBounds({params:{animate:e,scale:o,onCompleted:r},x0:c-50,x1:d+50,y0:u-50,y1:m+50}),this}loadPagingNodes(e){const i=this.getChartState();e.data._pagingButton=!1;const o=e.parent.data._pagingStep,r=i.pagingStep(e.parent),a=o+r;e.parent.data._pagingStep=a,this.updateNodesState()}setExpanded(e,i=!0){const o=this.getChartState(),r=o.allNodes.filter(({data:a})=>o.nodeId(a)==e)[0];if(!r)return console.log(`ORG CHART - ${i?"EXPAND":"COLLAPSE"} - Node with id (${e})  not found in the tree`),this;if(r.data._expanded=i,i==!1){const a=r.parent||{descendants:()=>[]};a.descendants().filter(s=>s!=a).forEach(s=>s.data._expanded=!1)}return this}setCentered(e){const i=this.getChartState(),o=i.generateRoot(i.data).descendants().filter(({data:r})=>i.nodeId(r).toString()==e.toString())[0];return o?(o.ancestors().forEach(r=>r.data._expanded=!0),o.data._centered=!0,o.data._expanded=!0,this):(console.log(`ORG CHART - CENTER - Node with id (${e}) not found in the tree`),this)}setHighlighted(e){const i=this.getChartState(),o=i.generateRoot(i.data).descendants().filter(r=>i.nodeId(r.data).toString()===e.toString())[0];return o?(o.ancestors().forEach(r=>r.data._expanded=!0),o.data._highlighted=!0,o.data._expanded=!0,o.data._centered=!0,this):(console.log(`ORG CHART - HIGHLIGHT - Node with id (${e})  not found in the tree`),this)}setUpToTheRootHighlighted(e){const i=this.getChartState(),o=i.generateRoot(i.data).descendants().filter(r=>i.nodeId(r.data).toString()===e.toString())[0];return o?(o.ancestors().forEach(r=>r.data._expanded=!0),o.data._upToTheRootHighlighted=!0,o.data._expanded=!0,o.ancestors().forEach(r=>r.data._upToTheRootHighlighted=!0),this):(console.log(`ORG CHART - HIGHLIGHTROOT - Node with id (${e}) not found in the tree`),this)}clearHighlighting(){const e=this.getChartState();return e.allNodes.forEach(i=>{i.data._highlighted=!1,i.data._upToTheRootHighlighted=!1}),this.update(e.root),this}fullscreen(e){const i=this.getChartState(),o=Dt.select(e||i.container).node();Dt.select(document).on("fullscreenchange."+i.id,function(r){(document.fullscreenElement||document.mozFullscreenElement||document.webkitFullscreenElement)==o?setTimeout(a=>{i.svg.attr("height",window.innerHeight-40)},500):i.svg.attr("height",i.svgHeight)}),o.requestFullscreen?o.requestFullscreen():o.mozRequestFullScreen?o.mozRequestFullScreen():o.webkitRequestFullscreen?o.webkitRequestFullscreen():o.msRequestFullscreen&&o.msRequestFullscreen()}zoomIn(){const{svg:e,zoomBehavior:i}=this.getChartState();e.transition().call(i.scaleBy,1.3)}zoomOut(){const{svg:e,zoomBehavior:i}=this.getChartState();e.transition().call(i.scaleBy,.78)}toDataURL(e,i){var o=new XMLHttpRequest;o.onload=function(){var r=new FileReader;r.onloadend=function(){i(r.result)},r.readAsDataURL(o.response)},o.open("GET",e),o.responseType="blob",o.send()}exportImg({full:e=!1,scale:i=3,onLoad:o=s=>s,save:r=!0,backgroundColor:a="#FAFAFA"}={}){const s=this,l=this.getChartState(),{svg:c,root:d}=l;let u=0;const m=c.selectAll("img");let y=m.size();const v=()=>{JSON.parse(JSON.stringify(s.lastTransform()));const w=s.duration();e&&s.fit();const{svg:D}=s.getChartState();setTimeout(S=>{s.downloadImage({node:D.node(),scale:i,isSvg:!1,backgroundColor:a,onAlreadySerialized:R=>{s.update(d)},imageName:l.imageName,onLoad:o,save:r})},e?w+10:0)};y>0?m.each(function(){s.toDataURL(this.src,w=>{this.src=w,++u==y&&v()})}):v()}exportSvg(){const{svg:e,imageName:i}=this.getChartState();return this.downloadImage({imageName:i,node:e.node(),scale:3,isSvg:!0}),this}expandAll(){const{allNodes:e,root:i,data:o}=this.getChartState();return o.forEach(r=>r._expanded=!0),this.render(),this}collapseAll(){const{allNodes:e,root:i}=this.getChartState();return e.forEach(o=>o.data._expanded=!1),this.initialExpandLevel(0),this.render(),this}downloadImage({node:e,scale:i=2,imageName:o="graph",isSvg:r=!1,save:a=!0,backgroundColor:s="#FAFAFA",onAlreadySerialized:l=d=>{},onLoad:c=d=>{}}){const d=e;function u(D,S){var R=document.createElement("a");typeof R.download=="string"?(document.body.appendChild(R),R.download=S,R.href=D,R.click(),document.body.removeChild(R)):location.replace(D)}function m(D){const S="http://www.w3.org/2000/xmlns/",R="http://www.w3.org/1999/xlink",A="http://www.w3.org/2000/svg";D=D.cloneNode(!0);const V=window.location.href+"#",W=document.createTreeWalker(D,NodeFilter.SHOW_ELEMENT,null,!1);for(;W.nextNode();)for(const it of W.currentNode.attributes)it.value.includes(V)&&(it.value=it.value.replace(V,"#"));return D.setAttributeNS(S,"xmlns",A),D.setAttributeNS(S,"xmlns:xlink",R),new XMLSerializer().serializeToString(D)}if(r){let D=m(d);D=`<?xml version="1.0" standalone="no"?>\r
`+D;var w="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(D);u(w,o+".svg"),l();return}const y=i,v=document.createElement("img");v.onload=function(){const D=document.createElement("canvas"),S=d.getBoundingClientRect();D.width=S.width*y,D.height=S.height*y;const R=D.getContext("2d");R.fillStyle=s,R.fillRect(0,0,S.width*y,S.height*y),R.drawImage(v,0,0,S.width*y,S.height*y);let A=D.toDataURL("image/png");c&&c(A),a&&u(A,o+".png")};var w="data:image/svg+xml; charset=utf8, "+encodeURIComponent(m(d));l(),v.src=w}getTextWidth(e,{fontSize:i=14,fontWeight:o=400,defaultFont:r="Helvetice",ctx:a}={}){return a.font=`${o||""} ${i}px ${r} `,a.measureText(e).width}clear(){const e=this.getChartState();Dt.select(window).on(`resize.${e.id}`,null),e.svg&&e.svg.selectAll("*").remove()}};const Gw={name:"OrgChart",components:{NcSelect:Rn},props:{data:{type:Array,default:()=>[]}},data(){return{chartReference:null,chart:0}},computed:{charts(){return this.data.map((e,i)=>{const o=e.find(r=>r.parentNodeId===null);return{id:i,label:o.org?`${o.org} (${o.fullName})`:o.fullName}}).sort((e,i)=>e.label.localeCompare(i.label,I1().replace("_","-"),{sensitivity:"base"}))},placeholder(){return t("contacts","Select chart …")}},watch:{data(){this.data[this.chart]?.length&&this.renderChart(this.data[this.chart])}},mounted(){this.data[this.chart]?.length&&this.renderChart(this.data[this.chart])},methods:{chartChanged(e){this.renderChart(this.data[e.id])},goToContact(e){this.$router.push({name:"contact",params:{selectedGroup:this.$route.params.selectedChart,selectedContact:e}})},renderChart(e){const i=this;this.chartReference||(this.chartReference=new Yw),this.chartReference.container(this.$refs.svgElementContainer).data(e).nodeWidth(()=>250).initialZoom(1).nodeHeight(()=>200).childrenMargin(()=>70).compactMarginBetween(()=>15).compactMarginPair(()=>80).nodeContent(()=>"").nodeUpdate(function(o){const r=this.querySelector(".node-foreign-object-div");if(r)if(o.data.rendered)r.appendChild(o.data.rendered);else{const a=_a(QC,{chartData:o.data,onAvatarClick:l=>i.goToContact(l)});a.use(ka),a.mixin(oc);const s=document.createElement("div");a.mount(s),o.data.rendered=s,r.appendChild(s)}le(this).select(".inner-box").attr("class",a=>a.data._highlighted||a.data._upToTheRootHighlighted?"inner-box inner-box-highlight":"inner-box")}).linkUpdate(function(o){le(this).attr("stroke",()=>"var(--color-primary-element)").attr("stroke-width",r=>r.data._upToTheRootHighlighted?2:1),o.data._upToTheRootHighlighted&&le(this).raise()}).onNodeClick(o=>{this.chartReference.data().filter(r=>r.nodeId===o)[0]._upToTheRootHighlighted?this.chartReference.clearHighlighting():(this.chartReference.clearHighlighting(),this.chartReference.setUpToTheRootHighlighted(o).render())}).render()}}},Fw={class:"org-chart"},Ww={key:0,class:"org-chart__menu"},jw={ref:"svgElementContainer",class:"org-chart__container"};function qw(e,i,o,r,a,s){const l=b("NcSelect");return p(),C("div",Fw,[o.data.length>1?(p(),C("div",Ww,[T("h3",null,E(e.t("contacts","Chart"))+": ",1),M(l,{modelValue:a.chart,"onUpdate:modelValue":[i[0]||(i[0]=c=>a.chart=c),s.chartChanged],class:"chart-selection",disabled:o.data.length===1,options:s.charts,"allow-empty":!1,searchable:!1,placeholder:s.placeholder,"input-id":"select-chart-input",label:"label"},null,8,["modelValue","disabled","options","placeholder","onUpdate:modelValue"])])):P("",!0),T("div",jw,null,512)])}const Xw=Q(Gw,[["render",qw]]),Zw={name:"ChartContent",components:{AppContent:Da,OrgChart:Xw},props:{contactsList:{type:Object,required:!0}},data(){return{data:[],searchQuery:""}},computed:{transformData(){const e={},i=Object.keys(this.contactsList).map(s=>{const[l,c]=ve.from(s,"base64").toString("utf-8").split("~");return e[c]||(e[c]={}),e[c][l]=this.contactsList[s]}),o=[],r=i.filter(s=>s.managersName).reduce((s,l)=>{s.push(_r(l));const c=e[l.addressbook.id][l.managersName];return c&&!c.managersName&&!o.some(d=>d.nodeId===c.uid)&&(s.push(_r(c)),o.push(_r(c))),s},[]),a=o.map(s=>om(r,s));return console.debug("Org charts",a.map((s,l)=>s.map(c=>`list ${l} ${c.nodeId} (${c.fullName}) -> ${c.parentNodeId}`))),a}}};function Jw(e,i,o,r,a,s){const l=b("OrgChart"),c=b("AppContent");return p(),O(c,null,{default:_(()=>[M(l,{data:s.transformData},null,8,["data"])]),_:1})}const Kw=Q(Zw,[["render",Jw]]);function Qw(e){e=structuredClone(e);const i=e.length,o=0;for(let r=-3;r<=3;r++)for(let a=-3;a<=3;a++)e[3+r][3+a]=o,e[3+r][i-4+a]=o,e[i-4+r][3+a]=o;for(let r=0;r<8;r++)e[7][r]=e[r][7]=e[7][i-r-1]=e[r][i-8]=e[i-8][r]=e[i-1-r][7]=o;return e}function tk(e,i,o){e=structuredClone(e);const r=e.length,a=Math.ceil((r*i/100+r%2)/2)*2-r%2,s=e[0]?.length??0,l=Math.ceil((s*o/100+s%2)/2)*2-s%2,c=Math.round((r-a)/2),d=Math.round((s-l)/2);for(let u=c;u<c+a;u+=1)for(let m=d;m<d+l;m+=1)e[u][m]=0;return e}const ek=new TextEncoder,nk=new TextDecoder;function la(e,i){let o,r;if(typeof e=="string"||typeof e=="number")o=`${e}`,r=ek.encode(o);else if(Array.isArray(e))r=new Uint8Array(e),o=nk.decode(e);else throw new Error("Bad data: "+typeof e);if(/^[0-9]+$/.test(o)){if(r.byteLength>7089)throw new Error("Too much data");return rk(o)}if(/^[0-9A-Z \$%\*\+\.\/\:\-]+$/.test(o)){if(r.byteLength>4296)throw new Error("Too much data");return ok(o)}if(i&&/^https?:/i.test(o))return ak(o);if(r.byteLength>2953)throw new Error("Too much data");return ik(new Uint8Array(r))}function ke(e,i,o){for(let r=1<<i-1;r;r>>>=1)e.push(r&o?1:0)}function ik(e){const i=e.byteLength,o=[];for(let s=0;s<i;s++)ke(o,8,e[s]);const r={};let a=[0,1,0,0];if(ke(a,16,i),r.data10=r.data27=a.concat(o),i<256){let s=[0,1,0,0];ke(s,8,i),r.data1=s.concat(o)}return r}const fl=function(e){const i={};for(let o=0;o<e.length;o++)i[e[o]]=o;return i}("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:");function ok(e){const i=e.length,o=[];for(let s=0;s<i;s+=2){let l=6,c=fl[e[s]];e[s+1]&&(l=11,c=c*45+fl[e[s+1]]),ke(o,l,c)}const r={};let a=[0,0,1,0];if(ke(a,13,i),r.data27=a.concat(o),i<2048){let s=[0,0,1,0];ke(s,11,i),r.data10=s.concat(o)}if(i<512){let s=[0,0,1,0];ke(s,9,i),r.data1=s.concat(o)}return r}function rk(e){const i=e.length,o=[];for(let s=0;s<i;s+=3){const l=e.substr(s,3),c=Math.ceil(l.length*10/3);ke(o,c,parseInt(l,10))}const r={};let a=[0,0,0,1];if(ke(a,14,i),r.data27=a.concat(o),i<4096){let s=[0,0,0,1];ke(s,12,i),r.data10=s.concat(o)}if(i<1024){let s=[0,0,0,1];ke(s,10,i),r.data1=s.concat(o)}return r}function ak(e){const i=e.indexOf("/",8)+1||e.length,o=la(e.slice(0,i).toUpperCase(),!1);if(i>=e.length)return o;const r=la(e.slice(i),!1);return o.data27=o.data27.concat(r.data27),o.data10&&r.data10&&(o.data10=o.data10.concat(r.data10)),o.data1&&r.data1&&(o.data1=o.data1.concat(r.data1)),o}function sk(e,i){e=[].slice.call(e);const o=bd(i);for(let r=0;r<i;r++)e.push(0);for(;e.length>i;){if(!e[0]){e.shift();continue}const r=vd(e[0]);for(let a=0;a<=i;a++)e[a]=e[a]^ca(o[a]+r);e.shift()}return new Uint8Array(e)}const lk=285,Ho=[1],yd=[];for(let e=1;e<256;e++){let i=Ho[e-1]<<1;i>255&&(i^=lk),Ho[e]=i}for(let e=0;e<255;e++)yd[Ho[e]]=e;function ca(e){for(;e<0;)e+=255;for(;e>255;)e-=255;return Ho[e]}function vd(e){if(e<1||e>255)throw Error(`Bad log(${e})`);return yd[e]}const Tr=[[0],[0,0],[0,25,1]];function bd(e){if(Tr[e])return Tr[e];const i=bd(e-1),o=[];o[0]=i[0];for(let r=1;r<=e;r++)o[r]=vd(ca(i[r])^ca(i[r-1]+e-1));return Tr[e]=o,o}function ck(e){const i=(e<<2)+17;return Array(i).fill(null).map(()=>Array(i).fill(0))}function dk(e){const i=e.length;for(let o=-3;o<=3;o++)for(let r=-3;r<=3;r++){const a=Math.max(o,r),s=Math.min(o,r),l=a==2&&s>=-2||s==-2&&a<=2?128:129;e[3+o][3+r]=l,e[3+o][i-4+r]=l,e[i-4+o][3+r]=l}for(let o=0;o<8;o++)e[7][o]=e[o][7]=e[7][i-o-1]=e[o][i-8]=e[i-8][o]=e[i-1-o][7]=128}function uk(e){const i=e.length;if(i>21){const r=i-13;let a=Math.round(r/Math.ceil(r/28));a%2&&a++;const s=[];for(let l=r+6;l>10;l-=a)s.unshift(l);s.unshift(6);for(var o=0;o<s.length;o++)for(let l=0;l<s.length;l++){const c=s[o],d=s[l];if(!e[c][d])for(let u=-2;u<=2;u++)for(let m=-2;m<=2;m++){const y=Math.max(u,m),v=Math.min(u,m),w=y==1&&v>=-1||v==-1&&y<=1?128:129;e[c+u][d+m]=w}}}for(var o=8;o<i-8;o++)e[6][o]=e[o][6]=o%2?128:129}function hk(e){const i=e.length;for(var o=0;o<8;o++)o!=6&&(e[8][o]=e[o][8]=128),e[8][i-1-o]=128,e[i-1-o][8]=128;if(e[8][8]=128,e[i-8][8]=129,!(i<45))for(var o=i-11;o<i-8;o++)for(let a=0;a<6;a++)e[o][a]=e[a][o]=128}const gl=function(){const e=Array(32),i=Array(40),o=1335,r=7973,a=21522;for(let l=0;l<32;l++){let c=l<<10;for(let d=5;d>0;d--)c>>>9+d&&(c^=o<<d-1);e[l]=(c|l<<10)^a}for(let l=7;l<=40;l++){let c=l<<12;for(let d=6;d>0;d--)c>>>11+d&&(c^=r<<d-1);i[l]=c|l<<12}const s={L:1,M:0,Q:3,H:2};return function(l,c,d){const u=l.length,m=e[s[c]<<3|d];function y(S){return m>>S&1?129:128}for(var v=0;v<8;v++)l[8][u-1-v]=y(v),v<6&&(l[v][8]=y(v));for(var v=8;v<15;v++)l[u-15+v][8]=y(v),v>8&&(l[8][14-v]=y(v));l[7][8]=y(6),l[8][8]=y(7),l[8][7]=y(8);const w=i[(u-17)/4];if(!w)return;function D(S){return w>>S&1?129:128}for(var v=0;v<6;v++)for(let R=0;R<3;R++)l[u-11+R][v]=l[v][u-11+R]=D(v*3+R)}}(),yl=function(){const e=[(i,o)=>(i+o)%2==0,(i,o)=>i%2==0,(i,o)=>o%3==0,(i,o)=>(i+o)%3==0,(i,o)=>(Math.floor(i/2)+Math.floor(o/3))%2==0,(i,o)=>i*o%2+i*o%3==0,(i,o)=>(i*o%2+i*o%3)%2==0,(i,o)=>(i*o%3+(i+o)%2)%2==0];return function(i,o,r){const a=i.length;let s,l,c=-1;s=l=a-1;const d=e[r];let u=o.blocks[o.blocks.length-1].length;for(var m=0;m<u;m++)for(var y=0;y<o.blocks.length;y++)o.blocks[y].length<=m||v(o.blocks[y][m]);u=o.ec_len;for(var m=0;m<u;m++)for(var y=0;y<o.ec.length;y++)v(o.ec[y][m]);if(l>-1)do i[s][l]=d(s,l)?1:0;while(w());function v(D){for(let S=128;S;S>>=1){let R=!!(S&D);d(s,l)&&(R=!R),i[s][l]=R?1:0,w()}}function w(){do if(l%2^+(l<6)?c<0&&s==0||c>0&&s==a-1?(l--,c=-c):(l++,s+=c):l--,l==6&&l--,l<0)return!1;while(i[s][l]&240);return!0}}}();function pk(e){const i=e.length;let o=0;for(var r=0;r<i;r++){for(var a=e[r][0]&1,s=1,l=1;l<i;l++){var c=e[r][l]&1;if(c==a){s++;continue}s>=5&&(o+=s-2),a=c,s=1}s>=5&&(o+=s-2)}for(var l=0;l<i;l++){for(var a=e[0][l]&1,s=1,r=1;r<i;r++){var c=e[r][l]&1;if(c==a){s++;continue}s>=5&&(o+=s-2),a=c,s=1}s>=5&&(o+=s-2)}for(var r=0;r<i-1;r++)for(var l=0;l<i-1;l++){const w=e[r][l]+e[r][l+1]+e[r+1][l]+e[r+1][l+1]&7;(w==0||w==4)&&(o+=3)}function d(y){return e[r][l+y]&1}function u(y){return e[r+y][l]&1}for(var r=0;r<i;r++)for(var l=0;l<i;l++)l<i-6&&d(0)&&!d(1)&&d(2)&&d(3)&&d(4)&&!d(5)&&d(6)&&(l>=4&&!(d(-4)||d(-3)||d(-2)||d(-1))&&(o+=40),l<i-10&&!(d(7)||d(8)||d(9)||d(10))&&(o+=40)),r<i-6&&u(0)&&!u(1)&&u(2)&&u(3)&&u(4)&&!u(5)&&u(6)&&(r>=4&&!(u(-4)||u(-3)||u(-2)||u(-1))&&(o+=40),r<i-10&&!(u(7)||u(8)||u(9)||u(10))&&(o+=40));let m=0;for(var r=0;r<i;r++)for(var l=0;l<i;l++)e[r][l]&1&&m++;return o+=10*Math.floor(Math.abs(10-20*m/(i*i))),o}function mk(e){const i=ck(e.version);dk(i),uk(i),hk(i);let o=1/0,r=0;for(let a=0;a<8;a++){yl(i,e,a),gl(i,e.ec_level,a);const s=pk(i);s<o&&(o=s,r=a)}return yl(i,e,r),gl(i,e.ec_level,r),i.map(a=>a.map(s=>s&1))}const Cd=["L","M","Q","H"];function fk(e,i){let o=1,r;for(e.data1?r=Math.ceil(e.data1.length/8):o=10;o<10;o++){let a=Pr[o][i];if(a.data_len>=r)return Er(a)}for(e.data10?r=Math.ceil(e.data10.length/8):o=27;o<27;o++){let a=Pr[o][i];if(a.data_len>=r)return Er(a)}for(r=Math.ceil(e.data27.length/8);o<41;o++){let a=Pr[o][i];if(a.data_len>=r)return Er(a)}throw new Error("Too much data")}function gk(e,i){const o=new Uint8ClampedArray(i.data_len);let r;i.version<10?r=e.data1:i.version<27?r=e.data10:r=e.data27;const a=r.length;for(let c=0;c<a;c+=8){let d=0;for(let u=0;u<8;u++)d=d<<1|(r[c+u]?1:0);o[c/8]=d}let s=236;for(let c=Math.ceil((a+4)/8);c<o.length;c++)o[c]=s,s=s==236?17:236;let l=0;return i.blocks=i.blocks.map(c=>{const d=o.slice(l,l+c);return l+=c,i.ec.push(sk(d,i.ec_len)),d}),i}function yk(e,i,o){i=Cd.includes(i)?i:"M";const r=la(e,o),a=gk(r,fk(r,i));return mk(a)}const Er=typeof structuredClone<"u"?structuredClone:e=>JSON.parse(JSON.stringify(e)),vk=[[],[26,7,1,10,1,13,1,17,1],[44,10,1,16,1,22,1,28,1],[70,15,1,26,1,36,2,44,2],[100,20,1,36,2,52,2,64,4],[134,26,1,48,2,72,4,88,4],[172,36,2,64,4,96,4,112,4],[196,40,2,72,4,108,6,130,5],[242,48,2,88,4,132,6,156,6],[292,60,2,110,5,160,8,192,8],[346,72,4,130,5,192,8,224,8],[404,80,4,150,5,224,8,264,11],[466,96,4,176,8,260,10,308,11],[532,104,4,198,9,288,12,352,16],[581,120,4,216,9,320,16,384,16],[655,132,6,240,10,360,12,432,18],[733,144,6,280,10,408,17,480,16],[815,168,6,308,11,448,16,532,19],[901,180,6,338,13,504,18,588,21],[991,196,7,364,14,546,21,650,25],[1085,224,8,416,16,600,20,700,25],[1156,224,8,442,17,644,23,750,25],[1258,252,9,476,17,690,23,816,34],[1364,270,9,504,18,750,25,900,30],[1474,300,10,560,20,810,27,960,32],[1588,312,12,588,21,870,29,1050,35],[1706,336,12,644,23,952,34,1110,37],[1828,360,12,700,25,1020,34,1200,40],[1921,390,13,728,26,1050,35,1260,42],[2051,420,14,784,28,1140,38,1350,45],[2185,450,15,812,29,1200,40,1440,48],[2323,480,16,868,31,1290,43,1530,51],[2465,510,17,924,33,1350,45,1620,54],[2611,540,18,980,35,1440,48,1710,57],[2761,570,19,1036,37,1530,51,1800,60],[2876,570,19,1064,38,1590,53,1890,63],[3034,600,20,1120,40,1680,56,1980,66],[3196,630,21,1204,43,1770,59,2100,70],[3362,660,22,1260,45,1860,62,2220,74],[3532,720,24,1316,47,1950,65,2310,77],[3706,750,25,1372,49,2040,68,2430,81]],Pr=vk.map((e,i)=>{if(!i)return Object.create(null);const o=Object.create(null);for(let r=1;r<8;r+=2){const a=e[0]-e[r],s=e[r+1],l=Cd[r/2|0],c={version:i,ec_level:l,data_len:a,ec_len:e[r]/s,blocks:[],ec:[]};for(let d=s,u=a;d>0;d--){const m=u/d|0;c.blocks.push(m),u-=m}o[l]=c}return o});var wd={exports:{}},bk={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},kd={exports:{}},Ck=function(e){return!e||typeof e=="string"?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")},wk=Ck,kk=Array.prototype.concat,_k=Array.prototype.slice,vl=kd.exports=function(e){for(var i=[],o=0,r=e.length;o<r;o++){var a=e[o];wk(a)?i=kk.call(i,_k.call(a)):i.push(a)}return i};vl.wrap=function(e){return function(){return e(vl(arguments))}};var xk=kd.exports,Li=bk,ki=xk,_d=Object.hasOwnProperty,xd=Object.create(null);for(var $r in Li)_d.call(Li,$r)&&(xd[Li[$r]]=$r);var de=wd.exports={to:{},get:{}};de.get=function(e){var i=e.substring(0,3).toLowerCase(),o,r;switch(i){case"hsl":o=de.get.hsl(e),r="hsl";break;case"hwb":o=de.get.hwb(e),r="hwb";break;default:o=de.get.rgb(e),r="rgb";break}return o?{model:r,value:o}:null},de.get.rgb=function(e){if(!e)return null;var i=/^#([a-f0-9]{3,4})$/i,o=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,r=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,a=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,s=/^(\w+)$/,l=[0,0,0,1],c,d,u;if(c=e.match(o)){for(u=c[2],c=c[1],d=0;d<3;d++){var m=d*2;l[d]=parseInt(c.slice(m,m+2),16)}u&&(l[3]=parseInt(u,16)/255)}else if(c=e.match(i)){for(c=c[1],u=c[3],d=0;d<3;d++)l[d]=parseInt(c[d]+c[d],16);u&&(l[3]=parseInt(u+u,16)/255)}else if(c=e.match(r)){for(d=0;d<3;d++)l[d]=parseInt(c[d+1],0);c[4]&&(c[5]?l[3]=parseFloat(c[4])*.01:l[3]=parseFloat(c[4]))}else if(c=e.match(a)){for(d=0;d<3;d++)l[d]=Math.round(parseFloat(c[d+1])*2.55);c[4]&&(c[5]?l[3]=parseFloat(c[4])*.01:l[3]=parseFloat(c[4]))}else return(c=e.match(s))?c[1]==="transparent"?[0,0,0,0]:_d.call(Li,c[1])?(l=Li[c[1]],l[3]=1,l):null:null;for(d=0;d<3;d++)l[d]=cn(l[d],0,255);return l[3]=cn(l[3],0,1),l},de.get.hsl=function(e){if(!e)return null;var i=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,o=e.match(i);if(o){var r=parseFloat(o[4]),a=(parseFloat(o[1])%360+360)%360,s=cn(parseFloat(o[2]),0,100),l=cn(parseFloat(o[3]),0,100),c=cn(isNaN(r)?1:r,0,1);return[a,s,l,c]}return null},de.get.hwb=function(e){if(!e)return null;var i=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,o=e.match(i);if(o){var r=parseFloat(o[4]),a=(parseFloat(o[1])%360+360)%360,s=cn(parseFloat(o[2]),0,100),l=cn(parseFloat(o[3]),0,100),c=cn(isNaN(r)?1:r,0,1);return[a,s,l,c]}return null},de.to.hex=function(){var e=ki(arguments);return"#"+no(e[0])+no(e[1])+no(e[2])+(e[3]<1?no(Math.round(e[3]*255)):"")},de.to.rgb=function(){var e=ki(arguments);return e.length<4||e[3]===1?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},de.to.rgb.percent=function(){var e=ki(arguments),i=Math.round(e[0]/255*100),o=Math.round(e[1]/255*100),r=Math.round(e[2]/255*100);return e.length<4||e[3]===1?"rgb("+i+"%, "+o+"%, "+r+"%)":"rgba("+i+"%, "+o+"%, "+r+"%, "+e[3]+")"},de.to.hsl=function(){var e=ki(arguments);return e.length<4||e[3]===1?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},de.to.hwb=function(){var e=ki(arguments),i="";return e.length>=4&&e[3]!==1&&(i=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+i+")"},de.to.keyword=function(e){return xd[e.slice(0,3)]};function cn(e,i,o){return Math.min(Math.max(i,e),o)}function no(e){var i=Math.round(e).toString(16).toUpperCase();return i.length<2?"0"+i:i}var Sk=wd.exports;const bl=Na(Sk);function Mk(e){return{...(e?.type??"png")==="png"?Lk:Dk,...e}}function zr(e){return typeof e=="string"?bl.to.hex(bl.get.rgb(e)):`#${(e>>>8).toString(16).padStart(6,"0")}`}const Sd=(e,i)=>["M",e,i],Md=()=>["z"],un=(e,i,o,r=0)=>e>0?["a",e,e,0,0,r,i,o]:[],Bo=e=>["v",e],Ro=e=>["h",e];function Ak(e,i=0,o=0,r=0){const a=e.length*i+o*2;let s=7;const l=[[0,0],[1,0],[0,1]],c=[];for(const d of l){const[u,m]=d.map(y=>y==0?1:-1);for(const y of[0,1,2]){let v=a*d[0]+u*(o+i*y),w=a*d[1]+m*(o+i*y);const D=u*(i*(s-2*y)-2*r),S=m*(i*(s-2*y)-2*r);let R=[Sd(v,w+r*m),Bo(S),un(r,r*u,r*m,d[1]|d[0]),Ro(D),un(r,r*u,-r*m,d[1]|d[0]),Bo(-S),un(r,-r*u,-r*m,d[1]|d[0]),Ro(-D),un(r,-r*u,r*m,d[1]|d[0]),Md()];c.push(...R.flat())}}return c.join(" ")}function Nk(e,i,o=0,r=0){let a=[];for(let s=0;s<e.length;s++){const l=e[s];for(let c=0;c<l.length;c++)if(l[c]){const d=s*i+o,u=c*i+o,m=i-2*r,y=[Sd(d,u+r),Bo(m),un(r,r,r),Ro(m),un(r,r,-r),Bo(-m),un(r,-r,-r),Ro(-m),un(r,-r,r),Md()];a.push(...y.flat())}}return a.join(" ")}const Ad={type:"png",parse_url:!1,ec_level:"M",logo:void 0,logoWidth:20,logoHeight:20,bgColor:4294967295,color:255},Lk={...Ad,margin:1,size:5},Dk={...Ad,margin:1,size:0},Nd="3.7.7",Ik=Nd,pi=typeof ve=="function",Cl=typeof TextDecoder=="function"?new TextDecoder:void 0,wl=typeof TextEncoder=="function"?new TextEncoder:void 0,Ok="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Ai=Array.prototype.slice.call(Ok),io=(e=>{let i={};return e.forEach((o,r)=>i[o]=r),i})(Ai),Tk=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Jt=String.fromCharCode.bind(String),kl=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),Ld=e=>e.replace(/=/g,"").replace(/[+\/]/g,i=>i=="+"?"-":"_"),Dd=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),Id=e=>{let i,o,r,a,s="";const l=e.length%3;for(let c=0;c<e.length;){if((o=e.charCodeAt(c++))>255||(r=e.charCodeAt(c++))>255||(a=e.charCodeAt(c++))>255)throw new TypeError("invalid character found");i=o<<16|r<<8|a,s+=Ai[i>>18&63]+Ai[i>>12&63]+Ai[i>>6&63]+Ai[i&63]}return l?s.slice(0,l-3)+"===".substring(l):s},Za=typeof btoa=="function"?e=>btoa(e):pi?e=>ve.from(e,"binary").toString("base64"):Id,da=pi?e=>ve.from(e).toString("base64"):e=>{let i=[];for(let o=0,r=e.length;o<r;o+=4096)i.push(Jt.apply(null,e.subarray(o,o+4096)));return Za(i.join(""))},wo=(e,i=!1)=>i?Ld(da(e)):da(e),Ek=e=>{if(e.length<2){var i=e.charCodeAt(0);return i<128?e:i<2048?Jt(192|i>>>6)+Jt(128|i&63):Jt(224|i>>>12&15)+Jt(128|i>>>6&63)+Jt(128|i&63)}else{var i=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return Jt(240|i>>>18&7)+Jt(128|i>>>12&63)+Jt(128|i>>>6&63)+Jt(128|i&63)}},Pk=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Od=e=>e.replace(Pk,Ek),_l=pi?e=>ve.from(e,"utf8").toString("base64"):wl?e=>da(wl.encode(e)):e=>Za(Od(e)),ii=(e,i=!1)=>i?Ld(_l(e)):_l(e),xl=e=>ii(e,!0),$k=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,zk=e=>{switch(e.length){case 4:var i=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),o=i-65536;return Jt((o>>>10)+55296)+Jt((o&1023)+56320);case 3:return Jt((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return Jt((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},Td=e=>e.replace($k,zk),Ed=e=>{if(e=e.replace(/\s+/g,""),!Tk.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let i,o="",r,a;for(let s=0;s<e.length;)i=io[e.charAt(s++)]<<18|io[e.charAt(s++)]<<12|(r=io[e.charAt(s++)])<<6|(a=io[e.charAt(s++)]),o+=r===64?Jt(i>>16&255):a===64?Jt(i>>16&255,i>>8&255):Jt(i>>16&255,i>>8&255,i&255);return o},Ja=typeof atob=="function"?e=>atob(Dd(e)):pi?e=>ve.from(e,"base64").toString("binary"):Ed,Pd=pi?e=>kl(ve.from(e,"base64")):e=>kl(Ja(e).split("").map(i=>i.charCodeAt(0))),$d=e=>Pd(zd(e)),Hk=pi?e=>ve.from(e,"base64").toString("utf8"):Cl?e=>Cl.decode(Pd(e)):e=>Td(Ja(e)),zd=e=>Dd(e.replace(/[-_]/g,i=>i=="-"?"+":"/")),ua=e=>Hk(zd(e)),Bk=e=>{if(typeof e!="string")return!1;const i=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(i)||!/[^\s0-9a-zA-Z\-_]/.test(i)},Hd=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),Bd=function(){const e=(i,o)=>Object.defineProperty(String.prototype,i,Hd(o));e("fromBase64",function(){return ua(this)}),e("toBase64",function(i){return ii(this,i)}),e("toBase64URI",function(){return ii(this,!0)}),e("toBase64URL",function(){return ii(this,!0)}),e("toUint8Array",function(){return $d(this)})},Rd=function(){const e=(i,o)=>Object.defineProperty(Uint8Array.prototype,i,Hd(o));e("toBase64",function(i){return wo(this,i)}),e("toBase64URI",function(){return wo(this,!0)}),e("toBase64URL",function(){return wo(this,!0)})},Rk=()=>{Bd(),Rd()},Vk={version:Nd,VERSION:Ik,atob:Ja,atobPolyfill:Ed,btoa:Za,btoaPolyfill:Id,fromBase64:ua,toBase64:ii,encode:ii,encodeURI:xl,encodeURL:xl,utob:Od,btou:Td,decode:ua,isValid:Bk,fromUint8Array:wo,toUint8Array:$d,extendString:Bd,extendUint8Array:Rd,extendBuiltins:Rk};function Uk(e,i={}){const o=Mk({...i,type:"svg"});let r=yk(e,o.ec_level,o.parse_url);return r=Qw(r),o.logo&&o.logoWidth&&o.logoHeight&&!o.noExcavate&&(r=tk(r,o.logoWidth,o.logoHeight)),Gk({matrix:r,...o})}const Yk=new TextEncoder;function Gk({matrix:e,margin:i,size:o,logo:r,logoWidth:a,logoHeight:s,color:l,bgColor:c,imageWidth:d,imageHeight:u,borderRadius:m}){const y=o||9,v=e.length*y,w=i*y,D=v+2*w,S=d?` width="${d}"`:"",R=u?` height="${d}"`:"",A='<?xml version="1.0" encoding="utf-8"?>',V=`<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink"${S}${R} viewBox="0 0 ${D} ${D}">`,W=Fk(e,{color:l,bgColor:c,size:D,margin:i,blockSize:y,borderRadius:m}),it="</svg>",et=r?Wk(r,w,v,a,s):"";return Yk.encode(A+V+W+et+it)}function Fk(e,i){const o=Nk(e,i.blockSize,i.margin*i.blockSize,i.borderRadius),r=Ak(e,i.blockSize,i.margin*i.blockSize,i.borderRadius);let a=`<rect width="${i.size}" height="${i.size}" fill="${zr(i.bgColor)}"></rect>`;return a+=`<path shape-rendering="geometricPrecision" d="${r}" fill-rule="evenodd" fill="${zr(i.color)}"/>`,a+=`<path shape-rendering="geometricPrecision" d="${o}" fill="${zr(i.color)}"/>`,a}function Wk(e,i,o,r,a){const s=`data:image/png;base64,${Vk.fromUint8Array(new Uint8Array(e))}`,l=r/100*o,c=a/100*o;return`<image width="${l}" height="${c}" xlink:href="${s}" x="${i+(o-l)/2}" y="${i+(o-c)/2}"></image>`}const jk={name:"TrayArrowDownIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},qk=["aria-hidden","aria-label"],Xk=["fill","width","height"],Zk={d:"M2 12H4V17H20V12H22V17C22 18.11 21.11 19 20 19H4C2.9 19 2 18.11 2 17V12M12 15L17.55 9.54L16.13 8.13L13 11.25V2H11V11.25L7.88 8.13L6.46 9.55L12 15Z"},Jk={key:0};function Kk(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon tray-arrow-down-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",Zk,[o.title?(p(),C("title",Jk,E(o.title),1)):P("",!0)])],8,Xk))],16,qk)}const sr=Q(jk,[["render",Kk]]),Qk={name:"QrcodeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},t_=["aria-hidden","aria-label"],e_=["fill","width","height"],n_={d:"M3,11H5V13H3V11M11,5H13V9H11V5M9,11H13V15H11V13H9V11M15,11H17V13H19V11H21V13H19V15H21V19H19V21H17V19H13V21H11V17H15V15H17V13H15V11M19,19V15H17V19H19M15,3H21V9H15V3M17,5V7H19V5H17M3,3H9V9H3V3M5,5V7H7V5H5M3,15H9V21H3V15M5,17V19H7V17H5Z"},i_={key:0};function o_(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon qrcode-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",n_,[o.title?(p(),C("title",i_,E(o.title),1)):P("",!0)])],8,e_))],16,t_)}const r_=Q(Qk,[["render",o_]]),a_={name:"CakeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},s_=["aria-hidden","aria-label"],l_=["fill","width","height"],c_={d:"M11.5,0.5C12,0.75 13,2.4 13,3.5C13,4.6 12.33,5 11.5,5C10.67,5 10,4.85 10,3.75C10,2.65 11,2 11.5,0.5M18.5,9C21,9 23,11 23,13.5C23,15.06 22.21,16.43 21,17.24V23H12L3,23V17.24C1.79,16.43 1,15.06 1,13.5C1,11 3,9 5.5,9H10V6H13V9H18.5M12,16A2.5,2.5 0 0,0 14.5,13.5H16A2.5,2.5 0 0,0 18.5,16A2.5,2.5 0 0,0 21,13.5A2.5,2.5 0 0,0 18.5,11H5.5A2.5,2.5 0 0,0 3,13.5A2.5,2.5 0 0,0 5.5,16A2.5,2.5 0 0,0 8,13.5H9.5A2.5,2.5 0 0,0 12,16Z"},d_={key:0};function u_(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon cake-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",c_,[o.title?(p(),C("title",d_,E(o.title),1)):P("",!0)])],8,l_))],16,s_)}const h_=Q(a_,[["render",u_]]),p_={name:"CheckIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},m_=["aria-hidden","aria-label"],f_=["fill","width","height"],g_={d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"},y_={key:0};function v_(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon check-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",g_,[o.title?(p(),C("title",y_,E(o.title),1)):P("",!0)])],8,f_))],16,m_)}const Vd=Q(p_,[["render",v_]]),b_={name:"EyeCircleOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},C_=["aria-hidden","aria-label"],w_=["fill","width","height"],k_={d:"M12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22M12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20M12,11A1,1 0 0,1 13,12A1,1 0 0,1 12,13A1,1 0 0,1 11,12A1,1 0 0,1 12,11M12,8C14.63,8 17,9.57 18,12C16.62,15.31 12.81,16.88 9.5,15.5C7.92,14.84 6.66,13.58 6,12C7,9.57 9.37,8 12,8M12,9.5A2.5,2.5 0 0,0 9.5,12A2.5,2.5 0 0,0 12,14.5A2.5,2.5 0 0,0 14.5,12A2.5,2.5 0 0,0 12,9.5"},__={key:0};function x_(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon eye-circle-outline-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",k_,[o.title?(p(),C("title",__,E(o.title),1)):P("",!0)])],8,w_))],16,C_)}const S_=Q(b_,[["render",x_]]),M_={name:"FolderMultipleImageIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},A_=["aria-hidden","aria-label"],N_=["fill","width","height"],L_={d:"M7,15L11.5,9L15,13.5L17.5,10.5L21,15M22,4H14L12,2H6A2,2 0 0,0 4,4V16A2,2 0 0,0 6,18H22A2,2 0 0,0 24,16V6A2,2 0 0,0 22,4M2,6H0V11H0V20A2,2 0 0,0 2,22H20V20H2V6Z"},D_={key:0};function I_(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon folder-multiple-image-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",L_,[o.title?(p(),C("title",D_,E(o.title),1)):P("",!0)])],8,N_))],16,A_)}const O_=Q(M_,[["render",I_]]),T_={name:"ChevronLeftIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},E_=["aria-hidden","aria-label"],P_=["fill","width","height"],$_={d:"M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z"},z_={key:0};function H_(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon chevron-left-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",$_,[o.title?(p(),C("title",z_,E(o.title),1)):P("",!0)])],8,P_))],16,E_)}const B_=Q(T_,[["render",H_]]),R_={name:"DotsHorizontalIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},V_=["aria-hidden","aria-label"],U_=["fill","width","height"],Y_={d:"M16,12A2,2 0 0,1 18,10A2,2 0 0,1 20,12A2,2 0 0,1 18,14A2,2 0 0,1 16,12M10,12A2,2 0 0,1 12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12M4,12A2,2 0 0,1 6,10A2,2 0 0,1 8,12A2,2 0 0,1 6,14A2,2 0 0,1 4,12Z"},G_={key:0};function F_(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon dots-horizontal-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",Y_,[o.title?(p(),C("title",G_,E(o.title),1)):P("",!0)])],8,U_))],16,V_)}const W_=Q(R_,[["render",F_]]),j_={name:"ContactDetailsAddNewProp",components:{IconAdd:Gi,PropertyTitleIcon:rm,Actions:Hn,ActionButton:gn,ChevronLeft:B_,DotsHorizontalIcon:W_},mixins:[am],props:{contact:{type:Pa,default:null},bus:{type:Object,required:!0}},data(){return{moreActionsOpen:!1}},computed:{properties(){return Ee.properties},propertiesOrder(){return Ee.fieldOrder},usedProperties(){return this.contact.jCal[1].map(e=>e[0])},availablePrimaryProperties(){return Object.keys(this.properties).filter(e=>this.properties[e].primary).map(e=>({id:e,name:this.properties[e].readableName,icon:this.properties[e].icon})).sort((e,i)=>this.propertiesOrder.indexOf(e.id)-this.propertiesOrder.indexOf(i.id))},availableSecondaryProperties(){return Object.keys(this.properties).filter(e=>!this.properties[e].primary).map(e=>({id:e,name:this.properties[e].readableName,icon:this.properties[e].icon})).sort((e,i)=>e.name.localeCompare(i.name))}},created(){this.bus.on("add-prop",this.addProp)},unmounted(){this.bus.off("add-prop",this.addProp)},methods:{async addProp(e){if(this.usedProperties.includes(e)&&!this.properties[e].multiple){this.bus.emit("focus-prop",e);return}if(e==="x-managersname"){const i=this.otherContacts(this.contact);i.length===1?(await this.contact.vCard.addPropertyWithValue(e,i[0].key),await this.$store.dispatch("updateContact",this.contact)):await this.contact.vCard.addPropertyWithValue(e,"")}else if(this.properties[e]&&this.properties[e].defaultjCal&&this.properties[e].defaultjCal[this.contact.version]){const i=this.properties[e].defaultjCal[this.contact.version],o=new Ia.Property([e,...i]);await this.contact.vCard.addProperty(o)}else{const i=this.properties[e].defaultValue;let o=i?i.value:"";Array.isArray(o)&&(o=[...o]);const r=await this.contact.vCard.addPropertyWithValue(e,o);i&&i.type&&r.setParameter("type",i.type)}this.moreActionsOpen=!1,this.bus.emit("focus-prop",e)}}},q_={class:"property__row"},X_={class:"property__value"};function Z_(e,i,o,r,a,s){const l=b("IconAdd"),c=b("PropertyTitleIcon"),d=b("ActionButton"),u=b("DotsHorizontalIcon"),m=b("ChevronLeft"),y=b("Actions");return p(),C("div",q_,[i[3]||(i[3]=T("div",{class:"property__label"},null,-1)),T("div",X_,[M(y,{"menu-align":"right",event:"",variant:"secondary","menu-name":e.t("contacts","Add more info"),onClick:i[2]||(i[2]=Wt(()=>{},["prevent"]))},{icon:_(()=>[M(l,{size:20})]),default:_(()=>[a.moreActionsOpen?P("",!0):(p(),C(mt,{key:0},[(p(!0),C(mt,null,It(s.availablePrimaryProperties,v=>(p(),O(d,{key:v.id,class:"action--primary","close-after-click":!0,onClick:Wt(w=>s.addProp(v.id),["prevent"])},{icon:_(()=>[M(c,{icon:v.icon},null,8,["icon"])]),default:_(()=>[K(" "+E(v.name),1)]),_:2},1032,["onClick"]))),128)),M(d,{"close-after-click":!1,onClick:i[0]||(i[0]=v=>a.moreActionsOpen=!0)},{icon:_(()=>[M(u,{title:e.t("contacts","More fields"),size:20},null,8,["title"])]),default:_(()=>[K(" "+E(e.t("contacts","More fields")),1)]),_:1})],64)),a.moreActionsOpen?(p(),C(mt,{key:1},[M(d,{"close-after-click":!1,onClick:i[1]||(i[1]=v=>a.moreActionsOpen=!1)},{icon:_(()=>[M(m,{title:e.t("contacts","More fields"),size:20},null,8,["title"]),K(" "+E(e.t("contacts","More fields")),1)]),_:1}),(p(!0),C(mt,null,It(s.availableSecondaryProperties,v=>(p(),O(d,{key:v.id,class:"action--primary","close-after-click":!0,onClick:Wt(w=>s.addProp(v.id),["prevent"])},{icon:_(()=>[M(c,{icon:v.icon},null,8,["icon"])]),default:_(()=>[K(" "+E(v.name),1)]),_:2},1032,["onClick"]))),128))],64)):P("",!0)]),_:1},8,["menu-name"])]),i[4]||(i[4]=T("div",{class:"property__actions"},null,-1))])}const J_=Q(j_,[["render",Z_]]),K_={name:"CloudDownloadOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Q_=["aria-hidden","aria-label"],t5=["fill","width","height"],e5={d:"M6.5 20Q4.22 20 2.61 18.43 1 16.85 1 14.58 1 12.63 2.17 11.1 3.35 9.57 5.25 9.15 5.68 7.35 7.38 5.73 9.07 4.1 11 4.1 11.83 4.1 12.41 4.69 13 5.28 13 6.1V12.15L14.6 10.6L16 12L12 16L8 12L9.4 10.6L11 12.15V6.1Q9.1 6.45 8.05 7.94 7 9.43 7 11H6.5Q5.05 11 4.03 12.03 3 13.05 3 14.5 3 15.95 4.03 17 5.05 18 6.5 18H18.5Q19.55 18 20.27 17.27 21 16.55 21 15.5 21 14.45 20.27 13.73 19.55 13 18.5 13H17V11Q17 9.8 16.45 8.76 15.9 7.73 15 7V4.68Q16.85 5.55 17.93 7.26 19 9 19 11 20.73 11.2 21.86 12.5 23 13.78 23 15.5 23 17.38 21.69 18.69 20.38 20 18.5 20M12 11.05Z"},n5={key:0};function i5(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon cloud-download-outline-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",e5,[o.title?(p(),C("title",n5,E(o.title),1)):P("",!0)])],8,t5))],16,Q_)}const o5=Q(K_,[["render",i5]]),r5={name:"UploadOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},a5=["aria-hidden","aria-label"],s5=["fill","width","height"],l5={d:"M9,10V16H15V10H19L12,3L5,10H9M12,5.8L14.2,8H13V14H11V8H9.8L12,5.8M19,18H5V20H19V18Z"},c5={key:0};function d5(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon upload-outline-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",l5,[o.title?(p(),C("title",c5,E(o.title),1)):P("",!0)])],8,s5))],16,a5)}const Ud=Q(r5,[["render",d5]]),u5={name:"FolderOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},h5=["aria-hidden","aria-label"],p5=["fill","width","height"],m5={d:"M20,18H4V8H20M20,6H12L10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6Z"},f5={key:0};function g5(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon folder-outline-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",m5,[o.title?(p(),C("title",f5,E(o.title),1)):P("",!0)])],8,p5))],16,h5)}const Yd=Q(u5,[["render",g5]]),y5={name:"ImageOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},v5=["aria-hidden","aria-label"],b5=["fill","width","height"],C5={d:"M19,19H5V5H19M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M13.96,12.29L11.21,15.83L9.25,13.47L6.5,17H17.5L13.96,12.29Z"},w5={key:0};function k5(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon image-outline-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",C5,[o.title?(p(),C("title",w5,E(o.title),1)):P("",!0)])],8,b5))],16,v5)}const _5=Q(y5,[["render",k5]]);var Gd={};const x5=O1(km);var Fd={exports:{}};(function(e,i){(function(o,r){e.exports=r()})(rc,function(){function o(h,f){var g=Object.keys(h);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(h);f&&(k=k.filter(function(x){return Object.getOwnPropertyDescriptor(h,x).enumerable})),g.push.apply(g,k)}return g}function r(h){for(var f=1;f<arguments.length;f++){var g=arguments[f]!=null?arguments[f]:{};f%2?o(Object(g),!0).forEach(function(k){m(h,k,g[k])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(g)):o(Object(g)).forEach(function(k){Object.defineProperty(h,k,Object.getOwnPropertyDescriptor(g,k))})}return h}function a(h,f){if(typeof h!="object"||!h)return h;var g=h[Symbol.toPrimitive];if(g!==void 0){var k=g.call(h,f||"default");if(typeof k!="object")return k;throw new TypeError("@@toPrimitive must return a primitive value.")}return(f==="string"?String:Number)(h)}function s(h){var f=a(h,"string");return typeof f=="symbol"?f:f+""}function l(h){"@babel/helpers - typeof";return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},l(h)}function c(h,f){if(!(h instanceof f))throw new TypeError("Cannot call a class as a function")}function d(h,f){for(var g=0;g<f.length;g++){var k=f[g];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(h,s(k.key),k)}}function u(h,f,g){return f&&d(h.prototype,f),g&&d(h,g),Object.defineProperty(h,"prototype",{writable:!1}),h}function m(h,f,g){return f=s(f),f in h?Object.defineProperty(h,f,{value:g,enumerable:!0,configurable:!0,writable:!0}):h[f]=g,h}function y(h){return v(h)||w(h)||D(h)||R()}function v(h){if(Array.isArray(h))return S(h)}function w(h){if(typeof Symbol<"u"&&h[Symbol.iterator]!=null||h["@@iterator"]!=null)return Array.from(h)}function D(h,f){if(h){if(typeof h=="string")return S(h,f);var g=Object.prototype.toString.call(h).slice(8,-1);if(g==="Object"&&h.constructor&&(g=h.constructor.name),g==="Map"||g==="Set")return Array.from(h);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return S(h,f)}}function S(h,f){(f==null||f>h.length)&&(f=h.length);for(var g=0,k=new Array(f);g<f;g++)k[g]=h[g];return k}function R(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var A=typeof window<"u"&&typeof window.document<"u",V=A?window:{},W=A&&V.document.documentElement?"ontouchstart"in V.document.documentElement:!1,it=A?"PointerEvent"in V:!1,et="cropper",st="all",lt="crop",ht="move",rt="zoom",dt="e",L="w",G="s",j="n",I="ne",Z="nw",z="se",tt="sw",at="".concat(et,"-crop"),ct="".concat(et,"-disabled"),Y="".concat(et,"-hidden"),gt="".concat(et,"-hide"),St="".concat(et,"-invisible"),Ht="".concat(et,"-modal"),Ot="".concat(et,"-move"),Gt="".concat(et,"Action"),Qt="".concat(et,"Preview"),jt="crop",oe="move",Yn="none",hr="crop",pr="cropend",mr="cropmove",fr="cropstart",gs="dblclick",Ou=W?"touchstart":"mousedown",Tu=W?"touchmove":"mousemove",Eu=W?"touchend touchcancel":"mouseup",ys=it?"pointerdown":Ou,vs=it?"pointermove":Tu,bs=it?"pointerup pointercancel":Eu,Cs="ready",ws="resize",ks="wheel",gr="zoom",_s="image/jpeg",Pu=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,$u=/^data:/,zu=/^data:image\/jpeg;base64,/,Hu=/^img|canvas$/i,xs=200,Ss=100,Ms={viewMode:0,dragMode:jt,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:xs,minContainerHeight:Ss,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},Bu='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',Ru=Number.isNaN||V.isNaN;function bt(h){return typeof h=="number"&&!Ru(h)}var As=function(h){return h>0&&h<1/0};function yr(h){return typeof h>"u"}function bn(h){return l(h)==="object"&&h!==null}var Vu=Object.prototype.hasOwnProperty;function Gn(h){if(!bn(h))return!1;try{var f=h.constructor,g=f.prototype;return f&&g&&Vu.call(g,"isPrototypeOf")}catch{return!1}}function re(h){return typeof h=="function"}var Uu=Array.prototype.slice;function Ns(h){return Array.from?Array.from(h):Uu.call(h)}function Vt(h,f){return h&&re(f)&&(Array.isArray(h)||bt(h.length)?Ns(h).forEach(function(g,k){f.call(h,g,k,h)}):bn(h)&&Object.keys(h).forEach(function(g){f.call(h,h[g],g,h)})),h}var $t=Object.assign||function(h){for(var f=arguments.length,g=new Array(f>1?f-1:0),k=1;k<f;k++)g[k-1]=arguments[k];return bn(h)&&g.length>0&&g.forEach(function(x){bn(x)&&Object.keys(x).forEach(function(N){h[N]=x[N]})}),h},Yu=/\.\d*(?:0|9){12}\d*$/;function Fn(h){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return Yu.test(h)?Math.round(h*f)/f:h}var Gu=/^width|height|left|top|marginLeft|marginTop$/;function on(h,f){var g=h.style;Vt(f,function(k,x){Gu.test(x)&&bt(k)&&(k="".concat(k,"px")),g[x]=k})}function Fu(h,f){return h.classList?h.classList.contains(f):h.className.indexOf(f)>-1}function qt(h,f){if(f){if(bt(h.length)){Vt(h,function(k){qt(k,f)});return}if(h.classList){h.classList.add(f);return}var g=h.className.trim();g?g.indexOf(f)<0&&(h.className="".concat(g," ").concat(f)):h.className=f}}function Le(h,f){if(f){if(bt(h.length)){Vt(h,function(g){Le(g,f)});return}if(h.classList){h.classList.remove(f);return}h.className.indexOf(f)>=0&&(h.className=h.className.replace(f,""))}}function Wn(h,f,g){if(f){if(bt(h.length)){Vt(h,function(k){Wn(k,f,g)});return}g?qt(h,f):Le(h,f)}}var Wu=/([a-z\d])([A-Z])/g;function vr(h){return h.replace(Wu,"$1-$2").toLowerCase()}function br(h,f){return bn(h[f])?h[f]:h.dataset?h.dataset[f]:h.getAttribute("data-".concat(vr(f)))}function fi(h,f,g){bn(g)?h[f]=g:h.dataset?h.dataset[f]=g:h.setAttribute("data-".concat(vr(f)),g)}function ju(h,f){if(bn(h[f]))try{delete h[f]}catch{h[f]=void 0}else if(h.dataset)try{delete h.dataset[f]}catch{h.dataset[f]=void 0}else h.removeAttribute("data-".concat(vr(f)))}var Ls=/\s\s*/,Ds=function(){var h=!1;if(A){var f=!1,g=function(){},k=Object.defineProperty({},"once",{get:function(){return h=!0,f},set:function(x){f=x}});V.addEventListener("test",g,k),V.removeEventListener("test",g,k)}return h}();function Ce(h,f,g){var k=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},x=g;f.trim().split(Ls).forEach(function(N){if(!Ds){var $=h.listeners;$&&$[N]&&$[N][g]&&(x=$[N][g],delete $[N][g],Object.keys($[N]).length===0&&delete $[N],Object.keys($).length===0&&delete h.listeners)}h.removeEventListener(N,x,k)})}function fe(h,f,g){var k=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},x=g;f.trim().split(Ls).forEach(function(N){if(k.once&&!Ds){var $=h.listeners,U=$===void 0?{}:$;x=function(){delete U[N][g],h.removeEventListener(N,x,k);for(var F=arguments.length,H=new Array(F),B=0;B<F;B++)H[B]=arguments[B];g.apply(h,H)},U[N]||(U[N]={}),U[N][g]&&h.removeEventListener(N,U[N][g],k),U[N][g]=x,h.listeners=U}h.addEventListener(N,x,k)})}function jn(h,f,g){var k;return re(Event)&&re(CustomEvent)?k=new CustomEvent(f,{detail:g,bubbles:!0,cancelable:!0}):(k=document.createEvent("CustomEvent"),k.initCustomEvent(f,!0,!0,g)),h.dispatchEvent(k)}function Is(h){var f=h.getBoundingClientRect();return{left:f.left+(window.pageXOffset-document.documentElement.clientLeft),top:f.top+(window.pageYOffset-document.documentElement.clientTop)}}var Cr=V.location,qu=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function Os(h){var f=h.match(qu);return f!==null&&(f[1]!==Cr.protocol||f[2]!==Cr.hostname||f[3]!==Cr.port)}function Ts(h){var f="timestamp=".concat(new Date().getTime());return h+(h.indexOf("?")===-1?"?":"&")+f}function gi(h){var f=h.rotate,g=h.scaleX,k=h.scaleY,x=h.translateX,N=h.translateY,$=[];bt(x)&&x!==0&&$.push("translateX(".concat(x,"px)")),bt(N)&&N!==0&&$.push("translateY(".concat(N,"px)")),bt(f)&&f!==0&&$.push("rotate(".concat(f,"deg)")),bt(g)&&g!==1&&$.push("scaleX(".concat(g,")")),bt(k)&&k!==1&&$.push("scaleY(".concat(k,")"));var U=$.length?$.join(" "):"none";return{WebkitTransform:U,msTransform:U,transform:U}}function Xu(h){var f=r({},h),g=0;return Vt(h,function(k,x){delete f[x],Vt(f,function(N){var $=Math.abs(k.startX-N.startX),U=Math.abs(k.startY-N.startY),F=Math.abs(k.endX-N.endX),H=Math.abs(k.endY-N.endY),B=Math.sqrt($*$+U*U),q=Math.sqrt(F*F+H*H),kt=(q-B)/B;Math.abs(kt)>Math.abs(g)&&(g=kt)})}),g}function Xi(h,f){var g=h.pageX,k=h.pageY,x={endX:g,endY:k};return f?x:r({startX:g,startY:k},x)}function Zu(h){var f=0,g=0,k=0;return Vt(h,function(x){var N=x.startX,$=x.startY;f+=N,g+=$,k+=1}),f/=k,g/=k,{pageX:f,pageY:g}}function rn(h){var f=h.aspectRatio,g=h.height,k=h.width,x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",N=As(k),$=As(g);if(N&&$){var U=g*f;x==="contain"&&U>k||x==="cover"&&U<k?g=k/f:k=g*f}else N?g=k/f:$&&(k=g*f);return{width:k,height:g}}function Ju(h){var f=h.width,g=h.height,k=h.degree;if(k=Math.abs(k)%180,k===90)return{width:g,height:f};var x=k%90*Math.PI/180,N=Math.sin(x),$=Math.cos(x),U=f*$+g*N,F=f*N+g*$;return k>90?{width:F,height:U}:{width:U,height:F}}function Ku(h,f,g,k){var x=f.aspectRatio,N=f.naturalWidth,$=f.naturalHeight,U=f.rotate,F=U===void 0?0:U,H=f.scaleX,B=H===void 0?1:H,q=f.scaleY,kt=q===void 0?1:q,yt=g.aspectRatio,Nt=g.naturalWidth,At=g.naturalHeight,Ut=k.fillColor,Zt=Ut===void 0?"transparent":Ut,Bt=k.imageSmoothingEnabled,an=Bt===void 0?!0:Bt,ae=k.imageSmoothingQuality,J=ae===void 0?"low":ae,Mt=k.maxWidth,Yt=Mt===void 0?1/0:Mt,De=k.maxHeight,Ve=De===void 0?1/0:De,Cn=k.minWidth,wn=Cn===void 0?0:Cn,sn=k.minHeight,ln=sn===void 0?0:sn,kn=document.createElement("canvas"),te=kn.getContext("2d"),Zi=rn({aspectRatio:yt,width:Yt,height:Ve}),$s=rn({aspectRatio:yt,width:wn,height:ln},"cover"),wr=Math.min(Zi.width,Math.max($s.width,Nt)),kr=Math.min(Zi.height,Math.max($s.height,At)),zs=rn({aspectRatio:x,width:Yt,height:Ve}),Hs=rn({aspectRatio:x,width:wn,height:ln},"cover"),Bs=Math.min(zs.width,Math.max(Hs.width,N)),Rs=Math.min(zs.height,Math.max(Hs.height,$)),hh=[-Bs/2,-Rs/2,Bs,Rs];return kn.width=Fn(wr),kn.height=Fn(kr),te.fillStyle=Zt,te.fillRect(0,0,wr,kr),te.save(),te.translate(wr/2,kr/2),te.rotate(F*Math.PI/180),te.scale(B,kt),te.imageSmoothingEnabled=an,te.imageSmoothingQuality=J,te.drawImage.apply(te,[h].concat(y(hh.map(function(ph){return Math.floor(Fn(ph))})))),te.restore(),kn}var Es=String.fromCharCode;function Qu(h,f,g){var k="";g+=f;for(var x=f;x<g;x+=1)k+=Es(h.getUint8(x));return k}var th=/^data:.*,/;function eh(h){var f=h.replace(th,""),g=atob(f),k=new ArrayBuffer(g.length),x=new Uint8Array(k);return Vt(x,function(N,$){x[$]=g.charCodeAt($)}),k}function nh(h,f){for(var g=[],k=8192,x=new Uint8Array(h);x.length>0;)g.push(Es.apply(null,Ns(x.subarray(0,k)))),x=x.subarray(k);return"data:".concat(f,";base64,").concat(btoa(g.join("")))}function ih(h){var f=new DataView(h),g;try{var k,x,N;if(f.getUint8(0)===255&&f.getUint8(1)===216)for(var $=f.byteLength,U=2;U+1<$;){if(f.getUint8(U)===255&&f.getUint8(U+1)===225){x=U;break}U+=1}if(x){var F=x+4,H=x+10;if(Qu(f,F,4)==="Exif"){var B=f.getUint16(H);if(k=B===18761,(k||B===19789)&&f.getUint16(H+2,k)===42){var q=f.getUint32(H+4,k);q>=8&&(N=H+q)}}}if(N){var kt=f.getUint16(N,k),yt,Nt;for(Nt=0;Nt<kt;Nt+=1)if(yt=N+Nt*12+2,f.getUint16(yt,k)===274){yt+=8,g=f.getUint16(yt,k),f.setUint16(yt,1,k);break}}}catch{g=1}return g}function oh(h){var f=0,g=1,k=1;switch(h){case 2:g=-1;break;case 3:f=-180;break;case 4:k=-1;break;case 5:f=90,k=-1;break;case 6:f=90;break;case 7:f=90,g=-1;break;case 8:f=-90;break}return{rotate:f,scaleX:g,scaleY:k}}var rh={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var h=this.element,f=this.options,g=this.container,k=this.cropper,x=Number(f.minContainerWidth),N=Number(f.minContainerHeight);qt(k,Y),Le(h,Y);var $={width:Math.max(g.offsetWidth,x>=0?x:xs),height:Math.max(g.offsetHeight,N>=0?N:Ss)};this.containerData=$,on(k,{width:$.width,height:$.height}),qt(h,Y),Le(k,Y)},initCanvas:function(){var h=this.containerData,f=this.imageData,g=this.options.viewMode,k=Math.abs(f.rotate)%180===90,x=k?f.naturalHeight:f.naturalWidth,N=k?f.naturalWidth:f.naturalHeight,$=x/N,U=h.width,F=h.height;h.height*$>h.width?g===3?U=h.height*$:F=h.width/$:g===3?F=h.width/$:U=h.height*$;var H={aspectRatio:$,naturalWidth:x,naturalHeight:N,width:U,height:F};this.canvasData=H,this.limited=g===1||g===2,this.limitCanvas(!0,!0),H.width=Math.min(Math.max(H.width,H.minWidth),H.maxWidth),H.height=Math.min(Math.max(H.height,H.minHeight),H.maxHeight),H.left=(h.width-H.width)/2,H.top=(h.height-H.height)/2,H.oldLeft=H.left,H.oldTop=H.top,this.initialCanvasData=$t({},H)},limitCanvas:function(h,f){var g=this.options,k=this.containerData,x=this.canvasData,N=this.cropBoxData,$=g.viewMode,U=x.aspectRatio,F=this.cropped&&N;if(h){var H=Number(g.minCanvasWidth)||0,B=Number(g.minCanvasHeight)||0;$>1?(H=Math.max(H,k.width),B=Math.max(B,k.height),$===3&&(B*U>H?H=B*U:B=H/U)):$>0&&(H?H=Math.max(H,F?N.width:0):B?B=Math.max(B,F?N.height:0):F&&(H=N.width,B=N.height,B*U>H?H=B*U:B=H/U));var q=rn({aspectRatio:U,width:H,height:B});H=q.width,B=q.height,x.minWidth=H,x.minHeight=B,x.maxWidth=1/0,x.maxHeight=1/0}if(f)if($>(F?0:1)){var kt=k.width-x.width,yt=k.height-x.height;x.minLeft=Math.min(0,kt),x.minTop=Math.min(0,yt),x.maxLeft=Math.max(0,kt),x.maxTop=Math.max(0,yt),F&&this.limited&&(x.minLeft=Math.min(N.left,N.left+(N.width-x.width)),x.minTop=Math.min(N.top,N.top+(N.height-x.height)),x.maxLeft=N.left,x.maxTop=N.top,$===2&&(x.width>=k.width&&(x.minLeft=Math.min(0,kt),x.maxLeft=Math.max(0,kt)),x.height>=k.height&&(x.minTop=Math.min(0,yt),x.maxTop=Math.max(0,yt))))}else x.minLeft=-x.width,x.minTop=-x.height,x.maxLeft=k.width,x.maxTop=k.height},renderCanvas:function(h,f){var g=this.canvasData,k=this.imageData;if(f){var x=Ju({width:k.naturalWidth*Math.abs(k.scaleX||1),height:k.naturalHeight*Math.abs(k.scaleY||1),degree:k.rotate||0}),N=x.width,$=x.height,U=g.width*(N/g.naturalWidth),F=g.height*($/g.naturalHeight);g.left-=(U-g.width)/2,g.top-=(F-g.height)/2,g.width=U,g.height=F,g.aspectRatio=N/$,g.naturalWidth=N,g.naturalHeight=$,this.limitCanvas(!0,!1)}(g.width>g.maxWidth||g.width<g.minWidth)&&(g.left=g.oldLeft),(g.height>g.maxHeight||g.height<g.minHeight)&&(g.top=g.oldTop),g.width=Math.min(Math.max(g.width,g.minWidth),g.maxWidth),g.height=Math.min(Math.max(g.height,g.minHeight),g.maxHeight),this.limitCanvas(!1,!0),g.left=Math.min(Math.max(g.left,g.minLeft),g.maxLeft),g.top=Math.min(Math.max(g.top,g.minTop),g.maxTop),g.oldLeft=g.left,g.oldTop=g.top,on(this.canvas,$t({width:g.width,height:g.height},gi({translateX:g.left,translateY:g.top}))),this.renderImage(h),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(h){var f=this.canvasData,g=this.imageData,k=g.naturalWidth*(f.width/f.naturalWidth),x=g.naturalHeight*(f.height/f.naturalHeight);$t(g,{width:k,height:x,left:(f.width-k)/2,top:(f.height-x)/2}),on(this.image,$t({width:g.width,height:g.height},gi($t({translateX:g.left,translateY:g.top},g)))),h&&this.output()},initCropBox:function(){var h=this.options,f=this.canvasData,g=h.aspectRatio||h.initialAspectRatio,k=Number(h.autoCropArea)||.8,x={width:f.width,height:f.height};g&&(f.height*g>f.width?x.height=x.width/g:x.width=x.height*g),this.cropBoxData=x,this.limitCropBox(!0,!0),x.width=Math.min(Math.max(x.width,x.minWidth),x.maxWidth),x.height=Math.min(Math.max(x.height,x.minHeight),x.maxHeight),x.width=Math.max(x.minWidth,x.width*k),x.height=Math.max(x.minHeight,x.height*k),x.left=f.left+(f.width-x.width)/2,x.top=f.top+(f.height-x.height)/2,x.oldLeft=x.left,x.oldTop=x.top,this.initialCropBoxData=$t({},x)},limitCropBox:function(h,f){var g=this.options,k=this.containerData,x=this.canvasData,N=this.cropBoxData,$=this.limited,U=g.aspectRatio;if(h){var F=Number(g.minCropBoxWidth)||0,H=Number(g.minCropBoxHeight)||0,B=$?Math.min(k.width,x.width,x.width+x.left,k.width-x.left):k.width,q=$?Math.min(k.height,x.height,x.height+x.top,k.height-x.top):k.height;F=Math.min(F,k.width),H=Math.min(H,k.height),U&&(F&&H?H*U>F?H=F/U:F=H*U:F?H=F/U:H&&(F=H*U),q*U>B?q=B/U:B=q*U),N.minWidth=Math.min(F,B),N.minHeight=Math.min(H,q),N.maxWidth=B,N.maxHeight=q}f&&($?(N.minLeft=Math.max(0,x.left),N.minTop=Math.max(0,x.top),N.maxLeft=Math.min(k.width,x.left+x.width)-N.width,N.maxTop=Math.min(k.height,x.top+x.height)-N.height):(N.minLeft=0,N.minTop=0,N.maxLeft=k.width-N.width,N.maxTop=k.height-N.height))},renderCropBox:function(){var h=this.options,f=this.containerData,g=this.cropBoxData;(g.width>g.maxWidth||g.width<g.minWidth)&&(g.left=g.oldLeft),(g.height>g.maxHeight||g.height<g.minHeight)&&(g.top=g.oldTop),g.width=Math.min(Math.max(g.width,g.minWidth),g.maxWidth),g.height=Math.min(Math.max(g.height,g.minHeight),g.maxHeight),this.limitCropBox(!1,!0),g.left=Math.min(Math.max(g.left,g.minLeft),g.maxLeft),g.top=Math.min(Math.max(g.top,g.minTop),g.maxTop),g.oldLeft=g.left,g.oldTop=g.top,h.movable&&h.cropBoxMovable&&fi(this.face,Gt,g.width>=f.width&&g.height>=f.height?ht:st),on(this.cropBox,$t({width:g.width,height:g.height},gi({translateX:g.left,translateY:g.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),jn(this.element,hr,this.getData())}},ah={initPreview:function(){var h=this.element,f=this.crossOrigin,g=this.options.preview,k=f?this.crossOriginUrl:this.url,x=h.alt||"The image to preview",N=document.createElement("img");if(f&&(N.crossOrigin=f),N.src=k,N.alt=x,this.viewBox.appendChild(N),this.viewBoxImage=N,!!g){var $=g;typeof g=="string"?$=h.ownerDocument.querySelectorAll(g):g.querySelector&&($=[g]),this.previews=$,Vt($,function(U){var F=document.createElement("img");fi(U,Qt,{width:U.offsetWidth,height:U.offsetHeight,html:U.innerHTML}),f&&(F.crossOrigin=f),F.src=k,F.alt=x,F.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',U.innerHTML="",U.appendChild(F)})}},resetPreview:function(){Vt(this.previews,function(h){var f=br(h,Qt);on(h,{width:f.width,height:f.height}),h.innerHTML=f.html,ju(h,Qt)})},preview:function(){var h=this.imageData,f=this.canvasData,g=this.cropBoxData,k=g.width,x=g.height,N=h.width,$=h.height,U=g.left-f.left-h.left,F=g.top-f.top-h.top;!this.cropped||this.disabled||(on(this.viewBoxImage,$t({width:N,height:$},gi($t({translateX:-U,translateY:-F},h)))),Vt(this.previews,function(H){var B=br(H,Qt),q=B.width,kt=B.height,yt=q,Nt=kt,At=1;k&&(At=q/k,Nt=x*At),x&&Nt>kt&&(At=kt/x,yt=k*At,Nt=kt),on(H,{width:yt,height:Nt}),on(H.getElementsByTagName("img")[0],$t({width:N*At,height:$*At},gi($t({translateX:-U*At,translateY:-F*At},h))))}))}},sh={bind:function(){var h=this.element,f=this.options,g=this.cropper;re(f.cropstart)&&fe(h,fr,f.cropstart),re(f.cropmove)&&fe(h,mr,f.cropmove),re(f.cropend)&&fe(h,pr,f.cropend),re(f.crop)&&fe(h,hr,f.crop),re(f.zoom)&&fe(h,gr,f.zoom),fe(g,ys,this.onCropStart=this.cropStart.bind(this)),f.zoomable&&f.zoomOnWheel&&fe(g,ks,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),f.toggleDragModeOnDblclick&&fe(g,gs,this.onDblclick=this.dblclick.bind(this)),fe(h.ownerDocument,vs,this.onCropMove=this.cropMove.bind(this)),fe(h.ownerDocument,bs,this.onCropEnd=this.cropEnd.bind(this)),f.responsive&&fe(window,ws,this.onResize=this.resize.bind(this))},unbind:function(){var h=this.element,f=this.options,g=this.cropper;re(f.cropstart)&&Ce(h,fr,f.cropstart),re(f.cropmove)&&Ce(h,mr,f.cropmove),re(f.cropend)&&Ce(h,pr,f.cropend),re(f.crop)&&Ce(h,hr,f.crop),re(f.zoom)&&Ce(h,gr,f.zoom),Ce(g,ys,this.onCropStart),f.zoomable&&f.zoomOnWheel&&Ce(g,ks,this.onWheel,{passive:!1,capture:!0}),f.toggleDragModeOnDblclick&&Ce(g,gs,this.onDblclick),Ce(h.ownerDocument,vs,this.onCropMove),Ce(h.ownerDocument,bs,this.onCropEnd),f.responsive&&Ce(window,ws,this.onResize)}},lh={resize:function(){if(!this.disabled){var h=this.options,f=this.container,g=this.containerData,k=f.offsetWidth/g.width,x=f.offsetHeight/g.height,N=Math.abs(k-1)>Math.abs(x-1)?k:x;if(N!==1){var $,U;h.restore&&($=this.getCanvasData(),U=this.getCropBoxData()),this.render(),h.restore&&(this.setCanvasData(Vt($,function(F,H){$[H]=F*N})),this.setCropBoxData(Vt(U,function(F,H){U[H]=F*N})))}}},dblclick:function(){this.disabled||this.options.dragMode===Yn||this.setDragMode(Fu(this.dragBox,at)?oe:jt)},wheel:function(h){var f=this,g=Number(this.options.wheelZoomRatio)||.1,k=1;this.disabled||(h.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){f.wheeling=!1},50),h.deltaY?k=h.deltaY>0?1:-1:h.wheelDelta?k=-h.wheelDelta/120:h.detail&&(k=h.detail>0?1:-1),this.zoom(-k*g,h)))},cropStart:function(h){var f=h.buttons,g=h.button;if(!(this.disabled||(h.type==="mousedown"||h.type==="pointerdown"&&h.pointerType==="mouse")&&(bt(f)&&f!==1||bt(g)&&g!==0||h.ctrlKey))){var k=this.options,x=this.pointers,N;h.changedTouches?Vt(h.changedTouches,function($){x[$.identifier]=Xi($)}):x[h.pointerId||0]=Xi(h),Object.keys(x).length>1&&k.zoomable&&k.zoomOnTouch?N=rt:N=br(h.target,Gt),Pu.test(N)&&jn(this.element,fr,{originalEvent:h,action:N})!==!1&&(h.preventDefault(),this.action=N,this.cropping=!1,N===lt&&(this.cropping=!0,qt(this.dragBox,Ht)))}},cropMove:function(h){var f=this.action;if(!(this.disabled||!f)){var g=this.pointers;h.preventDefault(),jn(this.element,mr,{originalEvent:h,action:f})!==!1&&(h.changedTouches?Vt(h.changedTouches,function(k){$t(g[k.identifier]||{},Xi(k,!0))}):$t(g[h.pointerId||0]||{},Xi(h,!0)),this.change(h))}},cropEnd:function(h){if(!this.disabled){var f=this.action,g=this.pointers;h.changedTouches?Vt(h.changedTouches,function(k){delete g[k.identifier]}):delete g[h.pointerId||0],f&&(h.preventDefault(),Object.keys(g).length||(this.action=""),this.cropping&&(this.cropping=!1,Wn(this.dragBox,Ht,this.cropped&&this.options.modal)),jn(this.element,pr,{originalEvent:h,action:f}))}}},ch={change:function(h){var f=this.options,g=this.canvasData,k=this.containerData,x=this.cropBoxData,N=this.pointers,$=this.action,U=f.aspectRatio,F=x.left,H=x.top,B=x.width,q=x.height,kt=F+B,yt=H+q,Nt=0,At=0,Ut=k.width,Zt=k.height,Bt=!0,an;!U&&h.shiftKey&&(U=B&&q?B/q:1),this.limited&&(Nt=x.minLeft,At=x.minTop,Ut=Nt+Math.min(k.width,g.width,g.left+g.width),Zt=At+Math.min(k.height,g.height,g.top+g.height));var ae=N[Object.keys(N)[0]],J={x:ae.endX-ae.startX,y:ae.endY-ae.startY},Mt=function(Yt){switch(Yt){case dt:kt+J.x>Ut&&(J.x=Ut-kt);break;case L:F+J.x<Nt&&(J.x=Nt-F);break;case j:H+J.y<At&&(J.y=At-H);break;case G:yt+J.y>Zt&&(J.y=Zt-yt);break}};switch($){case st:F+=J.x,H+=J.y;break;case dt:if(J.x>=0&&(kt>=Ut||U&&(H<=At||yt>=Zt))){Bt=!1;break}Mt(dt),B+=J.x,B<0&&($=L,B=-B,F-=B),U&&(q=B/U,H+=(x.height-q)/2);break;case j:if(J.y<=0&&(H<=At||U&&(F<=Nt||kt>=Ut))){Bt=!1;break}Mt(j),q-=J.y,H+=J.y,q<0&&($=G,q=-q,H-=q),U&&(B=q*U,F+=(x.width-B)/2);break;case L:if(J.x<=0&&(F<=Nt||U&&(H<=At||yt>=Zt))){Bt=!1;break}Mt(L),B-=J.x,F+=J.x,B<0&&($=dt,B=-B,F-=B),U&&(q=B/U,H+=(x.height-q)/2);break;case G:if(J.y>=0&&(yt>=Zt||U&&(F<=Nt||kt>=Ut))){Bt=!1;break}Mt(G),q+=J.y,q<0&&($=j,q=-q,H-=q),U&&(B=q*U,F+=(x.width-B)/2);break;case I:if(U){if(J.y<=0&&(H<=At||kt>=Ut)){Bt=!1;break}Mt(j),q-=J.y,H+=J.y,B=q*U}else Mt(j),Mt(dt),J.x>=0?kt<Ut?B+=J.x:J.y<=0&&H<=At&&(Bt=!1):B+=J.x,J.y<=0?H>At&&(q-=J.y,H+=J.y):(q-=J.y,H+=J.y);B<0&&q<0?($=tt,q=-q,B=-B,H-=q,F-=B):B<0?($=Z,B=-B,F-=B):q<0&&($=z,q=-q,H-=q);break;case Z:if(U){if(J.y<=0&&(H<=At||F<=Nt)){Bt=!1;break}Mt(j),q-=J.y,H+=J.y,B=q*U,F+=x.width-B}else Mt(j),Mt(L),J.x<=0?F>Nt?(B-=J.x,F+=J.x):J.y<=0&&H<=At&&(Bt=!1):(B-=J.x,F+=J.x),J.y<=0?H>At&&(q-=J.y,H+=J.y):(q-=J.y,H+=J.y);B<0&&q<0?($=z,q=-q,B=-B,H-=q,F-=B):B<0?($=I,B=-B,F-=B):q<0&&($=tt,q=-q,H-=q);break;case tt:if(U){if(J.x<=0&&(F<=Nt||yt>=Zt)){Bt=!1;break}Mt(L),B-=J.x,F+=J.x,q=B/U}else Mt(G),Mt(L),J.x<=0?F>Nt?(B-=J.x,F+=J.x):J.y>=0&&yt>=Zt&&(Bt=!1):(B-=J.x,F+=J.x),J.y>=0?yt<Zt&&(q+=J.y):q+=J.y;B<0&&q<0?($=I,q=-q,B=-B,H-=q,F-=B):B<0?($=z,B=-B,F-=B):q<0&&($=Z,q=-q,H-=q);break;case z:if(U){if(J.x>=0&&(kt>=Ut||yt>=Zt)){Bt=!1;break}Mt(dt),B+=J.x,q=B/U}else Mt(G),Mt(dt),J.x>=0?kt<Ut?B+=J.x:J.y>=0&&yt>=Zt&&(Bt=!1):B+=J.x,J.y>=0?yt<Zt&&(q+=J.y):q+=J.y;B<0&&q<0?($=Z,q=-q,B=-B,H-=q,F-=B):B<0?($=tt,B=-B,F-=B):q<0&&($=I,q=-q,H-=q);break;case ht:this.move(J.x,J.y),Bt=!1;break;case rt:this.zoom(Xu(N),h),Bt=!1;break;case lt:if(!J.x||!J.y){Bt=!1;break}an=Is(this.cropper),F=ae.startX-an.left,H=ae.startY-an.top,B=x.minWidth,q=x.minHeight,J.x>0?$=J.y>0?z:I:J.x<0&&(F-=B,$=J.y>0?tt:Z),J.y<0&&(H-=q),this.cropped||(Le(this.cropBox,Y),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}Bt&&(x.width=B,x.height=q,x.left=F,x.top=H,this.action=$,this.renderCropBox()),Vt(N,function(Yt){Yt.startX=Yt.endX,Yt.startY=Yt.endY})}},dh={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&qt(this.dragBox,Ht),Le(this.cropBox,Y),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=$t({},this.initialImageData),this.canvasData=$t({},this.initialCanvasData),this.cropBoxData=$t({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&($t(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),Le(this.dragBox,Ht),qt(this.cropBox,Y)),this},replace:function(h){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&h&&(this.isImg&&(this.element.src=h),f?(this.url=h,this.image.src=h,this.ready&&(this.viewBoxImage.src=h,Vt(this.previews,function(g){g.getElementsByTagName("img")[0].src=h}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(h))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,Le(this.cropper,ct)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,qt(this.cropper,ct)),this},destroy:function(){var h=this.element;return h[et]?(h[et]=void 0,this.isImg&&this.replaced&&(h.src=this.originalUrl),this.uncreate(),this):this},move:function(h){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,g=this.canvasData,k=g.left,x=g.top;return this.moveTo(yr(h)?h:k+Number(h),yr(f)?f:x+Number(f))},moveTo:function(h){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,g=this.canvasData,k=!1;return h=Number(h),f=Number(f),this.ready&&!this.disabled&&this.options.movable&&(bt(h)&&(g.left=h,k=!0),bt(f)&&(g.top=f,k=!0),k&&this.renderCanvas(!0)),this},zoom:function(h,f){var g=this.canvasData;return h=Number(h),h<0?h=1/(1-h):h=1+h,this.zoomTo(g.width*h/g.naturalWidth,null,f)},zoomTo:function(h,f,g){var k=this.options,x=this.canvasData,N=x.width,$=x.height,U=x.naturalWidth,F=x.naturalHeight;if(h=Number(h),h>=0&&this.ready&&!this.disabled&&k.zoomable){var H=U*h,B=F*h;if(jn(this.element,gr,{ratio:h,oldRatio:N/U,originalEvent:g})===!1)return this;if(g){var q=this.pointers,kt=Is(this.cropper),yt=q&&Object.keys(q).length?Zu(q):{pageX:g.pageX,pageY:g.pageY};x.left-=(H-N)*((yt.pageX-kt.left-x.left)/N),x.top-=(B-$)*((yt.pageY-kt.top-x.top)/$)}else Gn(f)&&bt(f.x)&&bt(f.y)?(x.left-=(H-N)*((f.x-x.left)/N),x.top-=(B-$)*((f.y-x.top)/$)):(x.left-=(H-N)/2,x.top-=(B-$)/2);x.width=H,x.height=B,this.renderCanvas(!0)}return this},rotate:function(h){return this.rotateTo((this.imageData.rotate||0)+Number(h))},rotateTo:function(h){return h=Number(h),bt(h)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=h%360,this.renderCanvas(!0,!0)),this},scaleX:function(h){var f=this.imageData.scaleY;return this.scale(h,bt(f)?f:1)},scaleY:function(h){var f=this.imageData.scaleX;return this.scale(bt(f)?f:1,h)},scale:function(h){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,g=this.imageData,k=!1;return h=Number(h),f=Number(f),this.ready&&!this.disabled&&this.options.scalable&&(bt(h)&&(g.scaleX=h,k=!0),bt(f)&&(g.scaleY=f,k=!0),k&&this.renderCanvas(!0,!0)),this},getData:function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,f=this.options,g=this.imageData,k=this.canvasData,x=this.cropBoxData,N;if(this.ready&&this.cropped){N={x:x.left-k.left,y:x.top-k.top,width:x.width,height:x.height};var $=g.width/g.naturalWidth;if(Vt(N,function(H,B){N[B]=H/$}),h){var U=Math.round(N.y+N.height),F=Math.round(N.x+N.width);N.x=Math.round(N.x),N.y=Math.round(N.y),N.width=F-N.x,N.height=U-N.y}}else N={x:0,y:0,width:0,height:0};return f.rotatable&&(N.rotate=g.rotate||0),f.scalable&&(N.scaleX=g.scaleX||1,N.scaleY=g.scaleY||1),N},setData:function(h){var f=this.options,g=this.imageData,k=this.canvasData,x={};if(this.ready&&!this.disabled&&Gn(h)){var N=!1;f.rotatable&&bt(h.rotate)&&h.rotate!==g.rotate&&(g.rotate=h.rotate,N=!0),f.scalable&&(bt(h.scaleX)&&h.scaleX!==g.scaleX&&(g.scaleX=h.scaleX,N=!0),bt(h.scaleY)&&h.scaleY!==g.scaleY&&(g.scaleY=h.scaleY,N=!0)),N&&this.renderCanvas(!0,!0);var $=g.width/g.naturalWidth;bt(h.x)&&(x.left=h.x*$+k.left),bt(h.y)&&(x.top=h.y*$+k.top),bt(h.width)&&(x.width=h.width*$),bt(h.height)&&(x.height=h.height*$),this.setCropBoxData(x)}return this},getContainerData:function(){return this.ready?$t({},this.containerData):{}},getImageData:function(){return this.sized?$t({},this.imageData):{}},getCanvasData:function(){var h=this.canvasData,f={};return this.ready&&Vt(["left","top","width","height","naturalWidth","naturalHeight"],function(g){f[g]=h[g]}),f},setCanvasData:function(h){var f=this.canvasData,g=f.aspectRatio;return this.ready&&!this.disabled&&Gn(h)&&(bt(h.left)&&(f.left=h.left),bt(h.top)&&(f.top=h.top),bt(h.width)?(f.width=h.width,f.height=h.width/g):bt(h.height)&&(f.height=h.height,f.width=h.height*g),this.renderCanvas(!0)),this},getCropBoxData:function(){var h=this.cropBoxData,f;return this.ready&&this.cropped&&(f={left:h.left,top:h.top,width:h.width,height:h.height}),f||{}},setCropBoxData:function(h){var f=this.cropBoxData,g=this.options.aspectRatio,k,x;return this.ready&&this.cropped&&!this.disabled&&Gn(h)&&(bt(h.left)&&(f.left=h.left),bt(h.top)&&(f.top=h.top),bt(h.width)&&h.width!==f.width&&(k=!0,f.width=h.width),bt(h.height)&&h.height!==f.height&&(x=!0,f.height=h.height),g&&(k?f.height=f.width/g:x&&(f.width=f.height*g)),this.renderCropBox()),this},getCroppedCanvas:function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var f=this.canvasData,g=Ku(this.image,this.imageData,f,h);if(!this.cropped)return g;var k=this.getData(h.rounded),x=k.x,N=k.y,$=k.width,U=k.height,F=g.width/Math.floor(f.naturalWidth);F!==1&&(x*=F,N*=F,$*=F,U*=F);var H=$/U,B=rn({aspectRatio:H,width:h.maxWidth||1/0,height:h.maxHeight||1/0}),q=rn({aspectRatio:H,width:h.minWidth||0,height:h.minHeight||0},"cover"),kt=rn({aspectRatio:H,width:h.width||(F!==1?g.width:$),height:h.height||(F!==1?g.height:U)}),yt=kt.width,Nt=kt.height;yt=Math.min(B.width,Math.max(q.width,yt)),Nt=Math.min(B.height,Math.max(q.height,Nt));var At=document.createElement("canvas"),Ut=At.getContext("2d");At.width=Fn(yt),At.height=Fn(Nt),Ut.fillStyle=h.fillColor||"transparent",Ut.fillRect(0,0,yt,Nt);var Zt=h.imageSmoothingEnabled,Bt=Zt===void 0?!0:Zt,an=h.imageSmoothingQuality;Ut.imageSmoothingEnabled=Bt,an&&(Ut.imageSmoothingQuality=an);var ae=g.width,J=g.height,Mt=x,Yt=N,De,Ve,Cn,wn,sn,ln;Mt<=-$||Mt>ae?(Mt=0,De=0,Cn=0,sn=0):Mt<=0?(Cn=-Mt,Mt=0,De=Math.min(ae,$+Mt),sn=De):Mt<=ae&&(Cn=0,De=Math.min($,ae-Mt),sn=De),De<=0||Yt<=-U||Yt>J?(Yt=0,Ve=0,wn=0,ln=0):Yt<=0?(wn=-Yt,Yt=0,Ve=Math.min(J,U+Yt),ln=Ve):Yt<=J&&(wn=0,Ve=Math.min(U,J-Yt),ln=Ve);var kn=[Mt,Yt,De,Ve];if(sn>0&&ln>0){var te=yt/$;kn.push(Cn*te,wn*te,sn*te,ln*te)}return Ut.drawImage.apply(Ut,[g].concat(y(kn.map(function(Zi){return Math.floor(Fn(Zi))})))),At},setAspectRatio:function(h){var f=this.options;return!this.disabled&&!yr(h)&&(f.aspectRatio=Math.max(0,h)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(h){var f=this.options,g=this.dragBox,k=this.face;if(this.ready&&!this.disabled){var x=h===jt,N=f.movable&&h===oe;h=x||N?h:Yn,f.dragMode=h,fi(g,Gt,h),Wn(g,at,x),Wn(g,Ot,N),f.cropBoxMovable||(fi(k,Gt,h),Wn(k,at,x),Wn(k,Ot,N))}return this}},uh=V.Cropper,Ps=function(){function h(f){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(c(this,h),!f||!Hu.test(f.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=f,this.options=$t({},Ms,Gn(g)&&g),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return u(h,[{key:"init",value:function(){var f=this.element,g=f.tagName.toLowerCase(),k;if(!f[et]){if(f[et]=this,g==="img"){if(this.isImg=!0,k=f.getAttribute("src")||"",this.originalUrl=k,!k)return;k=f.src}else g==="canvas"&&window.HTMLCanvasElement&&(k=f.toDataURL());this.load(k)}}},{key:"load",value:function(f){var g=this;if(f){this.url=f,this.imageData={};var k=this.element,x=this.options;if(!x.rotatable&&!x.scalable&&(x.checkOrientation=!1),!x.checkOrientation||!window.ArrayBuffer){this.clone();return}if($u.test(f)){zu.test(f)?this.read(eh(f)):this.clone();return}var N=new XMLHttpRequest,$=this.clone.bind(this);this.reloading=!0,this.xhr=N,N.onabort=$,N.onerror=$,N.ontimeout=$,N.onprogress=function(){N.getResponseHeader("content-type")!==_s&&N.abort()},N.onload=function(){g.read(N.response)},N.onloadend=function(){g.reloading=!1,g.xhr=null},x.checkCrossOrigin&&Os(f)&&k.crossOrigin&&(f=Ts(f)),N.open("GET",f,!0),N.responseType="arraybuffer",N.withCredentials=k.crossOrigin==="use-credentials",N.send()}}},{key:"read",value:function(f){var g=this.options,k=this.imageData,x=ih(f),N=0,$=1,U=1;if(x>1){this.url=nh(f,_s);var F=oh(x);N=F.rotate,$=F.scaleX,U=F.scaleY}g.rotatable&&(k.rotate=N),g.scalable&&(k.scaleX=$,k.scaleY=U),this.clone()}},{key:"clone",value:function(){var f=this.element,g=this.url,k=f.crossOrigin,x=g;this.options.checkCrossOrigin&&Os(g)&&(k||(k="anonymous"),x=Ts(g)),this.crossOrigin=k,this.crossOriginUrl=x;var N=document.createElement("img");k&&(N.crossOrigin=k),N.src=x||g,N.alt=f.alt||"The image to crop",this.image=N,N.onload=this.start.bind(this),N.onerror=this.stop.bind(this),qt(N,gt),f.parentNode.insertBefore(N,f.nextSibling)}},{key:"start",value:function(){var f=this,g=this.image;g.onload=null,g.onerror=null,this.sizing=!0;var k=V.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(V.navigator.userAgent),x=function(U,F){$t(f.imageData,{naturalWidth:U,naturalHeight:F,aspectRatio:U/F}),f.initialImageData=$t({},f.imageData),f.sizing=!1,f.sized=!0,f.build()};if(g.naturalWidth&&!k){x(g.naturalWidth,g.naturalHeight);return}var N=document.createElement("img"),$=document.body||document.documentElement;this.sizingImage=N,N.onload=function(){x(N.width,N.height),k||$.removeChild(N)},N.src=g.src,k||(N.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",$.appendChild(N))}},{key:"stop",value:function(){var f=this.image;f.onload=null,f.onerror=null,f.parentNode.removeChild(f),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var f=this.element,g=this.options,k=this.image,x=f.parentNode,N=document.createElement("div");N.innerHTML=Bu;var $=N.querySelector(".".concat(et,"-container")),U=$.querySelector(".".concat(et,"-canvas")),F=$.querySelector(".".concat(et,"-drag-box")),H=$.querySelector(".".concat(et,"-crop-box")),B=H.querySelector(".".concat(et,"-face"));this.container=x,this.cropper=$,this.canvas=U,this.dragBox=F,this.cropBox=H,this.viewBox=$.querySelector(".".concat(et,"-view-box")),this.face=B,U.appendChild(k),qt(f,Y),x.insertBefore($,f.nextSibling),Le(k,gt),this.initPreview(),this.bind(),g.initialAspectRatio=Math.max(0,g.initialAspectRatio)||NaN,g.aspectRatio=Math.max(0,g.aspectRatio)||NaN,g.viewMode=Math.max(0,Math.min(3,Math.round(g.viewMode)))||0,qt(H,Y),g.guides||qt(H.getElementsByClassName("".concat(et,"-dashed")),Y),g.center||qt(H.getElementsByClassName("".concat(et,"-center")),Y),g.background&&qt($,"".concat(et,"-bg")),g.highlight||qt(B,St),g.cropBoxMovable&&(qt(B,Ot),fi(B,Gt,st)),g.cropBoxResizable||(qt(H.getElementsByClassName("".concat(et,"-line")),Y),qt(H.getElementsByClassName("".concat(et,"-point")),Y)),this.render(),this.ready=!0,this.setDragMode(g.dragMode),g.autoCrop&&this.crop(),this.setData(g.data),re(g.ready)&&fe(f,Cs,g.ready,{once:!0}),jn(f,Cs)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var f=this.cropper.parentNode;f&&f.removeChild(this.cropper),Le(this.element,Y)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=uh,h}},{key:"setDefaults",value:function(f){$t(Ms,Gn(f)&&f)}}])}();return $t(Ps.prototype,rh,ah,sh,lh,ch,dh),Ps})})(Fd);var S5=Fd.exports;Object.defineProperty(Gd,"__esModule",{value:!0});var Sl=x5,M5=S5,A5=N5(M5);function N5(e){return e&&e.__esModule?e:{default:e}}function L5(e,i){var o={};for(var r in e)i.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o}var D5=typeof window>"u"?[String,Array]:[String,Array,Element,NodeList],I5=Gd.default={render:function(){var e=this.crossorigin||void 0;return(0,Sl.h)("div",{style:this.containerStyle},[(0,Sl.h)("img",{ref:"img",src:this.src,alt:this.alt||"image",style:[{"max-width":"100%"},this.imgStyle],crossorigin:e})])},props:{containerStyle:Object,src:{type:String,default:""},alt:String,imgStyle:Object,viewMode:Number,dragMode:String,initialAspectRatio:Number,aspectRatio:Number,data:Object,preview:D5,responsive:{type:Boolean,default:!0},restore:{type:Boolean,default:!0},checkCrossOrigin:{type:Boolean,default:!0},checkOrientation:{type:Boolean,default:!0},crossorigin:{type:String},modal:{type:Boolean,default:!0},guides:{type:Boolean,default:!0},center:{type:Boolean,default:!0},highlight:{type:Boolean,default:!0},background:{type:Boolean,default:!0},autoCrop:{type:Boolean,default:!0},autoCropArea:Number,movable:{type:Boolean,default:!0},rotatable:{type:Boolean,default:!0},scalable:{type:Boolean,default:!0},zoomable:{type:Boolean,default:!0},zoomOnTouch:{type:Boolean,default:!0},zoomOnWheel:{type:Boolean,default:!0},wheelZoomRatio:Number,cropBoxMovable:{type:Boolean,default:!0},cropBoxResizable:{type:Boolean,default:!0},toggleDragModeOnDblclick:{type:Boolean,default:!0},minCanvasWidth:Number,minCanvasHeight:Number,minCropBoxWidth:Number,minCropBoxHeight:Number,minContainerWidth:Number,minContainerHeight:Number,ready:Function,cropstart:Function,cropmove:Function,cropend:Function,crop:Function,zoom:Function},mounted:function(){var e=this.$options.props;e.containerStyle,e.src,e.alt,e.imgStyle;var i=L5(e,["containerStyle","src","alt","imgStyle"]),o={};for(var r in i)this[r]!==void 0&&(o[r]=this[r]);this.cropper=new A5.default(this.$refs.img,o)},methods:{reset:function(){return this.cropper.reset()},clear:function(){return this.cropper.clear()},initCrop:function(){return this.cropper.crop()},replace:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.cropper.replace(e,i)},enable:function(){return this.cropper.enable()},disable:function(){return this.cropper.disable()},destroy:function(){return this.cropper.destroy()},move:function(e,i){return this.cropper.move(e,i)},moveTo:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;return this.cropper.moveTo(e,i)},relativeZoom:function(e,i){return this.cropper.zoom(e,i)},zoomTo:function(e,i){return this.cropper.zoomTo(e,i)},rotate:function(e){return this.cropper.rotate(e)},rotateTo:function(e){return this.cropper.rotateTo(e)},scaleX:function(e){return this.cropper.scaleX(e)},scaleY:function(e){return this.cropper.scaleY(e)},scale:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;return this.cropper.scale(e,i)},getData:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.cropper.getData(e)},setData:function(e){return this.cropper.setData(e)},getContainerData:function(){return this.cropper.getContainerData()},getImageData:function(){return this.cropper.getImageData()},getCanvasData:function(){return this.cropper.getCanvasData()},setCanvasData:function(e){return this.cropper.setCanvasData(e)},getCropBoxData:function(){return this.cropper.getCropBoxData()},setCropBoxData:function(e){return this.cropper.setCropBoxData(e)},getCroppedCanvas:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.cropper.getCroppedCanvas(e)},setAspectRatio:function(e){return this.cropper.setAspectRatio(e)},setDragMode:function(e){return this.cropper.setDragMode(e)}}};const O5=$n("contacts","supportedNetworks"),T5={name:"ContactDetailsAvatar",components:{ActionButton:gn,ActionLink:tr,Actions:Hn,Avatar:Bn,IconCloudDownload:o5,IconDownload:sr,IconDelete:tn,IconUpload:Ud,IconFolder:Yd,IconImage:_5,NcButton:ne,VueCropper:I5,NcModal:yn},props:{contact:{type:Object,required:!0},isReadOnly:{type:Boolean,required:!0},reloadBus:{type:Object,required:!0}},data(){return{opened:!1,loading:!1,photoUrl:void 0,root:ac(`dav/files/${sc().uid}`),showCropper:!1,cropperOptions:{aspectRatio:1/1,viewMode:3,guides:!1,center:!1,highlight:!1,autoCropArea:1,dragMode:"move",minContainerWidth:100,minContainerHeight:100}}},computed:{supportedSocial(){const e=this.contact.vCard.getAllProperties("email"),i=this.contact.vCard.getAllProperties("x-socialprofile").map(s=>s.jCal[1].type.toString().toLowerCase()),o=this.contact.vCard.getAllProperties("impp").map(s=>s.jCal[1].type.toString().toLowerCase()),r=[].concat(i,o),a=O5.map(s=>s.toLowerCase());return e.length&&r.push("gravatar"),a.filter(s=>r.includes(s)).map(s=>this.capitalize(s))}},watch:{async contact(){await this.loadPhotoUrl()}},async mounted(){await this.loadPhotoUrl()},methods:{onLoad(...e){console.debug(...e)},async processPicture(e){const i=this.getMimetype(e);if(!i.startsWith("image/"))return vt(t("contacts","Please select a valid format")),!1;if(i==="image/svg"){const o=atob(e.toString("base64"));if(!await sm(o))throw new Error("Unsafe svg image",o)}return this.openCropper(e,i),!0},openCropper(e,i){const o=`data:${i};base64,${e.toString("base64")}`;this.$refs.cropper.replace(o),this.showCropper=!0},handleUploadedFile(e){if(e.target.files&&!this.loading){this.closeMenu();const i=e.target.files[0],o=new FileReader;o.onload=r=>{try{if(typeof r.target.result=="object"){const a=ve.from(r.target.result,"binary");if(this.processPicture(a))return;throw new Error("Wrong image mimetype")}}catch(a){console.error(a),vt(t("contacts","Invalid image"))}finally{this.resetPicker()}},o.readAsArrayBuffer(i)}},resetPicker(){this.$refs.uploadInput.value="",this.loading=!1},capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()},getMimetype(e){const i=[];e.slice(0,12).forEach(a=>{i.push(a.toString(16).padStart(2,"0"))});const o=i.join("").toUpperCase(),r=parseInt(window.OC.config.version.split(".")[0]);if(r>=31&&o.slice(0,8)==="52494646"&&o.slice(16,24)==="57454250")return"image/webp";if(r>=32&&o.slice(8,24)==="6674797061766966")return"image/avif";switch(o.slice(0,8)){case"89504E47":return"image/png";case"47494638":return"image/gif";case"3C3F786D":case"3C737667":return"image/svg+xml";case"FFD8FFDB":case"FFD8FFE0":case"FFD8FFE1":return"image/jpeg";default:return"application/octet-stream"}},async setPhoto(e,i){if(this.contact.photo&&this.contact.vCard.addPropertyWithValue("photo",""),this.contact.version==="3.0"){this.contact.photo=e;const o=this.contact.vCard.getFirstProperty("photo");o.setParameter("encoding","b"),i&&o.setParameter("type",i.split("/").pop())}else this.contact.photo=`data:${i};base64,${e}`;await this.loadPhotoUrl(),await this.reloadBus.emit("reload-avatar",this.contact.key),this.loading=!1},async loadPhotoUrl(){if(this.photoUrl=void 0,this.contact.photo){const e=await this.contact.getPhotoUrl();if(!e){console.warn("contact has an invalid photo");return}this.photoUrl=e}else this.contact.url&&(this.photoUrl=`${this.contact.url}?photo`)},saveAvatar(){this.showCropper=!1,this.loading=!0,this.$refs.cropper.getCroppedCanvas({minWidth:16,minHeight:16,maxWidth:512,maxHeight:512}).toBlob(async e=>{if(e===null){vt(t("contacts","Error cropping picture")),this.cancel();return}const i=new FileReader;i.readAsDataURL(e),i.onloadend=()=>{const o=i.result;this.setPhoto(o.split(",").pop(),e.type)}})},removePhoto(){this.contact.vCard.removeAllProperties("photo"),this.photoUrl=void 0,this.reloadBus.emit("delete-avatar",this.contact.key)},cancel(){this.showCropper=!1,this.loading=!1},selectFileInput(){this.loading||this.$refs.uploadInput.click()},async selectFilePicker(){if(!this.loading){this.closeMenu();const e=await fc(t("contacts","Pick an avatar")).setMimeTypeFilter(["image/png","image/jpeg","image/gif","image/x-xbitmap","image/bmp","image/svg+xml"]).addButton({label:t("calendar","Pick"),type:"primary",callback:i=>lc.debug("Picked avatar",{nodes:i})}).build().pick();if(e){this.loading=!0;try{const i=await xe.get(`${this.root}${e}`,{responseType:"arraybuffer"}),o=ve.from(i.data,"binary");this.processPicture(o)}catch(i){vt(t("contacts","Error while processing the picture.")),console.error(i),this.loading=!1}finally{this.resetPicker()}}}},async getSocialAvatar(e){if(!this.loading){this.loading=!0;try{if((await xe.put(Qo("/apps/contacts/api/v1/social/avatar/{network}/{id}/{uid}",{network:e.toLowerCase(),id:this.contact.addressbook.id,uid:this.contact.uid})))?.status!==200)throw new URIError("Download of social profile avatar failed");await this.$store.dispatch("fetchFullContact",{contact:this.contact,forceReFetch:!0});const i=this.$store.getters.getContact(this.contact.key);await this.$emit("update-local-contact",i),await this.loadPhotoUrl(),await this.reloadBus.emit("reload-avatar",this.contact.key),hc(t("contacts","Avatar downloaded from social network"))}catch(i){i?.response?.status===304?lm(t("contacts","Avatar already up to date")):(vt(t("contacts","Avatar download failed")),console.debug(i))}}this.loading=!1},closeMenu(){this.opened=!1}}},E5={class:"contact-header-avatar__wrapper"},P5={class:"avatar__container"},$5={class:"avatar__cropper-buttons"};function z5(e,i,o,r,a,s){const l=b("Avatar"),c=b("VueCropper"),d=b("NcButton"),u=b("NcModal"),m=b("IconImage"),y=b("IconUpload"),v=b("ActionButton"),w=b("IconFolder"),D=b("IconCloudDownload"),S=b("IconDownload"),R=b("ActionLink"),A=b("IconDelete"),V=b("Actions");return p(),C("div",E5,[T("input",{id:"contact-avatar-upload",ref:"uploadInput",type:"file",class:"hidden",accept:"image/*",onChange:i[0]||(i[0]=(...W)=>s.handleUploadedFile&&s.handleUploadedFile(...W))},null,544),o.contact.addressbook.id==="z-server-generated--system"?(p(),O(l,{key:0,"disable-menu":"","show-user-status":!1,user:o.contact.uid,size:75,class:"contact-header-avatar__photo"},null,8,["user"])):(p(),O(l,{key:1,"disable-tooltip":!0,"display-name":o.contact.displayName,"is-no-user":!0,size:75,url:a.photoUrl,class:"contact-header-avatar__photo"},null,8,["display-name","url"])),M(u,{show:a.showCropper,"onUpdate:show":i[1]||(i[1]=W=>a.showCropper=W),size:"small",onClose:s.cancel},{default:_(()=>[T("div",P5,[T("h2",null,E(e.t("contacts","Crop contact photo")),1),M(c,pt({ref:"cropper",class:"avatar__cropper"},a.cropperOptions),null,16),T("div",$5,[M(d,{variant:"tertiary",onClick:s.cancel},{default:_(()=>[K(E(e.t("contacts","Cancel")),1)]),_:1},8,["onClick"]),M(d,{variant:"primary",onClick:s.saveAvatar},{default:_(()=>[K(E(e.t("contacts","Save")),1)]),_:1},8,["onClick"])])])]),_:1},8,["show","onClose"]),o.isReadOnly?P("",!0):(p(),O(V,{key:2,open:a.opened,"onUpdate:open":i[2]||(i[2]=W=>a.opened=W),"force-menu":!0,class:"contact-header-avatar__menu"},{icon:_(()=>[M(m,{size:20,"fill-color":"#fff"})]),default:_(()=>[M(v,{"close-after-click":!0,onClick:Wt(s.selectFileInput,["stop","prevent"])},{icon:_(()=>[M(y,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Upload a new picture")),1)]),_:1},8,["onClick"]),M(v,{"close-after-click":!0,onClick:s.selectFilePicker},{icon:_(()=>[M(w,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Choose from Files")),1)]),_:1},8,["onClick"]),(p(!0),C(mt,null,It(s.supportedSocial,W=>(p(),O(v,{"close-after-click":!0,key:W,onClick:it=>s.getSocialAvatar(W)},{icon:_(()=>[M(D,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Get from "+W)),1)]),_:2},1032,["onClick"]))),128)),o.contact.photo?(p(),C(mt,{key:0},[M(R,{href:`${o.contact.url}?photo`,target:"_blank","close-after-click":!0},{icon:_(()=>[M(S,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Download picture")),1)]),_:1},8,["href"]),M(v,{"close-after-click":!0,onClick:s.removePhoto},{icon:_(()=>[M(A,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Delete picture")),1)]),_:1},8,["onClick"])],64)):P("",!0)]),_:1},8,["open"]))])}const H5=Q(T5,[["render",z5],["__scopeId","data-v-21f4a466"]]),B5={name:"DetailsHeader",components:{Actions:Hn},data(){return{avatarSize:75}},computed:{cssStyle(){return{"--avatar-size":this.avatarSize+"px"}}}},R5={class:"contact-header__no-wrap"},V5={class:"contact-header__avatar"},U5={class:"contact-header__infos"},Y5={class:"contact-header__infos-title"},G5={key:0,class:"contact-header__infos-subtitle"},F5={class:"contact-header__quick-actions"},W5={class:"contact-header__actions"};function j5(e,i,o,r,a,s){const l=b("Actions");return p(),C("header",{class:"contact-header",style:Zo(s.cssStyle)},[T("div",R5,[T("div",V5,[Tt(e.$slots,"avatar",{avatarSize:a.avatarSize},void 0,!0)]),T("div",U5,[T("h2",Y5,[Tt(e.$slots,"title",{},void 0,!0)]),e.$slots.subtitle?(p(),C("div",G5,[Tt(e.$slots,"subtitle",{},void 0,!0)])):P("",!0),T("div",F5,[Tt(e.$slots,"quick-actions",{},void 0,!0)])])]),T("div",W5,[Tt(e.$slots,"actions",{},void 0,!0),M(l,pt({ref:"actions",class:"header-menu","menu-align":"right"},e.$attrs),{default:_(()=>[Tt(e.$slots,"actions-menu",{},void 0,!0)]),_:3},16)])],4)}const q5=Q(B5,[["render",j5],["__scopeId","data-v-8f867b07"]]),X5=[];function oo(e){return e>=48&&e<=57}function Z5(e,i,o){if(typeof e!="string")throw new TypeError(`The first argument must be a string. Received type '${typeof e}'`);if(typeof i!="string")throw new TypeError(`The second argument must be a string. Received type '${typeof i}'`);const r=e.length,a=i.length;let s=0,l=0,c=X5,d=0;for(o&&(o.caseInsensitive&&(e=e.toLowerCase(),i=i.toLowerCase()),o.alphabet&&(c=J5(o.alphabet)));s<r&&l<a;){let u=e.charCodeAt(s),m=i.charCodeAt(l);if(oo(u)){if(!oo(m))return u-m;let y=s,v=l;for(;u===48&&++y<r;)u=e.charCodeAt(y);for(;m===48&&++v<a;)m=i.charCodeAt(v);y!==v&&d===0&&(d=y-v);let w=y,D=v;for(;w<r&&oo(e.charCodeAt(w));)++w;for(;D<a&&oo(i.charCodeAt(D));)++D;let S=w-y-D+v;if(S!==0)return S;for(;y<w;)if(S=e.charCodeAt(y++)-i.charCodeAt(v++),S!==0)return S;s=w,l=D;continue}if(u!==m)return u<c.length&&m<c.length&&c[u]!==-1&&c[m]!==-1?c[u]-c[m]:u-m;++s,++l}return s<r?1:l<a?-1:d}const Ml={};function J5(e){const i=Ml[e];if(i!==void 0)return i;const o=[],r=e.split("").reduce((a,s)=>Math.max(a,s.charCodeAt(0)),0);for(let a=0;a<=r;a++)o.push(-1);for(let a=0;a<e.length;a++)o[e.charCodeAt(a)]=a;return Ml[e]=o,o}var K5=Z5;const ha=Na(K5),Q5={name:"PropertyGroups",components:{PropertyTitle:cm,NcSelect:Rn},props:{propModel:{type:Object,default:()=>{},required:!0},value:{type:Array,default:()=>[],required:!0},contact:{type:Pa,default:null,required:!0},isReadOnly:{type:Boolean,required:!0}},data(){return{localValue:[...this.value].sort()}},computed:{showAsText(){return this.isReadOnly&&this.localValue.length<=1},showProperty(){return this.isReadOnly&&this.localValue.length>0||!this.isReadOnly},groups(){return this.$store.getters.getGroups.slice(0).map(e=>e.name).sort((e,i)=>ha(e,i,{caseInsensitive:!0}))},formatGroupsTitle(){return this.localValue.slice(3).join(", ")}},watch:{value(){this.localValue=this.value},selectType(){this.localType=this.selectType}},methods:{updateValue(){this.$emit("update:value",this.localValue)}}},t4={key:0,class:"property"},e4={class:"property__row"},n4={class:"property__label"},i4={class:"property__value"},o4={class:"multiselect__limit"},r4={key:1},a4={key:0},s4={key:1,class:"group__list"};function l4(e,i,o,r,a,s){const l=b("PropertyTitle"),c=b("NcSelect"),d=Sa("tooltip");return o.propModel&&s.showProperty?(p(),C("div",t4,[M(l,{icon:"icon-contacts-dark","readable-name":e.t("contacts","Contact groups"),"is-read-only":o.isReadOnly},null,8,["readable-name","is-read-only"]),T("div",e4,[T("div",n4,[T("span",null,E(o.propModel.readableName),1)]),T("div",i4,[o.isReadOnly?(p(),C("div",r4,[a.localValue.length===0?(p(),C("span",a4,E(e.t("contacts","None")),1)):(p(),C("div",s4,[(p(!0),C(mt,null,It(a.localValue,(u,m)=>(p(),C("span",{key:m},E(u)+E(m===a.localValue.length-1?"":", "),1))),128))]))])):(p(),O(c,{key:0,modelValue:a.localValue,"onUpdate:modelValue":i[0]||(i[0]=u=>a.localValue=u),options:s.groups,"no-wrap":!0,placeholder:e.t("contacts","Add contact in group"),multiple:!0,"close-on-select":!1,clearable:!0,"deselect-from-dropdown":!0,taggable:!0,"tag-placeholder":"create","onOption:deselected":s.updateValue,onClose:s.updateValue},{limit:_(()=>[ue((p(),C("span",o4,[K(" +"+E(a.localValue.length-3),1)])),[[d,s.formatGroupsTitle,void 0,{auto:!0}]])]),"no-options":_(()=>[T("span",null,E(e.t("contacts","No results")),1)]),_:1},8,["modelValue","options","placeholder","onOption:deselected","onClose"]))]),i[1]||(i[1]=T("div",{class:"property__actions"},null,-1))])])):P("",!0)}const c4=Q(Q5,[["render",l4],["__scopeId","data-v-cb1b2366"]]),d4={name:"PropertyRev",props:{value:{type:Object,required:!0}},computed:{relativeDate(){return dm.unix(Ao(this.value).toUnixTime()).fromNow()}}},u4={class:"property property--rev"},h4={class:"property__row"},p4={class:"property__value"};function m4(e,i,o,r,a,s){return p(),C("div",u4,[T("div",h4,[i[0]||(i[0]=T("div",{class:"property__label"},null,-1)),T("div",p4,E(e.t("contacts","Last modified"))+" "+E(s.relativeDate),1),i[1]||(i[1]=T("div",{class:"property__actions"},null,-1))])])}const f4=Q(d4,[["render",m4],["__scopeId","data-v-1f731c44"]]),g4=$n("contacts","isTalkEnabled",!1),{profileEnabled:y4}=$n("user_status","profileEnabled",!1),v4={name:"ContactDetails",components:{Actions:Hn,ActionButton:gn,ActionLink:tr,AddNewProp:J_,AppContentDetails:Im,ContactAvatar:H5,ContactDetailsProperty:gc,DetailsHeader:q5,EmptyContent:fn,IconContact:Vn,IconMail:yc,IconMessage:um,IconCall:hm,IconAccount:Ti,IconDownload:sr,IconDelete:tn,IconQr:r_,CakeIcon:h_,IconCopy:mc,IconLoading:me,PencilIcon:Ea,CheckIcon:Vd,Modal:yn,NcSelect:Rn,PropertyGroups:c4,PropertyRev:f4,PropertySelect:pm,NcButton:ne,NcRelatedResourcesPanel:H1,NcEmptyContent:fn,FolderMultipleImage:O_},mixins:[er],provide(){return{sharedState:this.sharedState}},props:{contactKey:{type:String,default:void 0},contacts:{type:Array,default:()=>[]},reloadBus:{type:Object,required:!0},desc:{type:String,required:!1,default:""}},data(){return{fixed:!1,localContact:void 0,loadingData:!0,loadingUpdate:!1,qrcode:"",showPickAddressbookModal:!1,pickedAddressbook:null,editMode:!1,newGroupsValue:[],newAddressBook:null,contactDetailsSelector:".contact-details",excludeFromBirthdayKey:"x-nc-exclude-from-birthday-calendar",bus:$a(),showMenuPopover:!1,profileEnabled:y4,isTalkEnabled:g4,hasFilesResources:!1,hasTalkResources:!1,hasCalendarResources:!1,hasDeckResources:!1,deckPanelHasError:!1,filesPanelHasError:!1,talkPanelHasError:!1,calendarPanelHasError:!1,sharedState:nc({validEmail:!0})}},computed:{hasRelatedResources(){return this.hasFilesResources||this.hasTalkResources||this.hasCalendarResources||this.hasDeckResources},canModifyCard(){return this.contact.addressbook?.canModifyCard},canDeleteCard(){return this.contact.addressbook?.canDeleteCard},isReadOnly(){return!this.canModifyCard||!this.editMode},isDataValid(){return this.sharedState.validEmail},warning(){return this.canModifyCard===!1?{icon:S_,classes:[],msg:t("contacts","This contact is in read-only mode. You do not have permission to edit this contact.")}:!1},conflict(){return this.contact.conflict?t("contacts","The contact you were trying to edit has changed. Please manually refresh the contact. Any further edits will be discarded."):!1},sortedProperties(){return this.localContact.properties.slice(0).sort((e,i)=>{const o=e.name.split(".").pop(),r=i.name.split(".").pop();return Ee.fieldOrder.indexOf(o)-Ee.fieldOrder.indexOf(r)})},groupedProperties(){return this.sortedProperties.reduce((e,i)=>this.canDisplay(i)?i.name==="bday"||i.name==="deathdate"||i.name==="anniversary"?(e.lifeEvents||(e.lifeEvents=[]),e.lifeEvents.push(i),e):(e[i.name]||(e[i.name]=[]),e[i.name].push(i),e):e,{})},addressbookModel(){return{readableName:t("contacts","Address book"),icon:"icon-address-book",options:this.addressbooksOptions}},addressbook(){return this.contact.addressbook.id},groupsModel(){return{readableName:t("contacts","Contact groups"),icon:"icon-contacts-dark"}},addressbooksOptions(){return this.addressbooks.filter(e=>e.enabled).map(e=>({id:e.id,name:e.displayName,readOnly:e.readOnly}))},copyableAddressbooksOptions(){return this.addressbooksOptions.filter(e=>!e.readOnly).filter(e=>e.id!==this.contact.addressbook.id).map(e=>({id:e.id,name:e.name}))},addressbooks(){return this.$store.getters.getAddressbooks},contact(){return this.$store.getters.getContact(this.contactKey)},excludeFromBirthdayLabel(){return this.localContact.vCard.hasProperty(this.excludeFromBirthdayKey)?t("contacts","Add contact to Birthday Calendar"):t("contacts","Exclude contact from Birthday Calendar")},enableToggleBirthdayExclusion(){return!!this.localContact?.vCard&&!this.isInSystemAddressBook},formattedSubtitle(){const e=this.contact.title,i=this.contact.org;return e&&i?t("contacts","{title} at {organization}",{title:e,organization:i}):e?Vs(e):i?Vs(i):""},profilePageLink(){return this.contact.socialLink("NEXTCLOUD")},emailAddressProperties(){return this.localContact.properties.find(e=>e.name==="email")},emailAddress(){return this.emailAddressProperties?.getFirstValue()},phoneNumberProperties(){return this.localContact.properties.find(e=>e.name==="tel")},phoneNumberList(){return this.groupedProperties?.tel?.map(e=>e.getFirstValue()).filter(e=>!!e)},emailAddressList(){return this.groupedProperties?.email?.map(e=>e.getFirstValue()).filter(e=>!!e)},callUrl(){return Qo("/apps/spreed/?callUser={uid}",{uid:this.contact.uid})},isInSystemAddressBook(){return this.contact.addressbook.id==="z-server-generated--system"},nextcloudVersionAtLeast28(){return parseInt(window.OC.config.version.split(".")[0])>=28}},watch:{contact(e,i){this.contactKey&&e!==i&&this.selectContact(this.contactKey)}},beforeMount(){this.contactKey&&this.selectContact(this.contactKey),document.addEventListener("keydown",this.onCtrlSave)},beforeUnmount(){document.removeEventListener("keydown",this.onCtrlSave)},methods:{updateGroups(e){this.newGroupsValue=e},updateAddressbook(e){this.newAddressBook=e},async updateContact(){this.fixed=!1,this.loadingUpdate=!0;try{await this.$store.dispatch("updateContact",this.localContact)}finally{this.loadingUpdate=!1}if(!this.localContact.dav){this.logger.debug("New contact synced!",{localContact:this.localContact});const e=this.$store.getters.getContact(this.localContact.key);await this.updateLocalContact(e)}},async showQRcode(){const e=this.contact.jCal.slice(0);e[1]=e[1].filter(o=>o[0]!=="photo");const i=Ia.stringify(e);if(i.length>0){const o=await Uk(i),r=new TextDecoder().decode(o);this.qrcode=btoa(r)}},async toggleBirthdayExclusionForContact(){this.localContact.vCard.hasProperty(this.excludeFromBirthdayKey)?this.localContact.vCard.removeProperty(this.excludeFromBirthdayKey):this.localContact.vCard.addPropertyWithValue(this.excludeFromBirthdayKey,!0),await this.updateContact()},selectInput(){this.$refs.fullname&&this.$refs.fullname.value===t("contacts","Name")&&this.$refs.fullname.select()},async selectContact(e){this.loadingData=!0,this.editMode=!1;const i=this.$store.getters.getContact(e);if(i)if(i.dav)try{await this.$store.dispatch("fetchFullContact",{contact:i}),await this.updateLocalContact(i)}catch(o){o.name==="ParserError"?vt(t("contacts","Syntax error. Cannot open the contact.")):o?.status===404?vt(t("contacts","The contact does not exist on the server anymore.")):vt(t("contacts","Unable to retrieve the contact from the server, please check your network connection.")),console.error(o),this.$store.dispatch("deleteContact",{contact:this.contact,dav:!1})}else await this.updateLocalContact(i),this.editMode=!0;this.loadingData=!1},deleteContact(){this.$store.dispatch("deleteContact",{contact:this.contact})},async moveContactToAddressbook(e){const i=this.addressbooks.find(o=>o.id===e);if(this.loadingUpdate=!0,i)try{const o=await this.$store.dispatch("moveContactToAddressbook",{contact:this.contact,addressbook:i});this.$router.push({name:"contact",params:{selectedGroup:this.$route.params.selectedGroup,selectedContact:o.key}})}catch(o){console.error(o),vt(t("contacts","An error occurred while trying to move the contact"))}finally{this.loadingUpdate=!1}},async copyContactToAddressbook(e){const i=this.addressbooks.find(o=>o.id===e);if(this.loadingUpdate=!0,i)try{const o=await this.$store.dispatch("copyContactToAddressbook",{contact:this.contact,addressbook:i});this.$router.push({name:"contact",params:{selectedGroup:this.$route.params.selectedGroup,selectedContact:o.key}})}catch(o){console.error(o),vt(t("contacts","An error occurred while trying to copy the contact"))}finally{this.loadingUpdate=!1}},refreshContact(){this.$store.dispatch("fetchFullContact",{contact:this.contact,etag:this.conflict}).then(()=>{this.contact.conflict=!1})},closeQrModal(){this.qrcode=""},async updateLocalContact(e){const i=Object.assign(Object.create(Object.getPrototypeOf(e)),e);this.fixed=mm(i),this.localContact=i,this.newGroupsValue=[...this.localContact.groups]},onCtrlSave(e){this.editMode&&e.keyCode===83&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&(e.preventDefault(),this.onSave())},async cloneContact(){this.pickedAddressbook&&this.addressbooks.find(e=>e.id===this.pickedAddressbook.id)?(this.logger.debug("Cloning contact to",{name:this.pickedAddressbook.name}),await this.copyContactToAddressbook(this.pickedAddressbook.id),this.closePickAddressbookModal()):this.addressbooksOptions.length===1?(this.logger.debug("Cloning contact to",{name:this.addressbooksOptions[0].name}),await this.copyContactToAddressbook(this.addressbooksOptions[0].id)):this.showPickAddressbookModal=!0},closePickAddressbookModal(){this.showPickAddressbookModal=!1,this.pickedAddressbook=null},canDisplay(e){const i=Ee.properties[e.name.split(".").pop()],o=i&&i.force?i.force:e.getDefaultType();return i&&o!=="unknown"},async onSave(){try{this.localContact.groups=[...this.newGroupsValue],await this.$store.dispatch("updateContactGroups",{groupNames:this.newGroupsValue,contact:this.contact}),await this.updateContact(),this.newAddressBook&&this.newAddressBook!==this.contact.addressbook.id&&(this.moveContactToAddressbook(this.newAddressBook),this.newAddressBook=null),this.editMode=!1}catch(e){this.logger.error("error while saving contact",{error:e}),vt(t("contacts","Unable to update contact")),this.logger.error(`Unable to update contact: ${e}`,{error:e,contact:Ao(this.contact),localContact:Ao(this.localContact)})}}}},b4={key:0,class:"contact-title"},C4=["placeholder"],w4=["innerHTML"],k4=["placeholder"],_4=["placeholder"],x4={key:0},S4=["title"],M4=["title"],A4=["src","alt"],N4={key:3,class:"contact-details-wrapper"},L4={class:"contact-details"},D4={key:0,class:"life-events-group"},I4={key:4,class:"related-resources"};function O4(e,i,o,r,a,s){const l=b("IconContact"),c=b("EmptyContent"),d=b("ContactAvatar"),u=b("ActionButton"),m=b("IconAccount"),y=b("IconMail"),v=b("ActionLink"),w=b("IconCall"),D=b("Actions"),S=b("PencilIcon"),R=b("NcButton"),A=b("IconLoading"),V=b("CheckIcon"),W=b("IconDownload"),it=b("IconCopy"),et=b("IconQr"),st=b("CakeIcon"),lt=b("IconDelete"),ht=b("DetailsHeader"),rt=b("Modal"),dt=b("NcSelect"),L=b("ContactDetailsProperty"),G=b("PropertySelect"),j=b("PropertyGroups"),I=b("NcRelatedResourcesPanel"),Z=b("FolderMultipleImage"),z=b("NcEmptyContent"),tt=b("AddNewProp"),at=b("PropertyRev"),ct=b("AppContentDetails");return p(),O(ct,null,{default:_(()=>[s.contact?(p(),C(mt,{key:1},[M(ht,null,{avatar:_(()=>[M(d,{contact:s.contact,"is-read-only":s.isReadOnly,"reload-bus":o.reloadBus,onUpdateLocalContact:s.updateLocalContact},null,8,["contact","is-read-only","reload-bus","onUpdateLocalContact"])]),title:_(()=>[s.isReadOnly?(p(),C("div",b4,E(s.contact.fullName),1)):ue((p(),C("input",{key:1,id:"contact-fullname",ref:"fullname","onUpdate:modelValue":i[0]||(i[0]=Y=>s.contact.fullName=Y),placeholder:e.t("contacts","Name"),type:"text",autocomplete:"off",autocorrect:"off",spellcheck:"false",name:"fullname",onClick:i[1]||(i[1]=(...Y)=>s.selectInput&&s.selectInput(...Y))},null,8,C4)),[[In,s.contact.fullName]])]),subtitle:_(()=>[s.isReadOnly?(p(),C("span",{key:0,innerHTML:s.formattedSubtitle},null,8,w4)):(p(),C(mt,{key:1},[ue(T("input",{id:"contact-title","onUpdate:modelValue":i[2]||(i[2]=Y=>s.contact.title=Y),placeholder:e.t("contacts","Title"),type:"text",autocomplete:"off",autocorrect:"off",spellcheck:"false",name:"title"},null,8,k4),[[In,s.contact.title]]),ue(T("input",{id:"contact-org","onUpdate:modelValue":i[3]||(i[3]=Y=>s.contact.org=Y),placeholder:e.t("contacts","Company"),type:"text",autocomplete:"off",autocorrect:"off",spellcheck:"false",name:"org"},null,8,_4),[[In,s.contact.org]])],64))]),"quick-actions":_(()=>[!a.editMode&&!a.loadingData?(p(),C("div",x4,[M(D,{inline:6,variant:"secondary"},{default:_(()=>[a.isTalkEnabled&&s.isInSystemAddressBook?(p(),O(u,{key:0,"aria-label":e.t("contacts","Go to talk conversation"),name:e.t("contacts","Go to talk conversation"),class:"icon-talk quick-action",href:s.callUrl},null,8,["aria-label","name","href"])):P("",!0),s.profilePageLink?(p(),O(u,{key:1,class:"quick-action","aria-label":e.t("contacts","View profile"),name:e.t("contacts","View profile"),href:s.profilePageLink},{icon:_(()=>[M(m,{size:20})]),_:1},8,["aria-label","name","href"])):P("",!0),(p(!0),C(mt,null,It(s.emailAddressList,Y=>(p(),O(v,{key:Y,class:"quick-action",href:"mailto:"+Y},{icon:_(()=>[M(y,{size:20})]),default:_(()=>[K(" "+E(Y),1)]),_:2},1032,["href"]))),128)),(p(!0),C(mt,null,It(s.phoneNumberList,Y=>(p(),O(v,{key:Y,class:"quick-action",href:"tel:"+Y},{icon:_(()=>[M(w,{size:20})]),default:_(()=>[K(" "+E(Y),1)]),_:2},1032,["href"]))),128))]),_:1})])):P("",!0)]),actions:_(()=>[s.warning?(p(),O(Pn(s.warning.icon),{key:0,title:s.warning?s.warning.msg:"",class:"header-icon",classes:s.warning.classes},null,8,["title","classes"])):P("",!0),s.conflict?(p(),C("div",{key:1,title:s.conflict,class:"header-icon header-icon--pulse icon-history",onClick:i[4]||(i[4]=(...Y)=>s.refreshContact&&s.refreshContact(...Y))},null,8,S4)):P("",!0),a.fixed?(p(),C("div",{key:2,title:e.t("contacts","This contact was broken and received a fix. Please review the content and click here to save it."),class:"header-icon header-icon--pulse icon-up",onClick:i[5]||(i[5]=(...Y)=>s.updateContact&&s.updateContact(...Y))},null,8,M4)):P("",!0),s.canModifyCard?(p(),C(mt,{key:3},[a.editMode?(p(),O(R,{key:1,variant:"secondary",disabled:a.loadingUpdate||!s.isDataValid,onClick:s.onSave},{icon:_(()=>[a.loadingUpdate?(p(),O(A,{key:0,size:20})):(p(),O(V,{key:1,size:20}))]),default:_(()=>[K(" "+E(e.t("contacts","Save")),1)]),_:1},8,["disabled","onClick"])):(p(),O(R,{key:0,variant:e.isMobile?"secondary":"tertiary",onClick:i[6]||(i[6]=Y=>a.editMode=!0)},{icon:_(()=>[M(S,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Edit")),1)]),_:1},8,["variant"]))],64)):P("",!0)]),"actions-menu":_(()=>[M(v,{href:s.contact.url,download:`${s.contact.displayName}.vcf`},{icon:_(()=>[M(W,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Download")),1)]),_:1},8,["href","download"]),s.isReadOnly&&s.addressbooksOptions.length>0?(p(),O(u,{key:0,ref:"cloneAction","close-after-click":!0,onClick:s.cloneContact},{icon:_(()=>[M(it,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Clone contact")),1)]),_:1},8,["onClick"])):P("",!0),M(u,{"close-after-click":!0,onClick:s.showQRcode},{icon:_(()=>[M(et,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Generate QR Code")),1)]),_:1},8,["onClick"]),s.enableToggleBirthdayExclusion?(p(),O(u,{key:1,"close-after-click":!0,onClick:s.toggleBirthdayExclusionForContact},{icon:_(()=>[M(st,{size:20})]),default:_(()=>[K(" "+E(s.excludeFromBirthdayLabel),1)]),_:1},8,["onClick"])):P("",!0),s.canDeleteCard?(p(),O(u,{key:2,onClick:s.deleteContact},{icon:_(()=>[M(lt,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Delete")),1)]),_:1},8,["onClick"])):P("",!0)]),_:1}),a.qrcode?(p(),O(rt,{key:0,id:"qrcode-modal",size:"small","clear-view-delay":-1,name:s.contact.displayName,"close-button-contained":!1,onClose:s.closeQrModal},{default:_(()=>[T("img",{src:`data:image/svg+xml;base64,${a.qrcode}`,alt:e.t("contacts","Contact vCard as QR code"),class:"qrcode",width:"400"},null,8,A4)]),_:1},8,["name","onClose"])):P("",!0),a.showPickAddressbookModal?(p(),O(rt,{key:1,id:"pick-addressbook-modal","clear-view-delay":-1,name:e.t("contacts","Pick an address book"),onClose:s.closePickAddressbookModal},{default:_(()=>[M(dt,{ref:"pickAddressbook",modelValue:a.pickedAddressbook,"onUpdate:modelValue":i[7]||(i[7]=Y=>a.pickedAddressbook=Y),class:"address-book","allow-empty":!1,options:s.copyableAddressbooksOptions,placeholder:e.t("contacts","Select address book"),label:"name"},null,8,["modelValue","options","placeholder"]),T("button",{onClick:i[8]||(i[8]=(...Y)=>s.closePickAddressbookModal&&s.closePickAddressbookModal(...Y))},E(e.t("contacts","Cancel")),1),T("button",{class:"primary",onClick:i[9]||(i[9]=(...Y)=>s.cloneContact&&s.cloneContact(...Y))},E(e.t("contacts","Clone contact")),1)]),_:1},8,["name","onClose"])):P("",!0),a.loadingData?(p(),O(A,{key:2,size:20,class:"contact-details"})):a.loadingData?P("",!0):(p(),C("div",N4,[T("section",L4,[e.name==="lifeEvents"?(p(),C("div",D4,[(p(!0),C(mt,null,It(e.properties,(Y,gt)=>(p(),O(L,{key:`${gt}-${s.contact.key}-${Y.name}`,"is-first-property":gt===0,"is-last-property":gt===e.properties.length-1,property:Y,contact:s.contact,"local-contact":a.localContact,contacts:o.contacts,bus:a.bus,"is-read-only":s.isReadOnly},null,8,["is-first-property","is-last-property","property","contact","local-contact","contacts","bus","is-read-only"]))),128))])):P("",!0),(p(!0),C(mt,null,It(s.groupedProperties,(Y,gt)=>(p(),C("div",{key:gt},[(p(!0),C(mt,null,It(Y,(St,Ht)=>(p(),O(L,{key:`${Ht}-${s.contact.key}-${St.name}`,"is-first-property":Ht===0,"is-last-property":Ht===Y.length-1,property:St,contact:s.contact,"local-contact":a.localContact,contacts:o.contacts,bus:a.bus,"is-read-only":s.isReadOnly},null,8,["is-first-property","is-last-property","property","contact","local-contact","contacts","bus","is-read-only"]))),128))]))),128))]),M(G,{"prop-model":s.addressbookModel,options:s.addressbooksOptions,value:s.addressbook,"is-first-property":!0,"is-last-property":!0,property:{},"hide-actions":!0,"is-read-only":s.isReadOnly,class:"property--addressbooks property--last","onUpdate:value":s.updateAddressbook},null,8,["prop-model","options","value","is-read-only","onUpdate:value"]),M(j,{value:a.localContact.groups,"prop-model":s.groupsModel,contact:s.contact,"is-read-only":s.isReadOnly,class:"property--groups property--last","onUpdate:value":s.updateGroups},null,8,["value","prop-model","contact","is-read-only","onUpdate:value"])])),s.nextcloudVersionAtLeast28&&!a.editMode?(p(),C("div",I4,[a.filesPanelHasError?P("",!0):(p(),O(I,{key:0,"provider-id":"account","resource-type":"files",description:o.desc,limit:5,header:e.t("contacts","Media shares with you"),"item-id":s.contact.uid,primary:!0,onHasResources:i[10]||(i[10]=Y=>a.hasFilesResources=Y),onHasError:i[11]||(i[11]=Y=>a.filesPanelHasError=Y)},null,8,["description","header","item-id"])),a.talkPanelHasError?P("",!0):(p(),O(I,{key:1,"provider-id":"account","resource-type":"talk",description:o.desc,limit:5,header:e.t("contacts","Talk conversations with you"),"item-id":s.contact.uid,primary:!0,onHasResources:i[12]||(i[12]=Y=>a.hasTalkResources=Y),onHasError:i[13]||(i[13]=Y=>a.talkPanelHasError=Y)},null,8,["description","header","item-id"])),a.calendarPanelHasError?P("",!0):(p(),O(I,{key:2,"provider-id":"account","resource-type":"calendar",description:o.desc,limit:5,header:e.t("contacts","Calendar events with you"),"item-id":s.contact.uid,primary:!0,onHasResources:i[14]||(i[14]=Y=>a.hasCalendarResources=Y),onHasError:i[15]||(i[15]=Y=>a.calendarPanelHasError=Y)},null,8,["description","header","item-id"])),a.deckPanelHasError?P("",!0):(p(),O(I,{key:3,"provider-id":"account","resource-type":"deck",description:o.desc,limit:5,header:e.t("contacts","Deck cards with you"),"item-id":s.contact.uid,primary:!0,onHasResources:i[16]||(i[16]=Y=>a.hasDeckResources=Y),onHasError:i[17]||(i[17]=Y=>a.deckPanelHasError=Y)},null,8,["description","header","item-id"])),!s.hasRelatedResources&&!a.loadingData?(p(),O(z,{key:4,name:e.t("contacts","No shared items with this contact")},{icon:_(()=>[M(Z,{size:20})]),_:1},8,["name"])):P("",!0)])):P("",!0),s.isReadOnly?P("",!0):(p(),O(tt,{key:5,class:"last-edit",bus:a.bus,contact:s.contact},null,8,["bus","contact"])),s.contact.rev?(p(),O(at,{key:6,value:s.contact.rev,class:"last-edit"},null,8,["value"])):P("",!0)],64)):(p(),O(c,{key:0,class:"empty-content",name:e.t("contacts","No contact selected"),description:e.t("contacts","Select a contact on the list to begin")},{icon:_(()=>[M(l,{size:20})]),_:1},8,["name","description"]))]),_:1})}const T4=Q(v4,[["render",O4],["__scopeId","data-v-7d9885ce"]]),E4={name:"ContactsListItem",mixins:[vn],components:{ListItem:kc,NcAvatar:Bn,CheckIcon:Vd},props:{index:{type:Number,required:!0},source:{type:Object,required:!0},reloadBus:{type:Object,required:!0},onSelectMultipleFromParent:{type:Function,default:()=>{}}},data(){return{avatarUrl:void 0,hoveringAvatar:!1}},computed:{isDraggable(){return!!this.source.dav&&this.source.addressbook.id!=="z-server-generated--system"},id(){return this.source.key.slice(0,-2)},getTel(){return this.source.properties.find(e=>e.name==="tel")?.getFirstValue()}},created(){this.reloadBus.on("reload-avatar",this.reloadAvatarUrl),this.reloadBus.on("delete-avatar",this.deleteAvatar)},unmounted(){this.reloadBus.off("reload-avatar",this.reloadAvatarUrl),this.reloadBus.off("delete-avatar",this.deleteAvatar)},async mounted(){await this.loadAvatarUrl()},methods:{startDrag(e,i){e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("item",JSON.stringify({addressbookId:i.addressbook.id,displayName:i.displayName,groups:i.groups,url:i.url,uid:i.uid}))},reloadAvatarUrl(e){e===this.source.key&&this.loadAvatarUrl()},deleteAvatar(e){e===this.source.key&&(this.avatarUrl=void 0)},async loadAvatarUrl(){if(this.avatarUrl=void 0,this.source.photo){const e=await this.source.getPhotoUrl();if(!e){console.warn("contact has an invalid photo");return}this.avatarUrl=e}else this.source.hasPhoto&&this.source.url&&(this.avatarUrl=`${this.source.url}?photo`)},selectContact(){this.$router.push({name:"contact",params:{selectedGroup:this.selectedGroup,selectedContact:this.source.key}})},onSelectMultiple(){this.onSelectMultipleFromParent(this.source,this.index)},onSelectMultipleRange(){this.onSelectMultipleFromParent(this.source,this.index,!0)}}},P4=["draggable"],$4={class:"envelope__subtitle"},z4={class:"envelope__subtitle__subject"};function H4(e,i,o,r,a,s){const l=b("NcAvatar"),c=b("CheckIcon"),d=b("ListItem");return p(),C("div",{class:"contacts-list__item-wrapper",draggable:s.isDraggable,onDragstart:i[3]||(i[3]=u=>s.startDrag(u,o.source)),onClick:i[4]||(i[4]=Wt((...u)=>s.onSelectMultipleRange&&s.onSelectMultipleRange(...u),["shift","exact","prevent"]))},[(p(),O(d,{id:s.id,key:o.source.key,class:"list-item-style envelope",name:o.source.displayName,to:{name:"contact",params:{selectedGroup:e.selectedGroup,selectedContact:o.source.key}}},{icon:_(()=>[T("div",{class:"contacts-list__item-icon",onClick:i[0]||(i[0]=Wt((...u)=>s.onSelectMultiple&&s.onSelectMultiple(...u),["exact","prevent"])),onMouseenter:i[1]||(i[1]=u=>a.hoveringAvatar=!0),onMouseleave:i[2]||(i[2]=u=>a.hoveringAvatar=!1)},[!o.source.isMultiSelected&&!a.hoveringAvatar&&o.source.addressbook.id==="z-server-generated--system"?(p(),O(l,{key:0,user:o.source.uid,"show-user-status":!1,size:40},null,8,["user"])):P("",!0),!o.source.isMultiSelected&&!a.hoveringAvatar&&o.source.addressbook.id!=="z-server-generated--system"?(p(),O(l,{key:1,"display-name":o.source.displayName,url:a.avatarUrl,size:40},null,8,["display-name","url"])):P("",!0),o.source.isMultiSelected||a.hoveringAvatar?(p(),O(c,{key:2,size:28,class:Kt({"contacts-list__item-avatar-selected":o.source.isMultiSelected,"contacts-list__item-avatar-hovered":!o.source.isMultiSelected})},null,8,["class"])):P("",!0)],32)]),subname:_(()=>[T("div",$4,[T("span",z4,E(o.source.email?o.source.email:s.getTel),1)])]),_:1},8,["id","name","to"]))],40,P4)}const B4=Q(E4,[["render",H4],["__scopeId","data-v-fcc4ae8e"]]),R4={name:"CloseThickIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},V4=["aria-hidden","aria-label"],U4=["fill","width","height"],Y4={d:"M20 6.91L17.09 4L12 9.09L6.91 4L4 6.91L9.09 12L4 17.09L6.91 20L12 14.91L17.09 20L20 17.09L14.91 12L20 6.91Z"},G4={key:0};function F4(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon close-thick-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",Y4,[o.title?(p(),C("title",G4,E(o.title),1)):P("",!0)])],8,U4))],16,V4)}const W4=Q(R4,[["render",F4]]),j4={name:"SetMergeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},q4=["aria-hidden","aria-label"],X4=["fill","width","height"],Z4={d:"M2 7V9H7V7H2M12 9V11H9V13H12V15L15 12L12 9M17 9V15H22V9H17M2 11V13H7V11H2M2 15V17H7V15H2Z"},J4={key:0};function K4(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon set-merge-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",Z4,[o.title?(p(),C("title",J4,E(o.title),1)):P("",!0)])],8,X4))],16,q4)}const Wd=Q(j4,[["render",K4]]),Q4={name:"CheckCircleOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},t8=["aria-hidden","aria-label"],e8=["fill","width","height"],n8={d:"M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M12 20C7.59 20 4 16.41 4 12S7.59 4 12 4 20 7.59 20 12 16.41 20 12 20M16.59 7.58L10 14.17L7.41 11.59L6 13L10 17L18 9L16.59 7.58Z"},i8={key:0};function o8(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon check-circle-outline-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",n8,[o.title?(p(),C("title",i8,E(o.title),1)):P("",!0)])],8,e8))],16,t8)}const r8=Q(Q4,[["render",o8]]),a8={name:"CloseCircleOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},s8=["aria-hidden","aria-label"],l8=["fill","width","height"],c8={d:"M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22C17.53,22 22,17.53 22,12C22,6.47 17.53,2 12,2M14.59,8L12,10.59L9.41,8L8,9.41L10.59,12L8,14.59L9.41,16L12,13.41L14.59,16L16,14.59L13.41,12L16,9.41L14.59,8Z"},d8={key:0};function u8(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon close-circle-outline-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",c8,[o.title?(p(),C("title",d8,E(o.title),1)):P("",!0)])],8,l8))],16,s8)}const h8=Q(a8,[["render",u8]]),p8={name:"DomainIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},m8=["aria-hidden","aria-label"],f8=["fill","width","height"],g8={d:"M18,15H16V17H18M18,11H16V13H18M20,19H12V17H14V15H12V13H14V11H12V9H20M10,7H8V5H10M10,11H8V9H10M10,15H8V13H10M10,19H8V17H10M6,7H4V5H6M6,11H4V9H6M6,15H4V13H6M6,19H4V17H6M12,7V3H2V21H22V7H12Z"},y8={key:0};function v8(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon domain-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",g8,[o.title?(p(),C("title",y8,E(o.title),1)):P("",!0)])],8,f8))],16,m8)}const Al=Q(p8,[["render",v8]]),b8={name:"BadgeAccountOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},C8=["aria-hidden","aria-label"],w8=["fill","width","height"],k8={d:"M17,3H14V5H17V21H7V5H10V3H7A2,2 0 0,0 5,5V21A2,2 0 0,0 7,23H17A2,2 0 0,0 19,21V5A2,2 0 0,0 17,3M12,7A2,2 0 0,1 14,9A2,2 0 0,1 12,11A2,2 0 0,1 10,9A2,2 0 0,1 12,7M16,15H8V14C8,12.67 10.67,12 12,12C13.33,12 16,12.67 16,14V15M16,18H8V17H16V18M12,20H8V19H12V20M13,5H11V1H13V5Z"},_8={key:0};function x8(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon badge-account-outline-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",k8,[o.title?(p(),C("title",_8,E(o.title),1)):P("",!0)])],8,w8))],16,C8)}const Nl=Q(b8,[["render",x8]]),S8={name:"Merging",components:{ContactDetailsProperty:gc,NcCheckboxRadioSwitch:Yi,IconCheckCircleOutline:r8,IconCloseCircleOutline:h8,IconSetMerge:Wd,NcNoteCard:vc,NcButton:ne,IconDomain:Al,IconAccount:Ti,IconBadgeAccount:Nl,NcSelect:Rn,NcLoadingIcon:me},props:{contacts:{type:Map,required:!0}},data(){return{bus:$a(),resolvedConflicts:new Map,conflictsToResolve:0,sortedProperties:[],simpleProperties:["fn","org","title"],simplePropertyDescriptions:{fn:{description:this.t("contacts","Name"),icon:Ti},org:{description:this.t("contacts","Company"),icon:Al},title:{description:this.t("contacts","Title"),icon:Nl}},chosenAddressBook:null,selectedGroups:[],isLoading:!1}},computed:{contactsList(){return Array.from(this.contacts.values()).map(e=>e)},dividedProperties(){const[e,i]=this.contactsList;if(!e||!i)return{};const o=this.sortProperties(e),r=this.sortProperties(i),a=this.groupedProperties(o),s=this.groupedProperties(r);return[a,s]},usedProperties(){const e=this.dividedProperties.flatMap(i=>Object.keys(i));return[...new Set(e)].filter(i=>{const o=this.dividedProperties[0][i]?this.dividedProperties[0][i].map(a=>this.getPropertyValue(a)):[],r=this.dividedProperties[1][i]?this.dividedProperties[1][i].map(a=>this.getPropertyValue(a)):[];return!o.every(a=>a==null||a==="")||!r.every(a=>a==null||a==="")})},conflictInformation(){const e={};return this.usedProperties.forEach(i=>{if((this.dividedProperties[0][i]??[]).every(o=>this.checkIfPropertyEmpty(o))){e[i]={type:"onlyInSecond",value:this.dividedProperties[1][i].map(o=>this.getPropertyValue(o))};return}if((this.dividedProperties[1][i]??[]).every(o=>this.checkIfPropertyEmpty(o))){e[i]={type:"onlyInFirst",value:this.dividedProperties[0][i].map(o=>this.getPropertyValue(o))};return}if(((o,r)=>o.length===r.length&&o.every((a,s)=>a===r[s]))((this.dividedProperties[0][i]??[]).map(o=>this.getPropertyValue(o)),(this.dividedProperties[1][i]??[]).map(o=>this.getPropertyValue(o)))){e[i]={type:"equal",value:this.dividedProperties[0][i].map(o=>this.getPropertyValue(o))};return}if(Ee.properties[i]?.multiple===!0){e[i]={type:"conflictWithMultipleValues",value:null};return}e[i]={type:"conflict",value:null}}),e},addressBookSelect(){return{placeholder:this.t("contacts","Select address book"),options:[{id:0,label:this.contactsList[0].addressbook.displayName},{id:1,label:this.contactsList[1].addressbook.displayName}]}}},mounted(){this.calculateConflictsToResolve(),this.sortedProperties=this.sortUsedProperties(),this.contactsList[0].addressbook.id===this.contactsList[1].addressbook.id&&(this.chosenAddressBook={id:0,label:this.contactsList[0].addressbook.displayName}),this.selectedGroups=this.selectedGroups.concat(this.contactsList[0].groups),this.selectedGroups=this.selectedGroups.concat(this.contactsList[1].groups)},methods:{resolveConflict(e,i){e===this.resolvedConflicts.get(i)?this.resolvedConflicts.set(i,void 0):this.resolvedConflicts.set(i,e),this.$forceUpdate(),this.calculateConflictsToResolve()},resolveMultiConflict(e,i){if(this.resolvedConflicts.has(i)){const o=this.resolvedConflicts.get(i);o.has(e)?o.delete(e):o.add(e),this.resolvedConflicts.set(i,o)}else{const o=new Set;o.add(e),this.resolvedConflicts.set(i,o)}this.$forceUpdate(),this.calculateConflictsToResolve()},canDisplay(e){const i=Ee.properties[e.name.split(".").pop()],o=i&&i.force?i.force:e.getDefaultType();return i&&o!=="unknown"},sortProperties(e){return e.properties.slice(0).sort((i,o)=>{const r=i.name.split(".").pop(),a=o.name.split(".").pop();return Ee.fieldOrder.indexOf(r)-Ee.fieldOrder.indexOf(a)})},groupedProperties(e){return e.reduce((i,o)=>!this.canDisplay(o)&&o.name!=="title"&&o.name!=="org"&&o.name!=="fn"?i:o.name==="bday"||o.name==="deathdate"||o.name==="anniversary"?(i.lifeEvents||(i.lifeEvents=[]),i.lifeEvents.push(o),i):(i[o.name]||(i[o.name]=[]),i[o.name].push(o),i),{})},calculateConflictsToResolve(){let e=0;this.usedProperties.forEach(i=>{this.conflictInformation[i]?.type==="conflict"&&this.resolvedConflicts.get(i)===void 0&&e++,this.conflictInformation[i]?.type==="conflictWithMultipleValues"&&!this.resolvedConflicts.get(i)?.size&&e++}),this.chosenAddressBook===null&&e++,this.conflictsToResolve=e},getPropertyValue(e){return e.isMultiValue?e.isStructuredValue?e.getValues()[0]:e.getValues():e.getFirstValue()},checkIfPropertyEmpty(e){if(e===void 0)return!0;const i=this.getPropertyValue(e);return i===""||i===null||Array.isArray(i)&&i.length===0?!0:Array.isArray(i)?i.every(o=>o===""||o===void 0):!1},sortUsedProperties(){return this.usedProperties.sort((e,i)=>{const o=this.conflictInformation[e]?.type,r=this.conflictInformation[i]?.type;return o==="conflict"&&r!=="conflict"?-1:r==="conflict"&&o!=="conflict"?1:0})},async mergeContacts(){this.isLoading=!0;const e=this.contactsList[0],i={};this.usedProperties.forEach(o=>{if(this.conflictInformation[o]?.type==="conflict"){const r=this.resolvedConflicts.get(o);r!==void 0&&(i[o]=[this.dividedProperties[r][o]])}else if(this.conflictInformation[o]?.type==="conflictWithMultipleValues"){const r=this.resolvedConflicts.get(o);r?.size&&(i[o]=Array.from(r).map(a=>this.dividedProperties[a][o]))}else this.conflictInformation[o]?.type==="onlyInSecond"?i[o]=[this.dividedProperties[1][o]]:i[o]=[this.dividedProperties[0][o]]}),this.usedProperties.forEach(o=>{i[o]!==void 0&&i[o].length>0&&i[o].flat().forEach((r,a)=>{a===0?e.vCard.updatePropertyWithValue(o,this.getPropertyValue(r)):e.vCard.addProperty(r)})}),e.groups=this.selectedGroups,e.addressbook=this.contactsList[this.chosenAddressBook.id].addressbook,await this.$store.dispatch("updateContact",e),await this.$store.dispatch("deleteContact",{contact:this.contactsList[1]}),this.$emit("finished",e)}}},M8={class:"merging"},A8={class:"merging__title"},N8={class:"merging-title__addressbooks"},L8={class:"merging__conflicts"},D8={key:0},I8={key:1,class:"simple-property"},O8={class:"simple-property__title"},T8={key:6,class:"merging-conflicts__filler"},E8={key:0},P8={key:1,class:"simple-property"},$8={class:"simple-property__title"},z8={key:2,class:"merging__groups"},H8={class:"merging__groups__header"},B8={class:"merging__actions"};function R8(e,i,o,r,a,s){const l=b("IconCloseCircleOutline"),c=b("NcSelect"),d=b("NcNoteCard"),u=b("IconCheckCircleOutline"),m=b("NcCheckboxRadioSwitch"),y=b("ContactDetailsProperty"),v=b("IconSetMerge"),w=b("NcLoadingIcon"),D=b("NcButton");return p(),C("div",M8,[T("div",A8,[T("h3",null,E(e.t("contacts","Confirm merging contacts")),1),T("div",N8,[a.chosenAddressBook===null?(p(),O(l,{key:0,size:20,class:"needs-action"})):P("",!0),M(c,pt(s.addressBookSelect,{modelValue:a.chosenAddressBook,"onUpdate:modelValue":[i[0]||(i[0]=S=>a.chosenAddressBook=S),s.calculateConflictsToResolve],disabled:s.contactsList[0].addressbook.id===s.contactsList[1].addressbook.id,title:e.t("contacts","Select address book")}),null,16,["modelValue","disabled","title","onUpdate:modelValue"])])]),a.conflictsToResolve?(p(),O(d,{key:0,type:"warning",text:e.t("contacts","The selected contacts have conflicting information. Choose which information to keep")},null,8,["text"])):(p(),O(d,{key:1,type:"success",text:e.t("contacts","Contacts can be merged")},null,8,["text"])),T("div",L8,[(p(!0),C(mt,null,It(a.sortedProperties,(S,R)=>(p(),C("div",{key:S,class:Kt(["merging__conflicts__row",{conflict:s.conflictInformation[S]?.type==="conflict"||s.conflictInformation[S]?.type==="conflictWithMultipleValues",last:R===a.sortedProperties.length-1}])},[(s.conflictInformation[S]?.type!=="conflict"||a.resolvedConflicts.get(S)!==void 0)&&(s.conflictInformation[S]?.type!=="conflictWithMultipleValues"||a.resolvedConflicts.get(S)?.size)?(p(),O(u,{key:0,size:20})):P("",!0),s.conflictInformation[S]?.type==="conflict"&&a.resolvedConflicts.get(S)===void 0?(p(),O(l,{key:1,size:20,class:"needs-action"})):P("",!0),s.conflictInformation[S]?.type==="conflictWithMultipleValues"&&!a.resolvedConflicts.get(S)?.size?(p(),O(l,{key:2,size:20,class:"needs-action"})):P("",!0),s.conflictInformation[S]?.type==="conflict"?(p(),O(m,{key:3,"model-value":a.resolvedConflicts.get(S)===0,type:"radio","onUpdate:modelValue":A=>s.resolveConflict(0,S)},null,8,["model-value","onUpdate:modelValue"])):P("",!0),s.conflictInformation[S]?.type==="conflictWithMultipleValues"?(p(),O(m,{key:4,"model-value":a.resolvedConflicts.get(S)?.has(0),"onUpdate:modelValue":A=>s.resolveMultiConflict(0,S)},null,8,["model-value","onUpdate:modelValue"])):P("",!0),s.conflictInformation[S]?.type!=="onlyInSecond"?(p(),C("div",{key:5,class:Kt(["merging__conflicts__property",{"no-conflict":s.conflictInformation[S]?.type!=="conflict"&&s.conflictInformation[S]?.type!=="conflictWithMultipleValues"}])},[a.simpleProperties.includes(S)?(p(),C("div",I8,[T("div",O8,[(p(),O(Pn(a.simplePropertyDescriptions[S]?.icon||"span"),{size:20})),T("h3",null,E(a.simplePropertyDescriptions[S]?.description||S),1)]),(p(!0),C(mt,null,It(s.dividedProperties[0][S],A=>(p(),C("span",{key:A.jCal},E(A.getFirstValue()),1))),128))])):(p(),C("div",D8,[(p(!0),C(mt,null,It(s.dividedProperties[0][S],(A,V)=>(p(),O(y,{key:A.jCal,"is-first-property":V===0,"is-last-property":!1,property:A,contact:s.contactsList[0],"local-contact":s.contactsList[0],contacts:o.contacts,bus:a.bus,"is-read-only":!0},null,8,["is-first-property","property","contact","local-contact","contacts","bus"]))),128))]))],2)):P("",!0),s.conflictInformation[S]?.type==="onlyInSecond"?(p(),C("div",T8)):P("",!0),s.conflictInformation[S]?.type==="conflict"?(p(),O(m,{key:7,"model-value":a.resolvedConflicts.get(S)===1,type:"radio","onUpdate:modelValue":A=>s.resolveConflict(1,S)},null,8,["model-value","onUpdate:modelValue"])):P("",!0),s.conflictInformation[S]?.type==="conflictWithMultipleValues"?(p(),O(m,{key:8,"model-value":a.resolvedConflicts.get(S)?.has(1),"onUpdate:modelValue":A=>s.resolveMultiConflict(1,S)},null,8,["model-value","onUpdate:modelValue"])):P("",!0),s.conflictInformation[S]?.type!=="onlyInFirst"?(p(),C("div",{key:9,class:Kt(["merging__conflicts__property",{"no-conflict":s.conflictInformation[S]?.type!=="conflict"&&s.conflictInformation[S]?.type!=="conflictWithMultipleValues"}])},[a.simpleProperties.includes(S)?(p(),C("div",P8,[T("div",$8,[(p(),O(Pn(a.simplePropertyDescriptions[S]?.icon||"span"),{size:20})),T("h3",null,E(a.simplePropertyDescriptions[S]?.description||S),1)]),(p(!0),C(mt,null,It(s.dividedProperties[1][S],A=>(p(),C("span",{key:A.jCal},E(A.getFirstValue()),1))),128))])):(p(),C("div",E8,[(p(!0),C(mt,null,It(s.dividedProperties[1][S],(A,V)=>(p(),O(y,{key:A.jCal,"is-first-property":V===0,"is-last-property":!1,property:A,contact:s.contactsList[1],"local-contact":s.contactsList[1],contacts:o.contacts,bus:a.bus,"is-read-only":!0},null,8,["is-first-property","property","contact","local-contact","contacts","bus"]))),128))]))],2)):P("",!0)],2))),128))]),s.contactsList[0].groups.length||s.contactsList[1].groups.length?(p(),C("div",z8,[T("h4",H8,E(e.t("contacts","Groups")),1),M(c,{modelValue:a.selectedGroups,"onUpdate:modelValue":[i[1]||(i[1]=S=>a.selectedGroups=S),s.calculateConflictsToResolve],options:s.contactsList[0].groups.concat(s.contactsList[1].groups),multiple:!0,placeholder:e.t("contacts","Select groups to add the merged contact to"),disabled:!s.contactsList[0].groups.length&&!s.contactsList[1].groups.length},null,8,["modelValue","options","placeholder","disabled","onUpdate:modelValue"])])):P("",!0),T("div",B8,[M(D,{disabled:a.conflictsToResolve!==0,variant:"secondary",onClick:s.mergeContacts},{icon:_(()=>[a.isLoading?(p(),O(w,{key:1,size:20})):(p(),O(v,{key:0,size:20}))]),default:_(()=>[K(E(e.t("contacts","Merge contacts"))+" ",1)]),_:1},8,["disabled","onClick"])])])}const V8=Q(S8,[["render",R8],["__scopeId","data-v-f546838d"]]),U8='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-cancel" viewBox="0 0 24 24"><path d="M12 2C17.5 2 22 6.5 22 12S17.5 22 12 22 2 17.5 2 12 6.5 2 12 2M12 4C10.1 4 8.4 4.6 7.1 5.7L18.3 16.9C19.3 15.5 20 13.8 20 12C20 7.6 16.4 4 12 4M16.9 18.3L5.7 7.1C4.6 8.4 4 10.1 4 12C4 16.4 7.6 20 12 20C13.9 20 15.6 19.4 16.9 18.3Z" /></svg>',Y8="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20id='mdi-delete-outline'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M6,19A2,2%200%200,0%208,21H16A2,2%200%200,0%2018,19V7H6V19M8,9H16V19H8V9M15.5,4L14.5,3H9.5L8.5,4H5V6H19V4H15.5Z'%20/%3e%3c/svg%3e",G8={name:"ContactsList",components:{AppContentList:Em,NcNoteCard:vc,VList:$c,NcButton:ne,IconSelect:W4,IconDelete:tn,IconSetMerge:Wd,NcDialog:B1,NcModal:yn,Merging:V8,NcLoadingIcon:me,ContactsListItem:B4,NcTextField:uc},mixins:[vn],props:{list:{type:Array,required:!0},contacts:{type:Object,required:!0},searchQuery:{type:String,default:""},reloadBus:{type:Object,required:!0}},data(){return{query:"",multiSelectedContacts:new Map,refreshKey:0,showDeleteConfirmationDialog:!1,buttons:[{label:t("contacts","Cancel"),icon:U8,callback:()=>{this.showDeleteConfirmationDialog=!1}},{label:t("contacts","Delete"),type:"primary",icon:Y8,callback:()=>{this.deleteAllMultiSelected()}}],lastToggledIndex:void 0,isMerging:!1,isMergingLoading:!1}},computed:{filteredList(){let e=this.list.filter(i=>this.matchSearch(this.contacts[i.key])).map(i=>this.contacts[i.key]);return e=e.filter(i=>i!==void 0),e.forEach((i,o)=>{i!==void 0&&(i.isMultiSelected=this.multiSelectedContacts.has(o))}),e},isMultiSelecting(){return this.multiSelectedContacts.size>0},readOnlyMultiSelectedCount(){let e=0;return this.multiSelectedContacts.forEach(i=>{i.addressbook.readOnly&&e++}),e},isAtLeastOneEditable(){return this.readOnlyMultiSelectedCount!==this.multiSelectedContacts.size},areTwoEditable(){return this.multiSelectedContacts.size-this.readOnlyMultiSelectedCount===2},deleteActionTitle(){return this.isAtLeastOneEditable?n("contacts","Delete {number} contact","Delete {number} contacts",this.multiSelectedContacts.size,{number:this.multiSelectedContacts.size}):t("contacts","Please select at least one editable contact to delete")},mergeActionTitle(){return this.areTwoEditable?t("contacts","Merge contacts"):t("contacts","Please select two editable contacts to merge")}},watch:{async selectedContact(e){e&&(await this.$nextTick(),this.scrollToContact(e))},list(e,i){e.length!==0&&i.length===0&&this.selectedContact&&this.$nextTick(()=>{this.scrollToContact(this.selectedContact)})}},mounted(){this.query=this.searchQuery},methods:{selectContact(e){if(this.list.length>0&&e<this.list.length){const i=e===0?this.list[e+1]:this.list[e-1];i&&this.$router.push({name:"contact",params:{selectedGroup:this.selectedGroup,selectedContact:i.key}})}},scrollToContact(e){const i=this.list.findIndex(l=>l.key===e);if(i===-1)return;const o=this.$refs.scroller,r=o.$el.getBoundingClientRect(),a=this.$el.querySelector("#"+e.slice(0,-2)),s=a?.getBoundingClientRect();if(!a||s.y<r.y)o.scrollToIndex(i);else if(a){const l=o.getItemSize(i),c=s.y+l-(this.$el.offsetHeight+50);c>0&&o.scrollTo(o.scrollOffset+c)}},matchSearch(e){if(this.query.trim()!=="")try{return e.searchData.toString().toLowerCase().search(this.query.trim().toLowerCase())!==-1}catch(i){if(i instanceof SyntaxError)return e.searchData.toString().toLowerCase().includes(this.query.trim().toLowerCase())}return!0},onSelectMultiple(e,i,o=!1){o&&this.lastToggledIndex!==i&&this.onSelectRange(i)||(this.multiSelectedContacts.has(i)?this.multiSelectedContacts.delete(i):this.multiSelectedContacts.set(i,e),this.lastToggledIndex=i,this.multiSelectedContacts=new Map(this.multiSelectedContacts))},onSelectRange(e){const i=this.lastToggledIndex??void 0;if(i===void 0)return!1;const o=Math.min(i,e),r=Math.max(i,e),a=this.multiSelectedContacts.has(e),s=new Map(this.multiSelectedContacts);for(let l=o;l<=r;l++)a?s.delete(l):s.set(l,this.filteredList[l]);return this.lastToggledIndex=e,this.multiSelectedContacts=s,!0},unselectAllMultiSelected(){this.multiSelectedContacts=new Map,this.lastToggledIndex=void 0},attemptDeleteAllMultiSelected(){this.showDeleteConfirmationDialog=!0},deleteAllMultiSelected(){this.multiSelectedContacts.forEach(async e=>{e.addressbook.readOnly||(await new Promise(i=>setTimeout(i,500)),await this.$store.dispatch("deleteContact",{contact:e}))}),this.unselectAllMultiSelected(),this.showDeleteConfirmationDialog=!1},async initiateContactMerging(){this.isMergingLoading=!0;const e=Array.from(this.multiSelectedContacts.values());for(const i of e)await this.$store.dispatch("fetchFullContact",{contact:i});this.isMergingLoading=!1,this.isMerging=!0},async finishContactMerging(e){await this.$store.dispatch("fetchFullContact",{contact:e,forceReFetch:!0}),this.unselectAllMultiSelected(),this.isMerging=!1,await this.$router.push({name:"root"})}}},F8={class:"contacts-list__header"},W8={class:"search-contacts-field"},j8={key:0,class:"contacts-list__multiselect-header"};function q8(e,i,o,r,a,s){const l=b("NcNoteCard"),c=b("NcDialog"),d=b("Merging"),u=b("NcModal"),m=b("NcTextField"),y=b("IconSelect"),v=b("NcButton"),w=b("IconDelete"),D=b("IconSetMerge"),S=b("NcLoadingIcon"),R=b("ContactsListItem"),A=b("VList"),V=b("AppContentList");return p(),O(V,{class:"content-list"},{default:_(()=>[M(c,{open:a.showDeleteConfirmationDialog,name:e.n("contacts","Delete {number} contact","Delete {number} contacts",a.multiSelectedContacts.size,{number:a.multiSelectedContacts.size}),buttons:a.buttons,"no-close":""},{default:_(()=>[K(E(e.t("contacts","Are you sure you want to proceed?"))+" ",1),s.readOnlyMultiSelectedCount?(p(),O(l,{key:0,variant:"info",text:e.n("contacts","Please note that {number} contact is read only and will not be deleted","Please note that {number} contacts are read only and will not be deleted",s.readOnlyMultiSelectedCount,{number:s.readOnlyMultiSelectedCount})},null,8,["text"])):P("",!0)]),_:1},8,["open","name","buttons"]),a.isMerging?(p(),O(u,{key:0,name:e.t("contacts","Merge contacts"),size:"large",onClose:i[0]||(i[0]=W=>a.isMerging=!1)},{default:_(()=>[M(d,{contacts:a.multiSelectedContacts,onFinished:s.finishContactMerging},null,8,["contacts","onFinished"])]),_:1},8,["name"])):P("",!0),T("div",F8,[T("div",W8,[M(m,{modelValue:a.query,"onUpdate:modelValue":i[1]||(i[1]=W=>a.query=W),label:e.t("contacts","Search contacts …"),"trailing-button-icon":"close","show-trailing-button":a.query!=="",onTrailingButtonClick:i[2]||(i[2]=W=>a.query="")},null,8,["modelValue","label","show-trailing-button"])])]),M(jl,{name:"contacts-list__multiselect-header"},{default:_(()=>[s.isMultiSelecting?(p(),C("div",j8,[M(v,{variant:"tertiary",title:e.t("contacts","Unselect {number}",{number:a.multiSelectedContacts.size}),"close-after-click":!0,onClick:Wt(s.unselectAllMultiSelected,["prevent"])},{default:_(()=>[M(y,{size:16})]),_:1},8,["title","onClick"]),M(v,{variant:"tertiary",disabled:!s.isAtLeastOneEditable,title:s.deleteActionTitle,"close-after-click":!0,onClick:Wt(s.attemptDeleteAllMultiSelected,["prevent"])},{default:_(()=>[M(w,{size:16})]),_:1},8,["disabled","title","onClick"]),a.isMergingLoading?(p(),O(S,{key:1,size:20})):(p(),O(v,{key:0,type:"tertiary",disabled:!s.areTwoEditable,title:s.mergeActionTitle,"close-after-click":!0,onClick:Wt(s.initiateContactMerging,["prevent"])},{default:_(()=>[M(D,{size:20})]),_:1},8,["disabled","title","onClick"]))])):P("",!0)]),_:1}),M(A,{ref:"scroller",class:"contacts-list",data:s.filteredList},{default:_(({item:W,index:it})=>[(p(),O(R,{key:W.key,index:it,source:W,"reload-bus":o.reloadBus,"on-select-multiple-from-parent":s.onSelectMultiple},null,8,["index","source","reload-bus","on-select-multiple-from-parent"]))]),_:1},8,["data"])]),_:1})}const X8=Q(G8,[["render",q8],["__scopeId","data-v-48d28adf"]]),Z8={name:"ContactsContent",components:{AppContent:Da,Button:ne,ContactDetails:T4,ContactsList:X8,EmptyContent:fn,IconContact:Vn,IconLoading:me},mixins:[vn],props:{loading:{type:Boolean,default:!0},contactsList:{type:Array,required:!0}},data(){return{searchQuery:"",reloadBus:$a()}},computed:{contacts(){return this.$store.getters.getContacts},groups(){return this.$store.getters.getGroups},sortedContacts(){return this.$store.getters.getSortedContacts},isRealGroup(){return this.groups.findIndex(e=>e.name===this.selectedGroup)>-1},isEmptyGroup(){return this.contactsList.length===0},showDetails(){return!!this.selectedContact}},methods:{addContactsToGroup(e){si("contacts:group:append",e)},newContact(){this.$emit("new-contact")},hideDetails(){this.$router.push({name:"group",params:{selectedGroup:this.selectedGroup}})}}};function J8(e,i,o,r,a,s){const l=b("IconLoading"),c=b("EmptyContent"),d=b("AppContent"),u=b("IconContact"),m=b("Button"),y=b("ContactsList"),v=b("ContactDetails");return o.loading?(p(),O(d,{key:0},{default:_(()=>[M(c,{class:"empty-content",name:e.t("contacts","Loading contacts …")},{icon:_(()=>[M(l,{size:20})]),_:1},8,["name"])]),_:1})):s.isEmptyGroup&&!s.isRealGroup?(p(),O(d,{key:1},{default:_(()=>[M(c,{class:"empty-content",name:e.t("contacts","There are no contacts yet")},{icon:_(()=>[M(u,{size:20})]),desc:_(()=>[M(m,{variant:"primary",onClick:s.newContact},{default:_(()=>[K(E(e.t("contacts","Create contact")),1)]),_:1},8,["onClick"])]),_:1},8,["name"])]),_:1})):s.isEmptyGroup&&s.isRealGroup?(p(),O(d,{key:2},{default:_(()=>[M(c,{class:"empty-content",name:e.t("contacts","There are no contacts in this group")},{icon:_(()=>[M(u,{size:20})]),desc:_(()=>[s.contacts.length===0?(p(),O(m,{key:0,variant:"primary",onClick:i[0]||(i[0]=w=>s.addContactsToGroup(e.selectedGroup))},{default:_(()=>[K(E(e.t("contacts","Create contacts")),1)]),_:1})):(p(),O(m,{key:1,variant:"primary",onClick:i[1]||(i[1]=w=>s.addContactsToGroup(e.selectedGroup))},{default:_(()=>[K(E(e.t("contacts","Add contacts")),1)]),_:1}))]),_:1},8,["name"])]),_:1})):(p(),O(d,{key:3,"show-details":s.showDetails,"onUpdate:showDetails":s.hideDetails},{list:_(()=>[M(y,{list:o.contactsList,contacts:s.contacts,"search-query":a.searchQuery,"reload-bus":a.reloadBus},null,8,["list","contacts","search-query","reload-bus"])]),default:_(()=>[M(v,{"contact-key":e.selectedContact,contacts:s.sortedContacts,"reload-bus":a.reloadBus},null,8,["contact-key","contacts","reload-bus"])]),_:1},8,["show-details","onUpdate:showDetails"]))}const K8=Q(Z8,[["render",J8],["__scopeId","data-v-d36b4845"]]),Q8={name:"ProcessingScreen",components:{EmptyContent:fn,IconContact:Vn},props:{total:{type:Number,required:!0},progress:{type:Number,required:!0},desc:{type:String,required:!0},title:{type:String,required:!0}}},t6={class:"processing-screen__progress"},e6=["max","value"];function n6(e,i,o,r,a,s){const l=b("IconContact"),c=b("EmptyContent");return p(),C("div",null,[M(c,{description:o.desc,name:o.title,class:"processing-screen__wrapper"},{icon:_(()=>[M(l,{size:20})]),_:1},8,["description","name"]),T("div",t6,[T("progress",{max:o.total,value:o.progress},null,8,e6)])])}const jd=Q(Q8,[["render",n6],["__scopeId","data-v-dd942720"]]),i6={name:"AddToGroupView",components:{ProcessingScreen:jd,Button:ne},props:{failed:{type:Number,default:0},progress:{type:Number,default:0},success:{type:Number,default:0},total:{type:Number,default:0},name:{type:String,default:""}},computed:{progressHeader(){return n("contacts","{success} contact added to {name}","{success} contacts added to {name}",this.success,{success:this.success,name:this.name})},finishedHeader(){return n("contacts","Adding {success} contact to {name}","Adding {success} contacts to {name}",this.success,{success:this.success,name:this.name})},messageFailed(){return n("contacts","{count} error","{count} errors",this.failed,{count:this.failed})}},methods:{onClose(){this.$emit("close")}}},o6={class:"close__button"};function r6(e,i,o,r,a,s){const l=b("ProcessingScreen"),c=b("Button");return p(),C("div",null,[M(l,{progress:o.progress,total:o.total,desc:o.failed>0?s.messageFailed:"",title:o.total===o.progress?s.finishedHeader:s.progressHeader},null,8,["progress","total","desc","title"]),T("div",o6,[o.total===o.progress?(p(),O(c,{key:0,class:"primary",onClick:s.onClose},{default:_(()=>[K(E(e.t("contacts","Close")),1)]),_:1},8,["onClick"])):P("",!0)])])}const a6=Q(i6,[["render",r6],["__scopeId","data-v-13da812b"]]),s6=async function(e,i){const o=e.groups;return o.push(i),xe.patch(e.url,{},{headers:{"X-PROPERTY":"CATEGORIES","X-PROPERTY-REPLACE":o.map(r=>encodeURIComponent(r)).join(",")}})},l6={name:"ContactsPicker",components:{AddToGroupView:a6,EntityPicker:zc,Modal:yn},data(){return{showPicker:!1,pickerforGroup:null,pickerData:[],pickerTypes:[{id:"contact",label:t("contacts","Contacts")}],isProcessing:!1,isProcessDone:!1,processStatus:{failed:0,progress:0,success:0,total:0,name:""},passedGroupName:""}},computed:{contacts(){return this.$store.getters.getContacts},groups(){return this.$store.getters.getGroups},sortedContacts(){return this.$store.getters.getSortedContacts}},mounted(){No("contacts:group:append",this.addContactsToGroup)},methods:{addContactsToGroup(e){if(console.debug("Contacts picker opened for group",e),this.passedGroupName=e.name?e.name:e,typeof e=="string"&&(e=this.groups.find(i=>i.name===e),!e)){console.error("Cannot add contact to an undefined group",e);return}this.pickerData=this.sortedContacts.map(({key:i})=>{const o=this.contacts[i];return{id:o.key,label:o.displayName,type:"contact",readOnly:o.addressbook.readOnly,groups:o.groups}}).filter(i=>!i.readOnly).filter(i=>i.groups.indexOf(e.name)===-1),this.showPicker=!0,this.pickerforGroup=e},onContactPickerClose(){this.pickerData=[],this.showPicker=!1},onContactPickerPick(e){console.debug("Adding",e,"to group",this.pickerforGroup);const i=this.pickerforGroup.name;this.isProcessing=!0,this.showPicker=!1,this.processStatus.total=e.length,this.processStatus.name=this.pickerforGroup.name,this.processStatus.progress=0,this.processStatus.failed=0;const o=fm(3),r=[];e.map(async a=>{try{const s=this.contacts[a.id];r.push(o(()=>s6(s,i).then(()=>{this.$store.dispatch("addContactToGroup",{contact:s,groupName:i}),this.processStatus.progress++,this.processStatus.success++}).catch(l=>{this.processStatus.progress++,this.processStatus.error++,console.error(l)})))}catch(s){console.error(s)}}),Promise.all(r).then(()=>{this.isProcessDone=!0,this.showPicker=!1,this.$router.push({name:"group",params:{selectedGroup:typeof this.passedGroupName=="string"?this.passedGroupName:this.passedGroupName.name}}),this.processStatus.failed===0&&setTimeout(this.closeProcess,3e3)})},closeProcess(){this.pickerforGroup=null,this.isProcessing=!1,this.isProcessDone=!1,this.processStatus.failed=0,this.processStatus.progress=0,this.processStatus.success=0,this.processStatus.total=0,!(this.passedGroupName===""||this.passedGroupName===void 0)&&this.$router.push({name:"group",params:{selectedGroup:typeof this.passedGroupName=="string"?this.passedGroupName:this.passedGroupName.name}})}}};function c6(e,i,o,r,a,s){const l=b("AddToGroupView"),c=b("Modal"),d=b("EntityPicker");return a.isProcessing||a.isProcessDone?(p(),O(c,{key:0,"clear-view-delay":-1,"can-close":a.isProcessDone,onClose:s.closeProcess},{default:_(()=>[M(l,pt(a.processStatus,{onClose:s.closeProcess}),null,16,["onClose"])]),_:1},8,["can-close","onClose"])):a.showPicker?(p(),O(d,{key:1,"confirm-label":e.t("contacts","Add to {group}",{group:a.pickerforGroup.name}),"data-types":a.pickerTypes,"data-set":a.pickerData,"empty-data-set-description":e.t("contacts","Please note that you can only add contacts from writable address books to contact groups. Contacts from read-only address books, such as the system address book, cannot be added."),onClose:s.onContactPickerClose,onSubmit:s.onContactPickerPick},null,8,["confirm-label","data-types","data-set","empty-data-set-description","onClose","onSubmit"])):P("",!0)}const d6=Q(l6,[["render",c6]]),u6={name:"ImportView",components:{ProcessingScreen:jd,Button:ne},computed:{importState(){return this.$store.getters.getImportState},addressbook(){return this.importState.addressbook},total(){return this.importState.total},accepted(){return this.importState.accepted},failed(){return this.importState.denied},progress(){return this.accepted+this.failed},importingHeader(){return n("contacts","Importing %n contact into {addressbook}","Importing %n contacts into {addressbook}",this.total,{addressbook:this.addressbook})},importedHeader(){return n("contacts","Done importing %n contact into {addressbook}","Done importing %n contacts into {addressbook}",this.total,{addressbook:this.addressbook})},importFailed(){return n("contacts","{count} error","{count} errors",this.failed,{count:this.failed})}},methods:{onClose(){this.$emit("close")}}},h6={class:"close__button"};function p6(e,i,o,r,a,s){const l=b("ProcessingScreen"),c=b("Button");return p(),C("div",null,[M(l,{progress:s.progress,total:s.total,desc:s.failed>0?s.importFailed:"",title:s.total===s.progress?s.importedHeader:s.importingHeader},null,8,["progress","total","desc","title"]),T("div",h6,[s.total===s.progress?(p(),O(c,{key:0,class:"primary",onClick:s.onClose},{default:_(()=>[K(E(e.t("contacts","Close")),1)]),_:1},8,["onClick"])):P("",!0)])])}const m6=Q(u6,[["render",p6],["__scopeId","data-v-bb652b08"]]),f6={name:"LocationEnterIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},g6=["aria-hidden","aria-label"],y6=["fill","width","height"],v6={d:"M14 12L10 8V11H2V13H10V16M22 12A10 10 0 0 1 2.46 15H4.59A8 8 0 1 0 4.59 9H2.46A10 10 0 0 1 22 12Z"},b6={key:0};function C6(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon location-enter-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",v6,[o.title?(p(),C("title",b6,E(o.title),1)):P("",!0)])],8,y6))],16,g6)}const w6=Q(f6,[["render",C6]]),k6={name:"AccountStarOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},_6=["aria-hidden","aria-label"],x6=["fill","width","height"],S6={d:"M15,4A4,4 0 0,1 19,8A4,4 0 0,1 15,12A4,4 0 0,1 11,8A4,4 0 0,1 15,4M15,5.9A2.1,2.1 0 0,0 12.9,8A2.1,2.1 0 0,0 15,10.1C16.16,10.1 17.1,9.16 17.1,8C17.1,6.84 16.16,5.9 15,5.9M15,13C17.67,13 23,14.33 23,17V20H7V17C7,14.33 12.33,13 15,13M15,14.9C12,14.9 8.9,16.36 8.9,17V18.1H21.1V17C21.1,16.36 17.97,14.9 15,14.9M5,13.28L2.5,14.77L3.18,11.96L1,10.08L3.87,9.83L5,7.19L6.11,9.83L9,10.08L6.8,11.96L7.45,14.77L5,13.28Z"},M6={key:0};function A6(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon account-star-outline-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",S6,[o.title?(p(),C("title",M6,E(o.title),1)):P("",!0)])],8,x6))],16,_6)}const N6=Q(k6,[["render",A6]]),L6={name:"AccountGroupIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},D6=["aria-hidden","aria-label"],I6=["fill","width","height"],O6={d:"M12,5.5A3.5,3.5 0 0,1 15.5,9A3.5,3.5 0 0,1 12,12.5A3.5,3.5 0 0,1 8.5,9A3.5,3.5 0 0,1 12,5.5M5,8C5.56,8 6.08,8.15 6.53,8.42C6.38,9.85 6.8,11.27 7.66,12.38C7.16,13.34 6.16,14 5,14A3,3 0 0,1 2,11A3,3 0 0,1 5,8M19,8A3,3 0 0,1 22,11A3,3 0 0,1 19,14C17.84,14 16.84,13.34 16.34,12.38C17.2,11.27 17.62,9.85 17.47,8.42C17.92,8.15 18.44,8 19,8M5.5,18.25C5.5,16.18 8.41,14.5 12,14.5C15.59,14.5 18.5,16.18 18.5,18.25V20H5.5V18.25M0,20V18.5C0,17.11 1.89,15.94 4.45,15.6C3.86,16.28 3.5,17.22 3.5,18.25V20H0M24,20H20.5V18.25C20.5,17.22 20.14,16.28 19.55,15.6C22.11,15.94 24,17.11 24,18.5V20Z"},T6={key:0};function E6(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon account-group-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",O6,[o.title?(p(),C("title",T6,E(o.title),1)):P("",!0)])],8,I6))],16,D6)}const P6=Q(L6,[["render",E6]]),$6={name:"CircleNavigationItem",components:{ActionButton:gn,ActionLink:tr,ActionText:La,NcCounterBubble:nr,AppNavigationItem:Oa,ExitToApp:Dc,IconCog:Ha,IconDelete:tn,LocationEnter:w6,AccountStar:N6,AccountGroup:P6,AccountGroupOutline:ir,IconLoading:me},mixins:[Nc],props:{circle:{type:pc,required:!0}},computed:{memberCount(){const e=Object.keys(this.circle?.members||[]).length;return e===0&&this.circle.population>0?this.circle.population:e}}};function z6(e,i,o,r,a,s){const l=b("AccountStar"),c=b("AccountGroup"),d=b("AccountGroupOutline"),u=b("IconLoading"),m=b("ActionText"),y=b("IconCog"),v=b("ActionButton"),w=b("ActionLink"),D=b("ExitToApp"),S=b("LocationEnter"),R=b("IconDelete"),A=b("NcCounterBubble"),V=b("AppNavigationItem");return p(),O(V,{key:o.circle.key,name:o.circle.displayName,to:o.circle.router},{icon:_(()=>[o.circle.isOwner?(p(),O(l,{key:0,size:20})):o.circle.isMember?(p(),O(c,{key:1,size:20})):(p(),O(d,{key:2,size:20}))]),actions:_(()=>[e.loadingAction?(p(),O(m,{key:0},{icon:_(()=>[M(u,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Loading …")),1)]),_:1})):(p(),C(mt,{key:1},[o.circle.canManageMembers?(p(),O(v,{key:0,"close-after-click":!0,onClick:e.addMemberToCircle},{icon:_(()=>[M(y,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Manage team")),1)]),_:1},8,["onClick"])):P("",!0),M(w,{href:e.circleUrl,icon:e.copyLinkIcon,onClick:i[0]||(i[0]=Wt(W=>e.copyToClipboard(e.circleUrl),["stop","prevent"]))},{default:_(()=>[K(E(e.copyButtonText),1)]),_:1},8,["href","icon"]),o.circle.canLeave?(p(),O(v,{key:1,onClick:e.confirmLeaveCircle},{icon:_(()=>[M(D,{size:16})]),default:_(()=>[K(E(e.t("contacts","Leave team"))+" ",1)]),_:1},8,["onClick"])):!o.circle.isMember&&o.circle.canJoin?(p(),O(v,{key:2,disabled:e.loadingJoin,onClick:e.joinCircle},{icon:_(()=>[M(S,{size:16})]),default:_(()=>[K(E(e.joinButtonTitle)+" ",1)]),_:1},8,["disabled","onClick"])):P("",!0),o.circle.canDelete?(p(),O(v,{key:3,onClick:e.confirmDeleteCircle},{icon:_(()=>[M(R,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Delete team")),1)]),_:1},8,["onClick"])):P("",!0)],64))]),counter:_(()=>[s.memberCount>0?(p(),O(A,{key:0,count:s.memberCount},null,8,["count"])):P("",!0)]),_:1},8,["name","to"])}const H6=Q($6,[["render",z6]]),B6={name:"AccountMultiplePlusOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},R6=["aria-hidden","aria-label"],V6=["fill","width","height"],U6={d:"M13 11A3 3 0 1 0 10 8A3 3 0 0 0 13 11M13 7A1 1 0 1 1 12 8A1 1 0 0 1 13 7M17.11 10.86A5 5 0 0 0 17.11 5.14A2.91 2.91 0 0 1 18 5A3 3 0 0 1 18 11A2.91 2.91 0 0 1 17.11 10.86M13 13C7 13 7 17 7 17V19H19V17S19 13 13 13M9 17C9 16.71 9.32 15 13 15C16.5 15 16.94 16.56 17 17M24 17V19H21V17A5.6 5.6 0 0 0 19.2 13.06C24 13.55 24 17 24 17M8 12H5V15H3V12H0V10H3V7H5V10H8Z"},Y6={key:0};function G6(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon account-multiple-plus-outline-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",U6,[o.title?(p(),C("title",Y6,E(o.title),1)):P("",!0)])],8,V6))],16,R6)}const F6=Q(B6,[["render",G6]]),W6={name:"ShareVariantOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},j6=["aria-hidden","aria-label"],q6=["fill","width","height"],X6={d:"M18 16.08C17.24 16.08 16.56 16.38 16.04 16.85L8.91 12.7C8.96 12.47 9 12.24 9 12S8.96 11.53 8.91 11.3L15.96 7.19C16.5 7.69 17.21 8 18 8C19.66 8 21 6.66 21 5S19.66 2 18 2 15 3.34 15 5C15 5.24 15.04 5.47 15.09 5.7L8.04 9.81C7.5 9.31 6.79 9 6 9C4.34 9 3 10.34 3 12S4.34 15 6 15C6.79 15 7.5 14.69 8.04 14.19L15.16 18.34C15.11 18.55 15.08 18.77 15.08 19C15.08 20.61 16.39 21.91 18 21.91S20.92 20.61 20.92 19C20.92 17.39 19.61 16.08 18 16.08M18 4C18.55 4 19 4.45 19 5S18.55 6 18 6 17 5.55 17 5 17.45 4 18 4M6 13C5.45 13 5 12.55 5 12S5.45 11 6 11 7 11.45 7 12 6.55 13 6 13M18 20C17.45 20 17 19.55 17 19S17.45 18 18 18 19 18.45 19 19 18.55 20 18 20Z"},Z6={key:0};function J6(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon share-variant-outline-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",X6,[o.title?(p(),C("title",Z6,E(o.title),1)):P("",!0)])],8,q6))],16,j6)}const K6=Q(W6,[["render",J6]]),Ll=$n("contacts","isGroupSharingEnabled",!1),Q6={name:"SettingsAddressbookSharee",components:{Button:ne,IconDelete:tn,IconGroup:Vn,IconLoading:me,IconUser:Ti},props:{addressbook:{type:Object,required:!0},sharee:{type:Object,required:!0}},data(){return{loading:!1}},computed:{writeable(){return this.sharee.writeable},uid(){return this.sharee.id+this.addressbook.id+Math.floor(Math.random()*1e3)}},methods:{async deleteSharee(){if(this.loading)return!1;this.loading=!0;try{await this.$store.dispatch("removeSharee",{addressbook:this.addressbook,uri:this.sharee.uri})}catch(e){console.error(e),vt(t("contacts","Unable to delete the share"))}finally{this.loading=!1}},async editSharee(){if(this.loading)return!1;this.loading=!0;try{await this.$store.dispatch("toggleShareeWritable",{addressbook:this.addressbook,uri:this.sharee.uri,writeable:!this.sharee.writeable})}catch(e){console.error(e),vt(t("contacts","Unable to change permissions"))}finally{this.loading=!1}}}},t3={class:"addressbook-sharee"},e3=["title"],n3={class:"addressbook-sharee__utils"},i3=["id","checked","disabled"],o3=["for","title"];function r3(e,i,o,r,a,s){const l=b("IconLoading"),c=b("IconGroup"),d=b("IconUser"),u=b("IconDelete"),m=b("Button");return p(),C("li",t3,[a.loading?(p(),O(l,{key:0,size:20})):o.sharee.isGroup&&!a.loading?(p(),O(c,{key:1})):!o.sharee.isGroup&&!a.loading?(p(),O(d,{key:2})):P("",!0),T("span",{class:"addressbook-sharee__identifier",title:o.sharee.displayName},E(o.sharee.displayName),9,e3),T("span",n3,[T("input",{id:s.uid,checked:s.writeable,disabled:a.loading,class:"checkbox",name:"editable",type:"checkbox",onChange:i[0]||(i[0]=(...y)=>s.editSharee&&s.editSharee(...y))},null,40,i3),T("label",{for:s.uid,title:e.t("contacts","can edit")},E(e.t("contacts","can edit")),9,o3),M(m,{class:Kt({"addressbook-sharee__utils--disabled":a.loading}),href:"#",title:"Delete",onClick:s.deleteSharee},{icon:_(()=>[M(u,{size:20})]),_:1},8,["class","onClick"])])])}const a3=Q(Q6,[["render",r3],["__scopeId","data-v-2a6d66b7"]]);function Dl(e){return decodeURIComponent(e.replace(/\+/g," "))}const s3={name:"SettingsAddressbookShare",components:{NcSelectUsers:cf,addressBookSharee:a3},props:{addressbook:{type:Object,default(){return{}}}},data(){return{isLoading:!1,inputGiven:!1,usersOrGroups:[]}},computed:{placeholder(){return Ll?t("contacts","Share with users or groups"):t("contacts","Share with users")},noResult(){return t("contacts","No users or groups")}},mounted(){document.getElementById("users-groups-search").focus()},methods:{shareAddressbook({user:e,displayName:i,uri:o,isGroup:r}){this.$store.dispatch("shareAddressbook",{addressbook:this.addressbook,user:e,displayName:i,uri:o,isGroup:r})},findSharee:dc(async function(e){if(this.isLoading=!0,this.usersOrGroups=[],e.length>0){const i=await co.principalPropertySearchByDisplayname(e);this.usersOrGroups=i.filter(o=>{const r=["INDIVIDUAL"];return Ll&&r.push("GROUP"),r.includes(o.calendarUserType)&&!this.addressbook.shares.some(a=>a.uri===o.principalScheme)}).map(o=>{const r=o.calendarUserType==="GROUP";return{user:Dl(o[r?"groupId":"userId"]),displayName:o.displayname,icon:r?"icon-group":"icon-user",uri:Dl(o.principalScheme),isGroup:r}}),this.isLoading=!1,this.inputGiven=!0}else this.inputGiven=!1,this.isLoading=!1},500)}},l3={class:"addressbook-shares"},c3={key:0,class:"addressbook-shares__list"};function d3(e,i,o,r,a,s){const l=b("NcSelectUsers"),c=b("addressBookSharee");return p(),C("div",l3,[M(l,{id:"users-groups-search",options:a.usersOrGroups,searchable:!0,"internal-search":!1,"max-height":600,"show-no-results":!0,placeholder:s.placeholder,class:Kt({showContent:a.inputGiven,"icon-loading":a.isLoading}),"get-option-key":d=>d.user,"open-direction":"bottom",label:"displayName",onSearch:s.findSharee,"onUpdate:modelValue":s.shareAddressbook},null,8,["options","placeholder","class","get-option-key","onSearch","onUpdate:modelValue"]),o.addressbook.shares.length>0?(p(),C("ul",c3,[(p(!0),C(mt,null,It(o.addressbook.shares,d=>(p(),O(c,{key:d.uri,sharee:d,addressbook:o.addressbook},null,8,["sharee","addressbook"]))),128))])):P("",!0)])}const u3=Q(s3,[["render",d3],["__scopeId","data-v-df609321"]]),h3={name:"SettingsAddressbook",components:{ActionButton:gn,ActionCheckbox:gm,ActionInput:Ta,ActionLink:tr,Actions:Hn,Button:ne,IconDelete:tn,IconDownload:sr,IconRename:Ea,IconContactPlus:F6,IconShare:K6,IconLoading:me,ShareAddressBook:u3},mixins:[Ac],props:{addressbook:{type:Object,default(){return{}}}},data(){return{deleteAddressbookLoading:!1,editingName:!1,menuOpen:!1,renameLoading:!1,shareOpen:!1,toggleEnabledLoading:!1}},computed:{enabled(){return this.addressbook.enabled},hasShares(){return this.addressbook.shares.length>0},addressbooks(){return this.$store.getters.getAddressbooks},hasMultipleAddressbooks(){return this.addressbooks.length>1},sharedWithTooltip(){return this.hasShares?n("contacts","Shared with {num} entity","Shared with {num} entities",this.addressbook.shares.length,{num:this.addressbook.shares.length}):""},copyButtonText(){return this.copied?this.copySuccess?t("contacts","Copied"):t("contacts","Cannot copy"):t("contacts","Copy link")},addressbookUrl(){return window.location.origin+this.addressbook.url},contacts(){return Object.values(this.addressbook.contacts)},groups(){const e=this.contacts.flatMap(i=>i.vCard.getAllProperties("categories").map(o=>o.getFirstValue()));return[...new Set(e)]},contactsCount(){return this.contacts.length},groupsCount(){return this.groups.length},principalUrl(){return bc().currentUserPrincipal.principalUrl},isSharedWithMe(){return this.addressbook.owner!==this.principalUrl}},watch:{menuOpen(){this.menuOpen===!1&&(this.editingName=!1)}},mounted(){this.popupItem=this.$el},methods:{closeMenu(){this.menuOpen=!1},toggleMenu(){this.menuOpen=!this.menuOpen},toggleShare(){this.shareOpen=!this.shareOpen},async toggleAddressbookEnabled(){this.toggleEnabledLoading=!0;try{await this.$store.dispatch("toggleAddressbookEnabled",this.addressbook)}catch(e){console.error(e),vt(t("contacts","Toggling of address book was not successful"))}finally{this.toggleEnabledLoading=!1}},confirmDeletion(){window.OC.dialogs.confirm(t("contacts","This will delete the address book and every contacts within it"),t("contacts","Delete {addressbook}?",{addressbook:this.addressbook.displayName}),this.deleteAddressbook,!0)},confirmUnshare(){window.OC.dialogs.confirm(t("contacts","This will unshare the address book and every contacts within it"),t("contacts","Unshare {addressbook}?",{addressbook:this.addressbook.displayName}),this.deleteAddressbook,!0)},async deleteAddressbook(e){if(e){this.deleteAddressbookLoading=!0;try{await this.$store.dispatch("deleteAddressbook",this.addressbook)}catch(i){console.error(i),vt(t("contacts","Deletion of address book was not successful."))}finally{this.deleteAddressbookLoading=!1}}},renameAddressbook(){this.editingName=!0},async updateAddressbookName(){const e=this.addressbook,i=this.$refs.renameInput.$el.querySelector('input[type="text"]').value;this.renameLoading=!0;try{await this.$store.dispatch("renameAddressbook",{addressbook:e,newName:i})}catch(o){console.error(o),vt(t("contacts","Renaming of address book was not successful."))}finally{this.editingName=!1,this.renameLoading=!1,this.menuOpen=!1}}}},p3={class:"settings-addressbook-list"},m3={class:"addressbook__content"},f3=["title"],g3={key:0,class:"addressbook__description"},y3={key:1,class:"addressbook__count-wrapper"},v3={class:"addressbook__count"},b3={class:"addressbook__count"};function C3(e,i,o,r,a,s){const l=b("IconContactPlus"),c=b("IconShare"),d=b("Button"),u=b("ActionLink"),m=b("IconDownload"),y=b("ActionCheckbox"),v=b("IconLoading"),w=b("ActionButton"),D=b("IconRename"),S=b("ActionInput"),R=b("IconDelete"),A=b("Actions"),V=b("ShareAddressBook"),W=Sa("tooltip");return p(),C("div",p3,[M(l,{class:"settings-line__icon"}),T("li",{class:Kt([{"addressbook--disabled":!o.addressbook.enabled},"addressbook"])},[T("div",m3,[T("span",{class:"addressbook__name",title:o.addressbook.displayName},E(o.addressbook.enabled?o.addressbook.displayName:e.t("contacts","{addressbookname} (Disabled)",{addressbookname:o.addressbook.displayName})),9,f3),o.addressbook.dav.description?(p(),C("div",g3,E(o.addressbook.dav.description),1)):P("",!0),o.addressbook.enabled?(p(),C("div",y3,[T("span",v3,E(e.n("contacts","%n contact","%n contacts",s.contactsCount)),1),T("span",b3,"- "+E(e.n("contacts","%n group","%n groups",s.groupsCount)),1)])):P("",!0)]),!o.addressbook.readOnly&&!s.isSharedWithMe?ue((p(),O(d,{key:0,class:Kt([{"addressbook__share--shared":s.hasShares},"addressbook__share"]),name:s.sharedWithTooltip,href:"#",onClick:s.toggleShare},{icon:_(()=>[M(c,{size:20})]),_:1},8,["class","name","onClick"])),[[W,s.sharedWithTooltip,void 0,{top:!0}]]):P("",!0),M(A,{class:"addressbook__menu","menu-align":"right"},{default:_(()=>[M(u,{href:o.addressbook.url,icon:e.copyLinkIcon,onClick:i[0]||(i[0]=Wt(it=>e.copyToClipboard(s.addressbookUrl),["stop","prevent"]))},{default:_(()=>[K(E(s.copyButtonText),1)]),_:1},8,["href","icon"]),M(u,{href:o.addressbook.url+"?export"},{icon:_(()=>[M(m,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Download")),1)]),_:1},8,["href"]),o.addressbook.writeProps?(p(),C(mt,{key:0},[a.toggleEnabledLoading?(p(),O(w,{key:1},{icon:_(()=>[M(v,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Show")),1)]),_:1})):(p(),O(y,{key:0,"model-value":s.enabled,"onUpdate:modelValue":s.toggleAddressbookEnabled},{default:_(()=>[K(E(e.t("contacts","Show")),1)]),_:1},8,["model-value","onUpdate:modelValue"]))],64)):P("",!0),o.addressbook.readOnly?P("",!0):(p(),C(mt,{key:1},[a.editingName?(p(),O(S,{key:1,ref:"renameInput",disabled:a.renameLoading,value:o.addressbook.displayName,onSubmit:s.updateAddressbookName},{icon:_(()=>[a.renameLoading?(p(),O(v,{key:0,size:20})):P("",!0),M(D,{size:20})]),_:1},8,["disabled","value","onSubmit"])):(p(),O(w,{key:0,onClick:Wt(s.renameAddressbook,["stop","prevent"])},{icon:_(()=>[M(D,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Rename")),1)]),_:1},8,["onClick"]))],64)),s.hasMultipleAddressbooks&&o.addressbook.owner!==s.principalUrl&&o.addressbook.owner!=="/remote.php/dav/principals/system/system/"?(p(),O(w,{key:2,onClick:s.confirmUnshare},{icon:_(()=>[a.deleteAddressbookLoading?(p(),O(v,{key:0,size:20})):P("",!0),M(R,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Unshare from me")),1)]),_:1},8,["onClick"])):s.hasMultipleAddressbooks&&o.addressbook.owner!=="/remote.php/dav/principals/system/system/"?(p(),O(w,{key:3,onClick:s.confirmDeletion},{icon:_(()=>[a.deleteAddressbookLoading?(p(),O(v,{key:0,size:20})):P("",!0),M(R,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Delete")),1)]),_:1},8,["onClick"])):P("",!0)]),_:1}),a.shareOpen&&!o.addressbook.readOnly?(p(),O(V,{key:1,addressbook:o.addressbook},null,8,["addressbook"])):P("",!0)],2)])}const w3=Q(h3,[["render",C3],["__scopeId","data-v-7bb44b29"]]),k3={name:"LoadingIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},_3=["aria-hidden","aria-label"],x3=["fill","width","height"],S3={d:"M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z"},M3={key:0};function A3(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon loading-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",S3,[o.title?(p(),C("title",M3,E(o.title),1)):P("",!0)])],8,x3))],16,_3)}const N3=Q(k3,[["render",A3]]),L3={name:"SettingsNewAddressbook",components:{NcInputField:R1,IconAdd:Gi,IconLoading:N3},data(){return{loading:!1,displayName:""}},computed:{inputErrorState(){return this.displayName===""?!1:/[/\\]/.test(this.displayName)}},methods:{addAddressbook(){this.displayName!==""&&(this.loading=!0,this.$store.dispatch("appendAddressbook",{displayName:this.displayName}).then(()=>{this.displayName="",this.loading=!1}).catch(e=>{console.error(e),vt(t("contacts","An error occurred, unable to create the address book")),this.loading=!1}))}}},D3={class:"new-addressbook-entry"};function I3(e,i,o,r,a,s){const l=b("IconLoading"),c=b("IconAdd"),d=b("NcInputField");return p(),C("div",D3,[a.loading?(p(),O(l,{key:0,size:20})):P("",!0),M(d,{"model-value":a.displayName,"onUpdate:modelValue":i[0]||(i[0]=u=>a.displayName=u),class:"new-addressbook",disabled:a.loading,label:e.t("contacts","Add new address book"),"show-trailing-button":!0,"trailing-button-label":e.t("contacts","Add"),error:s.inputErrorState,type:"text",autocomplete:"off",autocorrect:"off",spellcheck:"false",onTrailingButtonClick:s.addAddressbook},{"trailing-button-icon":_(()=>[M(c,{size:20})]),_:1},8,["model-value","disabled","label","trailing-button-label","error","onTrailingButtonClick"])])}const O3=Q(L3,[["render",I3]]),T3={name:"AlertCircleOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},E3=["aria-hidden","aria-label"],P3=["fill","width","height"],$3={d:"M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20Z"},z3={key:0};function H3(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon alert-circle-outline-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",$3,[o.title?(p(),C("title",z3,E(o.title),1)):P("",!0)])],8,P3))],16,E3)}const qd=Q(T3,[["render",H3]]),B3=xe.CancelToken,R3=fc(t("contacts","Choose a vCard file to import")).setMultiSelect(!1).setType(1).allowDirectories(!1).addMimeTypeFilter("text/vcard").build(),V3={name:"SettingsImportContacts",components:{Button:ne,Modal:yn,NcSelect:Rn,IconUpload:Ud,IconError:qd,IconFolder:Yd,IconLoading:me},data(){return{cancelRequest:()=>{},importDestination:!1,isOpened:!1,loading:!1}},computed:{addressbooks(){return this.$store.getters.getAddressbooks},availableAddressbooks(){return this.addressbooks.filter(e=>!e.readOnly&&e.enabled)},options(){return this.availableAddressbooks.map(e=>({id:e.id,displayName:e.displayName}))},selectedAddressbook:{get(){return this.importDestination?this.availableAddressbooks.find(e=>e.id===this.importDestination.id):this.availableAddressbooks[0]},set(e){this.importDestination=e}},selectedAddressbookOption:{get(){return this.options.find(e=>e.id===this.selectedAddressbook.id)},set(e){this.selectedAddressbook=this.availableAddressbooks.find(i=>i.id===e.id)}},isSingleAddressbook(){return this.options.length===1},isNoAddressbookAvailable(){return this.options.length<1},importState(){return this.$store.getters.getImportState},isImporting(){return this.importState.stage!=="default"}},async mounted(){if(this.$route.name==="import"){const e=this.$route.query.file;await this.processLocalFile(e),this.$router.push({name:"group",params:{selectedGroup:t("contacts","All contacts")}})}},methods:{processFile(e){this.loading=!0,this.$store.dispatch("changeStage","parsing");const i=e.target.files[0],o=new FileReader,r=this.selectedAddressbook;this.$store.dispatch("setAddressbook",r.displayName),o.onload=()=>{this.isOpened=!1,this.$store.dispatch("importContactsIntoAddressbook",{vcf:o.result,addressbook:r}),e.target.value="",this.resetState()},o.readAsText(i)},async processLocalFile(e){console.debug("Importing",e);try{this.cancelRequest();const i=B3.source();this.cancelRequest=i.cancel;const o=await xe.get(ac(`dav/files/${sc().uid}`)+V1(e),{cancelToken:i.token}),r=this.selectedAddressbook;this.$store.dispatch("changeStage","parsing"),this.$store.dispatch("setAddressbook",r.displayName),o.data&&await this.$store.dispatch("importContactsIntoAddressbook",{vcf:o.data,addressbook:r})}catch(i){console.error("Something wrong happened while processing local file",i)}},toggleModal(){this.isOpened=!this.isOpened,this.isOpened||this.cancelRequest()},clickImportInput(){this.$refs["contact-import-input"].click()},async openPicker(){try{this.cancelRequest();const e=await R3.pick();e&&(this.loading=!0,await this.processLocalFile(e)),this.resetState()}catch(e){this.loading=!1,console.error("Something wrong happened while picking a file",e)}},resetState(){this.cancelRequest=()=>{},this.importDestination=!1,this.isOpened=!1,this.loading=!1}}},U3={class:"import-contact"},Y3={class:"import-contact__modal-addressbook"},G3={class:"import-contact__modal-pick"},F3=["disabled"];function W3(e,i,o,r,a,s){const l=b("IconUpload"),c=b("Button"),d=b("NcSelect"),u=b("IconLoading"),m=b("IconFolder"),y=b("Modal"),v=b("IconError");return p(),C("div",U3,[s.isNoAddressbookAvailable?(p(),O(c,{key:1,id:"upload",for:"contact-import",class:"button import-contact__button-disabled import-contact__multiselect-label import-contact__multiselect--no-select"},{icon:_(()=>[M(v,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Importing is disabled because there are no address books available")),1)]),_:1})):(p(),C(mt,{key:0},[M(c,{class:"import-contact__button-main",onClick:s.toggleModal},{icon:_(()=>[M(l,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Import contacts")),1)]),_:1},8,["onClick"]),a.isOpened?(p(),O(y,{key:0,ref:"modal",class:"import-contact__modal",name:e.t("contacts","Import contacts"),onClose:s.toggleModal},{default:_(()=>[T("section",Y3,[T("h2",null,E(e.t("contacts","Import contacts")),1),s.isSingleAddressbook?P("",!0):(p(),O(d,{key:0,id:"select-addressbook",modelValue:s.selectedAddressbookOption,"onUpdate:modelValue":i[0]||(i[0]=w=>s.selectedAddressbookOption=w),"allow-empty":!1,clearable:!1,options:s.options,disabled:s.isSingleAddressbook||s.isImporting,placeholder:e.t("contacts","Contacts"),label:"displayName",class:"import-contact__modal-addressbook__select"},{"selected-option":_(({displayName:w})=>[T("span",null,E(e.t("contacts","Import into the {addressbookName} address book",{addressbookName:w})),1)]),_:1},8,["modelValue","options","disabled","placeholder"]))]),T("section",G3,[T("input",{id:"contact-import",ref:"contact-import-input",disabled:a.loading||s.isImporting,type:"file",class:"hidden-visually",onChange:i[1]||(i[1]=(...w)=>s.processFile&&s.processFile(...w))},null,40,F3),M(c,{disabled:a.loading,class:"import-contact__button import-contact__button--local",onClick:s.clickImportInput},{icon:_(()=>[M(l,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Select local file")),1)]),_:1},8,["disabled","onClick"]),M(c,{variant:"primary",disabled:a.loading,class:"import-contact__button import-contact__button--files",onClick:s.openPicker},{icon:_(()=>[a.loading?(p(),O(u,{key:0,size:20})):P("",!0),M(m,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Import from files")),1)]),_:1},8,["disabled","onClick"])])]),_:1},8,["name","onClose"])):P("",!0)],64))])}const Xd=Q(V3,[["render",W3],["__scopeId","data-v-fdf24e7f"]]),j3={name:"FormatListBulletedSquareIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},q3=["aria-hidden","aria-label"],X3=["fill","width","height"],Z3={d:"M3,4H7V8H3V4M9,5V7H21V5H9M3,10H7V14H3V10M9,11V13H21V11H9M3,16H7V20H3V16M9,17V19H21V17H9"},J3={key:0};function K3(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon format-list-bulleted-square-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",Z3,[o.title?(p(),C("title",J3,E(o.title),1)):P("",!0)])],8,X3))],16,q3)}const Q3=Q(j3,[["render",K3]]),tx={name:"SettingsSortContacts",components:{NcSelect:Rn,IconList:Q3},computed:{options(){return[{label:t("contacts","First name"),key:"firstName"},{label:t("contacts","Last name"),key:"lastName"},{label:t("contacts","Phonetic first name"),key:"phoneticFirstName"},{label:t("contacts","Phonetic last name"),key:"phoneticLastName"},{label:t("contacts","Display name"),key:"displayName"},{label:t("contacts","Last modified"),key:"rev"}]},orderKey(){return this.$store.getters.getOrderKey},orderKeyOption(){return this.options.filter(e=>e.key===this.orderKey)[0]}},methods:{sortContacts(e){const i=e&&e.key?e.key:"displayName";this.$store.commit("setOrder",i),this.$store.commit("sortContacts"),localStorage.setItem("orderKey",i)},formatSortByLabel(e){return t("contacts","Sort by {sorting}",{sorting:e.label})}}},ex={class:"sort-contacts"};function nx(e,i,o,r,a,s){const l=b("IconList"),c=b("NcSelect");return p(),C("div",ex,[M(l,{class:"settings-line__icon"}),M(c,{id:"sort-by",value:s.orderKeyOption,searchable:!1,"allow-empty":!1,options:s.options,"custom-label":s.formatSortByLabel,"get-option-key":d=>d.key,label:"label",onInput:s.sortContacts},null,8,["value","options","custom-label","get-option-key","onInput"])])}const ix=Q(tx,[["render",nx],["__scopeId","data-v-0482b4ca"]]),ox={name:"ContactsSettings",components:{AppSettingsDialog:U1,AppSettingsSection:Bm,SettingsAddressbook:w3,SettingsNewAddressbook:O3,SettingsImportContacts:Xd,SettingsSortContacts:ix,CheckboxRadioSwitch:Yi},props:{open:{required:!0,type:Boolean}},data(){return{CONTACTS_SETTINGS:Cc,allowSocialSync:$n("contacts","allowSocialSync")!=="no",enableSocialSync:$n("contacts","enableSocialSync")!=="no",enableSocialSyncLoading:!1,showSettings:!1}},computed:{addressbooks(){return this.$store.getters.getAddressbooks}},watch:{showSettings(e){e||this.$emit("update:open",e)},async open(e){e&&await this.onOpen()}},methods:{onClickImport(e){this.$emit("clicked",e)},async toggleSocialSync(){this.enableSocialSync=!this.enableSocialSync,this.enableSocialSyncLoading=!0;let e="yes";this.enableSocialSync?e="yes":e="no";try{await xe.put(Qo("apps/contacts/api/v1/social/config/user/enableSocialSync"),{allow:e})}finally{this.enableSocialSyncLoading=!1}},onLoad(){this.$emit("file-loaded",!1)},async onOpen(){this.showSettings=!0}}},rx={class:"social-sync__checkbox__label"},ax={class:"contacts-settings-modal__form"},sx={class:"contacts-settings-modal__form__row"},lx={id:"addressbook-list",class:"addressbook-list"};function cx(e,i,o,r,a,s){const l=b("CheckboxRadioSwitch"),c=b("SettingsSortContacts"),d=b("AppSettingsSection"),u=b("SettingsAddressbook"),m=b("SettingsNewAddressbook"),y=b("SettingsImportContacts"),v=b("AppSettingsDialog");return p(),O(v,{id:"app-settings-dialog",open:a.showSettings,"onUpdate:open":i[0]||(i[0]=w=>a.showSettings=w),name:e.t("contacts","Contacts settings"),"show-navigation":!0},{default:_(()=>[M(d,{id:"general-settings",name:e.t("contacts","General settings")},{default:_(()=>[M(l,{"model-value":a.enableSocialSync,loading:a.enableSocialSyncLoading,disabled:a.enableSocialSyncLoading,class:"social-sync__checkbox contacts-settings-modal__form__row","onUpdate:modelValue":s.toggleSocialSync},{default:_(()=>[T("div",rx,[T("span",null,[K(E(e.t("contacts","Update avatars from social media"))+" ",1),T("em",null,E(e.t("contacts","(refreshed once per week)")),1)])])]),_:1},8,["model-value","loading","disabled","onUpdate:modelValue"]),M(c,{class:"contacts-settings-modal__form__row"})]),_:1},8,["name"]),M(d,{id:"address-books",name:e.t("contacts","Address books")},{default:_(()=>[T("div",ax,[T("div",sx,[T("ul",lx,[(p(!0),C(mt,null,It(s.addressbooks,w=>(p(),O(u,{key:w.id,addressbook:w},null,8,["addressbook"]))),128))])]),M(m,{class:"contacts-settings-modal__form__row settings-new-addressbook",addressbooks:s.addressbooks},null,8,["addressbooks"]),M(y,{addressbooks:s.addressbooks,class:"contacts-settings-modal__form__row",onClicked:s.onClickImport,onFileLoaded:s.onLoad},null,8,["addressbooks","onClicked","onFileLoaded"])])]),_:1},8,["name"])]),_:1},8,["open","name"])}const dx=Q(ox,[["render",cx],["__scopeId","data-v-3dd8ff67"]]);var Zd={exports:{}};(function(e,i){(function(o,r){e.exports=r()})(rc,function(){return function o(r,a,s){var l=window,c="application/octet-stream",d=s||c,u=r,m=!a&&!s&&u,y=document.createElement("a"),v=function(lt){return String(lt)},w=l.Blob||l.MozBlob||l.WebKitBlob||v,D=a||"download",S,R;if(w=w.call?w.bind(l):Blob,String(this)==="true"&&(u=[u,d],d=u[0],u=u[1]),m&&m.length<2048&&(D=m.split("/").pop().split("?")[0],y.href=m,y.href.indexOf(m)!==-1)){var A=new XMLHttpRequest;return A.open("GET",m,!0),A.responseType="blob",A.onload=function(lt){o(lt.target.response,D,c)},setTimeout(function(){A.send()},0),A}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(u))if(u.length>1024*1024*1.999&&w!==v)u=et(u),d=u.type||c;else return navigator.msSaveBlob?navigator.msSaveBlob(et(u),D):st(u);else if(/([\x80-\xff])/.test(u)){var V=0,W=new Uint8Array(u.length),it=W.length;for(V;V<it;++V)W[V]=u.charCodeAt(V);u=new w([W],{type:d})}S=u instanceof w?u:new w([u],{type:d});function et(lt){var ht=lt.split(/[:;,]/),rt=ht[1],dt=ht[2]=="base64"?atob:decodeURIComponent,L=dt(ht.pop()),G=L.length,j=0,I=new Uint8Array(G);for(j;j<G;++j)I[j]=L.charCodeAt(j);return new w([I],{type:rt})}function st(lt,ht){if("download"in y)return y.href=lt,y.setAttribute("download",D),y.className="download-js-link",y.innerHTML="downloading...",y.style.display="none",document.body.appendChild(y),setTimeout(function(){y.click(),document.body.removeChild(y),ht===!0&&setTimeout(function(){l.URL.revokeObjectURL(y.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(lt)&&(lt="data:"+lt.replace(/^data:([\w\/\-\+]+)/,c)),window.open(lt)||confirm(`Displaying New Document

Use Save As... to download, then click back to return to this page.`)&&(location.href=lt),!0;var rt=document.createElement("iframe");document.body.appendChild(rt),!ht&&/^data:/.test(lt)&&(lt="data:"+lt.replace(/^data:([\w\/\-\+]+)/,c)),rt.src=lt,setTimeout(function(){document.body.removeChild(rt)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(S,D);if(l.URL)st(l.URL.createObjectURL(S),!0);else{if(typeof S=="string"||S.constructor===v)try{return st("data:"+d+";base64,"+l.btoa(S))}catch{return st("data:"+d+","+encodeURIComponent(S))}R=new FileReader,R.onload=function(lt){st(this.result)},R.readAsDataURL(S)}return!0}})})(Zd);var ux=Zd.exports;const hx=Na(ux);var Jd;function nt(){return Jd.apply(null,arguments)}function px(e){Jd=e}function Se(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function En(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function xt(e,i){return Object.prototype.hasOwnProperty.call(e,i)}function Ka(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var i;for(i in e)if(xt(e,i))return!1;return!0}function se(e){return e===void 0}function Ke(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function Wi(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function Kd(e,i){var o=[],r,a=e.length;for(r=0;r<a;++r)o.push(i(e[r],r));return o}function hn(e,i){for(var o in i)xt(i,o)&&(e[o]=i[o]);return xt(i,"toString")&&(e.toString=i.toString),xt(i,"valueOf")&&(e.valueOf=i.valueOf),e}function Be(e,i,o,r){return fu(e,i,o,r,!0).utc()}function mx(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function ft(e){return e._pf==null&&(e._pf=mx()),e._pf}var pa;Array.prototype.some?pa=Array.prototype.some:pa=function(e){var i=Object(this),o=i.length>>>0,r;for(r=0;r<o;r++)if(r in i&&e.call(this,i[r],r,i))return!0;return!1};function Qa(e){var i=null,o=!1,r=e._d&&!isNaN(e._d.getTime());if(r&&(i=ft(e),o=pa.call(i.parsedDateParts,function(a){return a!=null}),r=i.overflow<0&&!i.empty&&!i.invalidEra&&!i.invalidMonth&&!i.invalidWeekday&&!i.weekdayMismatch&&!i.nullInput&&!i.invalidFormat&&!i.userInvalidated&&(!i.meridiem||i.meridiem&&o),e._strict&&(r=r&&i.charsLeftOver===0&&i.unusedTokens.length===0&&i.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=r;else return r;return e._isValid}function lr(e){var i=Be(NaN);return e!=null?hn(ft(i),e):ft(i).userInvalidated=!0,i}var Il=nt.momentProperties=[],Hr=!1;function ts(e,i){var o,r,a,s=Il.length;if(se(i._isAMomentObject)||(e._isAMomentObject=i._isAMomentObject),se(i._i)||(e._i=i._i),se(i._f)||(e._f=i._f),se(i._l)||(e._l=i._l),se(i._strict)||(e._strict=i._strict),se(i._tzm)||(e._tzm=i._tzm),se(i._isUTC)||(e._isUTC=i._isUTC),se(i._offset)||(e._offset=i._offset),se(i._pf)||(e._pf=ft(i)),se(i._locale)||(e._locale=i._locale),s>0)for(o=0;o<s;o++)r=Il[o],a=i[r],se(a)||(e[r]=a);return e}function ji(e){ts(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Hr===!1&&(Hr=!0,nt.updateOffset(this),Hr=!1)}function Me(e){return e instanceof ji||e!=null&&e._isAMomentObject!=null}function Qd(e){nt.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function ye(e,i){var o=!0;return hn(function(){if(nt.deprecationHandler!=null&&nt.deprecationHandler(null,e),o){var r=[],a,s,l,c=arguments.length;for(s=0;s<c;s++){if(a="",typeof arguments[s]=="object"){a+=`
[`+s+"] ";for(l in arguments[0])xt(arguments[0],l)&&(a+=l+": "+arguments[0][l]+", ");a=a.slice(0,-2)}else a=arguments[s];r.push(a)}Qd(e+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),o=!1}return i.apply(this,arguments)},i)}var Ol={};function tu(e,i){nt.deprecationHandler!=null&&nt.deprecationHandler(e,i),Ol[e]||(Qd(i),Ol[e]=!0)}nt.suppressDeprecationWarnings=!1,nt.deprecationHandler=null;function Re(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function fx(e){var i,o;for(o in e)xt(e,o)&&(i=e[o],Re(i)?this[o]=i:this["_"+o]=i);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function ma(e,i){var o=hn({},e),r;for(r in i)xt(i,r)&&(En(e[r])&&En(i[r])?(o[r]={},hn(o[r],e[r]),hn(o[r],i[r])):i[r]!=null?o[r]=i[r]:delete o[r]);for(r in e)xt(e,r)&&!xt(i,r)&&En(e[r])&&(o[r]=hn({},o[r]));return o}function es(e){e!=null&&this.set(e)}var fa;Object.keys?fa=Object.keys:fa=function(e){var i,o=[];for(i in e)xt(e,i)&&o.push(i);return o};var gx={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function yx(e,i,o){var r=this._calendar[e]||this._calendar.sameElse;return Re(r)?r.call(i,o):r}function Oe(e,i,o){var r=""+Math.abs(e),a=i-r.length,s=e>=0;return(s?o?"+":"":"-")+Math.pow(10,Math.max(0,a)).toString().substr(1)+r}var ns=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ro=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Br={},oi={};function ut(e,i,o,r){var a=r;typeof r=="string"&&(a=function(){return this[r]()}),e&&(oi[e]=a),i&&(oi[i[0]]=function(){return Oe(a.apply(this,arguments),i[1],i[2])}),o&&(oi[o]=function(){return this.localeData().ordinal(a.apply(this,arguments),e)})}function vx(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function bx(e){var i=e.match(ns),o,r;for(o=0,r=i.length;o<r;o++)oi[i[o]]?i[o]=oi[i[o]]:i[o]=vx(i[o]);return function(a){var s="",l;for(l=0;l<r;l++)s+=Re(i[l])?i[l].call(a,e):i[l];return s}}function ko(e,i){return e.isValid()?(i=eu(i,e.localeData()),Br[i]=Br[i]||bx(i),Br[i](e)):e.localeData().invalidDate()}function eu(e,i){var o=5;function r(a){return i.longDateFormat(a)||a}for(ro.lastIndex=0;o>=0&&ro.test(e);)e=e.replace(ro,r),ro.lastIndex=0,o-=1;return e}var Cx={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function wx(e){var i=this._longDateFormat[e],o=this._longDateFormat[e.toUpperCase()];return i||!o?i:(this._longDateFormat[e]=o.match(ns).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[e])}var kx="Invalid date";function _x(){return this._invalidDate}var xx="%d",Sx=/\d{1,2}/;function Mx(e){return this._ordinal.replace("%d",e)}var Ax={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Nx(e,i,o,r){var a=this._relativeTime[o];return Re(a)?a(e,i,o,r):a.replace(/%d/i,e)}function Lx(e,i){var o=this._relativeTime[e>0?"future":"past"];return Re(o)?o(i):o.replace(/%s/i,i)}var Tl={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function be(e){return typeof e=="string"?Tl[e]||Tl[e.toLowerCase()]:void 0}function is(e){var i={},o,r;for(r in e)xt(e,r)&&(o=be(r),o&&(i[o]=e[r]));return i}var Dx={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function Ix(e){var i=[],o;for(o in e)xt(e,o)&&i.push({unit:o,priority:Dx[o]});return i.sort(function(r,a){return r.priority-a.priority}),i}var nu=/\d/,he=/\d\d/,iu=/\d{3}/,ga=/\d{4}/,Vo=/[+-]?\d{6}/,Et=/\d\d?/,El=/\d\d\d\d?/,Pl=/\d\d\d\d\d\d?/,_o=/\d{1,3}/,ya=/\d{1,4}/,Uo=/[+-]?\d{1,6}/,Qn=/\d+/,Yo=/[+-]?\d+/,Ox=/Z|[+-]\d\d:?\d\d/gi,xo=/Z|[+-]\d\d(?::?\d\d)?/gi,Tx=/[+-]?\d+(\.\d{1,3})?/,qi=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,hi=/^[1-9]\d?/,os=/^([1-9]\d|\d)/,Go;Go={};function ot(e,i,o){Go[e]=Re(i)?i:function(r,a){return r&&o?o:i}}function Ex(e,i){return xt(Go,e)?Go[e](i._strict,i._locale):new RegExp(Px(e))}function Px(e){return Xe(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(i,o,r,a,s){return o||r||a||s}))}function Xe(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function ge(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function Ct(e){var i=+e,o=0;return i!==0&&isFinite(i)&&(o=ge(i)),o}var va={};function Lt(e,i){var o,r=i,a;for(typeof e=="string"&&(e=[e]),Ke(i)&&(r=function(s,l){l[i]=Ct(s)}),a=e.length,o=0;o<a;o++)va[e[o]]=r}function Hi(e,i){Lt(e,function(o,r,a,s){a._w=a._w||{},i(o,a._w,a,s)})}function $x(e,i,o){i!=null&&xt(va,e)&&va[e](i,o._a,o,e)}function cr(e){return e%4===0&&e%100!==0||e%400===0}var ee=0,We=1,Te=2,Ft=3,_e=4,je=5,Ln=6,zx=7,Hx=8;ut("Y",0,0,function(){var e=this.year();return e<=9999?Oe(e,4):"+"+e}),ut(0,["YY",2],0,function(){return this.year()%100}),ut(0,["YYYY",4],0,"year"),ut(0,["YYYYY",5],0,"year"),ut(0,["YYYYYY",6,!0],0,"year"),ot("Y",Yo),ot("YY",Et,he),ot("YYYY",ya,ga),ot("YYYYY",Uo,Vo),ot("YYYYYY",Uo,Vo),Lt(["YYYYY","YYYYYY"],ee),Lt("YYYY",function(e,i){i[ee]=e.length===2?nt.parseTwoDigitYear(e):Ct(e)}),Lt("YY",function(e,i){i[ee]=nt.parseTwoDigitYear(e)}),Lt("Y",function(e,i){i[ee]=parseInt(e,10)});function Di(e){return cr(e)?366:365}nt.parseTwoDigitYear=function(e){return Ct(e)+(Ct(e)>68?1900:2e3)};var $l=mi("FullYear",!0);function Bx(){return cr(this.year())}function mi(e,i){return function(o){return o!=null?(ou(this,e,o),nt.updateOffset(this,i),this):Bi(this,e)}}function Bi(e,i){if(!e.isValid())return NaN;var o=e._d,r=e._isUTC;switch(i){case"Milliseconds":return r?o.getUTCMilliseconds():o.getMilliseconds();case"Seconds":return r?o.getUTCSeconds():o.getSeconds();case"Minutes":return r?o.getUTCMinutes():o.getMinutes();case"Hours":return r?o.getUTCHours():o.getHours();case"Date":return r?o.getUTCDate():o.getDate();case"Day":return r?o.getUTCDay():o.getDay();case"Month":return r?o.getUTCMonth():o.getMonth();case"FullYear":return r?o.getUTCFullYear():o.getFullYear();default:return NaN}}function ou(e,i,o){var r,a,s,l,c;if(!(!e.isValid()||isNaN(o))){switch(r=e._d,a=e._isUTC,i){case"Milliseconds":return void(a?r.setUTCMilliseconds(o):r.setMilliseconds(o));case"Seconds":return void(a?r.setUTCSeconds(o):r.setSeconds(o));case"Minutes":return void(a?r.setUTCMinutes(o):r.setMinutes(o));case"Hours":return void(a?r.setUTCHours(o):r.setHours(o));case"Date":return void(a?r.setUTCDate(o):r.setDate(o));case"FullYear":break;default:return}s=o,l=e.month(),c=e.date(),c=c===29&&l===1&&!cr(s)?28:c,a?r.setUTCFullYear(s,l,c):r.setFullYear(s,l,c)}}function Rx(e){return e=be(e),Re(this[e])?this[e]():this}function Vx(e,i){if(typeof e=="object"){e=is(e);var o=Ix(e),r,a=o.length;for(r=0;r<a;r++)this[o[r].unit](e[o[r].unit])}else if(e=be(e),Re(this[e]))return this[e](i);return this}function Ux(e,i){return(e%i+i)%i}var Rt;Array.prototype.indexOf?Rt=Array.prototype.indexOf:Rt=function(e){var i;for(i=0;i<this.length;++i)if(this[i]===e)return i;return-1};function rs(e,i){if(isNaN(e)||isNaN(i))return NaN;var o=Ux(i,12);return e+=(i-o)/12,o===1?cr(e)?29:28:31-o%7%2}ut("M",["MM",2],"Mo",function(){return this.month()+1}),ut("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),ut("MMMM",0,0,function(e){return this.localeData().months(this,e)}),ot("M",Et,hi),ot("MM",Et,he),ot("MMM",function(e,i){return i.monthsShortRegex(e)}),ot("MMMM",function(e,i){return i.monthsRegex(e)}),Lt(["M","MM"],function(e,i){i[We]=Ct(e)-1}),Lt(["MMM","MMMM"],function(e,i,o,r){var a=o._locale.monthsParse(e,r,o._strict);a!=null?i[We]=a:ft(o).invalidMonth=e});var Yx="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ru="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),au=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Gx=qi,Fx=qi;function Wx(e,i){return e?Se(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||au).test(i)?"format":"standalone"][e.month()]:Se(this._months)?this._months:this._months.standalone}function jx(e,i){return e?Se(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[au.test(i)?"format":"standalone"][e.month()]:Se(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function qx(e,i,o){var r,a,s,l=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)s=Be([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(s,"").toLocaleLowerCase();return o?i==="MMM"?(a=Rt.call(this._shortMonthsParse,l),a!==-1?a:null):(a=Rt.call(this._longMonthsParse,l),a!==-1?a:null):i==="MMM"?(a=Rt.call(this._shortMonthsParse,l),a!==-1?a:(a=Rt.call(this._longMonthsParse,l),a!==-1?a:null)):(a=Rt.call(this._longMonthsParse,l),a!==-1?a:(a=Rt.call(this._shortMonthsParse,l),a!==-1?a:null))}function Xx(e,i,o){var r,a,s;if(this._monthsParseExact)return qx.call(this,e,i,o);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++)if(a=Be([2e3,r]),o&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(a,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(a,"").replace(".","")+"$","i")),!o&&!this._monthsParse[r]&&(s="^"+this.months(a,"")+"|^"+this.monthsShort(a,""),this._monthsParse[r]=new RegExp(s.replace(".",""),"i")),o&&i==="MMMM"&&this._longMonthsParse[r].test(e)||o&&i==="MMM"&&this._shortMonthsParse[r].test(e)||!o&&this._monthsParse[r].test(e))return r}function su(e,i){if(!e.isValid())return e;if(typeof i=="string"){if(/^\d+$/.test(i))i=Ct(i);else if(i=e.localeData().monthsParse(i),!Ke(i))return e}var o=i,r=e.date();return r=r<29?r:Math.min(r,rs(e.year(),o)),e._isUTC?e._d.setUTCMonth(o,r):e._d.setMonth(o,r),e}function zl(e){return e!=null?(su(this,e),nt.updateOffset(this,!0),this):Bi(this,"Month")}function Zx(){return rs(this.year(),this.month())}function Jx(e){return this._monthsParseExact?(xt(this,"_monthsRegex")||lu.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(xt(this,"_monthsShortRegex")||(this._monthsShortRegex=Gx),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function Kx(e){return this._monthsParseExact?(xt(this,"_monthsRegex")||lu.call(this),e?this._monthsStrictRegex:this._monthsRegex):(xt(this,"_monthsRegex")||(this._monthsRegex=Fx),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function lu(){function e(d,u){return u.length-d.length}var i=[],o=[],r=[],a,s,l,c;for(a=0;a<12;a++)s=Be([2e3,a]),l=Xe(this.monthsShort(s,"")),c=Xe(this.months(s,"")),i.push(l),o.push(c),r.push(c),r.push(l);i.sort(e),o.sort(e),r.sort(e),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+i.join("|")+")","i")}function Qx(e,i,o,r,a,s,l){var c;return e<100&&e>=0?(c=new Date(e+400,i,o,r,a,s,l),isFinite(c.getFullYear())&&c.setFullYear(e)):c=new Date(e,i,o,r,a,s,l),c}function Ri(e){var i,o;return e<100&&e>=0?(o=Array.prototype.slice.call(arguments),o[0]=e+400,i=new Date(Date.UTC.apply(null,o)),isFinite(i.getUTCFullYear())&&i.setUTCFullYear(e)):i=new Date(Date.UTC.apply(null,arguments)),i}function Fo(e,i,o){var r=7+i-o,a=(7+Ri(e,0,r).getUTCDay()-i)%7;return-a+r-1}function cu(e,i,o,r,a){var s=(7+o-r)%7,l=Fo(e,r,a),c=1+7*(i-1)+s+l,d,u;return c<=0?(d=e-1,u=Di(d)+c):c>Di(e)?(d=e+1,u=c-Di(e)):(d=e,u=c),{year:d,dayOfYear:u}}function Vi(e,i,o){var r=Fo(e.year(),i,o),a=Math.floor((e.dayOfYear()-r-1)/7)+1,s,l;return a<1?(l=e.year()-1,s=a+Ze(l,i,o)):a>Ze(e.year(),i,o)?(s=a-Ze(e.year(),i,o),l=e.year()+1):(l=e.year(),s=a),{week:s,year:l}}function Ze(e,i,o){var r=Fo(e,i,o),a=Fo(e+1,i,o);return(Di(e)-r+a)/7}ut("w",["ww",2],"wo","week"),ut("W",["WW",2],"Wo","isoWeek"),ot("w",Et,hi),ot("ww",Et,he),ot("W",Et,hi),ot("WW",Et,he),Hi(["w","ww","W","WW"],function(e,i,o,r){i[r.substr(0,1)]=Ct(e)});function tS(e){return Vi(e,this._week.dow,this._week.doy).week}var eS={dow:0,doy:6};function nS(){return this._week.dow}function iS(){return this._week.doy}function oS(e){var i=this.localeData().week(this);return e==null?i:this.add((e-i)*7,"d")}function rS(e){var i=Vi(this,1,4).week;return e==null?i:this.add((e-i)*7,"d")}ut("d",0,"do","day"),ut("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),ut("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),ut("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),ut("e",0,0,"weekday"),ut("E",0,0,"isoWeekday"),ot("d",Et),ot("e",Et),ot("E",Et),ot("dd",function(e,i){return i.weekdaysMinRegex(e)}),ot("ddd",function(e,i){return i.weekdaysShortRegex(e)}),ot("dddd",function(e,i){return i.weekdaysRegex(e)}),Hi(["dd","ddd","dddd"],function(e,i,o,r){var a=o._locale.weekdaysParse(e,r,o._strict);a!=null?i.d=a:ft(o).invalidWeekday=e}),Hi(["d","e","E"],function(e,i,o,r){i[r]=Ct(e)});function aS(e,i){return typeof e!="string"?e:isNaN(e)?(e=i.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function sS(e,i){return typeof e=="string"?i.weekdaysParse(e)%7||7:isNaN(e)?null:e}function as(e,i){return e.slice(i,7).concat(e.slice(0,i))}var lS="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),du="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),cS="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),dS=qi,uS=qi,hS=qi;function pS(e,i){var o=Se(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(i)?"format":"standalone"];return e===!0?as(o,this._week.dow):e?o[e.day()]:o}function mS(e){return e===!0?as(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function fS(e){return e===!0?as(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function gS(e,i,o){var r,a,s,l=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)s=Be([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(s,"").toLocaleLowerCase();return o?i==="dddd"?(a=Rt.call(this._weekdaysParse,l),a!==-1?a:null):i==="ddd"?(a=Rt.call(this._shortWeekdaysParse,l),a!==-1?a:null):(a=Rt.call(this._minWeekdaysParse,l),a!==-1?a:null):i==="dddd"?(a=Rt.call(this._weekdaysParse,l),a!==-1||(a=Rt.call(this._shortWeekdaysParse,l),a!==-1)?a:(a=Rt.call(this._minWeekdaysParse,l),a!==-1?a:null)):i==="ddd"?(a=Rt.call(this._shortWeekdaysParse,l),a!==-1||(a=Rt.call(this._weekdaysParse,l),a!==-1)?a:(a=Rt.call(this._minWeekdaysParse,l),a!==-1?a:null)):(a=Rt.call(this._minWeekdaysParse,l),a!==-1||(a=Rt.call(this._weekdaysParse,l),a!==-1)?a:(a=Rt.call(this._shortWeekdaysParse,l),a!==-1?a:null))}function yS(e,i,o){var r,a,s;if(this._weekdaysParseExact)return gS.call(this,e,i,o);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++)if(a=Be([2e3,1]).day(r),o&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(a,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(a,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(a,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(s="^"+this.weekdays(a,"")+"|^"+this.weekdaysShort(a,"")+"|^"+this.weekdaysMin(a,""),this._weekdaysParse[r]=new RegExp(s.replace(".",""),"i")),o&&i==="dddd"&&this._fullWeekdaysParse[r].test(e)||o&&i==="ddd"&&this._shortWeekdaysParse[r].test(e)||o&&i==="dd"&&this._minWeekdaysParse[r].test(e)||!o&&this._weekdaysParse[r].test(e))return r}function vS(e){if(!this.isValid())return e!=null?this:NaN;var i=Bi(this,"Day");return e!=null?(e=aS(e,this.localeData()),this.add(e-i,"d")):i}function bS(e){if(!this.isValid())return e!=null?this:NaN;var i=(this.day()+7-this.localeData()._week.dow)%7;return e==null?i:this.add(e-i,"d")}function CS(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var i=sS(e,this.localeData());return this.day(this.day()%7?i:i-7)}else return this.day()||7}function wS(e){return this._weekdaysParseExact?(xt(this,"_weekdaysRegex")||ss.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(xt(this,"_weekdaysRegex")||(this._weekdaysRegex=dS),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function kS(e){return this._weekdaysParseExact?(xt(this,"_weekdaysRegex")||ss.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(xt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=uS),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function _S(e){return this._weekdaysParseExact?(xt(this,"_weekdaysRegex")||ss.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(xt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=hS),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function ss(){function e(m,y){return y.length-m.length}var i=[],o=[],r=[],a=[],s,l,c,d,u;for(s=0;s<7;s++)l=Be([2e3,1]).day(s),c=Xe(this.weekdaysMin(l,"")),d=Xe(this.weekdaysShort(l,"")),u=Xe(this.weekdays(l,"")),i.push(c),o.push(d),r.push(u),a.push(c),a.push(d),a.push(u);i.sort(e),o.sort(e),r.sort(e),a.sort(e),this._weekdaysRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+i.join("|")+")","i")}function Rr(){return this.hours()%12||12}function xS(){return this.hours()||24}ut("H",["HH",2],0,"hour"),ut("h",["hh",2],0,Rr),ut("k",["kk",2],0,xS),ut("hmm",0,0,function(){return""+Rr.apply(this)+Oe(this.minutes(),2)}),ut("hmmss",0,0,function(){return""+Rr.apply(this)+Oe(this.minutes(),2)+Oe(this.seconds(),2)}),ut("Hmm",0,0,function(){return""+this.hours()+Oe(this.minutes(),2)}),ut("Hmmss",0,0,function(){return""+this.hours()+Oe(this.minutes(),2)+Oe(this.seconds(),2)});function Hl(e,i){ut(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),i)})}Hl("a",!0),Hl("A",!1);function Bl(e,i){return i._meridiemParse}ot("a",Bl),ot("A",Bl),ot("H",Et,os),ot("h",Et,hi),ot("k",Et,hi),ot("HH",Et,he),ot("hh",Et,he),ot("kk",Et,he),ot("hmm",El),ot("hmmss",Pl),ot("Hmm",El),ot("Hmmss",Pl),Lt(["H","HH"],Ft),Lt(["k","kk"],function(e,i,o){var r=Ct(e);i[Ft]=r===24?0:r}),Lt(["a","A"],function(e,i,o){o._isPm=o._locale.isPM(e),o._meridiem=e}),Lt(["h","hh"],function(e,i,o){i[Ft]=Ct(e),ft(o).bigHour=!0}),Lt("hmm",function(e,i,o){var r=e.length-2;i[Ft]=Ct(e.substr(0,r)),i[_e]=Ct(e.substr(r)),ft(o).bigHour=!0}),Lt("hmmss",function(e,i,o){var r=e.length-4,a=e.length-2;i[Ft]=Ct(e.substr(0,r)),i[_e]=Ct(e.substr(r,2)),i[je]=Ct(e.substr(a)),ft(o).bigHour=!0}),Lt("Hmm",function(e,i,o){var r=e.length-2;i[Ft]=Ct(e.substr(0,r)),i[_e]=Ct(e.substr(r))}),Lt("Hmmss",function(e,i,o){var r=e.length-4,a=e.length-2;i[Ft]=Ct(e.substr(0,r)),i[_e]=Ct(e.substr(r,2)),i[je]=Ct(e.substr(a))});function SS(e){return(e+"").toLowerCase().charAt(0)==="p"}var MS=/[ap]\.?m?\.?/i,AS=mi("Hours",!0);function NS(e,i,o){return e>11?o?"pm":"PM":o?"am":"AM"}var uu={calendar:gx,longDateFormat:Cx,invalidDate:kx,ordinal:xx,dayOfMonthOrdinalParse:Sx,relativeTime:Ax,months:Yx,monthsShort:ru,week:eS,weekdays:lS,weekdaysMin:cS,weekdaysShort:du,meridiemParse:MS},zt={},_i={},Ui;function LS(e,i){var o,r=Math.min(e.length,i.length);for(o=0;o<r;o+=1)if(e[o]!==i[o])return o;return r}function Rl(e){return e&&e.toLowerCase().replace("_","-")}function DS(e){for(var i=0,o,r,a,s;i<e.length;){for(s=Rl(e[i]).split("-"),o=s.length,r=Rl(e[i+1]),r=r?r.split("-"):null;o>0;){if(a=dr(s.slice(0,o).join("-")),a)return a;if(r&&r.length>=o&&LS(s,r)>=o-1)break;o--}i++}return Ui}function IS(e){return!!(e&&e.match("^[^/\\\\]*$"))}function dr(e){var i=null,o;if(zt[e]===void 0&&typeof module<"u"&&module&&module.exports&&IS(e))try{i=Ui._abbr,o=require,o("./locale/"+e),mn(i)}catch{zt[e]=null}return zt[e]}function mn(e,i){var o;return e&&(se(i)?o=en(e):o=ls(e,i),o?Ui=o:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Ui._abbr}function ls(e,i){if(i!==null){var o,r=uu;if(i.abbr=e,zt[e]!=null)tu("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=zt[e]._config;else if(i.parentLocale!=null)if(zt[i.parentLocale]!=null)r=zt[i.parentLocale]._config;else if(o=dr(i.parentLocale),o!=null)r=o._config;else return _i[i.parentLocale]||(_i[i.parentLocale]=[]),_i[i.parentLocale].push({name:e,config:i}),null;return zt[e]=new es(ma(r,i)),_i[e]&&_i[e].forEach(function(a){ls(a.name,a.config)}),mn(e),zt[e]}else return delete zt[e],null}function OS(e,i){if(i!=null){var o,r,a=uu;zt[e]!=null&&zt[e].parentLocale!=null?zt[e].set(ma(zt[e]._config,i)):(r=dr(e),r!=null&&(a=r._config),i=ma(a,i),r==null&&(i.abbr=e),o=new es(i),o.parentLocale=zt[e],zt[e]=o),mn(e)}else zt[e]!=null&&(zt[e].parentLocale!=null?(zt[e]=zt[e].parentLocale,e===mn()&&mn(e)):zt[e]!=null&&delete zt[e]);return zt[e]}function en(e){var i;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Ui;if(!Se(e)){if(i=dr(e),i)return i;e=[e]}return DS(e)}function TS(){return fa(zt)}function cs(e){var i,o=e._a;return o&&ft(e).overflow===-2&&(i=o[We]<0||o[We]>11?We:o[Te]<1||o[Te]>rs(o[ee],o[We])?Te:o[Ft]<0||o[Ft]>24||o[Ft]===24&&(o[_e]!==0||o[je]!==0||o[Ln]!==0)?Ft:o[_e]<0||o[_e]>59?_e:o[je]<0||o[je]>59?je:o[Ln]<0||o[Ln]>999?Ln:-1,ft(e)._overflowDayOfYear&&(i<ee||i>Te)&&(i=Te),ft(e)._overflowWeeks&&i===-1&&(i=zx),ft(e)._overflowWeekday&&i===-1&&(i=Hx),ft(e).overflow=i),e}var ES=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,PS=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,$S=/Z|[+-]\d\d(?::?\d\d)?/,ao=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Vr=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],zS=/^\/?Date\((-?\d+)/i,HS=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,BS={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function hu(e){var i,o,r=e._i,a=ES.exec(r)||PS.exec(r),s,l,c,d,u=ao.length,m=Vr.length;if(a){for(ft(e).iso=!0,i=0,o=u;i<o;i++)if(ao[i][1].exec(a[1])){l=ao[i][0],s=ao[i][2]!==!1;break}if(l==null){e._isValid=!1;return}if(a[3]){for(i=0,o=m;i<o;i++)if(Vr[i][1].exec(a[3])){c=(a[2]||" ")+Vr[i][0];break}if(c==null){e._isValid=!1;return}}if(!s&&c!=null){e._isValid=!1;return}if(a[4])if($S.exec(a[4]))d="Z";else{e._isValid=!1;return}e._f=l+(c||"")+(d||""),us(e)}else e._isValid=!1}function RS(e,i,o,r,a,s){var l=[VS(e),ru.indexOf(i),parseInt(o,10),parseInt(r,10),parseInt(a,10)];return s&&l.push(parseInt(s,10)),l}function VS(e){var i=parseInt(e,10);return i<=49?2e3+i:i<=999?1900+i:i}function US(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function YS(e,i,o){if(e){var r=du.indexOf(e),a=new Date(i[0],i[1],i[2]).getDay();if(r!==a)return ft(o).weekdayMismatch=!0,o._isValid=!1,!1}return!0}function GS(e,i,o){if(e)return BS[e];if(i)return 0;var r=parseInt(o,10),a=r%100,s=(r-a)/100;return s*60+a}function pu(e){var i=HS.exec(US(e._i)),o;if(i){if(o=RS(i[4],i[3],i[2],i[5],i[6],i[7]),!YS(i[1],o,e))return;e._a=o,e._tzm=GS(i[8],i[9],i[10]),e._d=Ri.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),ft(e).rfc2822=!0}else e._isValid=!1}function FS(e){var i=zS.exec(e._i);if(i!==null){e._d=new Date(+i[1]);return}if(hu(e),e._isValid===!1)delete e._isValid;else return;if(pu(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:nt.createFromInputFallback(e)}nt.createFromInputFallback=ye("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function Zn(e,i,o){return e??i??o}function WS(e){var i=new Date(nt.now());return e._useUTC?[i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()]:[i.getFullYear(),i.getMonth(),i.getDate()]}function ds(e){var i,o,r=[],a,s,l;if(!e._d){for(a=WS(e),e._w&&e._a[Te]==null&&e._a[We]==null&&jS(e),e._dayOfYear!=null&&(l=Zn(e._a[ee],a[ee]),(e._dayOfYear>Di(l)||e._dayOfYear===0)&&(ft(e)._overflowDayOfYear=!0),o=Ri(l,0,e._dayOfYear),e._a[We]=o.getUTCMonth(),e._a[Te]=o.getUTCDate()),i=0;i<3&&e._a[i]==null;++i)e._a[i]=r[i]=a[i];for(;i<7;i++)e._a[i]=r[i]=e._a[i]==null?i===2?1:0:e._a[i];e._a[Ft]===24&&e._a[_e]===0&&e._a[je]===0&&e._a[Ln]===0&&(e._nextDay=!0,e._a[Ft]=0),e._d=(e._useUTC?Ri:Qx).apply(null,r),s=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Ft]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==s&&(ft(e).weekdayMismatch=!0)}}function jS(e){var i,o,r,a,s,l,c,d,u;i=e._w,i.GG!=null||i.W!=null||i.E!=null?(s=1,l=4,o=Zn(i.GG,e._a[ee],Vi(Pt(),1,4).year),r=Zn(i.W,1),a=Zn(i.E,1),(a<1||a>7)&&(d=!0)):(s=e._locale._week.dow,l=e._locale._week.doy,u=Vi(Pt(),s,l),o=Zn(i.gg,e._a[ee],u.year),r=Zn(i.w,u.week),i.d!=null?(a=i.d,(a<0||a>6)&&(d=!0)):i.e!=null?(a=i.e+s,(i.e<0||i.e>6)&&(d=!0)):a=s),r<1||r>Ze(o,s,l)?ft(e)._overflowWeeks=!0:d!=null?ft(e)._overflowWeekday=!0:(c=cu(o,r,a,s,l),e._a[ee]=c.year,e._dayOfYear=c.dayOfYear)}nt.ISO_8601=function(){},nt.RFC_2822=function(){};function us(e){if(e._f===nt.ISO_8601){hu(e);return}if(e._f===nt.RFC_2822){pu(e);return}e._a=[],ft(e).empty=!0;var i=""+e._i,o,r,a,s,l,c=i.length,d=0,u,m;for(a=eu(e._f,e._locale).match(ns)||[],m=a.length,o=0;o<m;o++)s=a[o],r=(i.match(Ex(s,e))||[])[0],r&&(l=i.substr(0,i.indexOf(r)),l.length>0&&ft(e).unusedInput.push(l),i=i.slice(i.indexOf(r)+r.length),d+=r.length),oi[s]?(r?ft(e).empty=!1:ft(e).unusedTokens.push(s),$x(s,r,e)):e._strict&&!r&&ft(e).unusedTokens.push(s);ft(e).charsLeftOver=c-d,i.length>0&&ft(e).unusedInput.push(i),e._a[Ft]<=12&&ft(e).bigHour===!0&&e._a[Ft]>0&&(ft(e).bigHour=void 0),ft(e).parsedDateParts=e._a.slice(0),ft(e).meridiem=e._meridiem,e._a[Ft]=qS(e._locale,e._a[Ft],e._meridiem),u=ft(e).era,u!==null&&(e._a[ee]=e._locale.erasConvertYear(u,e._a[ee])),ds(e),cs(e)}function qS(e,i,o){var r;return o==null?i:e.meridiemHour!=null?e.meridiemHour(i,o):(e.isPM!=null&&(r=e.isPM(o),r&&i<12&&(i+=12),!r&&i===12&&(i=0)),i)}function XS(e){var i,o,r,a,s,l,c=!1,d=e._f.length;if(d===0){ft(e).invalidFormat=!0,e._d=new Date(NaN);return}for(a=0;a<d;a++)s=0,l=!1,i=ts({},e),e._useUTC!=null&&(i._useUTC=e._useUTC),i._f=e._f[a],us(i),Qa(i)&&(l=!0),s+=ft(i).charsLeftOver,s+=ft(i).unusedTokens.length*10,ft(i).score=s,c?s<r&&(r=s,o=i):(r==null||s<r||l)&&(r=s,o=i,l&&(c=!0));hn(e,o||i)}function ZS(e){if(!e._d){var i=is(e._i),o=i.day===void 0?i.date:i.day;e._a=Kd([i.year,i.month,o,i.hour,i.minute,i.second,i.millisecond],function(r){return r&&parseInt(r,10)}),ds(e)}}function JS(e){var i=new ji(cs(mu(e)));return i._nextDay&&(i.add(1,"d"),i._nextDay=void 0),i}function mu(e){var i=e._i,o=e._f;return e._locale=e._locale||en(e._l),i===null||o===void 0&&i===""?lr({nullInput:!0}):(typeof i=="string"&&(e._i=i=e._locale.preparse(i)),Me(i)?new ji(cs(i)):(Wi(i)?e._d=i:Se(o)?XS(e):o?us(e):KS(e),Qa(e)||(e._d=null),e))}function KS(e){var i=e._i;se(i)?e._d=new Date(nt.now()):Wi(i)?e._d=new Date(i.valueOf()):typeof i=="string"?FS(e):Se(i)?(e._a=Kd(i.slice(0),function(o){return parseInt(o,10)}),ds(e)):En(i)?ZS(e):Ke(i)?e._d=new Date(i):nt.createFromInputFallback(e)}function fu(e,i,o,r,a){var s={};return(i===!0||i===!1)&&(r=i,i=void 0),(o===!0||o===!1)&&(r=o,o=void 0),(En(e)&&Ka(e)||Se(e)&&e.length===0)&&(e=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=a,s._l=o,s._i=e,s._f=i,s._strict=r,JS(s)}function Pt(e,i,o,r){return fu(e,i,o,r,!1)}var QS=ye("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Pt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:lr()}),t7=ye("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Pt.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:lr()});function gu(e,i){var o,r;if(i.length===1&&Se(i[0])&&(i=i[0]),!i.length)return Pt();for(o=i[0],r=1;r<i.length;++r)(!i[r].isValid()||i[r][e](o))&&(o=i[r]);return o}function e7(){var e=[].slice.call(arguments,0);return gu("isBefore",e)}function n7(){var e=[].slice.call(arguments,0);return gu("isAfter",e)}var i7=function(){return Date.now?Date.now():+new Date},xi=["year","quarter","month","week","day","hour","minute","second","millisecond"];function o7(e){var i,o=!1,r,a=xi.length;for(i in e)if(xt(e,i)&&!(Rt.call(xi,i)!==-1&&(e[i]==null||!isNaN(e[i]))))return!1;for(r=0;r<a;++r)if(e[xi[r]]){if(o)return!1;parseFloat(e[xi[r]])!==Ct(e[xi[r]])&&(o=!0)}return!0}function r7(){return this._isValid}function a7(){return Ae(NaN)}function ur(e){var i=is(e),o=i.year||0,r=i.quarter||0,a=i.month||0,s=i.week||i.isoWeek||0,l=i.day||0,c=i.hour||0,d=i.minute||0,u=i.second||0,m=i.millisecond||0;this._isValid=o7(i),this._milliseconds=+m+u*1e3+d*6e4+c*1e3*60*60,this._days=+l+s*7,this._months=+a+r*3+o*12,this._data={},this._locale=en(),this._bubble()}function So(e){return e instanceof ur}function ba(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function s7(e,i,o){var r=Math.min(e.length,i.length),a=Math.abs(e.length-i.length),s=0,l;for(l=0;l<r;l++)Ct(e[l])!==Ct(i[l])&&s++;return s+a}function Vl(e,i){ut(e,0,0,function(){var o=this.utcOffset(),r="+";return o<0&&(o=-o,r="-"),r+Oe(~~(o/60),2)+i+Oe(~~o%60,2)})}Vl("Z",":"),Vl("ZZ",""),ot("Z",xo),ot("ZZ",xo),Lt(["Z","ZZ"],function(e,i,o){o._useUTC=!0,o._tzm=hs(xo,e)});var l7=/([\+\-]|\d\d)/gi;function hs(e,i){var o=(i||"").match(e),r,a,s;return o===null?null:(r=o[o.length-1]||[],a=(r+"").match(l7)||["-",0,0],s=+(a[1]*60)+Ct(a[2]),s===0?0:a[0]==="+"?s:-s)}function ps(e,i){var o,r;return i._isUTC?(o=i.clone(),r=(Me(e)||Wi(e)?e.valueOf():Pt(e).valueOf())-o.valueOf(),o._d.setTime(o._d.valueOf()+r),nt.updateOffset(o,!1),o):Pt(e).local()}function Ca(e){return-Math.round(e._d.getTimezoneOffset())}nt.updateOffset=function(){};function c7(e,i,o){var r=this._offset||0,a;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=hs(xo,e),e===null)return this}else Math.abs(e)<16&&!o&&(e=e*60);return!this._isUTC&&i&&(a=Ca(this)),this._offset=e,this._isUTC=!0,a!=null&&this.add(a,"m"),r!==e&&(!i||this._changeInProgress?vu(this,Ae(e-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,nt.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:Ca(this)}function d7(e,i){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,i),this):-this.utcOffset()}function u7(e){return this.utcOffset(0,e)}function h7(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Ca(this),"m")),this}function p7(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=hs(Ox,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function m7(e){return this.isValid()?(e=e?Pt(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function f7(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function g7(){if(!se(this._isDSTShifted))return this._isDSTShifted;var e={},i;return ts(e,this),e=mu(e),e._a?(i=e._isUTC?Be(e._a):Pt(e._a),this._isDSTShifted=this.isValid()&&s7(e._a,i.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function y7(){return this.isValid()?!this._isUTC:!1}function v7(){return this.isValid()?this._isUTC:!1}function Ul(){return this.isValid()?this._isUTC&&this._offset===0:!1}var b7=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,C7=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ae(e,i){var o=e,r=null,a,s,l;return So(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:Ke(e)||!isNaN(+e)?(o={},i?o[i]=+e:o.milliseconds=+e):(r=b7.exec(e))?(a=r[1]==="-"?-1:1,o={y:0,d:Ct(r[Te])*a,h:Ct(r[Ft])*a,m:Ct(r[_e])*a,s:Ct(r[je])*a,ms:Ct(ba(r[Ln]*1e3))*a}):(r=C7.exec(e))?(a=r[1]==="-"?-1:1,o={y:Sn(r[2],a),M:Sn(r[3],a),w:Sn(r[4],a),d:Sn(r[5],a),h:Sn(r[6],a),m:Sn(r[7],a),s:Sn(r[8],a)}):o==null?o={}:typeof o=="object"&&("from"in o||"to"in o)&&(l=w7(Pt(o.from),Pt(o.to)),o={},o.ms=l.milliseconds,o.M=l.months),s=new ur(o),So(e)&&xt(e,"_locale")&&(s._locale=e._locale),So(e)&&xt(e,"_isValid")&&(s._isValid=e._isValid),s}Ae.fn=ur.prototype,Ae.invalid=a7;function Sn(e,i){var o=e&&parseFloat(e.replace(",","."));return(isNaN(o)?0:o)*i}function Yl(e,i){var o={};return o.months=i.month()-e.month()+(i.year()-e.year())*12,e.clone().add(o.months,"M").isAfter(i)&&--o.months,o.milliseconds=+i-+e.clone().add(o.months,"M"),o}function w7(e,i){var o;return e.isValid()&&i.isValid()?(i=ps(i,e),e.isBefore(i)?o=Yl(e,i):(o=Yl(i,e),o.milliseconds=-o.milliseconds,o.months=-o.months),o):{milliseconds:0,months:0}}function yu(e,i){return function(o,r){var a,s;return r!==null&&!isNaN(+r)&&(tu(i,"moment()."+i+"(period, number) is deprecated. Please use moment()."+i+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=o,o=r,r=s),a=Ae(o,r),vu(this,a,e),this}}function vu(e,i,o,r){var a=i._milliseconds,s=ba(i._days),l=ba(i._months);e.isValid()&&(r=r??!0,l&&su(e,Bi(e,"Month")+l*o),s&&ou(e,"Date",Bi(e,"Date")+s*o),a&&e._d.setTime(e._d.valueOf()+a*o),r&&nt.updateOffset(e,s||l))}var k7=yu(1,"add"),_7=yu(-1,"subtract");function bu(e){return typeof e=="string"||e instanceof String}function x7(e){return Me(e)||Wi(e)||bu(e)||Ke(e)||M7(e)||S7(e)||e===null||e===void 0}function S7(e){var i=En(e)&&!Ka(e),o=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],a,s,l=r.length;for(a=0;a<l;a+=1)s=r[a],o=o||xt(e,s);return i&&o}function M7(e){var i=Se(e),o=!1;return i&&(o=e.filter(function(r){return!Ke(r)&&bu(e)}).length===0),i&&o}function A7(e){var i=En(e)&&!Ka(e),o=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],a,s;for(a=0;a<r.length;a+=1)s=r[a],o=o||xt(e,s);return i&&o}function N7(e,i){var o=e.diff(i,"days",!0);return o<-6?"sameElse":o<-1?"lastWeek":o<0?"lastDay":o<1?"sameDay":o<2?"nextDay":o<7?"nextWeek":"sameElse"}function L7(e,i){arguments.length===1&&(arguments[0]?x7(arguments[0])?(e=arguments[0],i=void 0):A7(arguments[0])&&(i=arguments[0],e=void 0):(e=void 0,i=void 0));var o=e||Pt(),r=ps(o,this).startOf("day"),a=nt.calendarFormat(this,r)||"sameElse",s=i&&(Re(i[a])?i[a].call(this,o):i[a]);return this.format(s||this.localeData().calendar(a,this,Pt(o)))}function D7(){return new ji(this)}function I7(e,i){var o=Me(e)?e:Pt(e);return this.isValid()&&o.isValid()?(i=be(i)||"millisecond",i==="millisecond"?this.valueOf()>o.valueOf():o.valueOf()<this.clone().startOf(i).valueOf()):!1}function O7(e,i){var o=Me(e)?e:Pt(e);return this.isValid()&&o.isValid()?(i=be(i)||"millisecond",i==="millisecond"?this.valueOf()<o.valueOf():this.clone().endOf(i).valueOf()<o.valueOf()):!1}function T7(e,i,o,r){var a=Me(e)?e:Pt(e),s=Me(i)?i:Pt(i);return this.isValid()&&a.isValid()&&s.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(a,o):!this.isBefore(a,o))&&(r[1]===")"?this.isBefore(s,o):!this.isAfter(s,o))):!1}function E7(e,i){var o=Me(e)?e:Pt(e),r;return this.isValid()&&o.isValid()?(i=be(i)||"millisecond",i==="millisecond"?this.valueOf()===o.valueOf():(r=o.valueOf(),this.clone().startOf(i).valueOf()<=r&&r<=this.clone().endOf(i).valueOf())):!1}function P7(e,i){return this.isSame(e,i)||this.isAfter(e,i)}function $7(e,i){return this.isSame(e,i)||this.isBefore(e,i)}function z7(e,i,o){var r,a,s;if(!this.isValid())return NaN;if(r=ps(e,this),!r.isValid())return NaN;switch(a=(r.utcOffset()-this.utcOffset())*6e4,i=be(i),i){case"year":s=Mo(this,r)/12;break;case"month":s=Mo(this,r);break;case"quarter":s=Mo(this,r)/3;break;case"second":s=(this-r)/1e3;break;case"minute":s=(this-r)/6e4;break;case"hour":s=(this-r)/36e5;break;case"day":s=(this-r-a)/864e5;break;case"week":s=(this-r-a)/6048e5;break;default:s=this-r}return o?s:ge(s)}function Mo(e,i){if(e.date()<i.date())return-Mo(i,e);var o=(i.year()-e.year())*12+(i.month()-e.month()),r=e.clone().add(o,"months"),a,s;return i-r<0?(a=e.clone().add(o-1,"months"),s=(i-r)/(r-a)):(a=e.clone().add(o+1,"months"),s=(i-r)/(a-r)),-(o+s)||0}nt.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",nt.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function H7(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function B7(e){if(!this.isValid())return null;var i=e!==!0,o=i?this.clone().utc():this;return o.year()<0||o.year()>9999?ko(o,i?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Re(Date.prototype.toISOString)?i?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",ko(o,"Z")):ko(o,i?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function R7(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",i="",o,r,a,s;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",i="Z"),o="["+e+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",a="-MM-DD[T]HH:mm:ss.SSS",s=i+'[")]',this.format(o+r+a+s)}function V7(e){e||(e=this.isUtc()?nt.defaultFormatUtc:nt.defaultFormat);var i=ko(this,e);return this.localeData().postformat(i)}function U7(e,i){return this.isValid()&&(Me(e)&&e.isValid()||Pt(e).isValid())?Ae({to:this,from:e}).locale(this.locale()).humanize(!i):this.localeData().invalidDate()}function Y7(e){return this.from(Pt(),e)}function G7(e,i){return this.isValid()&&(Me(e)&&e.isValid()||Pt(e).isValid())?Ae({from:this,to:e}).locale(this.locale()).humanize(!i):this.localeData().invalidDate()}function F7(e){return this.to(Pt(),e)}function Cu(e){var i;return e===void 0?this._locale._abbr:(i=en(e),i!=null&&(this._locale=i),this)}var wu=ye("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function ku(){return this._locale}var Wo=1e3,ri=60*Wo,jo=60*ri,_u=(365*400+97)*24*jo;function ai(e,i){return(e%i+i)%i}function xu(e,i,o){return e<100&&e>=0?new Date(e+400,i,o)-_u:new Date(e,i,o).valueOf()}function Su(e,i,o){return e<100&&e>=0?Date.UTC(e+400,i,o)-_u:Date.UTC(e,i,o)}function W7(e){var i,o;if(e=be(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(o=this._isUTC?Su:xu,e){case"year":i=o(this.year(),0,1);break;case"quarter":i=o(this.year(),this.month()-this.month()%3,1);break;case"month":i=o(this.year(),this.month(),1);break;case"week":i=o(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":i=o(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":i=o(this.year(),this.month(),this.date());break;case"hour":i=this._d.valueOf(),i-=ai(i+(this._isUTC?0:this.utcOffset()*ri),jo);break;case"minute":i=this._d.valueOf(),i-=ai(i,ri);break;case"second":i=this._d.valueOf(),i-=ai(i,Wo);break}return this._d.setTime(i),nt.updateOffset(this,!0),this}function j7(e){var i,o;if(e=be(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(o=this._isUTC?Su:xu,e){case"year":i=o(this.year()+1,0,1)-1;break;case"quarter":i=o(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":i=o(this.year(),this.month()+1,1)-1;break;case"week":i=o(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":i=o(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":i=o(this.year(),this.month(),this.date()+1)-1;break;case"hour":i=this._d.valueOf(),i+=jo-ai(i+(this._isUTC?0:this.utcOffset()*ri),jo)-1;break;case"minute":i=this._d.valueOf(),i+=ri-ai(i,ri)-1;break;case"second":i=this._d.valueOf(),i+=Wo-ai(i,Wo)-1;break}return this._d.setTime(i),nt.updateOffset(this,!0),this}function q7(){return this._d.valueOf()-(this._offset||0)*6e4}function X7(){return Math.floor(this.valueOf()/1e3)}function Z7(){return new Date(this.valueOf())}function J7(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function K7(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Q7(){return this.isValid()?this.toISOString():null}function tM(){return Qa(this)}function eM(){return hn({},ft(this))}function nM(){return ft(this).overflow}function iM(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}ut("N",0,0,"eraAbbr"),ut("NN",0,0,"eraAbbr"),ut("NNN",0,0,"eraAbbr"),ut("NNNN",0,0,"eraName"),ut("NNNNN",0,0,"eraNarrow"),ut("y",["y",1],"yo","eraYear"),ut("y",["yy",2],0,"eraYear"),ut("y",["yyy",3],0,"eraYear"),ut("y",["yyyy",4],0,"eraYear"),ot("N",Ur),ot("NN",Ur),ot("NNN",Ur),ot("NNNN",mM),ot("NNNNN",fM),Lt(["N","NN","NNN","NNNN","NNNNN"],function(e,i,o,r){var a=o._locale.erasParse(e,r,o._strict);a?ft(o).era=a:ft(o).invalidEra=e}),ot("y",Qn),ot("yy",Qn),ot("yyy",Qn),ot("yyyy",Qn),ot("yo",gM),Lt(["y","yy","yyy","yyyy"],ee),Lt(["yo"],function(e,i,o,r){var a;o._locale._eraYearOrdinalRegex&&(a=e.match(o._locale._eraYearOrdinalRegex)),o._locale.eraYearOrdinalParse?i[ee]=o._locale.eraYearOrdinalParse(e,a):i[ee]=parseInt(e,10)});function oM(e,i){var o,r,a,s=this._eras||en("en")._eras;for(o=0,r=s.length;o<r;++o){switch(typeof s[o].since){case"string":a=nt(s[o].since).startOf("day"),s[o].since=a.valueOf();break}switch(typeof s[o].until){case"undefined":s[o].until=1/0;break;case"string":a=nt(s[o].until).startOf("day").valueOf(),s[o].until=a.valueOf();break}}return s}function rM(e,i,o){var r,a,s=this.eras(),l,c,d;for(e=e.toUpperCase(),r=0,a=s.length;r<a;++r)if(l=s[r].name.toUpperCase(),c=s[r].abbr.toUpperCase(),d=s[r].narrow.toUpperCase(),o)switch(i){case"N":case"NN":case"NNN":if(c===e)return s[r];break;case"NNNN":if(l===e)return s[r];break;case"NNNNN":if(d===e)return s[r];break}else if([l,c,d].indexOf(e)>=0)return s[r]}function aM(e,i){var o=e.since<=e.until?1:-1;return i===void 0?nt(e.since).year():nt(e.since).year()+(i-e.offset)*o}function sM(){var e,i,o,r=this.localeData().eras();for(e=0,i=r.length;e<i;++e)if(o=this.clone().startOf("day").valueOf(),r[e].since<=o&&o<=r[e].until||r[e].until<=o&&o<=r[e].since)return r[e].name;return""}function lM(){var e,i,o,r=this.localeData().eras();for(e=0,i=r.length;e<i;++e)if(o=this.clone().startOf("day").valueOf(),r[e].since<=o&&o<=r[e].until||r[e].until<=o&&o<=r[e].since)return r[e].narrow;return""}function cM(){var e,i,o,r=this.localeData().eras();for(e=0,i=r.length;e<i;++e)if(o=this.clone().startOf("day").valueOf(),r[e].since<=o&&o<=r[e].until||r[e].until<=o&&o<=r[e].since)return r[e].abbr;return""}function dM(){var e,i,o,r,a=this.localeData().eras();for(e=0,i=a.length;e<i;++e)if(o=a[e].since<=a[e].until?1:-1,r=this.clone().startOf("day").valueOf(),a[e].since<=r&&r<=a[e].until||a[e].until<=r&&r<=a[e].since)return(this.year()-nt(a[e].since).year())*o+a[e].offset;return this.year()}function uM(e){return xt(this,"_erasNameRegex")||ms.call(this),e?this._erasNameRegex:this._erasRegex}function hM(e){return xt(this,"_erasAbbrRegex")||ms.call(this),e?this._erasAbbrRegex:this._erasRegex}function pM(e){return xt(this,"_erasNarrowRegex")||ms.call(this),e?this._erasNarrowRegex:this._erasRegex}function Ur(e,i){return i.erasAbbrRegex(e)}function mM(e,i){return i.erasNameRegex(e)}function fM(e,i){return i.erasNarrowRegex(e)}function gM(e,i){return i._eraYearOrdinalRegex||Qn}function ms(){var e=[],i=[],o=[],r=[],a,s,l,c,d,u=this.eras();for(a=0,s=u.length;a<s;++a)l=Xe(u[a].name),c=Xe(u[a].abbr),d=Xe(u[a].narrow),i.push(l),e.push(c),o.push(d),r.push(l),r.push(c),r.push(d);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+i.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+o.join("|")+")","i")}ut(0,["gg",2],0,function(){return this.weekYear()%100}),ut(0,["GG",2],0,function(){return this.isoWeekYear()%100});function so(e,i){ut(0,[e,e.length],0,i)}so("gggg","weekYear"),so("ggggg","weekYear"),so("GGGG","isoWeekYear"),so("GGGGG","isoWeekYear"),ot("G",Yo),ot("g",Yo),ot("GG",Et,he),ot("gg",Et,he),ot("GGGG",ya,ga),ot("gggg",ya,ga),ot("GGGGG",Uo,Vo),ot("ggggg",Uo,Vo),Hi(["gggg","ggggg","GGGG","GGGGG"],function(e,i,o,r){i[r.substr(0,2)]=Ct(e)}),Hi(["gg","GG"],function(e,i,o,r){i[r]=nt.parseTwoDigitYear(e)});function yM(e){return Mu.call(this,e,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function vM(e){return Mu.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function bM(){return Ze(this.year(),1,4)}function CM(){return Ze(this.isoWeekYear(),1,4)}function wM(){var e=this.localeData()._week;return Ze(this.year(),e.dow,e.doy)}function kM(){var e=this.localeData()._week;return Ze(this.weekYear(),e.dow,e.doy)}function Mu(e,i,o,r,a){var s;return e==null?Vi(this,r,a).year:(s=Ze(e,r,a),i>s&&(i=s),_M.call(this,e,i,o,r,a))}function _M(e,i,o,r,a){var s=cu(e,i,o,r,a),l=Ri(s.year,0,s.dayOfYear);return this.year(l.getUTCFullYear()),this.month(l.getUTCMonth()),this.date(l.getUTCDate()),this}ut("Q",0,"Qo","quarter"),ot("Q",nu),Lt("Q",function(e,i){i[We]=(Ct(e)-1)*3});function xM(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}ut("D",["DD",2],"Do","date"),ot("D",Et,hi),ot("DD",Et,he),ot("Do",function(e,i){return e?i._dayOfMonthOrdinalParse||i._ordinalParse:i._dayOfMonthOrdinalParseLenient}),Lt(["D","DD"],Te),Lt("Do",function(e,i){i[Te]=Ct(e.match(Et)[0])});var Gl=mi("Date",!0);ut("DDD",["DDDD",3],"DDDo","dayOfYear"),ot("DDD",_o),ot("DDDD",iu),Lt(["DDD","DDDD"],function(e,i,o){o._dayOfYear=Ct(e)});function SM(e){var i=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?i:this.add(e-i,"d")}ut("m",["mm",2],0,"minute"),ot("m",Et,os),ot("mm",Et,he),Lt(["m","mm"],_e);var MM=mi("Minutes",!1);ut("s",["ss",2],0,"second"),ot("s",Et,os),ot("ss",Et,he),Lt(["s","ss"],je);var AM=mi("Seconds",!1);ut("S",0,0,function(){return~~(this.millisecond()/100)}),ut(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),ut(0,["SSS",3],0,"millisecond"),ut(0,["SSSS",4],0,function(){return this.millisecond()*10}),ut(0,["SSSSS",5],0,function(){return this.millisecond()*100}),ut(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),ut(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),ut(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),ut(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),ot("S",_o,nu),ot("SS",_o,he),ot("SSS",_o,iu);var pn,Au;for(pn="SSSS";pn.length<=9;pn+="S")ot(pn,Qn);function NM(e,i){i[Ln]=Ct(("0."+e)*1e3)}for(pn="S";pn.length<=9;pn+="S")Lt(pn,NM);Au=mi("Milliseconds",!1),ut("z",0,0,"zoneAbbr"),ut("zz",0,0,"zoneName");function LM(){return this._isUTC?"UTC":""}function DM(){return this._isUTC?"Coordinated Universal Time":""}var X=ji.prototype;X.add=k7,X.calendar=L7,X.clone=D7,X.diff=z7,X.endOf=j7,X.format=V7,X.from=U7,X.fromNow=Y7,X.to=G7,X.toNow=F7,X.get=Rx,X.invalidAt=nM,X.isAfter=I7,X.isBefore=O7,X.isBetween=T7,X.isSame=E7,X.isSameOrAfter=P7,X.isSameOrBefore=$7,X.isValid=tM,X.lang=wu,X.locale=Cu,X.localeData=ku,X.max=t7,X.min=QS,X.parsingFlags=eM,X.set=Vx,X.startOf=W7,X.subtract=_7,X.toArray=J7,X.toObject=K7,X.toDate=Z7,X.toISOString=B7,X.inspect=R7,typeof Symbol<"u"&&Symbol.for!=null&&(X[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),X.toJSON=Q7,X.toString=H7,X.unix=X7,X.valueOf=q7,X.creationData=iM,X.eraName=sM,X.eraNarrow=lM,X.eraAbbr=cM,X.eraYear=dM,X.year=$l,X.isLeapYear=Bx,X.weekYear=yM,X.isoWeekYear=vM,X.quarter=X.quarters=xM,X.month=zl,X.daysInMonth=Zx,X.week=X.weeks=oS,X.isoWeek=X.isoWeeks=rS,X.weeksInYear=wM,X.weeksInWeekYear=kM,X.isoWeeksInYear=bM,X.isoWeeksInISOWeekYear=CM,X.date=Gl,X.day=X.days=vS,X.weekday=bS,X.isoWeekday=CS,X.dayOfYear=SM,X.hour=X.hours=AS,X.minute=X.minutes=MM,X.second=X.seconds=AM,X.millisecond=X.milliseconds=Au,X.utcOffset=c7,X.utc=u7,X.local=h7,X.parseZone=p7,X.hasAlignedHourOffset=m7,X.isDST=f7,X.isLocal=y7,X.isUtcOffset=v7,X.isUtc=Ul,X.isUTC=Ul,X.zoneAbbr=LM,X.zoneName=DM,X.dates=ye("dates accessor is deprecated. Use date instead.",Gl),X.months=ye("months accessor is deprecated. Use month instead",zl),X.years=ye("years accessor is deprecated. Use year instead",$l),X.zone=ye("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",d7),X.isDSTShifted=ye("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",g7);function IM(e){return Pt(e*1e3)}function OM(){return Pt.apply(null,arguments).parseZone()}function Fl(e){return e}var _t=es.prototype;_t.calendar=yx,_t.longDateFormat=wx,_t.invalidDate=_x,_t.ordinal=Mx,_t.preparse=Fl,_t.postformat=Fl,_t.relativeTime=Nx,_t.pastFuture=Lx,_t.set=fx,_t.eras=oM,_t.erasParse=rM,_t.erasConvertYear=aM,_t.erasAbbrRegex=hM,_t.erasNameRegex=uM,_t.erasNarrowRegex=pM,_t.months=Wx,_t.monthsShort=jx,_t.monthsParse=Xx,_t.monthsRegex=Kx,_t.monthsShortRegex=Jx,_t.week=tS,_t.firstDayOfYear=iS,_t.firstDayOfWeek=nS,_t.weekdays=pS,_t.weekdaysMin=fS,_t.weekdaysShort=mS,_t.weekdaysParse=yS,_t.weekdaysRegex=wS,_t.weekdaysShortRegex=kS,_t.weekdaysMinRegex=_S,_t.isPM=SS,_t.meridiem=NS;function qo(e,i,o,r){var a=en(),s=Be().set(r,i);return a[o](s,e)}function Nu(e,i,o){if(Ke(e)&&(i=e,e=void 0),e=e||"",i!=null)return qo(e,i,o,"month");var r,a=[];for(r=0;r<12;r++)a[r]=qo(e,r,o,"month");return a}function fs(e,i,o,r){typeof e=="boolean"?(Ke(i)&&(o=i,i=void 0),i=i||""):(i=e,o=i,e=!1,Ke(i)&&(o=i,i=void 0),i=i||"");var a=en(),s=e?a._week.dow:0,l,c=[];if(o!=null)return qo(i,(o+s)%7,r,"day");for(l=0;l<7;l++)c[l]=qo(i,(l+s)%7,r,"day");return c}function TM(e,i){return Nu(e,i,"months")}function EM(e,i){return Nu(e,i,"monthsShort")}function PM(e,i,o){return fs(e,i,o,"weekdays")}function $M(e,i,o){return fs(e,i,o,"weekdaysShort")}function zM(e,i,o){return fs(e,i,o,"weekdaysMin")}mn("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var i=e%10,o=Ct(e%100/10)===1?"th":i===1?"st":i===2?"nd":i===3?"rd":"th";return e+o}}),nt.lang=ye("moment.lang is deprecated. Use moment.locale instead.",mn),nt.langData=ye("moment.langData is deprecated. Use moment.localeData instead.",en);var Ye=Math.abs;function HM(){var e=this._data;return this._milliseconds=Ye(this._milliseconds),this._days=Ye(this._days),this._months=Ye(this._months),e.milliseconds=Ye(e.milliseconds),e.seconds=Ye(e.seconds),e.minutes=Ye(e.minutes),e.hours=Ye(e.hours),e.months=Ye(e.months),e.years=Ye(e.years),this}function Lu(e,i,o,r){var a=Ae(i,o);return e._milliseconds+=r*a._milliseconds,e._days+=r*a._days,e._months+=r*a._months,e._bubble()}function BM(e,i){return Lu(this,e,i,1)}function RM(e,i){return Lu(this,e,i,-1)}function Wl(e){return e<0?Math.floor(e):Math.ceil(e)}function VM(){var e=this._milliseconds,i=this._days,o=this._months,r=this._data,a,s,l,c,d;return e>=0&&i>=0&&o>=0||e<=0&&i<=0&&o<=0||(e+=Wl(wa(o)+i)*864e5,i=0,o=0),r.milliseconds=e%1e3,a=ge(e/1e3),r.seconds=a%60,s=ge(a/60),r.minutes=s%60,l=ge(s/60),r.hours=l%24,i+=ge(l/24),d=ge(Du(i)),o+=d,i-=Wl(wa(d)),c=ge(o/12),o%=12,r.days=i,r.months=o,r.years=c,this}function Du(e){return e*4800/146097}function wa(e){return e*146097/4800}function UM(e){if(!this.isValid())return NaN;var i,o,r=this._milliseconds;if(e=be(e),e==="month"||e==="quarter"||e==="year")switch(i=this._days+r/864e5,o=this._months+Du(i),e){case"month":return o;case"quarter":return o/3;case"year":return o/12}else switch(i=this._days+Math.round(wa(this._months)),e){case"week":return i/7+r/6048e5;case"day":return i+r/864e5;case"hour":return i*24+r/36e5;case"minute":return i*1440+r/6e4;case"second":return i*86400+r/1e3;case"millisecond":return Math.floor(i*864e5)+r;default:throw new Error("Unknown unit "+e)}}function nn(e){return function(){return this.as(e)}}var Iu=nn("ms"),YM=nn("s"),GM=nn("m"),FM=nn("h"),WM=nn("d"),jM=nn("w"),qM=nn("M"),XM=nn("Q"),ZM=nn("y"),JM=Iu;function KM(){return Ae(this)}function QM(e){return e=be(e),this.isValid()?this[e+"s"]():NaN}function Un(e){return function(){return this.isValid()?this._data[e]:NaN}}var t9=Un("milliseconds"),e9=Un("seconds"),n9=Un("minutes"),i9=Un("hours"),o9=Un("days"),r9=Un("months"),a9=Un("years");function s9(){return ge(this.days()/7)}var Ge=Math.round,ti={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function l9(e,i,o,r,a){return a.relativeTime(i||1,!!o,e,r)}function c9(e,i,o,r){var a=Ae(e).abs(),s=Ge(a.as("s")),l=Ge(a.as("m")),c=Ge(a.as("h")),d=Ge(a.as("d")),u=Ge(a.as("M")),m=Ge(a.as("w")),y=Ge(a.as("y")),v=s<=o.ss&&["s",s]||s<o.s&&["ss",s]||l<=1&&["m"]||l<o.m&&["mm",l]||c<=1&&["h"]||c<o.h&&["hh",c]||d<=1&&["d"]||d<o.d&&["dd",d];return o.w!=null&&(v=v||m<=1&&["w"]||m<o.w&&["ww",m]),v=v||u<=1&&["M"]||u<o.M&&["MM",u]||y<=1&&["y"]||["yy",y],v[2]=i,v[3]=+e>0,v[4]=r,l9.apply(null,v)}function d9(e){return e===void 0?Ge:typeof e=="function"?(Ge=e,!0):!1}function u9(e,i){return ti[e]===void 0?!1:i===void 0?ti[e]:(ti[e]=i,e==="s"&&(ti.ss=i-1),!0)}function h9(e,i){if(!this.isValid())return this.localeData().invalidDate();var o=!1,r=ti,a,s;return typeof e=="object"&&(i=e,e=!1),typeof e=="boolean"&&(o=e),typeof i=="object"&&(r=Object.assign({},ti,i),i.s!=null&&i.ss==null&&(r.ss=i.s-1)),a=this.localeData(),s=c9(this,!o,r,a),o&&(s=a.pastFuture(+this,s)),a.postformat(s)}var Yr=Math.abs;function qn(e){return(e>0)-(e<0)||+e}function lo(){if(!this.isValid())return this.localeData().invalidDate();var e=Yr(this._milliseconds)/1e3,i=Yr(this._days),o=Yr(this._months),r,a,s,l,c=this.asSeconds(),d,u,m,y;return c?(r=ge(e/60),a=ge(r/60),e%=60,r%=60,s=ge(o/12),o%=12,l=e?e.toFixed(3).replace(/\.?0+$/,""):"",d=c<0?"-":"",u=qn(this._months)!==qn(c)?"-":"",m=qn(this._days)!==qn(c)?"-":"",y=qn(this._milliseconds)!==qn(c)?"-":"",d+"P"+(s?u+s+"Y":"")+(o?u+o+"M":"")+(i?m+i+"D":"")+(a||r||e?"T":"")+(a?y+a+"H":"")+(r?y+r+"M":"")+(e?y+l+"S":"")):"P0D"}var wt=ur.prototype;wt.isValid=r7,wt.abs=HM,wt.add=BM,wt.subtract=RM,wt.as=UM,wt.asMilliseconds=Iu,wt.asSeconds=YM,wt.asMinutes=GM,wt.asHours=FM,wt.asDays=WM,wt.asWeeks=jM,wt.asMonths=qM,wt.asQuarters=XM,wt.asYears=ZM,wt.valueOf=JM,wt._bubble=VM,wt.clone=KM,wt.get=QM,wt.milliseconds=t9,wt.seconds=e9,wt.minutes=n9,wt.hours=i9,wt.days=o9,wt.weeks=s9,wt.months=r9,wt.years=a9,wt.humanize=h9,wt.toISOString=lo,wt.toString=lo,wt.toJSON=lo,wt.locale=Cu,wt.localeData=ku,wt.toIsoString=ye("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",lo),wt.lang=wu,ut("X",0,0,"unix"),ut("x",0,0,"valueOf"),ot("x",Yo),ot("X",Tx),Lt("X",function(e,i,o){o._d=new Date(parseFloat(e)*1e3)}),Lt("x",function(e,i,o){o._d=new Date(Ct(e))});nt.version="2.30.1",px(Pt),nt.fn=X,nt.min=e7,nt.max=n7,nt.now=i7,nt.utc=Be,nt.unix=IM,nt.months=TM,nt.isDate=Wi,nt.locale=mn,nt.invalid=lr,nt.duration=Ae,nt.isMoment=Me,nt.weekdays=PM,nt.parseZone=OM,nt.localeData=en,nt.isDuration=So,nt.monthsShort=EM,nt.weekdaysMin=zM,nt.defineLocale=ls,nt.updateLocale=OS,nt.locales=TS,nt.weekdaysShort=$M,nt.normalizeUnits=be,nt.relativeTimeRounding=d9,nt.relativeTimeThreshold=u9,nt.calendarFormat=N7,nt.prototype=X,nt.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const p9=async function(e,i,o){const r=e.groups;r.push(o);let a=r.map(s=>encodeURIComponent(s));return a=a.filter(s=>s!==encodeURIComponent(i)),xe.patch(e.url,{},{headers:{"X-PROPERTY":"CATEGORIES","X-PROPERTY-REPLACE":a.join(",")}})},m9=async function(e,i){let o=e.groups.map(r=>encodeURIComponent(r));return o=o.filter(r=>r!==encodeURIComponent(i)),xe.patch(e.url,{},{headers:{"X-PROPERTY":"CATEGORIES","X-PROPERTY-REPLACE":o.join(",")}})},f9={name:"FolderEditOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},g9=["aria-hidden","aria-label"],y9=["fill","width","height"],v9={d:"M4 18H12.13L11 19.13V20H4C2.9 20 2 19.11 2 18V6C2 4.89 2.89 4 4 4H10L12 6H20C21.1 6 22 6.89 22 8V10.15C21.74 10.06 21.46 10 21.17 10C20.75 10 20.36 10.11 20 10.3V8H4V18M22.85 13.47L21.53 12.15C21.33 11.95 21 11.95 20.81 12.15L19.83 13.13L21.87 15.17L22.85 14.19C23.05 14 23.05 13.67 22.85 13.47M13 19.96V22H15.04L21.17 15.88L19.13 13.83L13 19.96Z"},b9={key:0};function C9(e,i,o,r,a,s){return p(),C("span",pt(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon folder-edit-outline-icon",role:"img",onClick:i[0]||(i[0]=l=>e.$emit("click",l))}),[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[T("path",v9,[o.title?(p(),C("title",b9,E(o.title),1)):P("",!0)])],8,y9))],16,g9)}const w9=Q(f9,[["render",C9]]),k9={name:"GroupNavigationItem",components:{ActionButton:gn,NcCounterBubble:nr,AppNavigationItem:Oa,ActionInput:Ta,IconContact:Vn,IconAdd:Gi,IconDownload:sr,IconEmail:yc,IconRename:w9,IconDelete:tn,IconLoading:me},props:{group:{type:Object,required:!0}},data(){return{newGroupName:"",renaming:!1,deleting:!1}},computed:{contacts(){return this.$store.getters.getContacts},isEmpty(){return this.group.contacts.length===0}},methods:{isInGroup(e,i){return e.includes(i)},async onDrop(e,i){try{const o=JSON.parse(e.dataTransfer.getData("item")),r=this.$store.getters.getContact(ve.from(`${o.uid}~${o.addressbookId}`,"utf-8").toString("base64"));if(r&&!this.isInGroup(r.groups,i.id)){const a=this.$store.getters.getContact(ve.from(`${o.uid}~${o.addressbookId}`,"utf-8").toString("base64"));await this.$store.dispatch("updateContactGroups",{groupNames:[...r.groups,i.id],contact:a});const s=Object.assign(Object.create(Object.getPrototypeOf(a)),a);s.groups=[...r.groups,i.id],await this.$store.dispatch("updateContact",s)}}catch(o){console.error(o),vt("Tried to drop an invalid contact!")}finally{e.target.closest(".group-drop-area").removeAttribute("drop-active")}},onDragOver(e){e.preventDefault(),e.target.closest(".group-drop-area").setAttribute("drop-active",!0)},onDragLeave(e){e.target.closest(".group-drop-area").removeAttribute("drop-active")},addContactsToGroup(){si("contacts:group:append",this.group.name)},downloadGroup(e){let i={};e.contacts.forEach(r=>{const a=this.contacts[r].addressbook.id;i=Object.assign({[a]:{addressbook:this.contacts[r].addressbook,contacts:[]}},i),i[a].contacts.push(this.contacts[r].url)});const o=Promise.all(Object.keys(i).map(r=>i[r].addressbook.dav.addressbookMultigetExport(i[r].contacts))).then(r=>({groupName:e.name,data:r.map(a=>a.body).join("")}));this.downloadVcardPromise(o)},async downloadVcardPromise(e){e.then(i=>{const o=nt().format("YYYY-MM-DD_HH-mm")+"_"+i.groupName+".vcf",r="data:text/plain;charset=utf-8,"+window.encodeURIComponent(i.data);hx(r,o,"text/vcard")})},emailGroup(e,i="to"){const o=[];e.contacts.filter(r=>this.contacts[r].email!==null).forEach(r=>{const a=this.contacts[r].email.replace(/(.*<)([^>]*)(>)/g,"$2").trim(),s=this.contacts[r].fullName.replace(/[,<>]/g,"").trim();if(a!==""){if(s===null||s===""){o.push(a);return}o.push(`${s} <${a}>`)}}),window.location.href=`mailto:?${i}=${o.map(encodeURIComponent).join(",")}`},async renameGroup(){if(this.newGroupName!==""){this.renaming=!0;for(const e of this.group.contacts){const i=this.$store.getters.getContact(e);if(i===void 0)return;try{await p9(i,this.group.name,this.newGroupName)}catch(o){console.error("Error renaming group",o)}}this.$store.commit("renameGroup",{oldGroupName:this.group.name,newGroupName:this.newGroupName}),this.renaming=!1}},async deleteGroup(){this.deleting=!0;for(const e of this.group.contacts){const i=this.$store.getters.getContact(e);if(i===void 0)return;try{await m9(i,this.group.name)}catch(o){console.error("Error deleting group",o)}}this.$store.commit("removeGroup",this.group.name),this.deleting=!1}}};function _9(e,i,o,r,a,s){const l=b("IconContact"),c=b("IconAdd"),d=b("ActionButton"),u=b("IconLoading"),m=b("IconRename"),y=b("ActionInput"),v=b("IconDownload"),w=b("IconEmail"),D=b("IconDelete"),S=b("NcCounterBubble"),R=b("AppNavigationItem");return s.isEmpty?P("",!0):(p(),C("div",{key:0,class:"group-drop-area","data-testid":"group-drop-area",onDrop:i[5]||(i[5]=A=>s.onDrop(A,o.group)),onDragenter:i[6]||(i[6]=Wt(()=>{},["prevent"])),onDragover:i[7]||(i[7]=A=>s.onDragOver(A)),onDragleave:i[8]||(i[8]=A=>s.onDragLeave(A))},[(p(),O(R,{key:o.group.key,to:o.group.router,name:o.group.name},{icon:_(()=>[M(l,{size:20})]),actions:_(()=>[M(d,{"close-after-click":!0,onClick:i[0]||(i[0]=A=>s.addContactsToGroup(o.group))},{icon:_(()=>[M(c,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Add contacts")),1)]),_:1}),M(y,{"model-value":a.newGroupName,"onUpdate:modelValue":i[1]||(i[1]=A=>a.newGroupName=A),disabled:a.renaming,onSubmit:s.renameGroup},{icon:_(()=>[a.renaming?(p(),O(u,{key:0,size:20})):(p(),O(m,{key:1,size:20}))]),default:_(()=>[K(" "+E(e.t("contacts","Rename")),1)]),_:1},8,["model-value","disabled","onSubmit"]),M(d,{"close-after-click":!0,onClick:i[2]||(i[2]=A=>s.downloadGroup(o.group))},{icon:_(()=>[M(v,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Export")),1)]),_:1}),M(d,{onClick:i[3]||(i[3]=A=>s.emailGroup(o.group))},{icon:_(()=>[M(w,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Send email")),1)]),_:1}),M(d,{onClick:i[4]||(i[4]=A=>s.emailGroup(o.group,"bcc"))},{icon:_(()=>[M(w,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Send email as BCC")),1)]),_:1}),M(d,{disabled:a.deleting,onClick:s.deleteGroup},{icon:_(()=>[a.deleting?(p(),O(u,{key:0,size:20})):(p(),O(D,{key:1,size:20}))]),default:_(()=>[K(" "+E(e.t("contacts","Delete")),1)]),_:1},8,["disabled","onClick"])]),counter:_(()=>[o.group.contacts.length>0?(p(),O(S,{key:0,count:o.group.contacts.length},null,8,["count"])):P("",!0)]),_:1},8,["to","name"]))],32))}const x9=Q(k9,[["render",_9],["__scopeId","data-v-a38ebff6"]]),S9={name:"NewCircleIntro",components:{CheckboxRadioSwitch:Yi,Modal:yn},props:{loading:{type:Boolean,default:!1}},data(){return{circleName:"",isPersonal:!1,isLocal:!1,CIRCLE_DESC:wc}},computed:{isEmptyName(){return this.circleName.trim()===""},isGlobalScale(){return Y1().circles?.status?.globalScale!==!1}},mounted(){this.$nextTick(()=>{this.$refs.input.focus(),this.$refs.input.select()})},methods:{onCancel(){this.$emit("close")},onSubmit(){this.$emit("submit",this.circleName,this.isPersonal,this.isLocal)}}},M9={class:"entity-picker"},A9={class:"entity-picker__new"},N9=["placeholder"],L9={class:"entity-picker__content"},D9={class:"entity-picker__navigation"},I9=["disabled"],O9=["disabled"];function T9(e,i,o,r,a,s){const l=b("CheckboxRadioSwitch"),c=b("Modal");return p(),O(c,{size:"normal",onClose:s.onCancel},{default:_(()=>[T("div",M9,[T("div",A9,[ue(T("input",{ref:"input","onUpdate:modelValue":i[0]||(i[0]=d=>a.circleName=d),placeholder:e.t("contacts","New team name"),class:"entity-picker__new-input",type:"text",onKeypress:i[1]||(i[1]=Ko((...d)=>s.onSubmit&&s.onSubmit(...d),["enter"]))},null,40,N9),[[In,a.circleName]])]),T("div",L9,[T("p",null,E(a.CIRCLE_DESC),1),i[6]||(i[6]=T("br",null,null,-1)),P("",!0),s.isGlobalScale?(p(),C(mt,{key:1},[M(l,{"model-value":a.isLocal,"onUpdate:modelValue":i[3]||(i[3]=d=>a.isLocal=d),disabled:o.loading!==!1},{default:_(()=>[K(E(e.t("contacts","Local team")),1)]),_:1},8,["model-value","disabled"]),T("p",null,E(e.t("contacts","This team will not be shared with the other instances of the global scale")),1)],64)):P("",!0)]),T("div",D9,[T("button",{disabled:o.loading,class:"navigation__button-left",onClick:i[4]||(i[4]=(...d)=>s.onCancel&&s.onCancel(...d))},E(e.t("contacts","Cancel")),9,I9),T("button",{disabled:s.isEmptyName||o.loading,class:"navigation__button-right primary",onClick:i[5]||(i[5]=(...d)=>s.onSubmit&&s.onSubmit(...d))},E(e.t("contacts","Create team")),9,O9)])])]),_:1},8,["onClose"])}const E9=Q(S9,[["render",T9],["__scopeId","data-v-e4cd0734"]]),P9=$n("contacts","isContactsInteractionEnabled",!1),$9={name:"IconRecentlyContacted",props:{title:{type:String,default:""},size:{type:Number,default:20},fillColor:{type:String,default:"currentColor"}}},z9=["aria-hidden","aria-label"],H9=["fill","width","height"];function B9(e,i,o,r,a,s){return p(),C("span",{"aria-hidden":!o.title,"aria-label":o.title,class:"material-design-icon icon-recently-contacted",role:"img"},[(p(),C("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 16 16"},i[0]||(i[0]=[T("path",{d:"M0 0h24v24H0V0z",fill:"none"},null,-1),T("path",{d:"M14 3v10h1V3zM12 13h1V3h-1zM1.7 3a.7.7 0 00-.7.7v8.6c0 .4.3.7.7.7h8.6c.4 0 .7-.3.7-.7V3.7a.7.7 0 00-.7-.7zM6 5a1.6 1.6 0 010 3.2A1.6 1.6 0 016 5zm0 4.4c1 0 3.2.6 3.2 1.6v.6H2.8V11c0-1 2.1-1.6 3.2-1.6z"},null,-1)]),8,H9))],8,z9)}const R9=Q($9,[["render",B9]]),V9={name:"RootNavigation",components:{ActionInput:Ta,ActionText:La,NcActionButton:gn,AppNavigation:G1,NcCounterBubble:nr,AppNavigationItem:Oa,AppNavigationCaption:F1,CircleNavigationItem:H6,Cog:Ha,ContactsSettings:dx,GroupNavigationItem:x9,IconContact:Vn,IconUser:Ti,IconAdd:Gi,IconError:qd,IconLoading:me,IconRecentlyContacted:R9,NewCircleIntro:E9},mixins:[vn],props:{loading:{type:Boolean,default:!0},contactsList:{type:Array,required:!0}},data(){return{CIRCLE_DESC:wc,CONTACTS_SETTINGS:Cc,ELLIPSIS_COUNT:xr,GROUP_ALL_CONTACTS:uo,CHART_ALL_CONTACTS:ym,GROUP_NO_GROUP_CONTACTS:ho,GROUP_RECENTLY_CONTACTED:Sr,isNewGroupMenuOpen:!1,createGroupError:null,isNewCircleModalOpen:!1,createCircleLoading:!1,createCircleError:null,isCirclesEnabled:jr,isContactsInteractionEnabled:P9,collapsedGroups:!0,collapsedCircles:!0,showSettings:!1}},computed:{circles(){return this.$store.getters.getCircles},contacts(){const e=this.$store.getters.getContacts;return e.undefined&&(e[this.selectedContact]=e.undefined,delete e.undefined),this.$store.getters.getContacts},groups(){return this.$store.getters.getGroups},sortedContacts(){return this.$store.getters.getSortedContacts},ungroupedContacts(){return this.sortedContacts.filter(e=>this.contacts[e.key]?.groups&&this.contacts[e.key]?.groups?.length===0)},existChart(){return!!Object.keys(this.contacts).filter(e=>this.contacts[e].managersName).length},groupsMenu(){const e=this.groups.map(o=>Object.assign({},o,{id:o.name.replace(" ","_"),key:o.name.replace(" ","_"),router:{name:"group",params:{selectedGroup:o.name}},toString:()=>o.name}));e.sort((o,r)=>ha(o.toString(),r.toString(),{caseInsensitive:!0}));const i=e.findIndex(o=>o.name===Sr);return i>=0&&e.splice(i,1),e},ellipsisGroupsMenu(){return this.isCirclesEnabled&&this.collapsedGroups?this.groupsMenu.slice(0,xr):this.groupsMenu},circlesMenu(){const e=this.circles||[];return e.sort((i,o)=>i?.initiator?.level!==o?.initiator?.level&&i?.initiator?.level&&o?.initiator?.level?o.initiator.level-i.initiator.level:i.initiator&&!o.initiator?-1:!i.initiator&&o.initiator?1:ha(i.toString(),o.toString(),{caseInsensitive:!0})),e},ellipsisCirclesMenu(){return this.collapsedCircles?this.circlesMenu.slice(0,xr):this.circlesMenu},recentlyContactedContacts(){return this.groups.find(e=>e.name===Sr)},collapseGroupsTitle(){return this.collapsedGroups?t("contacts","Show all groups"):t("contacts","Collapse groups")},collapseCirclesTitle(){return this.collapsedCircles?t("contacts","Show all teams"):t("contacts","Collapse teams")}},methods:{toggleNewGroupMenu(){this.isNewGroupMenuOpen=!this.isNewGroupMenuOpen},createNewGroup(e){const i=e.target.querySelector("input[type=text]").value.trim();if(i.length===0){vt(t("contacts","Group name cannot be empty"));return}if(this.logger.debug("Creating new group",{groupName:i}),this.groups.find(o=>o.name===i)){this.createGroupError=t("contacts","This group already exists"),si("contacts:group:append",this.groups.find(o=>o.name===i).name);return}this.createGroupError=null,this.logger.debug("Created new local group",{groupName:i});try{this.$store.dispatch("addGroup",i),this.isNewGroupMenuOpen=!1,si("contacts:group:append",i)}catch{vt(t("contacts","An error occurred while creating the group"))}},onToggleGroups(){this.collapsedGroups=!this.collapsedGroups},onToggleCircles(){this.collapsedCircles=!this.collapsedCircles},toggleNewCircleModal(){this.isNewCircleModalOpen=!0},async createNewCircle(e,i,o){if(this.logger.debug("Creating new team",{circleName:e}),this.createCircleLoading=!0,this.circles.find(r=>r.name===e)){this.createCircleError=t("contacts","This team already exists");return}this.createCircleError=null;try{const r=await this.$store.dispatch("createCircle",{circleName:e,isPersonal:i,isLocal:o});this.closeNewCircleIntro(),this.$router.push({name:"circle",params:{selectedCircle:r.id}})}catch{vt(t("contacts","An error happened during the creation of the team"))}finally{this.createCircleLoading=!1}},closeNewCircleIntro(){this.isNewCircleModalOpen=!1},showContactsSettings(){this.showSettings=!0}}},U9={class:"header"},Y9={class:"app-navigation__circle-desc"},G9={class:"contacts-settings"};function F9(e,i,o,r,a,s){const l=b("IconLoading"),c=b("IconContact"),d=b("NcCounterBubble"),u=b("AppNavigationItem"),m=b("IconUser"),y=b("IconRecentlyContacted"),v=b("IconAdd"),w=b("IconError"),D=b("ActionText"),S=b("ActionInput"),R=b("AppNavigationCaption"),A=b("GroupNavigationItem"),V=b("NcActionButton"),W=b("NewCircleIntro"),it=b("CircleNavigationItem"),et=b("Cog"),st=b("ContactsSettings"),lt=b("AppNavigation");return p(),O(lt,null,{icon:_(()=>[o.loading?(p(),O(l,{key:0,size:20})):P("",!0)]),search:_(()=>[T("header",U9,[Tt(e.$slots,"default",{},void 0,!0)])]),list:_(()=>[M(u,{id:"everyone",name:a.GROUP_ALL_CONTACTS,to:{name:"group",params:{selectedGroup:a.GROUP_ALL_CONTACTS}}},{icon:_(()=>[M(c,{size:20})]),counter:_(()=>[s.sortedContacts.length?(p(),O(d,{key:0,count:s.sortedContacts.length},null,8,["count"])):P("",!0)]),_:1},8,["name","to"]),s.existChart?(p(),O(u,{key:0,id:"chart",name:a.CHART_ALL_CONTACTS,to:{name:"chart",params:{selectedChart:a.GROUP_ALL_CONTACTS}},icon:"icon-category-monitoring"},null,8,["name","to"])):P("",!0),s.ungroupedContacts.length>0?(p(),O(u,{key:1,id:"notgrouped",name:a.GROUP_NO_GROUP_CONTACTS,to:{name:"group",params:{selectedGroup:a.GROUP_NO_GROUP_CONTACTS}}},{icon:_(()=>[M(m,{size:20})]),counter:_(()=>[s.ungroupedContacts.length?(p(),O(d,{key:0,count:s.ungroupedContacts.length},null,8,["count"])):P("",!0)]),_:1},8,["name","to"])):P("",!0),a.isContactsInteractionEnabled&&s.recentlyContactedContacts&&s.recentlyContactedContacts.contacts.length>0?(p(),O(u,{key:2,id:"recentlycontacted",name:e.t("contacts","Recently contacted"),to:{name:"group",params:{selectedGroup:a.GROUP_RECENTLY_CONTACTED}}},{icon:_(()=>[M(y,{size:20})]),counter:_(()=>[s.recentlyContactedContacts.contacts.length?(p(),O(d,{key:0,count:s.recentlyContactedContacts.contacts.length},null,8,["count"])):P("",!0)]),_:1},8,["name","to"])):P("",!0),M(R,{id:"newgroup","menu-open":a.isNewGroupMenuOpen,"onUpdate:menuOpen":i[0]||(i[0]=ht=>a.isNewGroupMenuOpen=ht),"force-menu":!0,name:e.t("contacts","Contact groups"),onClick:Wt(s.toggleNewGroupMenu,["prevent","stop"])},{actionsTriggerIcon:_(()=>[M(v,{size:20})]),actions:_(()=>[ue(M(D,null,{icon:_(()=>[a.createGroupError?(p(),O(w,{key:0,size:20})):a.createGroupError?P("",!0):(p(),O(c,{key:1,size:20}))]),default:_(()=>[K(" "+E(a.createGroupError?a.createGroupError:e.t("contacts","Create a new contact group")),1)]),_:1},512),[[Oi,a.isNewGroupMenuOpen]]),ue(M(S,{icon:"",placeholder:e.t("contacts","Contact group name"),onSubmit:Wt(s.createNewGroup,["prevent","stop"])},null,8,["placeholder","onSubmit"]),[[Oi,a.isNewGroupMenuOpen]])]),_:1},8,["menu-open","name","onClick"]),(p(!0),C(mt,null,It(s.ellipsisGroupsMenu,ht=>(p(),O(A,{key:ht.key,group:ht},null,8,["group"]))),128)),a.isCirclesEnabled?(p(),C(mt,{key:3},[s.groupsMenu.length>a.ELLIPSIS_COUNT?(p(),O(u,{key:0,name:s.collapseGroupsTitle,class:"app-navigation__collapse",icon:"",onClick:s.onToggleGroups},null,8,["name","onClick"])):P("",!0),M(R,{id:"newcircle",name:e.t("contacts","Teams")},{actions:_(()=>[M(V,{onClick:s.toggleNewCircleModal},{icon:_(()=>[M(v,{size:20})]),default:_(()=>[K(" "+E(e.t("contacts","Create a new team")),1)]),_:1},8,["onClick"])]),_:1},8,["name"]),a.isNewCircleModalOpen?(p(),O(W,{key:1,loading:a.createCircleLoading,onClose:s.closeNewCircleIntro,onSubmit:s.createNewCircle},null,8,["loading","onClose","onSubmit"])):P("",!0),s.circlesMenu.length>0?(p(),C(mt,{key:2},[(p(!0),C(mt,null,It(s.ellipsisCirclesMenu,ht=>(p(),O(it,{key:ht.key,circle:ht},null,8,["circle"]))),128)),s.circlesMenu.length>a.ELLIPSIS_COUNT?(p(),O(u,{key:0,name:s.collapseCirclesTitle,class:"app-navigation__collapse",icon:"",onClick:s.onToggleCircles},null,8,["name","onClick"])):P("",!0)],64)):P("",!0),T("p",Y9,E(a.CIRCLE_DESC),1)],64)):P("",!0)]),footer:_(()=>[T("div",G9,[M(u,{"aria-label":e.t("contacts","Open the contacts app settings"),name:a.CONTACTS_SETTINGS,onClick:s.showContactsSettings},{icon:_(()=>[M(et,{size:20})]),_:1},8,["aria-label","name","onClick"])])]),default:_(()=>[M(st,{open:a.showSettings,"onUpdate:open":i[1]||(i[1]=ht=>a.showSettings=ht)},null,8,["open"])]),_:3})}const W9=Q(V9,[["render",F9],["__scopeId","data-v-aa287647"]]),j9={name:"Contacts",components:{Button:ne,CircleContent:_y,ChartContent:Kw,ContactsContent:K8,ContactsPicker:d6,Content:W1,ImportView:m6,IconAdd:Gi,Modal:yn,RootNavigation:W9,SettingsImportContacts:Xd},mixins:[er,vn],data(){return{appName:mh,loadingCircles:jr,loadingContacts:!0}},computed:{addressbooks(){return this.$store.getters.getAddressbooks},contacts(){return this.$store.getters.getContacts},sortedContacts(){return this.$store.getters.getSortedContacts},groups(){return this.$store.getters.getGroups},circles(){return this.$store.getters.getCircles},orderKey(){return this.$store.getters.getOrderKey},importState(){return this.$store.getters.getImportState},isEmptyGroup(){return this.contactsList.length===0},isChartView(){return!!this.selectedChart},isImporting(){return this.importState.stage!=="default"},isImportDone(){return this.importState.stage==="done"},defaultAddressbook(){return this.addressbooks.find(e=>!e.readOnly&&e.enabled)},contactsList(){if(this.selectedGroup===uo)return this.sortedContacts;if(this.selectedGroup===ho)return this.ungroupedContacts.map(i=>this.sortedContacts.find(o=>o.key===i.key));if(this.selectedGroup===po)return[];const e=this.groups.filter(i=>i.name===this.selectedGroup)[0];return e?this.sortedContacts.filter(i=>e.contacts.indexOf(i.key)>=0):[]},isCirclesView(){return this.selectedGroup===po},ungroupedContacts(){return this.sortedContacts.filter(e=>this.contacts[e.key].groups&&this.contacts[e.key].groups.length===0)}},watch:{selectedGroup(){!this.isMobile&&!this.selectedChart&&this.selectFirstContactIfNone()},selectedContact(){!this.isMobile&&!this.selectedChart&&this.selectFirstContactIfNone()}},mounted(){this.isCirclesEnabled?this.logger.info("Circles frontend enabled"):this.logger.info("No compatible version of circles found")},async beforeMount(){co.connect({enableCardDAV:!0}).then(()=>{this.logger.debug("Connected to dav!",{client:co}),bc().setCurrentUserPrincipal(co),this.$store.dispatch("getAddressbooks").then(e=>{e.filter(i=>!i.readOnly).length===0?this.$store.dispatch("appendAddressbook",{displayName:t("contacts","Contacts")}).then(()=>{this.fetchContacts()}):this.fetchContacts()}),localStorage.getItem("orderKey")&&this.$store.commit("setOrder",localStorage.getItem("orderKey"))}),jr&&this.$store.dispatch("getCircles").then(()=>{this.loadingCircles=!1})},methods:{async newContact(){if(this.isCirclesView){si("contacts:circles:append",this.selectedCircle.id);return}const e=new Pa(`
				BEGIN:VCARD
				VERSION:4.0
				PRODID:-//Nextcloud Contacts v${fh}
				END:VCARD
			`.trim().replace(/\t/gm,""),this.defaultAddressbook);e.fullName=t("contacts","Name"),e.rev=Ia.Time.fromJSDate(new Date,!0);const i=Ee.properties;for(const o in i)if(i[o].default){const r=i[o].defaultValue;let a=r.value;Array.isArray(a)&&(a=[...a]);const s=e.vCard.addPropertyWithValue(o,a);r.type&&s.setParameter("type",r.type)}[uo,ho].indexOf(this.selectedGroup)===-1&&(e.groups=[this.selectedGroup]);try{await this.$store.dispatch("addContact",e),await this.$router.push({name:"contact",params:{selectedGroup:this.selectedGroup,selectedContact:e.key}})}catch(o){vt(t("contacts","Unable to create the contact.")),console.error(o)}},updateSorting(e="displayName"){this.$store.commit("setOrder",e),this.$store.commit("sortContacts")},fetchContacts(){Promise.all(this.addressbooks.map(e=>e.enabled?this.$store.dispatch("getContactsFromAddressBook",{addressbook:e}):Promise.resolve())).then(()=>{this.loadingContacts=!1,!this.isMobile&&!this.selectedChart&&this.selectFirstContactIfNone()})},selectFirstContactIfNone(){if(this.$route.name==="import")return;const e=this.contactsList.findIndex(i=>i.key===this.selectedContact)>-1;if(!this.selectedContact||!e){if(this.selectedContact&&!e&&(vt(t("contacts","Contact not found")),this.$router.push({name:"group",params:{selectedGroup:this.selectedGroup}})),!this.selectedCircle&&!this.groups.find(i=>i.name===this.selectedGroup)&&uo!==this.selectedGroup&&ho!==this.selectedGroup&&po!==this.selectedGroup){vt(t("contacts","Group {group} not found",{group:this.selectedGroup})),console.error("Group not found",this.selectedGroup),this.$router.push({name:"root"});return}Object.keys(this.contactsList).length&&this.$router.push({name:"contact",params:{selectedGroup:this.selectedGroup,selectedContact:Object.values(this.contactsList)[0].key}})}},closeImport(){this.$store.dispatch("changeStage","default")}}},q9={class:"import-and-new-contact-buttons"};function X9(e,i,o,r,a,s){const l=b("SettingsImportContacts"),c=b("IconAdd"),d=b("Button"),u=b("RootNavigation"),m=b("CircleContent"),y=b("ChartContent"),v=b("ContactsContent"),w=b("ImportView"),D=b("Modal"),S=b("ContactsPicker"),R=b("Content");return p(),O(R,{"app-name":a.appName},{default:_(()=>[M(u,{"contacts-list":s.contactsList,loading:a.loadingContacts||a.loadingCircles,"selected-group":e.selectedGroup,"selected-contact":e.selectedContact},{default:_(()=>[T("div",q9,[!a.loadingContacts&&s.isEmptyGroup&&!s.isChartView&&!s.isCirclesView?(p(),O(l,{key:0})):P("",!0),a.loadingContacts?P("",!0):(p(),O(d,{key:1,disabled:!s.defaultAddressbook,variant:"secondary",wide:"",onClick:s.newContact},{icon:_(()=>[M(c,{size:20})]),default:_(()=>[K(" "+E(s.isCirclesView?e.t("contacts","Add member"):e.t("contacts","New contact")),1)]),_:1},8,["disabled","onClick"]))])]),_:1},8,["contacts-list","loading","selected-group","selected-contact"]),e.selectedCircle?(p(),O(m,{key:0,loading:a.loadingCircles},null,8,["loading"])):e.selectedChart?(p(),O(y,{key:1,"contacts-list":s.contacts},null,8,["contacts-list"])):(p(),O(v,{key:2,"contacts-list":s.contactsList,loading:a.loadingContacts,onNewContact:s.newContact},null,8,["contacts-list","loading","onNewContact"])),s.isImporting?(p(),O(D,{key:3,"clear-view-delay":-1,"can-close":s.isImportDone,onClose:s.closeImport},{default:_(()=>[M(w,{onClose:s.closeImport},null,8,["onClose"])]),_:1},8,["can-close","onClose"])):P("",!0),M(S)]),_:1},8,["app-name"])}const Xn=Q(j9,[["render",X9],["__scopeId","data-v-0172efd7"]]),Z9=j1(Qo("/apps/contacts","")),ka=q1({history:Z9,linkActiveClass:"active",routes:[{path:"/",component:Xn,props:!0,name:"root",redirect:{name:"group",params:{selectedGroup:t("contacts","All contacts")}},children:[{path:`/${vm}/:selectedChart`,name:"chart",component:Xn},{path:"import",name:"import",component:Xn},{path:`${po}/:selectedCircle`,name:"circle",component:Xn},{path:":selectedGroup",name:"group",component:Xn},{path:":selectedGroup/:selectedContact",name:"contact",component:Xn}]}]}),Jn=_a(Sm);Jn.config.errorHandler=async function(e,i,o){lc.error(`[Vue error]: Error in ${o}: ${e}`,{error:e,vm:i,info:o}),window.onerror?.(e)};const J9=bm();Jn.use(J9),Jn.use(Cm),Jn.use(ka),Jn.mixin(oc),window.location.pathname.split("/")[1]==="index.php"&&window.OC.config.modRewriteWorking&&ka.push({name:"group",params:{selectedGroup:t("contacts","All contacts")}}),Jn.mount("#content");
//# sourceMappingURL=contacts-main.mjs.map
